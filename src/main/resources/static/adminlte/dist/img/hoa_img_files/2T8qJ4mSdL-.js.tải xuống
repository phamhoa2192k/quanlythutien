if (self.CavalryLogger) { CavalryLogger.start_js(["vBSbl"]); }

__d("OzHiveStreaming",[],(function $module_OzHiveStreaming(global,require,requireDynamic,requireLazy,module,exports){!function(define){!function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).adapter=e()}(function(){return function a(o,s,c){function d(t,e){if(!s[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(p)return p(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=s[t]={exports:{}};o[t][0].call(i.exports,function(e){return d(o[t][1][e]||e)},i,i.exports,a,o,s,c)}return s[t].exports}for(var p="function"==typeof require&&require,e=0;e<c.length;e++)d(c[e]);return d}({1:[function(e,t,r){"use strict";var n=e("./adapter_factory.js").adapterFactory({window:window});t.exports=n},{"./adapter_factory.js":2}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.adapterFactory=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},r=a.log,n=a.detectBrowser(e),i={browserDetails:n,commonShim:p,extractVersion:a.extractVersion,disableLog:a.disableLog,disableWarnings:a.disableWarnings};switch(n.browser){case"chrome":if(!o||!o.shimPeerConnection||!t.shimChrome)return r("Chrome shim is not included in this adapter release."),i;r("adapter.js shimming chrome."),(i.browserShim=o).shimGetUserMedia(e),o.shimMediaStream(e),o.shimPeerConnection(e),o.shimOnTrack(e),o.shimAddTrackRemoveTrack(e),o.shimGetSendersWithDtmf(e),o.shimGetStats(e),o.shimSenderReceiverGetStats(e),o.fixNegotiationNeeded(e),p.shimRTCIceCandidate(e),p.shimConnectionState(e),p.shimMaxMessageSize(e),p.shimSendThrowTypeError(e),p.removeAllowExtmapMixed(e);break;case"firefox":if(!c||!c.shimPeerConnection||!t.shimFirefox)return r("Firefox shim is not included in this adapter release."),i;r("adapter.js shimming firefox."),(i.browserShim=c).shimGetUserMedia(e),c.shimPeerConnection(e),c.shimOnTrack(e),c.shimRemoveStream(e),c.shimSenderGetStats(e),c.shimReceiverGetStats(e),c.shimRTCDataChannel(e),p.shimRTCIceCandidate(e),p.shimConnectionState(e),p.shimMaxMessageSize(e),p.shimSendThrowTypeError(e);break;case"edge":if(!s||!s.shimPeerConnection||!t.shimEdge)return r("MS edge shim is not included in this adapter release."),i;r("adapter.js shimming edge."),(i.browserShim=s).shimGetUserMedia(e),s.shimGetDisplayMedia(e),s.shimPeerConnection(e),s.shimReplaceTrack(e),p.shimMaxMessageSize(e),p.shimSendThrowTypeError(e);break;case"safari":if(!d||!t.shimSafari)return r("Safari shim is not included in this adapter release."),i;r("adapter.js shimming safari."),(i.browserShim=d).shimRTCIceServerUrls(e),d.shimCreateOfferLegacy(e),d.shimCallbacksAPI(e),d.shimLocalStreamsAPI(e),d.shimRemoteStreamsAPI(e),d.shimTrackEventTransceiver(e),d.shimGetUserMedia(e),p.shimRTCIceCandidate(e),p.shimMaxMessageSize(e),p.shimSendThrowTypeError(e),p.removeAllowExtmapMixed(e);break;default:r("Unsupported browser!")}return i};var a=n(e("./utils")),o=n(e("./chrome/chrome_shim")),s=n(e("./edge/edge_shim")),c=n(e("./firefox/firefox_shim")),d=n(e("./safari/safari_shim")),p=n(e("./common_shim"));function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var i=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),r.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},r.shimOnTrack=function(a){if("object"!==(void 0===a?"undefined":s(a))||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype)c.wrapPeerConnectionEvent(a,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e});else{Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var e=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var i=this;return this._ontrackpoly||(this._ontrackpoly=function(n){n.stream.addEventListener("addtrack",function(t){var e=void 0;e=a.RTCPeerConnection.prototype.getReceivers?i.getReceivers().find(function(e){return e.track&&e.track.id===t.track.id}):{track:t.track};var r=new Event("track");r.track=t.track,r.receiver=e,r.transceiver={receiver:e},r.streams=[n.stream],i.dispatchEvent(r)}),n.stream.getTracks().forEach(function(t){var e=void 0;e=a.RTCPeerConnection.prototype.getReceivers?i.getReceivers().find(function(e){return e.track&&e.track.id===t.id}):{track:t};var r=new Event("track");r.track=t,r.receiver=e,r.transceiver={receiver:e},r.streams=[n.stream],i.dispatchEvent(r)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}},r.shimGetSendersWithDtmf=function(e){if("object"===(void 0===e?"undefined":s(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var n=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,t){var r=i.apply(this,arguments);return r||(r=n(this,e),this._senders.push(r)),r};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var a=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._senders=this._senders||[],a.apply(this,[e]),e.getTracks().forEach(function(e){t._senders.push(n(t,e))})};var t=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var r=this;this._senders=this._senders||[],t.apply(this,[e]),e.getTracks().forEach(function(t){var e=r._senders.find(function(e){return e.track===t});e&&r._senders.splice(r._senders.indexOf(e),1)})}}else if("object"===(void 0===e?"undefined":s(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var o=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=o.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},r.shimGetStats=function(e){if(!e.RTCPeerConnection)return;var s=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,t,r){var n=this,i=arguments;if(0<arguments.length&&"function"==typeof e)return s.apply(this,arguments);if(0===s.length&&(0===arguments.length||"function"!=typeof e))return s.apply(this,[]);function a(e){var n={};return e.result().forEach(function(t){var r={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach(function(e){r[e]=t.stat(e)}),n[r.id]=r}),n}function o(t){return new Map(Object.keys(t).map(function(e){return[e,t[e]]}))}return 2<=arguments.length?s.apply(this,[function(e){i[1](o(a(e)))},e]):new Promise(function(t,e){s.apply(n,[function(e){t(o(a(e)))},e])}).then(t,r)}},r.shimSenderReceiverGetStats=function(e){if(!("object"===(void 0===e?"undefined":s(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){var r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=r.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e});var t=e.RTCPeerConnection.prototype.addTrack;t&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return c.filterStats(e,t.track,!0)})}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var n=e.RTCPeerConnection.prototype.getReceivers;n&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=n.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e}),c.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var t=this;return this._pc.getStats().then(function(e){return c.filterStats(e,t.track,!1)})}}if(!("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype))return;var a=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],r=void 0,n=void 0,i=void 0;return this.getSenders().forEach(function(e){e.track===t&&(r?i=!0:r=e)}),this.getReceivers().forEach(function(e){return e.track===t&&(n?i=!0:n=e),e.track===t}),i||r&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return a.apply(this,arguments)}},r.shimAddTrackRemoveTrackWithNative=d,r.shimAddTrackRemoveTrack=function(o){if(!o.RTCPeerConnection)return;var e=c.detectBrowser(o);if(o.RTCPeerConnection.prototype.addTrack&&65<=e.version)return d(o);var r=o.RTCPeerConnection.prototype.getLocalStreams;o.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this,e=r.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(function(e){return t._reverseStreams[e.id]})};var n=o.RTCPeerConnection.prototype.addStream;o.RTCPeerConnection.prototype.addStream=function(e){var r=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},e.getTracks().forEach(function(t){if(r.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[e.id]){var t=new o.MediaStream(e.getTracks());this._streams[e.id]=t,this._reverseStreams[t.id]=e,e=t}n.apply(this,[e])};var t=o.RTCPeerConnection.prototype.removeStream;function i(n,e){var i=e.sdp;return Object.keys(n._reverseStreams||[]).forEach(function(e){var t=n._reverseStreams[e],r=n._streams[t.id];i=i.replace(new RegExp(r.id,"g"),t.id)}),new RTCSessionDescription({type:e.type,sdp:i})}o.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},o.RTCPeerConnection.prototype.addTrack=function(t,e){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var n=[].slice.call(arguments,1);if(1!==n.length||!n[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var i=this._streams[e.id];if(i)i.addTrack(t),Promise.resolve().then(function(){r.dispatchEvent(new Event("negotiationneeded"))});else{var a=new o.MediaStream([t]);this._streams[e.id]=a,this._reverseStreams[a.id]=e,this.addStream(a)}return this.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(e){var t=o.RTCPeerConnection.prototype[e];o.RTCPeerConnection.prototype[e]=function(){var r=this,n=arguments;return arguments.length&&"function"==typeof arguments[0]?t.apply(this,[function(e){var t=i(r,e);n[0].apply(null,[t])},function(e){n[1]&&n[1].apply(null,e)},arguments[2]]):t.apply(this,arguments).then(function(e){return i(r,e)})}});var a=o.RTCPeerConnection.prototype.setLocalDescription;o.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type&&(arguments[0]=function(n,e){var i=e.sdp;return Object.keys(n._reverseStreams||[]).forEach(function(e){var t=n._reverseStreams[e],r=n._streams[t.id];i=i.replace(new RegExp(t.id,"g"),r.id)}),new RTCSessionDescription({type:e.type,sdp:i})}(this,arguments[0])),a.apply(this,arguments)};var s=Object.getOwnPropertyDescriptor(o.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(o.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=s.get.apply(this);return""===e.type?e:i(this,e)}}),o.RTCPeerConnection.prototype.removeTrack=function(t){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!t._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(t._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var n=void 0;Object.keys(this._streams).forEach(function(e){r._streams[e].getTracks().find(function(e){return t.track===e})&&(n=r._streams[e])}),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(t.track),this.dispatchEvent(new Event("negotiationneeded")))}},r.shimPeerConnection=function(r){!r.RTCPeerConnection&&r.webkitRTCPeerConnection&&(r.RTCPeerConnection=r.webkitRTCPeerConnection);if(!r.RTCPeerConnection)return;["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=r.RTCPeerConnection.prototype[e];r.RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=r.RTCPeerConnection.prototype.addIceCandidate;r.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}},r.fixNegotiationNeeded=function(e){c.wrapPeerConnectionEvent(e,"negotiationneeded",function(e){if("stable"===e.target.signalingState)return e})};var c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils.js"));function d(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(e){return t._shimmedLocalStreams[e][0]})};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,t){if(!t)return n.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=n.apply(this,arguments);return this._shimmedLocalStreams[t.id]?-1===this._shimmedLocalStreams[t.id].indexOf(r)&&this._shimmedLocalStreams[t.id].push(r):this._shimmedLocalStreams[t.id]=[t,r],r};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(t){if(r.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError")});var t=this.getSenders();i.apply(this,arguments);var n=this.getSenders().filter(function(e){return-1===t.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(n)};var t=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],t.apply(this,arguments)};var a=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(r){var n=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},r&&Object.keys(this._shimmedLocalStreams).forEach(function(e){var t=n._shimmedLocalStreams[e].indexOf(r);-1!==t&&n._shimmedLocalStreams[e].splice(t,1),1===n._shimmedLocalStreams[e].length&&delete n._shimmedLocalStreams[e]}),a.apply(this,arguments)}}},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(a,e){if(a.navigator.mediaDevices&&"getDisplayMedia"in a.navigator.mediaDevices)return;if(!a.navigator.mediaDevices)return;if("function"!=typeof e)return void 0;a.navigator.mediaDevices.getDisplayMedia=function(i){return e(i).then(function(e){var t=i.video&&i.video.width,r=i.video&&i.video.height,n=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:n||3}},t&&(i.video.mandatory.maxWidth=t),r&&(i.video.mandatory.maxHeight=r),a.navigator.mediaDevices.getUserMedia(i)})}}},{}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var o=e&&e.navigator;if(!o.mediaDevices)return;function s(i){if("object"!==(void 0===i?"undefined":d(i))||i.mandatory||i.optional)return i;var a={};return Object.keys(i).forEach(function(t){if("require"!==t&&"advanced"!==t&&"mediaSource"!==t){var r="object"===d(i[t])?i[t]:{ideal:i[t]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var n=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){a.optional=a.optional||[];var e={};"number"==typeof r.ideal?(e[n("min",t)]=r.ideal,a.optional.push(e),(e={})[n("max",t)]=r.ideal):e[n("",t)]=r.ideal,a.optional.push(e)}void 0!==r.exact&&"number"!=typeof r.exact?(a.mandatory=a.mandatory||{},a.mandatory[n("",t)]=r.exact):["min","max"].forEach(function(e){void 0!==r[e]&&(a.mandatory=a.mandatory||{},a.mandatory[n(e,t)]=r[e])})}}),i.advanced&&(a.optional=(a.optional||[]).concat(i.advanced)),a}function n(r,n){if(61<=c.version)return n(r);if((r=JSON.parse(JSON.stringify(r)))&&"object"===d(r.audio)){var e=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])};e((r=JSON.parse(JSON.stringify(r))).audio,"autoGainControl","googAutoGainControl"),e(r.audio,"noiseSuppression","googNoiseSuppression"),r.audio=s(r.audio)}if(r&&"object"===d(r.video)){var i=r.video.facingMode;i=i&&("object"===(void 0===i?"undefined":d(i))?i:{ideal:i});var t=c.version<66;if(i&&("user"===i.exact||"environment"===i.exact||"user"===i.ideal||"environment"===i.ideal)&&(!o.mediaDevices.getSupportedConstraints||!o.mediaDevices.getSupportedConstraints().facingMode||t)){delete r.video.facingMode;var a=void 0;if("environment"===i.exact||"environment"===i.ideal?a=["back","rear"]:"user"!==i.exact&&"user"!==i.ideal||(a=["front"]),a)return o.mediaDevices.enumerateDevices().then(function(e){var t=(e=e.filter(function(e){return"videoinput"===e.kind})).find(function(t){return a.some(function(e){return t.label.toLowerCase().includes(e)})});return!t&&e.length&&a.includes("back")&&(t=e[e.length-1]),t&&(r.video.deviceId=i.exact?{exact:t.deviceId}:{ideal:t.deviceId}),r.video=s(r.video),p("chrome: "+JSON.stringify(r)),n(r)})}r.video=s(r.video)}return p("chrome: "+JSON.stringify(r)),n(r)}function i(e){return 64<=c.version?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}}var c=a.detectBrowser(e);if(o.getUserMedia=function(e,t,r){n(e,function(e){o.webkitGetUserMedia(e,t,function(e){r&&r(i(e))})})}.bind(o),o.mediaDevices.getUserMedia){var r=o.mediaDevices.getUserMedia.bind(o.mediaDevices);o.mediaDevices.getUserMedia=function(e){return n(e,function(t){return r(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return e},function(e){return Promise.reject(i(e))})})}}};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils.js")),p=a.log},{"../utils.js":15}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimRTCIceCandidate=function(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;var i=t.RTCIceCandidate;t.RTCIceCandidate=function(e){if("object"===(void 0===e?"undefined":a(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var t=new i(e),r=s["default"].parseCandidate(e.candidate),n=Object.assign(t,r);return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new i(e)},t.RTCIceCandidate.prototype=i.prototype,c.wrapPeerConnectionEvent(t,"icecandidate",function(e){return e.candidate&&Object.defineProperty(e,"candidate",{value:new t.RTCIceCandidate(e.candidate),writable:"false"}),e})},r.shimMaxMessageSize=function(e){if(e.RTCSctpTransport||!e.RTCPeerConnection)return;var a=c.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var o=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,function(e){if(!e||!e.sdp)return!1;var t=s["default"].splitSections(e.sdp);return t.shift(),t.some(function(e){var t=s["default"].parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})}(arguments[0])){var e=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var r=parseInt(t[1],10);return r!=r?-1:r}(arguments[0]),t=function(e){var t=65536;return"firefox"===a.browser&&(t=a.version<57?-1===e?16384:2147483637:a.version<60?57===a.version?65535:65536:2147483637),t}(e),r=function(e,t){var r=65536;"firefox"===a.browser&&57===a.version&&(r=65535);var n=s["default"].matchPrefix(e.sdp,"a=max-message-size:");return 0<n.length?r=parseInt(n[0].substr(19),10):"firefox"===a.browser&&-1!==t&&(r=2147483637),r}(arguments[0],e),n=void 0;n=0===t&&0===r?Number.POSITIVE_INFINITY:0===t||0===r?Math.max(t,r):Math.min(t,r);var i={};Object.defineProperty(i,"maxMessageSize",{get:function(){return n}}),this._sctp=i}return o.apply(this,arguments)}},r.shimSendThrowTypeError=function(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype))return;function t(r,n){var i=r.send;r.send=function(){var e=arguments[0],t=e.length||e.size||e.byteLength;if("open"===r.readyState&&n.sctp&&t>n.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)");return i.apply(r,arguments)}}var r=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=r.apply(this,arguments);return t(e,this),e},c.wrapPeerConnectionEvent(e,"datachannel",function(e){return t(e.channel,e.target),e})},r.shimConnectionState=function(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;var r=e.RTCPeerConnection.prototype;Object.defineProperty(r,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(r,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(e){var t=r[e];r[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var r=new Event("connectionstatechange",e);t.dispatchEvent(r)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),t.apply(this,arguments)}})},r.removeAllowExtmapMixed=function(e){if(!e.RTCPeerConnection)return;var t=c.detectBrowser(e);if("chrome"===t.browser&&71<=t.version)return;var r=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n")),r.apply(this,arguments)}};var n,i=e("sdp"),s=(n=i)&&n.__esModule?n:{"default":n},c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("./utils"))},{"./utils":15,sdp:17}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var n=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var i=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),r.shimPeerConnection=function(e){var t=o.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var r=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){r.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}});e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var n=d["default"](e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=s.filterIceServers(e.iceServers,t.version),o.log("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype},r.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};var a,o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils")),s=e("./filtericeservers"),c=e("rtcpeerconnection-shim"),d=(a=c)&&a.__esModule?a:{"default":a}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.filterIceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&i.deprecated("RTCIceServer.url","RTCIceServer.urls");var r="string"==typeof t;return r&&(t=[t]),t=t.filter(function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?n=!0:t&&!n}),delete e.url,e.urls=r?t[0]:t,!!t.length}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils"))},{"../utils":15}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(e){if(!("getDisplayMedia"in e.navigator))return;if(!e.navigator.mediaDevices)return;if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)}},{}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetUserMedia=function(e){var t=e&&e.navigator,r=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return r(e)["catch"](function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))})}}},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return n.shimGetUserMedia}});var i=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),r.shimOnTrack=function(e){"object"===(void 0===e?"undefined":o(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimPeerConnection=function(r){var n=s.detectBrowser(r);if("object"!==(void 0===r?"undefined":o(r))||!r.RTCPeerConnection&&!r.mozRTCPeerConnection)return;!r.RTCPeerConnection&&r.mozRTCPeerConnection&&(r.RTCPeerConnection=r.mozRTCPeerConnection);["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=r.RTCPeerConnection.prototype[e];r.RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=r.RTCPeerConnection.prototype.addIceCandidate;r.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},a=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(e,t,r){return a.apply(this,[e||null]).then(function(r){if(n.version<53&&!t)try{r.forEach(function(e){e.type=i[e.type]||e.type})}catch(e){if("TypeError"!==e.name)throw e;r.forEach(function(e,t){r.set(t,Object.assign({},e,{type:i[e.type]||e.type}))})}return r}).then(t,r)}},r.shimSenderGetStats=function(e){if("object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;var r=e.RTCPeerConnection.prototype.getSenders;r&&(e.RTCPeerConnection.prototype.getSenders=function(){var t=this,e=r.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e});var t=e.RTCPeerConnection.prototype.addTrack;t&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=t.apply(this,arguments);return e._pc=this,e});e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map())}},r.shimReceiverGetStats=function(e){if("object"!==(void 0===e?"undefined":o(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;var r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){var t=this,e=r.apply(this,[]);return e.forEach(function(e){return e._pc=t}),e});s.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}},r.shimRemoveStream=function(e){if(!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype)return;e.RTCPeerConnection.prototype.removeStream=function(t){var r=this;s.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(e){e.track&&t.getTracks().includes(e.track)&&r.removeTrack(e)})}},r.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)};var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=function(r,n){if(r.navigator.mediaDevices&&"getDisplayMedia"in r.navigator.mediaDevices)return;if(!r.navigator.mediaDevices)return;r.navigator.mediaDevices.getDisplayMedia=function(e){if(e&&e.video)return!0===e.video?e.video={mediaSource:n}:e.video.mediaSource=n,r.navigator.mediaDevices.getUserMedia(e);var t=new DOMException("getDisplayMedia without video constraints is undefined");return t.name="NotFoundError",t.code=8,Promise.reject(t)}}},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var t=d.detectBrowser(e),n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){d.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(55<t.version&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var i=function(e,t,r){t in e&&!(r in e)&&(e[r]=e[t],delete e[t])},a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":c(e))&&"object"===c(e.audio)&&(e=JSON.parse(JSON.stringify(e)),i(e.audio,"autoGainControl","mozAutoGainControl"),i(e.audio,"noiseSuppression","mozNoiseSuppression")),a(e)},r&&r.prototype.getSettings){var o=r.prototype.getSettings;r.prototype.getSettings=function(){var e=o.apply(this,arguments);return i(e,"mozAutoGainControl","autoGainControl"),i(e,"mozNoiseSuppression","noiseSuppression"),e}}if(r&&r.prototype.applyConstraints){var s=r.prototype.applyConstraints;r.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":c(e))&&(e=JSON.parse(JSON.stringify(e)),i(e,"autoGainControl","mozAutoGainControl"),i(e,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[e])}}}};var d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils"))},{"../utils":15}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimLocalStreamsAPI=function(e){if("object"!==(void 0===e?"undefined":d(e))||!e.RTCPeerConnection)return;"getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams});if(!("addStream"in e.RTCPeerConnection.prototype)){var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(t){var r=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(t)||this._localStreams.push(t),t.getTracks().forEach(function(e){return n.call(r,e,t)})},e.RTCPeerConnection.prototype.addTrack=function(e,t){return t&&(this._localStreams?this._localStreams.includes(t)||this._localStreams.push(t):this._localStreams=[t]),n.call(this,e,t)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var r=this._localStreams.indexOf(e);if(-1!==r){this._localStreams.splice(r,1);var n=e.getTracks();this.getSenders().forEach(function(e){n.includes(e.track)&&t.removeTrack(e)})}})},r.shimRemoteStreamsAPI=function(e){if("object"!==(void 0===e?"undefined":d(e))||!e.RTCPeerConnection)return;"getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]});if(!("onaddstream"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var r=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(r._remoteStreams||(r._remoteStreams=[]),!r._remoteStreams.includes(e)){r._remoteStreams.push(e);var t=new Event("addstream");t.stream=e,r.dispatchEvent(t)}})})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(r._remoteStreams||(r._remoteStreams=[]),!(0<=r._remoteStreams.indexOf(e))){r._remoteStreams.push(e);var t=new Event("addstream");t.stream=e,r.dispatchEvent(t)}})}),t.apply(r,arguments)}}},r.shimCallbacksAPI=function(e){if("object"!==(void 0===e?"undefined":d(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype,i=t.createOffer,a=t.createAnswer,o=t.setLocalDescription,s=t.setRemoteDescription,c=t.addIceCandidate;t.createOffer=function(e,t){var r=2<=arguments.length?arguments[2]:e,n=i.apply(this,[r]);return t?(n.then(e,t),Promise.resolve()):n},t.createAnswer=function(e,t){var r=2<=arguments.length?arguments[2]:e,n=a.apply(this,[r]);return t?(n.then(e,t),Promise.resolve()):n};var r=function(e,t,r){var n=o.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n};t.setLocalDescription=r,r=function(e,t,r){var n=s.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.setRemoteDescription=r,r=function(e,t,r){var n=c.apply(this,[e]);return r?(n.then(t,r),Promise.resolve()):n},t.addIceCandidate=r},r.shimGetUserMedia=function(e){var n=e&&e.navigator;if(n.mediaDevices&&n.mediaDevices.getUserMedia){var t=n.mediaDevices,r=t.getUserMedia.bind(t);n.mediaDevices.getUserMedia=function(e){return r(i(e))}}!n.getUserMedia&&n.mediaDevices&&n.mediaDevices.getUserMedia&&(n.getUserMedia=function(e,t,r){n.mediaDevices.getUserMedia(e).then(t,r)}.bind(n))},r.shimConstraints=i,r.shimRTCIceServerUrls=function(e){var a=e.RTCPeerConnection;e.RTCPeerConnection=function(e,t){if(e&&e.iceServers){for(var r=[],n=0;n<e.iceServers.length;n++){var i=e.iceServers[n];!i.hasOwnProperty("urls")&&i.hasOwnProperty("url")?(o.deprecated("RTCIceServer.url","RTCIceServer.urls"),(i=JSON.parse(JSON.stringify(i))).urls=i.url,delete i.url,r.push(i)):r.push(e.iceServers[n])}e.iceServers=r}return new a(e,t)},e.RTCPeerConnection.prototype=a.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return a.generateCertificate}})},r.shimTrackEventTransceiver=function(e){"object"===(void 0===e?"undefined":d(e))&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimCreateOfferLegacy=function(e){var n=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var t=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind});!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var r=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind});!1===e.offerToReceiveVideo&&r?"sendrecv"===r.direction?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":"recvonly"===r.direction&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):!0!==e.offerToReceiveVideo||r||this.addTransceiver("video")}return n.apply(this,arguments)}};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}(e("../utils"));function i(e){return e&&void 0!==e.video?Object.assign({},e,{video:o.compactObject(e.video)}):e}},{"../utils":15}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.extractVersion=a,r.wrapPeerConnectionEvent=function(e,n,i){if(!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype,a=t.addEventListener;t.addEventListener=function(e,r){if(e!==n)return a.apply(this,arguments);function t(e){var t=i(e);t&&r(t)}return this._eventMap=this._eventMap||{},this._eventMap[r]=t,a.apply(this,[e,t])};var o=t.removeEventListener;t.removeEventListener=function(e,t){if(e!==n||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);var r=this._eventMap[t];return delete this._eventMap[t],o.apply(this,[e,r])},Object.defineProperty(t,"on"+n,{get:function(){return this["_on"+n]},set:function(e){this["_on"+n]&&(this.removeEventListener(n,this["_on"+n]),delete this["_on"+n]),e&&this.addEventListener(n,this["_on"+n]=e)},enumerable:!0,configurable:!0})},r.disableLog=function(e){return"boolean"==typeof e?(n=e)?"adapter.js logging disabled":"adapter.js logging enabled":new Error("Argument type: "+(void 0===e?"undefined":s(e))+". Please use a boolean.")},r.disableWarnings=function(e){return"boolean"==typeof e?(i=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled")):new Error("Argument type: "+(void 0===e?"undefined":s(e))+". Please use a boolean.")},r.log=function(){if("object"===("undefined"==typeof window?"undefined":s(window))){if(n)return;"undefined"!=typeof console&&"function"==typeof emptyFunction&&emptyFunction.apply(console,arguments)}},r.deprecated=function(e,t){if(!i)return},r.detectBrowser=function(e){var t=e.navigator,r={browser:null,version:null};if(void 0===e||!e.navigator)return r.browser="Not a browser.",r;if(t.mozGetUserMedia)r.browser="firefox",r.version=a(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)r.browser="chrome",r.version=a(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))r.browser="edge",r.version=a(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return r.browser="Not a supported browser.",r;r.browser="safari",r.version=a(t.userAgent,/AppleWebKit\/(\d+)\./,1)}return r},r.compactObject=function a(o){return"object"!==(void 0===o?"undefined":s(o))?o:Object.keys(o).reduce(function(e,t){var r="object"===s(o[t]),n=r?a(o[t]):o[t],i=r&&!Object.keys(n).length;return void 0===n||i?e:Object.assign(e,c({},t,n))},{})},r.walkStats=o,r.filterStats=function(r,t,e){var n=e?"outbound-rtp":"inbound-rtp",i=new Map();if(null===t)return i;var a=[];return r.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)}),a.forEach(function(t){r.forEach(function(e){e.type===n&&e.trackId===t.id&&o(r,e,i)})}),i};var n=!0,i=!0;function a(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function o(t,r,n){r&&!n.has(r.id)&&(n.set(r.id,r),Object.keys(r).forEach(function(e){e.endsWith("Id")?o(t,t.get(r[e]),n):e.endsWith("Ids")&&r[e].forEach(function(e){o(t,t.get(e),n)})}))}},{}],16:[function(e,t,r){"use strict";var G=e("sdp");function c(e,t,r,n,i){var a=G.writeRtpDescription(e.kind,t);if(a+=G.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=G.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":i||"active"),a+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var o=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=o;var s="msid:"+(n?n.id:"-")+" "+o+"\r\n";a+="a="+s,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+G.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+G.localCName+"\r\n"),a}function A(d,p){function u(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++)if(t[r].payloadType===e||t[r].preferredPayloadType===e)return t[r]}var f={codecs:[],headerExtensions:[],fecMechanisms:[]};return d.codecs.forEach(function(r){for(var e=0;e<p.codecs.length;e++){var t=p.codecs[e];if(r.name.toLowerCase()===t.name.toLowerCase()&&r.clockRate===t.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&t.parameters.apt&&(n=r,i=t,a=d.codecs,o=p.codecs,c=s=void 0,s=u(n.parameters.apt,a),c=u(i.parameters.apt,o),!s||!c||s.name.toLowerCase()!==c.name.toLowerCase()))continue;(t=JSON.parse(JSON.stringify(t))).numChannels=Math.min(r.numChannels,t.numChannels),f.codecs.push(t),t.rtcpFeedback=t.rtcpFeedback.filter(function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}var n,i,a,o,s,c}),d.headerExtensions.forEach(function(e){for(var t=0;t<p.headerExtensions.length;t++){var r=p.headerExtensions[t];if(e.uri===r.uri){f.headerExtensions.push(r);break}}}),f}function a(e,t,r){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)}function N(e,t){var r=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return r||e.addRemoteCandidate(t),!r}function m(e,t){var r=new Error(t);return r.name=e,r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],r}t.exports=function(I,j){function L(e,t){t.addTrack(e),t.dispatchEvent(new I.MediaStreamTrackEvent("addtrack",{track:e}))}function i(e,t,r,n){var i=new Event("track");i.track=t,i.receiver=r,i.transceiver={receiver:r},i.streams=n,I.setTimeout(function(){e._dispatchEvent("track",i)})}function n(e){var t=this,r=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){t[e]=r[e].bind(r)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",e=JSON.parse(JSON.stringify(e||{})),this.usingBundle="max-bundle"===e.bundlePolicy,"negotiate"===e.rtcpMuxPolicy)throw m("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(e.rtcpMuxPolicy||(e.rtcpMuxPolicy="require"),e.iceTransportPolicy){case"all":case"relay":break;default:e.iceTransportPolicy="all"}switch(e.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:e.bundlePolicy="balanced"}if(e.iceServers=function(e,n){var i=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&!1;var r="string"==typeof t;return r&&(t=[t]),t=t.filter(function(e){return 0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!i?i=!0:0===e.indexOf("stun:")&&14393<=n&&-1===e.indexOf("?transport=udp")}),delete e.url,e.urls=r?t[0]:t,!!t.length}})}(e.iceServers||[],j),this._iceGatherers=[],e.iceCandidatePoolSize)for(var n=e.iceCandidatePoolSize;0<n;n--)this._iceGatherers.push(new I.RTCIceGatherer({iceServers:e.iceServers,gatherPolicy:e.iceTransportPolicy}));else e.iceCandidatePoolSize=0;this._config=e,this.transceivers=[],this._sdpSessionId=G.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1}Object.defineProperty(n.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(n.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),n.prototype.onicecandidate=null,n.prototype.onaddstream=null,n.prototype.ontrack=null,n.prototype.onremovestream=null,n.prototype.onsignalingstatechange=null,n.prototype.oniceconnectionstatechange=null,n.prototype.onconnectionstatechange=null,n.prototype.onicegatheringstatechange=null,n.prototype.onnegotiationneeded=null,n.prototype.ondatachannel=null,n.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},n.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},n.prototype.getConfiguration=function(){return this._config},n.prototype.getLocalStreams=function(){return this.localStreams},n.prototype.getRemoteStreams=function(){return this.remoteStreams},n.prototype._createTransceiver=function(e,t){var r=0<this.transceivers.length,n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&r)n.iceTransport=this.transceivers[0].iceTransport,n.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();n.iceTransport=i.iceTransport,n.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(n),n},n.prototype.addTrack=function(t,e){if(this._isClosed)throw m("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find(function(e){return e.track===t}))throw m("InvalidAccessError","Track already exists.");for(var n=0;n<this.transceivers.length;n++)this.transceivers[n].track||this.transceivers[n].kind!==t.kind||(r=this.transceivers[n]);return r=r||this._createTransceiver(t.kind),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(e)&&this.localStreams.push(e),r.track=t,r.stream=e,r.rtpSender=new I.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},n.prototype.addStream=function(t){var r=this;if(15025<=j)t.getTracks().forEach(function(e){r.addTrack(e,t)});else{var n=t.clone();t.getTracks().forEach(function(e,t){var r=n.getTracks()[t];e.addEventListener("enabled",function(e){r.enabled=e.enabled})}),n.getTracks().forEach(function(e){r.addTrack(e,n)})}},n.prototype.removeTrack=function(t){if(this._isClosed)throw m("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof I.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var e=this.transceivers.find(function(e){return e.rtpSender===t});if(!e)throw m("InvalidAccessError","Sender was not created by this connection.");var r=e.stream;e.rtpSender.stop(),e.rtpSender=null,e.track=null,e.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(r)&&-1<this.localStreams.indexOf(r)&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},n.prototype.removeStream=function(e){var r=this;e.getTracks().forEach(function(t){var e=r.getSenders().find(function(e){return e.track===t});e&&r.removeTrack(e)})},n.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},n.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},n.prototype._createIceGatherer=function(r,e){var n=this;if(e&&0<r)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new I.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[r].bufferedCandidateEvents=[],this.transceivers[r].bufferCandidates=function(e){var t=!e.candidate||0===Object.keys(e.candidate).length;i.state=t?"completed":"gathering",null!==n.transceivers[r].bufferedCandidateEvents&&n.transceivers[r].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[r].bufferCandidates),i},n.prototype._gather=function(s,c){var d=this,p=this.transceivers[c].iceGatherer;if(!p.onlocalcandidate){var e=this.transceivers[c].bufferedCandidateEvents;this.transceivers[c].bufferedCandidateEvents=null,p.removeEventListener("localcandidate",this.transceivers[c].bufferCandidates),p.onlocalcandidate=function(e){if(!(d.usingBundle&&0<c)){var t=new Event("icecandidate");t.candidate={sdpMid:s,sdpMLineIndex:c};var r=e.candidate,n=!r||0===Object.keys(r).length;if(n)"new"!==p.state&&"gathering"!==p.state||(p.state="completed");else{"new"===p.state&&(p.state="gathering"),r.component=1,r.ufrag=p.getLocalParameters().usernameFragment;var i=G.writeCandidate(r);t.candidate=Object.assign(t.candidate,G.parseCandidate(i)),t.candidate.candidate=i,t.candidate.toJSON=function(){return{candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex,usernameFragment:t.candidate.usernameFragment}}}var a=G.getMediaSections(d._localDescription.sdp);a[t.candidate.sdpMLineIndex]+=n?"a=end-of-candidates\r\n":"a="+t.candidate.candidate+"\r\n",d._localDescription.sdp=G.getDescription(d._localDescription.sdp)+a.join("");var o=d.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});"gathering"!==d.iceGatheringState&&(d.iceGatheringState="gathering",d._emitGatheringStateChange()),n||d._dispatchEvent("icecandidate",t),o&&(d._dispatchEvent("icecandidate",new Event("icecandidate")),d.iceGatheringState="complete",d._emitGatheringStateChange())}},I.setTimeout(function(){e.forEach(function(e){p.onlocalcandidate(e)})},0)}},n.prototype._createIceAndDtlsTransports=function(){var e=this,t=new I.RTCIceTransport(null);t.onicestatechange=function(){e._updateIceConnectionState(),e._updateConnectionState()};var r=new I.RTCDtlsTransport(t);return r.ondtlsstatechange=function(){e._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),e._updateConnectionState()},{iceTransport:t,dtlsTransport:r}},n.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var r=this.transceivers[e].iceTransport;r&&(delete r.onicestatechange,delete this.transceivers[e].iceTransport);var n=this.transceivers[e].dtlsTransport;n&&(delete n.ondtlsstatechange,delete n.onerror,delete this.transceivers[e].dtlsTransport)},n.prototype._transceive=function(e,t,r){var n=A(e.localCapabilities,e.remoteCapabilities);t&&e.rtpSender&&(n.encodings=e.sendEncodingParameters,n.rtcp={cname:G.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(n.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(n)),r&&e.rtpReceiver&&0<n.codecs.length&&("video"===e.kind&&e.recvEncodingParameters&&j<15019&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),e.recvEncodingParameters.length?n.encodings=e.recvEncodingParameters:n.encodings=[{}],n.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(n.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(n.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(n))},n.prototype.setLocalDescription=function(e){var t,u,f=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(m("TypeError",'Unsupported type "'+e.type+'"'));if(!a("setLocalDescription",e.type,f.signalingState)||f._isClosed)return Promise.reject(m("InvalidStateError","Can not set local "+e.type+" in state "+f.signalingState));if("offer"===e.type)t=G.splitSections(e.sdp),u=t.shift(),t.forEach(function(e,t){var r=G.parseRtpParameters(e);f.transceivers[t].localCapabilities=r}),f.transceivers.forEach(function(e,t){f._gather(e.mid,t)});else if("answer"===e.type){t=G.splitSections(f._remoteDescription.sdp),u=t.shift();var l=0<G.matchPrefix(u,"a=ice-lite").length;t.forEach(function(e,t){var r=f.transceivers[t],n=r.iceGatherer,i=r.iceTransport,a=r.dtlsTransport,o=r.localCapabilities,s=r.remoteCapabilities;if(!(G.isRejected(e)&&0===G.matchPrefix(e,"a=bundle-only").length)&&!r.rejected){var c=G.getIceParameters(e,u),d=G.getDtlsParameters(e,u);l&&(d.role="server"),f.usingBundle&&0!==t||(f._gather(r.mid,t),"new"===i.state&&i.start(n,c,l?"controlling":"controlled"),"new"===a.state&&a.start(d));var p=A(o,s);f._transceive(r,0<p.codecs.length,!1)}})}return f._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?f._updateSignalingState("have-local-offer"):f._updateSignalingState("stable"),Promise.resolve()},n.prototype.setRemoteDescription=function(_){var w=this;if(-1===["offer","answer"].indexOf(_.type))return Promise.reject(m("TypeError",'Unsupported type "'+_.type+'"'));if(!a("setRemoteDescription",_.type,w.signalingState)||w._isClosed)return Promise.reject(m("InvalidStateError","Can not set remote "+_.type+" in state "+w.signalingState));var k={};w.remoteStreams.forEach(function(e){k[e.id]=e});var M=[],e=G.splitSections(_.sdp),D=e.shift(),x=0<G.matchPrefix(D,"a=ice-lite").length,O=0<G.matchPrefix(D,"a=group:BUNDLE ").length;w.usingBundle=O;var t=G.matchPrefix(D,"a=ice-options:")[0];return w.canTrickleIceCandidates=!!t&&0<=t.substr(14).split(" ").indexOf("trickle"),e.forEach(function(e,t){var r=G.splitLines(e),n=G.getKind(e),i=G.isRejected(e)&&0===G.matchPrefix(e,"a=bundle-only").length,a=r[0].substr(2).split(" ")[2],o=G.getDirection(e,D),s=G.parseMsid(e),c=G.getMid(e)||G.generateIdentifier();if(i||"application"===n&&("DTLS/SCTP"===a||"UDP/DTLS/SCTP"===a))w.transceivers[t]={mid:c,kind:n,protocol:a,rejected:!0};else{var d,p,u,f,l,m,h,v,y;!i&&w.transceivers[t]&&w.transceivers[t].rejected&&(w.transceivers[t]=w._createTransceiver(n,!0));var g,C,S=G.parseRtpParameters(e);i||(g=G.getIceParameters(e,D),(C=G.getDtlsParameters(e,D)).role="client"),h=G.parseRtpEncodingParameters(e);var T=G.parseRtcpParameters(e),R=0<G.matchPrefix(e,"a=end-of-candidates",D).length,P=G.matchPrefix(e,"a=candidate:").map(function(e){return G.parseCandidate(e)}).filter(function(e){return 1===e.component});if(("offer"===_.type||"answer"===_.type)&&!i&&O&&0<t&&w.transceivers[t]&&(w._disposeIceAndDtlsTransports(t),w.transceivers[t].iceGatherer=w.transceivers[0].iceGatherer,w.transceivers[t].iceTransport=w.transceivers[0].iceTransport,w.transceivers[t].dtlsTransport=w.transceivers[0].dtlsTransport,w.transceivers[t].rtpSender&&w.transceivers[t].rtpSender.setTransport(w.transceivers[0].dtlsTransport),w.transceivers[t].rtpReceiver&&w.transceivers[t].rtpReceiver.setTransport(w.transceivers[0].dtlsTransport)),"offer"!==_.type||i)"answer"===_.type&&!i&&(p=(d=w.transceivers[t]).iceGatherer,u=d.iceTransport,f=d.dtlsTransport,l=d.rtpReceiver,m=d.sendEncodingParameters,v=d.localCapabilities,w.transceivers[t].recvEncodingParameters=h,w.transceivers[t].remoteCapabilities=S,w.transceivers[t].rtcpParameters=T,P.length&&"new"===u.state&&(!x&&!R||O&&0!==t?P.forEach(function(e){N(d.iceTransport,e)}):u.setRemoteCandidates(P)),O&&0!==t||("new"===u.state&&u.start(p,g,"controlling"),"new"===f.state&&f.start(C)),!A(d.localCapabilities,d.remoteCapabilities).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&d.sendEncodingParameters[0].rtx&&delete d.sendEncodingParameters[0].rtx,w._transceive(d,"sendrecv"===o||"recvonly"===o,"sendrecv"===o||"sendonly"===o),!l||"sendrecv"!==o&&"sendonly"!==o?delete d.rtpReceiver:(y=l.track,s?(k[s.stream]||(k[s.stream]=new I.MediaStream()),L(y,k[s.stream]),M.push([y,l,k[s.stream]])):(k["default"]||(k["default"]=new I.MediaStream()),L(y,k["default"]),M.push([y,l,k["default"]]))));else{(d=w.transceivers[t]||w._createTransceiver(n)).mid=c,d.iceGatherer||(d.iceGatherer=w._createIceGatherer(t,O)),P.length&&"new"===d.iceTransport.state&&(!R||O&&0!==t?P.forEach(function(e){N(d.iceTransport,e)}):d.iceTransport.setRemoteCandidates(P)),v=I.RTCRtpReceiver.getCapabilities(n),j<15019&&(v.codecs=v.codecs.filter(function(e){return"rtx"!==e.name})),m=d.sendEncodingParameters||[{ssrc:1001*(2*t+2)}];var b,E=!1;"sendrecv"===o||"sendonly"===o?(E=!d.rtpReceiver,l=d.rtpReceiver||new I.RTCRtpReceiver(d.dtlsTransport,n),E)&&(y=l.track,s&&"-"===s.stream||(b=s?(k[s.stream]||(k[s.stream]=new I.MediaStream(),Object.defineProperty(k[s.stream],"id",{get:function(){return s.stream}})),Object.defineProperty(y,"id",{get:function(){return s.track}}),k[s.stream]):(k["default"]||(k["default"]=new I.MediaStream()),k["default"])),b&&(L(y,b),d.associatedRemoteMediaStreams.push(b)),M.push([y,l,b])):d.rtpReceiver&&d.rtpReceiver.track&&(d.associatedRemoteMediaStreams.forEach(function(e){var t=e.getTracks().find(function(e){return e.id===d.rtpReceiver.track.id});t&&(function(e,t){t.removeTrack(e),t.dispatchEvent(new I.MediaStreamTrackEvent("removetrack",{track:e}))})(t,e)}),d.associatedRemoteMediaStreams=[]);d.localCapabilities=v,d.remoteCapabilities=S,d.rtpReceiver=l,d.rtcpParameters=T,d.sendEncodingParameters=m,d.recvEncodingParameters=h,w._transceive(w.transceivers[t],!1,E)}}}),void 0===w._dtlsRole&&(w._dtlsRole="offer"===_.type?"active":"passive"),w._remoteDescription={type:_.type,sdp:_.sdp},"offer"===_.type?w._updateSignalingState("have-remote-offer"):w._updateSignalingState("stable"),Object.keys(k).forEach(function(e){var n=k[e];if(n.getTracks().length){if(-1===w.remoteStreams.indexOf(n)){w.remoteStreams.push(n);var t=new Event("addstream");t.stream=n,I.setTimeout(function(){w._dispatchEvent("addstream",t)})}M.forEach(function(e){var t=e[0],r=e[1];n.id===e[2].id&&i(w,t,r,[n])})}}),M.forEach(function(e){e[2]||i(w,e[0],e[1],[])}),I.setTimeout(function(){w&&w.transceivers&&w.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&0<e.iceTransport.getRemoteCandidates().length&&(!1,e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},n.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},n.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},n.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,I.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0))},n.prototype._updateIceConnectionState=function(){var e,t={"new":0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++}),e="new",0<t.failed?e="failed":0<t.checking?e="checking":0<t.disconnected?e="disconnected":0<t["new"]?e="new":0<t.connected?e="connected":0<t.completed&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}},n.prototype._updateConnectionState=function(){var e,t={"new":0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)}),t.connected+=t.completed,e="new",0<t.failed?e="failed":0<t.connecting?e="connecting":0<t.disconnected?e="disconnected":0<t["new"]?e="new":0<t.connected&&(e="connected"),e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}},n.prototype.createOffer=function(){var s=this;if(s._isClosed)return Promise.reject(m("InvalidStateError","Can not call createOffer after close"));var t=s.transceivers.filter(function(e){return"audio"===e.kind}).length,r=s.transceivers.filter(function(e){return"video"===e.kind}).length,e=arguments[0];if(e){if(e.mandatory||e.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==e.offerToReceiveAudio&&(t=!0===e.offerToReceiveAudio?1:!1===e.offerToReceiveAudio?0:e.offerToReceiveAudio),void 0!==e.offerToReceiveVideo&&(r=!0===e.offerToReceiveVideo?1:!1===e.offerToReceiveVideo?0:e.offerToReceiveVideo)}for(s.transceivers.forEach(function(e){"audio"===e.kind?--t<0&&(e.wantReceive=!1):"video"===e.kind&&--r<0&&(e.wantReceive=!1)});0<t||0<r;)0<t&&(s._createTransceiver("audio"),t--),0<r&&(s._createTransceiver("video"),r--);var n=G.writeSessionBoilerplate(s._sdpSessionId,s._sdpSessionVersion++);s.transceivers.forEach(function(e,t){var r=e.track,n=e.kind,i=e.mid||G.generateIdentifier();e.mid=i,e.iceGatherer||(e.iceGatherer=s._createIceGatherer(t,s.usingBundle));var a=I.RTCRtpSender.getCapabilities(n);j<15019&&(a.codecs=a.codecs.filter(function(e){return"rtx"!==e.name})),a.codecs.forEach(function(t){"H264"===t.name&&void 0===t.parameters["level-asymmetry-allowed"]&&(t.parameters["level-asymmetry-allowed"]="1"),e.remoteCapabilities&&e.remoteCapabilities.codecs&&e.remoteCapabilities.codecs.forEach(function(e){t.name.toLowerCase()===e.name.toLowerCase()&&t.clockRate===e.clockRate&&(t.preferredPayloadType=e.payloadType)})}),a.headerExtensions.forEach(function(t){(e.remoteCapabilities&&e.remoteCapabilities.headerExtensions||[]).forEach(function(e){t.uri===e.uri&&(t.id=e.id)})});var o=e.sendEncodingParameters||[{ssrc:1001*(2*t+1)}];r&&15019<=j&&"video"===n&&!o[0].rtx&&(o[0].rtx={ssrc:o[0].ssrc+1}),e.wantReceive&&(e.rtpReceiver=new I.RTCRtpReceiver(e.dtlsTransport,n)),e.localCapabilities=a,e.sendEncodingParameters=o}),"max-compat"!==s._config.bundlePolicy&&(n+="a=group:BUNDLE "+s.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),n+="a=ice-options:trickle\r\n",s.transceivers.forEach(function(e,t){n+=c(e,e.localCapabilities,"offer",e.stream,s._dtlsRole),n+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===s.iceGatheringState||0!==t&&s.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,n+="a="+G.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(n+="a=end-of-candidates\r\n"))});var i=new I.RTCSessionDescription({type:"offer",sdp:n});return Promise.resolve(i)},n.prototype.createAnswer=function(){var i=this;if(i._isClosed)return Promise.reject(m("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==i.signalingState&&"have-local-pranswer"!==i.signalingState)return Promise.reject(m("InvalidStateError","Can not call createAnswer in signalingState "+i.signalingState));var a=G.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);i.usingBundle&&(a+="a=group:BUNDLE "+i.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n";var o=G.getMediaSections(i._remoteDescription.sdp).length;i.transceivers.forEach(function(e,t){if(!(o<t+1)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?a+="m=application 0 DTLS/SCTP 5000\r\n":a+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void (a+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var r;e.stream&&("audio"===e.kind?r=e.stream.getAudioTracks()[0]:"video"===e.kind&&(r=e.stream.getVideoTracks()[0]),r&&15019<=j&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var n=A(e.localCapabilities,e.remoteCapabilities);!n.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,a+=c(e,n,"answer",e.stream,i._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(a+="a=rtcp-rsize\r\n")}});var e=new I.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(e)},n.prototype.addIceCandidate=function(c){var d,p=this;return c&&void 0===c.sdpMLineIndex&&!c.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(e,t){if(!p._remoteDescription)return t(m("InvalidStateError","Can not add ICE candidate without a remote description"));if(c&&""!==c.candidate){var r=c.sdpMLineIndex;if(c.sdpMid)for(var n=0;n<p.transceivers.length;n++)if(p.transceivers[n].mid===c.sdpMid){r=n;break}var i=p.transceivers[r];if(!i)return t(m("OperationError","Can not add ICE candidate"));if(i.rejected)return e();var a=0<Object.keys(c.candidate).length?G.parseCandidate(c.candidate):{};if("tcp"===a.protocol&&(0===a.port||9===a.port))return e();if(a.component&&1!==a.component)return e();if((0===r||0<r&&i.iceTransport!==p.transceivers[0].iceTransport)&&!N(i.iceTransport,a))return t(m("OperationError","Can not add ICE candidate"));var o=c.candidate.trim();0===o.indexOf("a=")&&(o=o.substr(2)),(d=G.getMediaSections(p._remoteDescription.sdp))[r]+="a="+(a.type?o:"end-of-candidates")+"\r\n",p._remoteDescription.sdp=G.getDescription(p._remoteDescription.sdp)+d.join("")}else for(var s=0;s<p.transceivers.length&&(p.transceivers[s].rejected||(p.transceivers[s].iceTransport.addRemoteCandidate({}),(d=G.getMediaSections(p._remoteDescription.sdp))[s]+="a=end-of-candidates\r\n",p._remoteDescription.sdp=G.getDescription(p._remoteDescription.sdp)+d.join(""),!p.usingBundle));s++);e()})},n.prototype.getStats=function(t){if(t&&t instanceof I.MediaStreamTrack){var r=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?r=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(r=e.rtpReceiver)}),!r)throw m("InvalidAccessError","Invalid selector.");return r.getStats()}var n=[];return this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(e){t[e]&&n.push(t[e].getStats())})}),Promise.all(n).then(function(e){var t=new Map();return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(e){var t=I[e];if(t&&t.prototype&&t.prototype.getStats){var r=t.prototype.getStats;t.prototype.getStats=function(){return r.apply(this).then(function(t){var r=new Map();return Object.keys(t).forEach(function(e){t[e].type=function(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}(t[e]),r.set(e,t[e])}),r})}}});var e=["createOffer","createAnswer"];return e.forEach(function(e){var r=n.prototype[e];n.prototype[e]=function(){var t=arguments;return"function"==typeof t[0]||"function"==typeof t[1]?r.apply(this,[arguments[2]]).then(function(e){"function"==typeof t[0]&&t[0].apply(null,[e])},function(e){"function"==typeof t[1]&&t[1].apply(null,[e])}):r.apply(this,arguments)}}),(e=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e){var r=n.prototype[e];n.prototype[e]=function(){var t=arguments;return"function"==typeof t[1]||"function"==typeof t[2]?r.apply(this,arguments).then(function(){"function"==typeof t[1]&&t[1].apply(null)},function(e){"function"==typeof t[2]&&t[2].apply(null,[e])}):r.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=n.prototype[e];n.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),n}},{sdp:17}],17:[function(e,t,r){"use strict";var p={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};p.localCName=p.generateIdentifier(),p.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},p.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(0<t?"m="+e:e).trim()+"\r\n"})},p.getDescription=function(e){var t=p.splitSections(e);return t&&t[0]},p.getMediaSections=function(e){var t=p.splitSections(e);return t.shift(),t},p.matchPrefix=function(e,t){return p.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},p.parseCandidate=function(e){for(var t,r={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},n=8;n<t.length;n+=2)switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1],r.usernameFragment=t[n+1];break;default:r[t[n]]=t[n+1]}return r},p.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var r=e.type;return t.push("typ"),t.push(r),"host"!==r&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},p.parseIceOptions=function(e){return e.substr(14).split(" ")},p.parseRtpMap=function(e){var t=e.substr(9).split(" "),r={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),r.name=t[0],r.clockRate=parseInt(t[1],10),r.channels=3===t.length?parseInt(t[2],10):1,r.numChannels=r.channels,r},p.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var r=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==r?"/"+r:"")+"\r\n"},p.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:0<t[0].indexOf("/")?t[0].split("/")[1]:"sendrecv",uri:t[1]}},p.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},p.parseFmtp=function(e){for(var t,r={},n=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<n.length;i++)r[(t=n[i].trim().split("="))[0].trim()]=t[1];return r},p.writeFmtp=function(t){var e="",r=t.payloadType;if(void 0!==t.preferredPayloadType&&(r=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){var n=[];Object.keys(t.parameters).forEach(function(e){t.parameters[e]?n.push(e+"="+t.parameters[e]):n.push(e)}),e+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return e},p.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},p.writeRtcpFb=function(e){var t="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},p.parseSsrcMedia=function(e){var t=e.indexOf(" "),r={ssrc:parseInt(e.substr(7,t-7),10)},n=e.indexOf(":",t);return-1<n?(r.attribute=e.substr(t+1,n-t-1),r.value=e.substr(n+1)):r.attribute=e.substr(t+1),r},p.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(function(e){return parseInt(e,10)})}},p.getMid=function(e){var t=p.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},p.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},p.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:p.matchPrefix(e+t,"a=fingerprint:").map(p.parseFingerprint)}},p.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),r},p.getIceParameters=function(e,t){var r=p.splitLines(e);return{usernameFragment:(r=r.concat(p.splitLines(t))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:r.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},p.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},p.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=p.splitLines(e)[0].split(" "),n=3;n<r.length;n++){var i=r[n],a=p.matchPrefix(e,"a=rtpmap:"+i+" ")[0];if(a){var o=p.parseRtpMap(a),s=p.matchPrefix(e,"a=fmtp:"+i+" ");switch(o.parameters=s.length?p.parseFmtp(s[0]):{},o.rtcpFeedback=p.matchPrefix(e,"a=rtcp-fb:"+i+" ").map(p.parseRtcpFb),t.codecs.push(o),o.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(o.name.toUpperCase())}}}return p.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(p.parseExtmap(e))}),t},p.writeRtpDescription=function(e,t){var r="";r+="m="+e+" ",r+=0<t.codecs.length?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){r+=p.writeRtpMap(e),r+=p.writeFmtp(e),r+=p.writeRtcpFb(e)});var n=0;return t.codecs.forEach(function(e){e.maxptime>n&&(n=e.maxptime)}),0<n&&(r+="a=maxptime:"+n+"\r\n"),r+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){r+=p.writeExtmap(e)}),r},p.parseRtpEncodingParameters=function(e){var r,n=[],t=p.parseRtpParameters(e),i=-1!==t.fecMechanisms.indexOf("RED"),a=-1!==t.fecMechanisms.indexOf("ULPFEC"),o=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),s=0<o.length&&o[0].ssrc,c=p.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})});0<c.length&&1<c[0].length&&c[0][0]===s&&(r=c[0][1]),t.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&r&&(t.rtx={ssrc:r}),n.push(t),i&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:s,mechanism:a?"red+ulpfec":"red"},n.push(t))}}),0===n.length&&s&&n.push({ssrc:s});var d=p.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?1e3*parseInt(d[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(e){e.maxBitrate=d})),n},p.parseRtcpParameters=function(e){var t={},r=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];r&&(t.cname=r.value,t.ssrc=r.ssrc);var n=p.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=0<n.length,t.compound=0===n.length;var i=p.matchPrefix(e,"a=rtcp-mux");return t.mux=0<i.length,t},p.parseMsid=function(e){var t,r=p.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(t=r[0].substr(7).split(" "))[0],track:t[1]};var n=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return 0<n.length?{stream:(t=n[0].value.split(" "))[0],track:t[1]}:void 0},p.generateSessionId=function(){return Math.random().toString().substr(2,21)},p.writeSessionBoilerplate=function(e,t,r){var n=void 0!==t?t:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||p.generateSessionId())+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},p.writeMediaSection=function(e,t,r,n){var i=p.writeRtpDescription(e.kind,t);if(i+=p.writeIceParameters(e.iceGatherer.getLocalParameters()),i+=p.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),i+="a=mid:"+e.mid+"\r\n",e.direction?i+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?i+="a=sendrecv\r\n":e.rtpSender?i+="a=sendonly\r\n":e.rtpReceiver?i+="a=recvonly\r\n":i+="a=inactive\r\n",e.rtpSender){var a="msid:"+n.id+" "+e.rtpSender.track.id+"\r\n";i+="a="+a,i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,i+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+p.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+p.localCName+"\r\n"),i},p.getDirection=function(e,t){for(var r=p.splitLines(e),n=0;n<r.length;n++)switch(r[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[n].substr(2)}return t?p.getDirection(t):"sendrecv"},p.getKind=function(e){return p.splitLines(e)[0].split(" ")[0].substr(2)},p.isRejected=function(e){return"0"===e.split(" ",2)[1]},p.parseMLine=function(e){var t=p.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},p.parseOLine=function(e){var t=p.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},p.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=p.splitLines(e),r=0;r<t.length;r++)if(t[r].length<2||"="!==t[r].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=p)},{}]},{},[1])(1)})}(void 0),!function(t,i){if("object"==typeof exports&&"object"==typeof module)module.exports=i();else if("function"==typeof define&&define.i)define([],i);else{var n=i();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(this,function(){return f=[function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(27),s=n(3),e=n(42),h=n(124),o=(u.getId=function(){return"["+a.time()+"] ["+a.h().id+"]"},u);function u(){}var a=(f.startup=function(t){this.startTime=new Date(),t.apply(this.o),this.u=this.o.resolve(e.v.l),this.logger_=this.o.resolve(e.v.p),this.g=this.u.T(),this.O=!1,this.u.init()},f.m=function(t,i,n){this._<1&&(this.startup(i),this.R(t,n),this.A(t)),this._+=1},f.I=function(){this.network=this.o.resolve(e.v.NETWORK),this.network.init()},f.net=function(){return this.network},f.system=function(){return this.o},f.logger=function(){return this.logger_},f.N=function(){return this.u},f.C=function(t){return this.k.get(t)},f.R=function(t,i){var n=new h.D(t);return n.apply(i),this.k.set(t,n),n},f.A=function(t){this.j=this.C(t)},f.resolve=function(t){return null!=this.j?this.j.context.resolve(t):(!1,null)},f.h=function(){return this.j},f.time=function(){if(this.u)return this.u.time();throw new Error("Framework.time called on purged Framework")},f.setTimeout=function(t,i,n){if(void 0===n&&(n=!1),!this.u||this.O)throw new Error("Framework.setTimeout called on purging / purged Framework");return this.u.setTimeout(t,i,n)},f.clearTimeout=function(t){return this.u.clearTimeout(t)},f.setInterval=function(t,i){if(!this.u||this.O)throw new Error("Framework.setInterval called on purging / purged Framework");return this.u.setInterval(t,i)},f.clearInterval=function(t){return this.u.clearInterval(t)},f.M=function(){return this.u.M()},f.P=function(t){if(void 0===t&&(t=!1),t)return this.L(t),void (this._=0);0!==this._&&(this._<=1&&this.L(),this._-=1)},f.L=function(t){var i=this;void 0===t&&(t=!1),this.O=!0,this.u&&this.u.H(t,function(){i.O&&i.reset()})},f.reset=function(){this.o.U(),this.o=new r.F(),this.k=new s(),this.j=null,this.startTime=null,this.g=!1,this.seed=null,this.u=null,this.network=null,this.logger_=null},f.G=function(t){this.seed=t},f.random=function(){return null==this.seed&&(this.seed=new Date().getTime()),this.seed=(9301*this.seed+49297)%233280,this.seed/233280},f.B=function(){return this.startTime},f.T=function(){return this.g},f.V=o,f.v=e.v,f._=0,f.o=new r.F(),f.k=new s(),f.g=!1,f);function f(){}i.Framework=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(126),s=n(20),e=n(8),o=n(2),u=n(2),h=e.Y.q,f=(e.Y.K,e.Y.W),c=e.Y.$,a=(l.getInstance=function(t){return void 0===t&&(t="3.0.0"),void 0===this.instance&&(this.instance=new l(t)),this.instance},l.prototype.X=function(){r.Z.getInstance().J([16,17,88],function(){try{throw new Error("Upload console logs")}catch(t){atatus.notify(t),window.console&&!1}})},l.prototype.tt=function(){try{throw new Error("test")}catch(t){var i=t.stack.match(/(\/\/.*\.js)/i);if(i&&0<i.length)return i[0]}},l.prototype.setUser=function(t){this.it&&this.isActive&&atatus.setUser(t)},l.prototype.nt=function(t){this.logger=t},l.prototype.setCustomData=function(t){this.it&&this.isActive&&atatus.setCustomData(t)},l.prototype.rt=function(t){for(var i in t)t.hasOwnProperty(i)&&(this.st[i]=t[i])},l.prototype.et=function(t){this.ht=t},l.prototype.ot=function(){this.ht=null},l.prototype.logError=function(t,i,n,r,s){var e="",h=n&&u.ut[n]?u.ut[n]:u.ft.at;if("string"==typeof i?e=i.trim():void 0!==i&&(r=i),(r instanceof Error||r&&"object"!=typeof r)&&(r={error:r.toString()}),(r=r||{}).errorCode=n||o.GENERIC_ERROR,this.logger&&(0<Object.keys(r).length?this.logger.warn(e+" "+t,r):this.logger.warn(e+" "+t)),e&&(s=s?s.concat([e]):[e]),r.forceSend=!0,this.it&&this.isActive)try{throw new Error(t)}catch(t){atatus.notify(t,r,s)}if(this.ht)try{this.ht({pluginVersion:this.version,reportingId:this.st?this.st.reportingGuid:"",p2pId:this.st?this.st.p2pId:"",message:t,severity:h,code:r.errorCode})}catch(t){this.logger.warn("Error in the onErrorCallback",t)}},l.prototype.setTags=function(t){this.it&&this.isActive&&atatus.setTags(t)},l.prototype.notify=function(t,i){this.it&&this.isActive&&((i=i||{}).forceSend=!0,atatus.notify(t,i))},l);function l(t){var o=this;if(this.isActive=!1,this.it="undefined"!=typeof atatus&&null!=atatus,this.st={},this.version=t,l.instance)throw new Error("Error: Instantiation failed: Use AtatusLogger.getInstance() instead of new.");var u,i=null!=s.ErrorMonitorOptions.key?s.ErrorMonitorOptions.key:h,n=1==s.ErrorMonitorOptions.enabledRUM,r=1==s.ErrorMonitorOptions.enableKeyCombination,a=1==s.ErrorMonitorOptions.enabledErrorFilter;a&&(u=this.tt()),this.version=t,this.it&&(null==s.ErrorMonitorOptions.enabled&&f||null!=s.ErrorMonitorOptions.enabled&&1==s.ErrorMonitorOptions.enabled)&&(atatus.config(i,{enableSourcemap:!0,disableRUM:!n,console:!1,version:t,beforeErrorSend:function(t){var i=!1;for(var n in t.customData=t.customData||{},void 0!==t.customData.forceSend&&(i=t.customData.forceSend,delete t.customData.forceSend,0===Object.keys(t.customData).length&&(t.customData=null)),o.st)o.st.hasOwnProperty(n)&&(t.customData[n]=o.st[n]);if(!a||i)return!0;if(!u)return!1;try{var r=!1;if(t.backTraces){for(var s=0,e=t.backTraces;s<e.length;s++){var h=e[s];if(-1<h.f.indexOf(u)&&h.ln>c){r=!0;break}}r&&(t.name=t.name.replace(/%s \[[0-9]{2}:[0-9]{2}:[0-9]{2}:[0-9]+] /,""),0<=t.name.indexOf("Status Code Error:")&&(t.tags=["Plugin Error Code",t.name.split(":")[1].trim()]))}return r}catch(t){return!1}}}).install(),r&&this.X(),this.isActive=!0,window.console&&!1,a&&!u&&this.logError("Could not extract error filter"))}i.ErrorMonitor=a},function(t,i,n){"use strict";var r,s,e,h,o,u,a,f,c,l,v,d,E,w,p,g,b,y,T,O,m,_,R,S,A,I,N,C,k,D,j,M,P,L,H,U,F,G,x,B,V,q,Q,Y,K,W,$,X,z,J,Z,tt,it,nt,rt,st,et,ht;Object.defineProperty(i,"s",{value:!0}),(h=e=i.ft||(i.ft={}))[h.at=0]="NORMAL",h[h.ct=1]="HIGH",h[h.CRITICAL=2]="CRITICAL",(u=o=i.lt||(i.lt={}))[u.vt=268435456]="BASE_CODE",u[u.dt=268435457]="FIRE_SERVER_CONNECTED_WITH_SWARM",u[u.Et=268435458]="FIRE_SERVER_CONNECTED_WITHOUT_SWARM",u[u.wt=268435459]="CONNECTION_NOT_ESTABLISHED",u[u.pt=268435460]="SEND_MESSAGE_TO_NON_EXISTING_CHANNEL",u[u.gt=268435461]="RECEIVED_MESSAGE_FROM_NON_EXISTING_CONNECTION",(a=i.bt||(i.bt={}))[a.vt=536870912]="BASE_CODE",a[a.yt=536870913]="CREATE_OFFER",a[a.Tt=536870914]="CREATE_ANSWER",a[a.Ot=536870915]="SIGNALING_STATE_CLOSED",a[a._t=536870916]="SET_LOCAL_DESCRIPTION_FAILED",a[a.Rt=536870917]="NEGOTIATION_FAILURE",a[a.St=536870918]="SETUP_CHANNEL_ERROR",a[a.At=536870919]="ICE_CONNECTION_FAILED",a[a.It=536870920]="SET_REMOTE_DESCRIPTION",a[a.Nt=536870921]="UPDATE_ICE_CANDIDATES",a[a.Ct=536870922]="ANSWER_RECEIVED",a[a.kt=536870923]="OFFER_RECEIVED",a[a.Dt=536870924]="SEND_CANDIDATES",a[a.jt=536870925]="CLOSE_CONNECTION",a[a.Mt=536870926]="SEND_DATA",(f=i.Pt||(i.Pt={}))[f.vt=805306368]="BASE_CODE",f[f.Lt=805306369]="SEND_MSG_WITHOUT_CHANNEL",f[f.Ht=805306370]="MSG_TRIGGER_ERROR",f[f.Ut=805306371]="CONNECTION_TIMEOUT",(c=i.Ft||(i.Ft={}))[c.vt=1073741824]="BASE_CODE",c[c.jt=1073741825]="CLOSE_CONNECTION",c[c.Gt=1073741826]="P2P_DISPATCHER_ERROR",(l=i.xt||(i.xt={}))[l.vt=1342177280]="BASE_CODE",l[l.Bt=1342177281]="CONSTRUCT_MESSAGE",l[l.Vt=1342177282]="DROPPED_MESSAGE",l[l.qt=1342177283]="SEND_MESSAGE",l[l.Qt=1342177284]="RECEIVE_MESSAGE",(v=i.Yt||(i.Yt={}))[v.vt=1610612736]="BASE_CODE",v[v.Kt=1610612737]="NEW_DISPATCHER",(d=i.Wt||(i.Wt={}))[d.vt=1879048192]="BASE_CODE",d[d.$t=1879048193]="INIT_CACHE",d[d.Xt=1879048194]="PUT_OPERATION",d[d.zt=1879048195]="GET_OPERATION",d[d.Jt=1879048196]="CONTAINS_OPERATION",d[d.Zt=1879048197]="GET_KEYS_OPERATION",d[d.ti=1879048198]="GET_ELEMENTS_OPERATION",(E=i.ii||(i.ii={}))[E.vt=2147483648]="BASE_CODE",E[E.Xt=2147483649]="PUT_OPERATION",E[E.zt=2147483650]="GET_OPERATION",E[E.Jt=2147483651]="CONTAINS_OPERATION",E[E.Zt=2147483652]="GET_KEYS_OPERATION",E[E.ti=2147483653]="GET_ELEMENTS_OPERATION",E[E.ni=2147483654]="PURGE_CACHE_OPERATION",(w=i.ri||(i.ri={}))[w.vt=2415919104]="BASE_CODE",(p=i.si||(i.si={}))[p.vt=2684354560]="BASE_CODE",p[p.ei=2684354561]="DISCOVERED_PEERS",p[p.hi=2684354562]="LEADER_ELECTION",p[p.oi=2684354563]="GC_MEMBERS",p[p.ui=2684354564]="ADD_LAN_MEMBER",p[p.ai=2684354565]="ADD_RANDOM_MEMBER",p[p.fi=2684354566]="SAMPLE_MEMBERSHIP",(g=i.ci||(i.ci={}))[g.vt=2952790016]="BASE_CODE",g[g.li=2952790017]="SEND_ALL_HAVES",g[g.vi=2952790018]="SEND_HAVE",g[g.di=2952790019]="UNKNOWN_HAVE",g[g.Ei=2952790020]="UNKNOWN_HAVES",g[g.wi=2952790021]="RECEIVED_HAVE",g[g.pi=2952790022]="RECEIVED_HAVES",g[g.gi=2952790023]="NO_OUT_PARTNER",g[g.bi=2952790024]="CREATE_RANDOM_BUFFER",g[g.yi=2952790025]="REQUEST_PING",g[g.Ti=2952790026]="RECEIVED_PING",g[g.Oi=2952790027]="UNKNOWN_PING",g[g.mi=2952790028]="SEND_PONG",g[g._i=2952790029]="UNKOWN_PONG",g[g.Ri=2952790030]="WRONG_PONG_SIZE",g[g.Si=2952790031]="WRONG_TIMESTAMP",g[g.Ai=2952790032]="RECEIVED_PONG",g[g.Ii=2952790033]="COLLECT_PARTNER_SNAPSHOTS",(y=b=i.Ni||(i.Ni={}))[y.vt=3221225472]="BASE_CODE",y[y.Ci=3221225473]="START_PARTNERSHIP",y[y.ki=3221225474]="NEW_LAN_MEMBER",y[y.Di=3221225475]="IN_PARTNER_CHOICE",y[y.ji=3221225476]="IN_PARTNER_ADD_PROCESS",y[y.Mi=3221225477]="IN_PARTNER_CONNECT",y[y.Pi=3221225478]="IN_PARTNERSHIP_REQUEST",y[y.Li=3221225479]="OUT_PARNTERSHIP_REQUEST_PROCESS",y[y.Hi=3221225480]="CONSTRUCT_DISCOVER_PEER_INFO",y[y.Ui=3221225481]="SEND_PARTN_RESP",y[y.Fi=3221225482]="NEW_IN_PARTNER_TO_LIST",y[y.Gi=3221225483]="REMOVE_DISCONNECTED_PEER",y[y.xi=3221225484]="REMOVE_IN_PARTNER",y[y.Bi=3221225485]="CLOSE_RECEIVED",y[y.Vi=3221225486]="SEND_PART_REQUEST",y[y.qi=3221225487]="PART_REQUEST_EXPIRED",y[y.Qi=3221225488]="UNKNOWN_PARTNERSHIP_REQUEST_EXPIRED",y[y.Yi=3221225489]="UNKNOWN_OUT_PART_RESP",y[y.Ki=3221225490]="CLOSE_PARTNERSHIP",y[y.Wi=3221225491]="ANNOUNCE_QUALITY_LEVEL",y[y.$i=3221225492]="CONSTRUCT_ANNOUNCE_QUALITY_LEVEL_MSG",y[y.Xi=3221225493]="RECEIVE_QUALITY_LEVEL_INFO",y[y.zi=3221225494]="PEER_INFO_RECEIVED",y[y.Ji=3221225495]="PEER_INFO_ANNOUNCED",y[y.Zi=3221225496]="COLLECT_ALL_PARTNERS",(T=i.tn||(i.tn={}))[T.vt=3489660928]="BASE_CODE",T[T["in"]=3489660929]="UPDATE_IN_PARTNERS",(O=i.nn||(i.nn={}))[O.vt=3758096384]="BASE_CODE",O[O.rn=3758096385]="SELECT_PARTNERS_TO_REMOVE",O[O.sn=3758096386]="SELECT_PARTNERS_TO_ADD",O[O.en=3758096387]="SELECT_UPDATE_OUT",(m=i.hn||(i.hn={}))[m.vt=4026531840]="BASE_CODE",m[m.rn=4026531841]="SELECT_PARTNERS_TO_REMOVE",m[m.sn=4026531842]="SELECT_PARTNERS_TO_ADD",m[m.en=4026531843]="SELECT_UPDATE_OUT",(_=i.un||(i.un={}))[_.vt=4294967296]="BASE_CODE",_[_["in"]=4294967297]="UPDATE_IN_PARTNERS",_[_.rn=4294967298]="SELECT_PARTNERS_TO_REMOVE",_[_.sn=4294967299]="SELECT_PARTNERS_TO_ADD",_[_.en=4294967300]="SELECT_UPDATE_OUT",_[_.an=4294967301]="GROUP_PARTNERS",_[_.fn=4294967302]="IDENTIFY_MEMBER_AS_LEADER_OR_SAME_SITE",_[_.cn=4294967303]="AHEAD_BUT_BEHIND_DELTA",_[_.vn=4294967304]="BEHIND_OR_NOT_RETRIEVING_QUALITY_LEVEL",_[_.dn=4294967305]="GET_DELTA_FOR_QUALITY_LEVEL",(R=i.En||(i.En={}))[R.vt=4563402752]="BASE_CODE",R[R.wn=4563402753]="UPDATE_OUT_PARTNERS",(S=i.pn||(i.pn={}))[S.vt=4831838208]="BASE_CODE",S[S.gn=4831838209]="ADD_FRAGMENT_TO_MAP",S[S.bn=4831838210]="WRAP_CHUNK",S[S.yn=4831838211]="GENERATE_HASHMAPS",(A=i.Tn||(i.Tn={}))[A.vt=5100273664]="BASE_CODE",A[A.On=5100273665]="INIT_AES_MANAGER",A[A.mn=5100273666]="INIT_KEY",A[A._n=5100273667]="INIT_IV",A[A.Rn=5100273668]="DECRYPT_BUFFER",A[A.Sn=5100273669]="DOWNLOAD_KEY_ONLOAD",A[A.An=5100273670]="DOWNLOAD_KEY",(N=I=i.In||(i.In={}))[N.vt=5368709120]="BASE_CODE",N[N.Nn=5368709121]="GET_ENTITY_TYPE",N[N.Cn=5368709122]="GET_ENTITY_CHARACTERISTICS",N[N.kn=5368709123]="GET_NEXT_ENTITY",N[N.Dn=5368709124]="IS_CURRENT_CONTEXT",N[N.jn=5368709125]="PARSED_METADATA",N[N.Mn=5368709126]="PREFETCH_METADATA_RECEIVED",N[N.Pn=5368709127]="FRAGMENT_RECEIVED",N[N.Ln=5368709128]="EVALUATE_PROTECTION",N[N.Hn=5368709129]="GET_DISTANCE_DURATION",(k=C=i.Un||(i.Un={}))[k.vt=5637144576]="BASE_CODE",k[k.Fn=5637144577]="PARSE_METADATA",k[k.Gn=5637144578]="EXTRACT_SEGMENT_MAPS",k[k.xn=5637144579]="INIT_PROTECTION",k[k.Bn=5637144580]="GET_SEGMENT_INFO",k[k.Vn=5637144581]="GET_SEGMENT_DISTANCE",k[k.qn=5637144582]="EXTRACT_DURATION",k[k.Qn=5637144583]="EXTRACT_DURATION_OR_DECRYPT",k[k.Yn=5637144584]="EXTRACT_DURATION_CANNOT_DECRYPT",k[k.Kn=5637144585]="EXTRACT_DURATION_NON_ENCRYPTED",k[k.Wn=5637144586]="GENERATE_MISSING_SEGMENTS",k[k.$n=5637144587]="REGENERATE_MANIFEST",k[k.Xn=5637144588]="TRIM_MANIFEST",k[k.zn=5637144589]="PARSE_BITRATES_TO_FILTER",k[k.Jn=5637144590]="FILTER_BITRATES",k[k.Zn=5637144591]="GET_DISTANCE_DURATION_BETWEEN_SEGMENTS",k[k.tr=5637144592]="GET_SEGMENT",(j=D=i.ir||(i.ir={}))[j.vt=5905580032]="BASE_CODE",j[j.Dn=5905580033]="IS_CURRENT_CONTEXT",j[j.Nn=5905580034]="GET_ENTITY_TYPE",j[j.Cn=5905580035]="GET_ENTITY_CHARACTERISTICS",j[j.nr=5905580036]="METADATA_RECEIVED",j[j.rr=5905580037]="SCHEDULE_METADATA_PREFETCH",j[j.kn=5905580038]="GET_NEXT_ENTITY",j[j.Hn=5905580039]="GET_DISTANCE_DURATION",(P=M=i.sr||(i.sr={}))[P.vt=6174015488]="BASE_CODE",P[P.er=6174015489]="PLAYLIST_MISMATCH",P[P.hr=6174015490]="FLOAT_BITRATE",P[P.Fn=6174015491]="PARSE_METADATA",P[P.Bn=6174015492]="GET_SEGMENT_INFO",P[P.ur=6174015493]="UPDATE_PLAYLIST",P[P.ar=6174015494]="TRIM_PLAYLIST",(L=i.cr||(i.cr={}))[L.vt=6442450944]="BASE_CODE",L[L.lr=6442450945]="GET_P2P_TIMEOUT",L[L.vr=6442450946]="DELIVER_DELAY",(H=i.dr||(i.dr={}))[H.vt=6710886400]="BASE_CODE",H[H.Er=6710886401]="IS_PLAYER_BUFFERING_BASE",H[H.wr=6710886402]="CONFIGURE_REQUEST_DIRECTIVE",H[H.pr=6710886403]="ATTEMPT_TO_UPGRADE_PREFETCH",H[H.kn=6710886404]="GET_NEXT_ENTITY",(U=i.gr||(i.gr={}))[U.vt=6979321856]="BASE_CODE",U[U.br=6979321857]="PREPARE_REQUEST",U[U.yr=6979321858]="GET_CONNECTIVITY_INFO",U[U.Tr=6979321859]="COLLECT_TRACKER_REQUEST_INFO",U[U.Or=6979321860]="PREPARE_QUERY",U[U.mr=6979321861]="PREPARE_QUALITY_LEVEL_QUERY",U[U.Rr=6979321862]="PREPARE_TRACKER_INFO",U[U.Sr=6979321863]="SEND_REQUEST",U[U.Ar=6979321864]="HANDLE_RESPONSE",(F=i.Ir||(i.Ir={}))[F.vt=7247757312]="BASE_CODE",F[F.Nr=7247757313]="NEW_TRACKER_CLIENT",F[F.Cr=7247757314]="SERIALIZE_REQUEST",F[F.kr=7247757315]="DESERIALIZE_RESPONSE",F[F.Dr=7247757316]="SERVICE_CONNECTION_DOWN",F[F.Sr=7247757317]="SEND_REQUEST",F[F.jr=7247757318]="TRACKER_MANAGER_INIT",(G=i.Mr||(i.Mr={}))[G.vt=7516192768]="BASE_CODE",G[G.Pr=7516192769]="SORT_PARTNERS",(x=i.Lr||(i.Lr={}))[x.vt=7784628224]="BASE_CODE",x[x.Hr=7784628225]="CHOOSE_PARTNER",(B=i.Ur||(i.Ur={}))[B.vt=8053063680]="BASE_CODE",B[B.Fr=8053063681]="CONSTRUCT_FRAGMENT_REQUEST_MESSAGE",B[B.Gr=8053063682]="SEND_FRAGMENT_REQUEST",B[B.xr=8053063683]="RECEIVE_CHUNK",B[B.Br=8053063684]="SEND_ACK",B[B.Vr=8053063685]="CLEAN_UP_NOT_PENDING",B[B.qr=8053063686]="STOP_TRANSFER",B[B.Qr=8053063687]="RECEIVE_EXPIRED_CHUNK",(V=i.Yr||(i.Yr={}))[V.vt=8321499136]="BASE_CODE",V[V.Kr=8321499137]="CONSTRUCT_CHUNK_RESPONSE",V[V.Wr=8321499138]="START_SENDING_CHUNK",V[V.$r=8321499139]="SEND_CHUNK",V[V.Xr=8321499140]="UNKNOWN_ACK",(q=i.zr||(i.zr={}))[q.vt=8589934592]="BASE_CODE",q[q.Jr=8589934593]="NO_PARTNER_FOUND",q[q.Zr=8589934594]="FILTER_IN_PARTNERS",q[q.ns=8589934595]="SET_REQUEST_TIMEOUT",q[q.rs=8589934596]="REMOVE_REQUEST",q[q.ss=8589934597]="CANCEL_ON_NON_EXISTING_SESSION",q[q.es=8589934598]="DO_NOT_HAVE",q[q.hs=8589934599]="REQUESTED_TO_NON_PARTNER",(Q=i.us||(i.us={}))[Q.vt=8858370048]="BASE_CODE",Q[Q.fs=8858370049]="RESPOND_TO_PEER",Q[Q.cs=8858370050]="REQUEST_SATISFIED",Q[Q.ls=8858370051]="REQUEST_PARTIALLY_SATISFIED",Q[Q.vs=8858370052]="REQUEST_NOT_SATISFIED",Q[Q.ds=8858370053]="SEND_DO_NOT_HAVE",Q[Q.Es=8858370054]="SEND_NO_PARTNERS",(Y=i.ws||(i.ws={}))[Y.vt=9126805504]="BASE_CODE",Y[Y.ps=9126805505]="VIOLATE_SPOOFING_HANDLER",Y[Y.gs=9126805506]="VIOLATE_SPOOFING_RULES",Y[Y.bs=9126805507]="ADD_OR_UPDATE_SPOOFING_MAPS",Y[Y.ys=9126805508]="PERIODIC_CHECK_IP_SPOOFING",(K=i.Ts||(i.Ts={}))[K.vt=9395240960]="BASE_CODE",K[K.Os=9395240961]="REQUEST_COMPLETED",K[K.ms=9395240962]="REQUEST_NOT_EXISTING_COMPLETED",K[K._s=9395240963]="REQUEST_PARTIALLY_FAILED",K[K.Rs=9395240964]="REQUEST_NOT_EXISTING_PARTIALLY_FAILED",K[K.Ss=9395240965]="REQUEST_FAILED",K[K.As=9395240966]="REQUEST_NOT_EXISTING_FAILED",(W=i.Is||(i.Is={}))[W.vt=9663676416]="BASE_CODE",W[W.Ns=9663676417]="UPDATE_WANTED_SESSIONS",W[W.Cs=9663676418]="CONFIGURE_PREFETCHING",W[W.ks=9663676419]="START_PREFETCHING",W[W.Ds=9663676420]="FRAGMENT_RETRIEVED_SESSION_NOT_EXISTING",W[W.js=9663676421]="ATTEMPT_PREFETCH_BEFORE_PLAYER_REQUEST",W[W.Ms=9663676422]="FORWARD_IF_NECESSARY",W[W.Ps=9663676423]="IS_ALLOWED_TO_PREFETCH",W[W.Ls=9663676424]="PREFETCH_PROCESS",W[W.Hs=9663676425]="CHECK_PLAYER_DISTANCE",W[W.Us=9663676426]="OFFLOAD_LEADER",W[W.Fs=9663676427]="UPGRADE_PREFETCH",($=i.Gs||(i.Gs={}))[$.vt=9932111872]="BASE_CODE",$[$.xs=9932111873]="REQUEST_TIMEOUT",(X=i.Bs||(i.Bs={}))[X.vt=10200547328]="BASE_CODE",X[X.Vs=10200547329]="PLAYER_REQUEST_ERROR",X[X.qs=10200547330]="PLAYER_ABORT_ERROR",(z=i.Qs||(i.Qs={}))[z.vt=10468982784]="BASE_CODE",z[z.Ys=10468982785]="ADD_HAVE",z[z.Ks=10468982786]="REMOVE_PEER",(Z=J=i.Ws||(i.Ws={}))[Z.vt=10737418240]="BASE_CODE",Z[Z.$s=10737418241]="CONSTRUCT_SWARM",Z[Z.Xs=10737418242]="INIT_SWARM",Z[Z.zs=10737418243]="SWITCH_STATE",Z[Z.xs=10737418244]="REQUEST_TIMEOUT",(tt=i.Js||(i.Js={}))[tt.vt=11005853696]="BASE_CODE",tt[tt.Zs=11005853697]="SERIALIZE_MESSAGE",tt[tt.te=11005853698]="EXTRACT_MESSAGE",(nt=it=i.ie||(i.ie={}))[nt.vt=11274289152]="BASE_CODE",nt[nt.ne=11274289153]="NO_MATCHING_SESSION",nt[nt.re=11274289154]="UNABLE_RESOLVE_TICKET",nt[nt.se=11274289155]="UNABLE_INIT_TECHS",nt[nt.ee=11274289156]="NO_TOKEN_FOUND",nt[nt.he=11274289157]="NO_VALID_TICKET",nt[nt.oe=11274289158]="ON_ACTIVE_SESSION_CB_ERROR",nt[nt.ue=11274289159]="NO_VISIBILITY_LISTENER",nt[nt.ae=11274289160]="STATUS_CODE",nt[nt.fe=11274289161]="ON_SESSION_STATE_CHANGE_CB_ERROR",nt[nt.ce=11274289162]="NO_REQUIRED_PARAMETERS",(rt=i.le||(i.le={}))[rt.vt=11542724608]="BASE_CODE",rt[rt.ve=11542724609]="CALCULATE_BATCH_LOCALITY",(et=st=i.de||(i.de={}))[et.vt=11811160064]="BASE_CODE",et[et.Ee=11811160065]="BITRATE_TOO_HIGH",et[et.we=11811160066]="NUM_BITRATES_NONE",et[et.pe=11811160067]="NUM_BITRATES_OK",et[et.ge=11811160068]="NUM_BITRATES_WARNING",et[et.be=11811160069]="NUM_BITRATES_ERROR",et[et.ye=11811160070]="NUM_BITRATES_ATATUS_ERROR_NONE",et[et.Te=11811160071]="NUM_BITRATES_ATATUS_ERROR_HIGH",(ht=i.Oe||(i.Oe={}))[ht.vt=12079595520]="BASE_CODE",ht[ht.Zs=12079595521]="SERIALIZE_MESSAGE",ht[ht.Sr=12079595522]="SEND_REQUEST",ht[ht.Dr=12079595523]="SERVICE_CONNECTION_DOWN",ht[ht.yr=12079595524]="GET_CONNECTIVITY_INFO",i.GENERIC_ERROR=1,i.me=((r={})[st.Ee]="The detected bitrate ({0}) is higher than the maximum certified bitrate ({1}). You may encounter issues watching the stream.",r[st.we]="{0} stream detected with missing video bitrate metadata. This is likely caused by an incorrect manifest served by the video platform application.",r[st.pe]="{0} stream detected {1} video bitrates: {2}",r[st.ge]="{0} stream detected with {1} video bitrates: {2}. Hive Streaming recommends four or fewer video bitrates to insure optimal networking savings.",r[st.be]="{0} stream detected with {1} video bitrates: {2}. This is likely caused by an incorrect configuration in the video encoder, video streaming origin or transcoding service.",r[st.ye]="Stream has zero available bitrates.",r[st.Te]="Stream has too many available bitrates.",r),i.ut=((s={})[o.dt]=e.ct,s[o.Et]=e.ct,s[b.Ci]=e.ct,s[I.Dn]=e.ct,s[C.$n]=e.ct,s[D.Dn]=e.ct,s[M.er]=e.ct,s[J.$s]=e.ct,s[it.ne]=e.ct,s[it.re]=e.ct,s[it.se]=e.ct,s[it.ee]=e.ct,s[it.he]=e.ct,s[it.ce]=e.CRITICAL,s)},function(t,i,n){"use strict";n(10);var s=n(73),r=n(11),e=n(59),h=n(12);function o(t,n,i,r){if(!(this instanceof o))return new o(t,n,i,r);n=n||Object.equals,i=i||Object.hash,r=r||Function._e,this.Re=n,this.Se=i,this.Ae=r,this.store=new s(void 0,function(t,i){return n(t.key,i.key)},function(t){return i(t.key)}),this.length=0,this.hiveAddEach(t)}(t.exports=o).Map=o,Object.hiveAddEach(o.prototype,r.prototype),Object.hiveAddEach(o.prototype,e.prototype),Object.hiveAddEach(o.prototype,h.prototype),Object.defineProperty(o.prototype,"size",r.Ie),o.prototype.Ne=function(t){return new this.constructor(t,this.Re,this.Se,this.Ae)},o.prototype.log=function(t,r,i,n){r=r||this.Ce,this.store.log(t,function(t,i,n){r(t.value.value,i,n)},i,n)},o.prototype.Ce=function(t,i){i(" key: "+t.key),i(" value: "+t.value)}},function(i,t,n){(function(W,$){!function(t){"use strict";"function"==typeof bootstrap?bootstrap("promise",t):i.exports=t()}(function(){"use strict";var o=!1;try{throw new Error()}catch(t){o=!!t.stack}function i(){}var s,e=T(),c=function(){var n={ke:void 0,next:null},i=n,r=!1,s=void 0,e=!1,t=!1;try{t=navigator&&("Microsoft Internet Explorer"===navigator.appName||null!=navigator.appVersion.match(/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i))}catch(t){}var h=[];function o(){for(var t,i;n.next;)t=(n=n.next).ke,n.ke=void 0,(i=n.domain)&&(n.domain=void 0,i.De()),u(t,i);for(;h.length;)u(t=h.pop());r=!1}function u(t,i){try{t()}catch(t){if(e)throw i&&i.je(),setTimeout(o,0),i&&i.De(),t;setTimeout(function(){throw t},0)}i&&i.je()}if(c=function(t){"undefined"!=typeof Framework&&Framework.T()?Framework.setTimeout(t,0):(i=i.next={ke:t,domain:e&&W.domain,next:null},r||(r=!0,s()))},"object"==typeof W&&W&&"[object process]"===W.toString()&&W.Me)e=!0,s=function(){W.Me(o)};else if("function"!=typeof $||t)if("undefined"==typeof MessageChannel||t)s=function(){setTimeout(o,0)};else{var a=new MessageChannel();a.port1.onmessage=function(){s=f,(a.port1.onmessage=o)()};var f=function(){a.port2.postMessage(0)};s=function(){setTimeout(o,0),f()}}else s="undefined"!=typeof window?$.bind(window,o):function(){$(o)};return c.Pe=function(t){h.push(t),r||(r=!0,s())},c}(),n=Function.call;function t(t){return function(){return n.apply(t,arguments)}}var h,u=t(Array.prototype.slice),a=t(Array.prototype.reduce||function(t,i){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){i=this[n++];break}if(++n>=r)throw new TypeError()}for(;n<r;n++)n in this&&(i=t(i,this[n],n));return i}),r=t(Array.prototype.indexOf||function(t){for(var i=0;i<this.length;i++)if(this[i]===t)return i;return-1}),f=t(Array.prototype.map||function(r,s){var e=this,h=[];return a(e,function(t,i,n){h.push(r.call(s,i,n,e))},void 0),h}),l=Object.create||function(t){function i(){}return i.prototype=t,new i()},v=Object.defineProperty||function(t,i,n){return t[i]=n.value,t},d=t(Object.prototype.hasOwnProperty),E=Object.keys||function(t){var i=[];for(var n in t)d(t,n)&&i.push(n);return i},w=t(Object.prototype.toString);h="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var p="From previous event:";function g(t,i){if(o&&i.stack&&"object"==typeof t&&null!==t&&t.stack){for(var n=[],r=i;r;r=r.source)r.stack&&(!t.Le||t.Le>r.He)&&(v(t,"__minimumStackCounter__",{value:r.He,configurable:!0}),n.unshift(r.stack));n.unshift(t.stack);var s=function(t){for(var i=t.split("\n"),n=[],r=0;r<i.length;++r){var s=i[r];!y(s)&&-1===(e=s).indexOf("(module.js:")&&-1===e.indexOf("(node.js:")&&s&&n.push(s)}var e;return n.join("\n")}(n.join("\n"+p+"\n"));v(t,"stack",{value:s,configurable:!0})}}function b(t){var i=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(i)return[i[1],Number(i[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function y(t){var i=b(t);if(!i)return!1;var n=i[0],r=i[1];return n===s&&e<=r&&r<=K}function T(){if(o)try{throw new Error()}catch(t){var i=t.stack.split("\n"),n=b(0<i[0].indexOf("@")?i[1]:i[2]);if(!n)return;return s=n[0],n[1]}}function O(t){return t instanceof A?t:k(t)?function(t){var i=_();return O.Me(function(){try{t.then(i.resolve,i.reject,i.notify)}catch(t){i.reject(t)}}),i.promise}(t):x(t)}(O.resolve=O).Me=c,O.Ue=!1;var m=1;function _(){var s,e=[],h=[],t=l(_.prototype),i=l(A.prototype);if(i.Fe=function(t,i,n){var r=u(arguments);e?(e.push(r),"when"===i&&n[1]&&h.push(n[1])):O.Me(function(){s.Fe.apply(s,r)})},i.valueOf=function(){if(e)return i;var t=N(s);return C(t)&&(s=t),t},i.inspect=function(){return s?s.inspect():{state:"pending"}},O.Ue&&o)try{throw new Error()}catch(t){i.stack=t.stack.substring(t.stack.indexOf("\n")+1),i.He=m++}function n(n){s=n,O.Ue&&o&&(i.source=n),a(e,function(t,i){O.Me(function(){n.Fe.apply(n,i)})},void 0),h=e=void 0}return t.promise=i,t.resolve=function(t){s||n(O(t))},t.fulfill=function(t){s||n(x(t))},t.reject=function(t){s||n(G(t))},t.notify=function(n){s||a(h,function(t,i){O.Me(function(){i(n)})},void 0)},t}function R(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var i=_();try{t(i.resolve,i.reject,i.notify)}catch(t){i.reject(t)}return i.promise}function S(s){return R(function(t,i){for(var n=0,r=s.length;n<r;n++)O(s[n]).then(t,i)})}function A(s,e,i){void 0===e&&(e=function(t){return G(new Error("Promise does not support operation: "+t))}),void 0===i&&(i=function(){return{state:"unknown"}});var h=l(A.prototype);if(h.Fe=function(t,i,n){var r;try{r=s[i]?s[i].apply(h,n):e.call(h,i,n)}catch(t){r=G(t)}t&&t(r)},h.inspect=i){var t=i();"rejected"===t.state&&(h.exception=t.reason),h.valueOf=function(){var t=i();return"pending"===t.state||"rejected"===t.state?h:t.value}}return h}function I(t,i,n,r){return O(t).then(i,n,r)}function N(t){if(C(t)){var i=t.inspect();if("fulfilled"===i.state)return i.value}return t}function C(t){return t instanceof A}function k(t){return function(t){return t===Object(t)}(t)&&"function"==typeof t.then}"object"==typeof W&&W&&W.Ge&&W.Ge.xe&&(O.Ue=!0),(O.defer=_).prototype.Be=function(){var n=this;return function(t,i){t?n.reject(t):2<arguments.length?n.resolve(u(arguments,1)):n.resolve(i)}},O.Promise=R,(O.promise=R).race=S,R.all=q,R.reject=G,(R.resolve=O).Ve=function(t){return t},A.prototype.Ve=function(){return this},O.join=function(t,i){return O(t).join(i)},A.prototype.join=function(t){return O([this,t]).qe(function(t,i){if(t===i)return t;throw new Error("Q can't join: not the same: "+t+" "+i)})},O.race=S,A.prototype.race=function(){return this.then(O.race)},(O.Qe=A).prototype.toString=function(){return"[object Promise]"},A.prototype.then=function(i,n,r){var s=this,e=_(),h=!1;return O.Me(function(){s.Fe(function(t){h||(h=!0,e.resolve(function(t){try{return"function"==typeof i?i(t):t}catch(t){return G(t)}}(t)))},"when",[function(t){h||(h=!0,e.resolve(function(t){if("function"==typeof n){g(t,s);try{return n(t)}catch(t){return G(t)}}return G(t)}(t)))}])}),s.Fe(void 0,"when",[void 0,function(t){var i,n=!1;try{i=function(t){return"function"==typeof r?r(t):t}(t)}catch(t){if(n=!0,!O.onerror)throw t;O.onerror(t)}n||e.notify(i)}]),e.promise},O.Ye=function(t,i){return O(t).Ye(i)},A.prototype.Ye=function(i){return i=O(i),this.then(function(t){return i.We(t).Ke(t)})},O.when=I,A.prototype.Ke=function(t){return this.then(function(){return t})},O.Ke=function(t,i){return O(t).Ke(i)},A.prototype.$e=function(t){return this.then(function(){throw t})},O.$e=function(t,i){return O(t).$e(i)},O.Xe=N,O.ze=C,O.Je=k,O.Ze=function(t){return C(t)&&"pending"===t.inspect().state},A.prototype.Ze=function(){return"pending"===this.inspect().state},O.th=function(t){return!C(t)||"fulfilled"===t.inspect().state},A.prototype.th=function(){return"fulfilled"===this.inspect().state},O.ih=function(t){return C(t)&&"rejected"===t.inspect().state},A.prototype.ih=function(){return"rejected"===this.inspect().state};var D,j,M,P=[],L=[],H=[],U=!0;function F(){P.length=0,L.length=0,U=U||!0}function G(i){var t=A({when:function(t){return t&&function(i){if(U){var n=r(L,i);-1!==n&&("object"==typeof W&&W&&"function"==typeof W.nh&&O.Me.Pe(function(){var t=r(H,i);-1!==t&&(W.nh("rejectionHandled",P[n],i),H.splice(t,1))}),L.splice(n,1),P.splice(n,1))}}(this),t?t(i):this}},function(){return this},function(){return{state:"rejected",reason:i}});return function(t,i){U&&("object"==typeof W&&W&&"function"==typeof W.nh&&O.Me.Pe(function(){-1!==r(L,t)&&(W.nh("unhandledRejection",i,t),H.push(t))}),L.push(t),i&&void 0!==i.stack?P.push(i.stack):P.push("(no stack) "+i))}(t,i),t}function x(n){return A({when:function(){return n},get:function(t){return n[t]},set:function(t,i){n[t]=i},"delete":function(t){delete n[t]},rh:function(t,i){return null==t?n.apply(void 0,i):n[t].apply(n,i)},apply:function(t,i){return n.apply(t,i)},keys:function(){return E(n)}},void 0,function(){return{state:"fulfilled",value:n}})}function B(t,i,n){return O(t).qe(i,n)}function V(t,i,n){return O(t).sh(i,n)}function q(t){return I(t,function(s){var e=0,h=_();return a(s,function(t,i,n){var r;C(i)&&"fulfilled"===(r=i.inspect()).state?s[n]=r.value:(++e,I(i,function(t){s[n]=t,0==--e&&h.resolve(s)},h.reject,function(t){h.notify({index:n,value:t})}))},void 0),0===e&&h.resolve(s),h.promise})}function Q(s){if(0===s.length)return O.resolve();var e=O.defer(),h=0;return a(s,function(t,i,n){var r=s[n];h++,I(r,function(t){e.resolve(t)},function(t){if(0===--h){var i=t||new Error(""+t);i.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+i.message,e.reject(i)}},function(t){e.notify({index:n,value:t})})},void 0),e.promise}function Y(t){return I(t,function(t){return t=f(t,O),I(q(f(t,function(t){return I(t,i,i)})),function(){return t})})}O.eh=F,O.hh=function(){return P.slice()},O.oh=function(){F(),U=!1},F(),O.reject=G,O.fulfill=x,O.uh=function(n){return A({ah:function(){}},function(t,i){return V(n,t,i)},function(){return O(n).inspect()})},O.qe=B,A.prototype.qe=function(i,t){return this.all().then(function(t){return i.apply(void 0,t)},t)},O.async=function(i){return function(){function t(t,i){var n;if("undefined"==typeof StopIteration){try{n=r[t](i)}catch(t){return G(t)}return n.done?O(n.value):I(n.value,s,e)}try{n=r[t](i)}catch(t){return function(t){return"[object StopIteration]"===w(t)||t instanceof h}(t)?O(t.value):G(t)}return I(n,s,e)}var r=i.apply(this,arguments),s=t.bind(t,"next"),e=t.bind(t,"throw");return s()}},O.fh=function(t){O.done(O.async(t)())},O.lh=function(t){throw new h(t)},O.vh=function(n){return function(){return B([this,q(arguments)],function(t,i){return n.apply(t,i)})}},O.sh=V,A.prototype.sh=function(t,i){var n=this,r=_();return O.Me(function(){n.Fe(r.resolve,t,i)}),r.promise},O.get=function(t,i){return O(t).sh("get",[i])},A.prototype.get=function(t){return this.sh("get",[t])},O.set=function(t,i,n){return O(t).sh("set",[i,n])},A.prototype.set=function(t,i){return this.sh("set",[t,i])},O.dh=O["delete"]=function(t,i){return O(t).sh("delete",[i])},A.prototype.dh=A.prototype["delete"]=function(t){return this.sh("delete",[t])},O.Eh=O.rh=function(t,i,n){return O(t).sh("post",[i,n])},A.prototype.Eh=A.prototype.rh=function(t,i){return this.sh("post",[t,i])},O.send=O.wh=O.ph=function(t,i){return O(t).sh("post",[i,u(arguments,2)])},A.prototype.send=A.prototype.wh=A.prototype.ph=function(t){return this.sh("post",[t,u(arguments,1)])},O.gh=function(t,i){return O(t).sh("apply",[void 0,i])},A.prototype.gh=function(t){return this.sh("apply",[void 0,t])},O.bh=O.We=function(t){return O(t).sh("apply",[void 0,u(arguments,1)])},A.prototype.We=function(){return this.sh("apply",[void 0,u(arguments)])},O.yh=function(t){var i=O(t),n=u(arguments,1);return function(){return i.sh("apply",[this,n.concat(u(arguments))])}},A.prototype.yh=function(){var t=this,i=u(arguments);return function(){return t.sh("apply",[this,i.concat(u(arguments))])}},O.keys=function(t){return O(t).sh("keys",[])},A.prototype.keys=function(){return this.sh("keys",[])},O.all=q,A.prototype.all=function(){return q(this)},O.Th=Q,A.prototype.Th=function(){return Q(this)},O.Oh=(D=Y,j="allResolved",M="allSettled",function(){return"undefined"!=typeof console&&"function"==typeof emptyFunction&&!1,D.apply(D,arguments)}),A.prototype.Oh=function(){return Y(this)},O.allSettled=function(t){return O(t).allSettled()},A.prototype.allSettled=function(){return this.then(function(t){return q(f(t,function(t){function i(){return t.inspect()}return(t=O(t)).then(i,i)}))})},O.fail=O["catch"]=function(t,i){return O(t).then(void 0,i)},A.prototype.fail=A.prototype["catch"]=function(t){return this.then(void 0,t)},O.progress=function(t,i){return O(t).then(void 0,void 0,i)},A.prototype.progress=function(t){return this.then(void 0,void 0,t)},O.mh=O["finally"]=function(t,i){return O(t)["finally"](i)},A.prototype.mh=A.prototype["finally"]=function(i){if(!i||"function"!=typeof i.apply)throw new Error("Q can't apply finally callback");return i=O(i),this.then(function(t){return i.We().then(function(){return t})},function(t){return i.We().then(function(){throw t})})},O.done=function(t,i,n,r){return O(t).done(i,n,r)},A.prototype.done=function(t,i,n){var r=function(t){O.Me(function(){if(g(t,s),!O.onerror)throw t;O.onerror(t)})},s=t||i||n?this.then(t,i,n):this;"object"==typeof W&&W&&W.domain&&(r=W.domain.bind(r)),s.then(void 0,r)},O.timeout=function(t,i,n){return O(t).timeout(i,n)},A.prototype.timeout=function(t,i){var n=_(),r=setTimeout(function(){i&&"string"!=typeof i||((i=new Error(i||"Timed out after "+t+" ms")).code="ETIMEDOUT"),n.reject(i)},t);return this.then(function(t){clearTimeout(r),n.resolve(t)},function(t){clearTimeout(r),n.reject(t)},n.notify),n.promise},O.delay=function(t,i){return void 0===i&&(i=t,t=void 0),O(t).delay(i)},A.prototype.delay=function(n){return this.then(function(t){var i=_();return setTimeout(function(){i.resolve(t)},n),i.promise})},O._h=function(t,i){return O(t)._h(i)},A.prototype._h=function(t){var i=_(),n=u(t);return n.push(i.Be()),this.gh(n).fail(i.reject),i.promise},O.Rh=function(t){var i=u(arguments,1);return O(t)._h(i)},A.prototype.Rh=function(){var t=u(arguments),i=_();return t.push(i.Be()),this.gh(t).fail(i.reject),i.promise},O.Sh=O.Ah=function(n){if(void 0===n)throw new Error("Q can't wrap an undefined function");var r=u(arguments,1);return function(){var t=r.concat(u(arguments)),i=_();return t.push(i.Be()),O(n).gh(t).fail(i.reject),i.promise}},A.prototype.Sh=A.prototype.Ah=function(){var t=u(arguments);return t.unshift(this),O.Ah.apply(void 0,t)},O.Ih=function(n,r){var s=u(arguments,2);return function(){var t=s.concat(u(arguments)),i=_();return t.push(i.Be()),O(function(){return n.apply(r,arguments)}).gh(t).fail(i.reject),i.promise}},A.prototype.Ih=function(){var t=u(arguments,0);return t.unshift(this),O.Ih.apply(void 0,t)},O.Nh=O.Ch=function(t,i,n){return O(t).Ch(i,n)},A.prototype.Nh=A.prototype.Ch=function(t,i){var n=u(i||[]),r=_();return n.push(r.Be()),this.sh("post",[t,n]).fail(r.reject),r.promise},O.kh=O.Dh=O.jh=function(t,i){var n=u(arguments,2),r=_();return n.push(r.Be()),O(t).sh("post",[i,n]).fail(r.reject),r.promise},A.prototype.kh=A.prototype.Dh=A.prototype.jh=function(t){var i=u(arguments,1),n=_();return i.push(n.Be()),this.sh("post",[t,i]).fail(n.reject),n.promise},O.Mh=function(t,i){return O(t).Mh(i)},A.prototype.Mh=function(i){if(!i)return this;this.then(function(t){O.Me(function(){i(null,t)})},function(t){O.Me(function(){i(t)})})},O.Ph=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var K=T();return O})}).call(this,n(37),n(117).setImmediate)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(8),s=(e.Lh=5e3,e.Hh=6,e.Uh=1e4,e.Fh=.2,e.Gh=10,e);function e(){}var h=(o.xh="0.0.1",o.Bh=3e4,o.Vh=4e7,o.qh=1,o.Qh=.8,o.Yh=!1,o.Kh=2e4,o.Wh=1e4,o);function o(){}var u=(a.$h=r.Y.Xh,a.zh=3,a.Jh=1e4,a);function a(){}var f=(c.Zh=1.2,c.to=1.5,c.io=1.2,c.no=.5,c);function c(){}var l=(v.ro=r.Y.so,v.eo=2e4,v.ho=5e3,v);function v(){}var d=(E.oo=[412,404],E);function E(){}var w=(p.uo=2e3,p.ao=!0,p.fo=!1,p.co=!0,p.lo=1,p.vo=.04,p["do"]=2,p.Eo=!0,p.wo=!1,p.po=!1,p.bo=1e4,p.yo=4e4,p.To=3700,p.Oo=2e4,p.mo=1,p._o=5,p.Ro=.4,p.So=1,p.Ao=!0,p.Io=2,p.No=1.5,p);function p(){}var g=(b.Co=30,b.ko=2e4,b.Do=3e4,b);function b(){}var y=(T.jo=3e7,T.Mo=3e4,T.Po=10,T);function T(){}var O=(m.Lo=3,m.Ho=!1,m.Uo=3e4,m.Fo=3,m.Go=.2,m.xo=.2,m.Bo=1e4,m);function m(){}var _=(R.Vo=!1,R);function R(){}var S=(A.qo=64e3,A.Qo=5e3,A.Yo=1,A.Ko=1,A.Wo=!1,A.$o=!0,A);function A(){}var I=(N.Xo=4e3,N.zo=3e4,N.Jo=4096,N.Zo=!0,N.tu=5e3,N.iu=1e4,N);function N(){}var C=(k.nu=100,k.ru=200,k);function k(){}var D=(j.su=20,j.eu=20,j.hu=20,j.ou=5,j.TIMEOUT=6e4,j);function j(){}var M=(P.uu="site",P.au="externalAs",P.fu="availableSendRate",P.cu="remoteAddress",P.lu="localAddress",P.vu=2e4,P);function P(){}var L=(H.du=3e4,H);function H(){}var U=(F.Eu=300,F);function F(){}var G=(x.wu=!0,x.pu=!0,x);function x(){}var B=(V.gu=1,V.bu=6,V.yu=12,V.Tu=4,V.Ou=27,V);function V(){}var q=(Q.mu=s,Q._u=h,Q.Ru=u,Q.Su=f,Q.Au=l,Q.Iu=d,Q.Nu=w,Q.Cu=g,Q.Cache=y,Q.ku=O,Q.Du=_,Q.ju=S,Q.UDPBroadcast=I,Q.Mu=C,Q.Pu=D,Q.Lu=M,Q.Hu=L,Q.Uu=U,Q.Fu=G,Q.Gu=B,Q);function Q(){}i.xu=q},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var a=n(21),e=n(22),h=n(0),r=(s.prototype.next=function(){return this.count++,this.count},s);function s(){this.count=0}i.Counter=r;var o=(u.prototype.start=function(t){void 0===t&&(t=h.Framework.time()),this.Bu||(this.Bu={start:t,end:void 0},this.Vu.push(this.Bu))},u.prototype.stop=function(t){void 0===t&&(t=h.Framework.time()),this.Bu&&(this.Bu.end=t,this.Bu=void 0,this.qu=!1)},u.prototype.Qu=function(t,i){void 0===t&&(t=h.Framework.time());var n=this.Bu,r=this.qu;n&&this.stop(t);var s=(r?i:0)||this.Vu.reduce(function(t,i){var n=i.start;return t+i.end-n},0);return this.Vu.length=0,n&&(this.start(t),this.qu=!0),s},u.prototype.reset=function(){this.qu=!1,this.Bu=void 0,this.Vu.length=0},u.prototype.Yu=function(){return Boolean(this.Bu)},u);function u(t){this.Vu=[],this.qu=!1,void 0!==t&&this.start(t)}i.Ku=o;var f=(c.prototype.add=function(t){t<=0||(this.Wu+=t,this.$u++,t>this.Xu&&(this.Xu=t),t<this.zu&&(this.zu=t))},c.prototype.min=function(t){void 0===t&&(t=!0);var i=this.zu==Number.POSITIVE_INFINITY?0:this.zu;return t&&this.reset(),i},c.prototype.max=function(t){void 0===t&&(t=!0);var i=this.Xu==Number.NEGATIVE_INFINITY?0:this.Xu;return t&&this.reset(),i},c.prototype.Ju=function(t){void 0===t&&(t=!0);var i=this.Wu;return t&&this.reset(),i},c.prototype.Zu=function(t){void 0===t&&(t=!0);var i=0<this.$u?this.Wu/this.$u:0;return t&&this.reset(),i},c.prototype.reset=function(){this.zu=Number.POSITIVE_INFINITY,this.Xu=Number.NEGATIVE_INFINITY,this.Wu=0,this.$u=0},c);function c(){this.reset()}i.ta=f;var l=(v.prototype.ia=function(t,i,n){this.protocol.na(i,e.ra.ONEWAY,n),t.write(this.protocol),this.protocol.sa();var r=this.transport.ea(),s=this.ha(r,",",4);return r.slice(s+1,r.length-1)},v.prototype.oa=function(t,i,n,r){var s="["+n+', "'+i+'", 4, 0,'+t+"]";this.transport.ua(s),this.protocol.aa();var e=new r();return e.read(this.protocol),this.protocol.fa(),e},v.prototype.ha=function(t,i,n){return t.split(i,n).join(i).length},v);function v(){this.transport=new e.ca(),this.protocol=new e.la(this.transport)}i.va=l;var d=(E.prototype.isValid=function(){return void 0!==this.bandwidth},E.prototype.da=function(t){return this.bandwidth=Math.max(E.Ea,t),this},E.prototype.wa=function(t){t.isValid()&&(this.isValid()?this.bandwidth=this.bandwidth*(1-E.ALPHA)+t.bandwidth*E.ALPHA:this.bandwidth=t.bandwidth)},E.prototype.pa=function(t){return this.isValid()?Math.round(8e3*t/this.bandwidth):NaN},E.prototype.ga=function(){return this.isValid()?this.bandwidth:NaN},E.prototype.ba=function(){return this.isValid()?this.bandwidth/1e3:NaN},E.prototype.ya=function(){return this.isValid()?this.bandwidth/1e6:NaN},E.prototype.Ta=function(){return this.isValid()?1e6<this.bandwidth?(this.bandwidth/1e6).toFixed(2)+"Mb/s":1e3<this.bandwidth?(this.bandwidth/1e3).toFixed(2)+"Kb/s":this.bandwidth+"b/s":"NaN"},E.ALPHA=.25,E.Ea=1e8,E.Oa=1e4,E);function E(t,i){void 0!==t&&void 0!==i&&(this.bandwidth=Math.min(E.Ea,i/t*8e3))}i.ma=d,i._a=new r(),i.Ra=function(t,i){return i?t+"-"+i:t},i.appendBuffer=function(t,i){var n=new Uint8Array(t.byteLength+i.byteLength);return n.set(new Uint8Array(t),0),n.set(new Uint8Array(i),t.byteLength),n.buffer},i.Sa=function(t){var i=new Uint8Array(t.byteLength);return i.set(new Uint8Array(t),0),i.buffer},i.Aa=function(t,i,n){void 0===n&&(n=!0);for(var r=0;r<t.length;)if(t[r]===i){if(t.splice(r,1),n)break}else r++},i.Ia=function(t){return String.fromCharCode.apply(null,new Uint8Array(t))},i.Na=function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null==i?"":decodeURIComponent(i[1].replace(/\+/g," "))},i.Ca=function(t){for(var i=t.length-1;0<i;i--){var n=Math.floor(h.Framework.random()*(i+1)),r=t[i];t[i]=t[n],t[n]=r}return t},i.ka=function(t){var i=new Array();for(var n in t)t.hasOwnProperty(n)&&!/^\d+$/.test(n)&&i.push(n);return i},i.Da=function(t){return Object.keys(t).map(function(t){return parseInt(t,10)}).filter(function(t){return!isNaN(t)})},i.ja=function(t,i){return t[i]?t[i]:null},i.Ma=function(t,i){return new a(i).Pa(t).toString()},i.La=function(t){void 0===t&&(t="");var i=t.toLowerCase().indexOf("(format=mpd-time-csf)");return-1!=i&&(t=t.substr(0,i)),-1==(i=t.indexOf("?"))&&(i=t.length),t.substr(0,i)},i.Ha=function(t){var i,n,r,s,e=new a(t),h=e.origin(),o=e.query(),u=e.path();for("/"!==u.charAt(0)&&(i=!0,u="/"+u),"/.."!==u.slice(-3)&&"/."!==u.slice(-2)||(u+="/"),u=u.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),i&&(n=(n=u.substring(1).match(/^(\.\.\/)+/)||"")&&n[0]);-1!==(r=u.search(/\/\.\.(\/|$)/));)u=0!==r?(-1===(s=u.substring(0,r).lastIndexOf("/"))&&(s=r),u.substring(0,s)+u.substring(r+3)):u.substring(3);return h+u+(o?"?"+o:"")},i.Zu=function(t){return 0==t.length?0:t.reduce(function(t,i){return t+i})/t.length},i.Ua=function(t){for(var i=new ArrayBuffer(t.length),n=new Uint8Array(i),r=0,s=t.length;r<s;r++)n[r]=t.charCodeAt(r);return i},i.createEvent=function(t,i,n,r){var s=new t(i,n),e=r||n.currentTarget;return e&&Object.defineProperties(s,{currentTarget:{value:e,enumerable:!0,writable:!1},target:{value:e,enumerable:!0,writable:!1}}),s},i.Fa=/[-\/\\^$*+?.()|[\]{}]/g,i.Ga=function(t){return t.replace(i.Fa,"\\$&")}},function(t,i,n){"use strict";var r;Object.defineProperty(i,"s",{value:!0}),(r=i.xa||(i.xa={}))[r.Ba=0]="AUDIO",r[r.Va=1]="VIDEO",r[r.qa=2]="METADATA",r[r.Qa=3]="OTHER"},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.Ya=!0,s.Ka=!0,s.Wa="4.1.0",s.$a="oz",s.Xa="undefined"!=typeof HIVE_PLUGIN_TIMEOUT?HIVE_PLUGIN_TIMEOUT:3e4,s.za="6.0.0-rc.3",s.Ja="undefined"!=typeof HIVE_CACHE_PLAYER_REQUEST_QUERY_PARAMS?HIVE_CACHE_PLAYER_REQUEST_QUERY_PARAMS:[],s.Za="undefined"!=typeof HIVE_CACHE_PLAYER_REQUEST_HEADERS?HIVE_CACHE_PLAYER_REQUEST_HEADERS:[],s["if"]=!1,s.nf=!0,s.rf="undefined"!=typeof INCLUDE_UDP_BROADCAST&&INCLUDE_UDP_BROADCAST,s.sf="undefined"!=typeof INCLUDE_UDP_LEADER_ELECTION&&INCLUDE_UDP_LEADER_ELECTION,s.ef="undefined"!=typeof LEADER_SCORE_EQUALITY&&LEADER_SCORE_EQUALITY,s.hf="undefined"!=typeof INCLUDE_DEFAULT_NETWORK&&INCLUDE_DEFAULT_NETWORK,s.uf="undefined"!=typeof HIVE_RESTRICTED_CONNINFO&&HIVE_RESTRICTED_CONNINFO,s.so="undefined"!=typeof HIVE_DISCOVERY?HIVE_DISCOVERY:"ws://127.0.0.1:8000/hive",s.af="undefined"!=typeof P2PDispatcherDetailedLog&&P2PDispatcherDetailedLog,s.ff="undefined"!=typeof NetworkManagerDetailedLog&&NetworkManagerDetailedLog,s.q="undefined"!=typeof ATATUS_KEY?ATATUS_KEY:"0b83dd6a94664cc9a09c478a7d77384e",s.K="undefined"!=typeof ATATUS_VERSION?ATATUS_VERSION:"4.2.1",s.W="undefined"==typeof ATATUS_DEFAULT_ENABLED||ATATUS_DEFAULT_ENABLED,s.$="undefined"!=typeof ATATUS_ROWS_TO_EXCLUDE?ATATUS_ROWS_TO_EXCLUDE:5,s.cf="undefined"==typeof HIVE_DETECT_PRIVATEIP||HIVE_DETECT_PRIVATEIP,s.lf=!0,s.vf=!1,s.df=!0,s.Xh=!1,s.Ef="undefined"==typeof STATS_MANIFEST_INTERCEPTION_ENABLED||STATS_MANIFEST_INTERCEPTION_ENABLED,s.wf="undefined"!=typeof HIVE_REPORTING_THRESHOLD?HIVE_REPORTING_THRESHOLD:0,s);function s(){}i.Y=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0}),n(25);var r,s=n(48);(r=i.pf||(i.pf={}))[r.gf=0]="TRACKER",r[r.bf=1]="UDP";function e(t,i,n){this.type=t,(this.isLeader=n)||(this.isLeader=!1),i&&(this.guid=i.guid,this.internalAs=i.internalAs,this.externalAs=i.externalAs,this.nat=i.nat,this.bandwidth=i.bandwidth,this.watchingQualityLevel=new s.QualityLevel(i.watchingQualityLevel,i.watchingBitrate),this.streams=i.streams,this.rankValue=i.rankValue,this.timestamp=i.timestamp,this.privateIpString=i.privateIpString,this.publicIpString=i.publicIpString)}i.yf=e},function(t,i,n){n(70),n(38),n(71),n(119)},function(t,i,n){"use strict";function r(){throw new Error("Can't construct. GenericCollection is a mixin.")}(t.exports=r).Tf=Object.freeze([]),r.prototype.hiveAddEach=function(i){if(i&&Object(i)===i)if("function"==typeof i.forEach)i.forEach(this.hiveAdd,this);else if("number"==typeof i.length)for(var t=0;t<i.length;t++)this.hiveAdd(i[t],t);else Object.keys(i).forEach(function(t){this.hiveAdd(i[t],t)},this);else if(i&&"number"==typeof i.length)for(t=0;t<i.length;t++)this.hiveAdd(i[t],t);return this},r.prototype.Of=function(t,i){return t.forEach(function(t){this["delete"](t,i)},this),this},r.prototype.forEach=function(e){var h=arguments[1];return this.reduce(function(t,i,n,r,s){e.call(h,i,n,r,s)},void 0)},r.prototype.map=function(e){var h=arguments[1],o=[];return this.reduce(function(t,i,n,r,s){o.push(e.call(h,i,n,r,s))},void 0),o},r.prototype.enumerate=function(n){null==n&&(n=0);var r=[];return this.reduce(function(t,i){r.push([n++,i])},void 0),r},r.prototype.group=function(e,h,o){o=o||Object.equals;var u=[],a=[];return this.forEach(function(t,i,n){i=e.call(h,t,i,n);var r,s=a.indexOf(i,o);-1===s?(r=[],u.push([i,r]),a.push(i)):r=u[s][1],r.push(t)}),u},r.prototype.toArray=function(){return this.map(Function.identity)},r.prototype.mf=function(){var r={};return this.reduce(function(t,i,n){r[n]=i},void 0),r},r.prototype.filter=function(e){var h=arguments[1],o=this.Ne();return this.reduce(function(t,i,n,r,s){e.call(h,i,n,r,s)&&o.hiveAdd(i,n)},void 0),o},r.prototype.every=function(e){var h=arguments[1];return this.reduce(function(t,i,n,r,s){return t&&e.call(h,i,n,r,s)},!0)},r.prototype.some=function(e){var h=arguments[1];return this.reduce(function(t,i,n,r,s){return t||e.call(h,i,n,r,s)},!1)},r.prototype.all=function(){return this.every(Boolean)},r.prototype.Th=function(){return this.some(Boolean)},r.prototype.min=function(n){n=n||this._f||Object.compare;var r=!0;return this.reduce(function(t,i){return r?(r=!1,i):n(i,t)<0?i:t},void 0)},r.prototype.max=function(n){n=n||this._f||Object.compare;var r=!0;return this.reduce(function(t,i){return r?(r=!1,i):0<n(i,t)?i:t},void 0)},r.prototype.Ju=function(t){return t=void 0===t?0:t,this.reduce(function(t,i){return t+i},t)},r.prototype.Rf=function(t){var n=void 0===t?0:t,r=void 0===t?0:t;return this.reduce(function(t,i){n+=i,r+=1},void 0),n/r},r.prototype.concat=function(){for(var t=this.Ne(this),i=0;i<arguments.length;i++)t.hiveAddEach(arguments[i]);return t},r.prototype.Sf=function(){var n=this;return this.reduce(function(t,i){return i.forEach(function(t){this.push(t)},t,n),t},[])},r.prototype.Af=function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),Array.If(t)},r.prototype.join=function(n){return this.reduce(function(t,i){return void 0===t?i:t+n+i},void 0)},r.prototype.Nf=function(n,i,r){return(n=n||this._f||Object.compare).Cf?(i=n.Cf,n=n.compare||this._f||Object.compare):i=i||Function.identity,void 0===r&&(r=1),this.map(function(t){return{Cf:i(t),value:t}}).sort(function(t,i){return n(t.Cf,i.Cf)*r}).map(function(t){return t.value})},r.prototype.reversed=function(){return this.Ne(this).reverse()},r.prototype.clone=function(n,r){if(void 0===n)n=1/0;else if(0===n)return this;var s=this.Ne();return this.forEach(function(t,i){s.hiveAdd(Object.clone(t,n-1,r),i)},this),s},r.prototype.only=function(){if(1===this.length)return this.kf()},r.prototype.iterator=function(){return this.Df.apply(this,arguments)},r.Ie={get:function(){return this.length},enumerable:!1,configurable:!0},Object.defineProperty(r.prototype,"size",r.Ie),n(70)},function(t,i,n){n(10);var r=Object.prototype.hasOwnProperty;function h(){throw new Error("This is an abstract interface. Mix it. Don't construct it")}function o(t,i,n,r){var s,e,h,o=t.active,u=t.jf,a=u.length,f=a;for(o.length>a&&(o.length=a);a--;)o[a]=u[a];for(e=0;e<f;e++)if(h=o[e],!e||0<=u.indexOf(h)){if(!(s=h[t.Mf]||h[t.Pf]||h).call)throw new Error("No event listener for "+t.Lf+" or "+t.Hf+" or call on "+s);s.call(h,n,i,r)}}(t.exports=h).debug=!0,h.prototype.Uf=function(t){this.Ff||Object.defineProperty(this,"Ff",{value:{},enumerable:!1,configurable:!0,writable:!0});var i=this.Ff;if(!r.call(i,t)){var n=String(t);n=n&&n[0].toUpperCase()+n.slice(1),i[t]={Gf:{jf:[],active:[],Mf:"handle"+n+"WillChange",Pf:"handlePropertyWillChange"},xf:{jf:[],active:[],Mf:"handle"+n+"Change",Pf:"handlePropertyChange"}}}return i[t]},h.prototype.Bf=function(t){if(!this.Ff)return!1;if(!t)return!0;var i=this.Ff;return!!r.call(i,t)},h.prototype.Vf=function(t,i,n){this.qf&&!this.Qf&&this.qf();var r,s=h.Uf(this,t);r=n?s.Gf:s.xf,h.Yf(this,t),r.jf.push(i);var e=this;return function(){h.Kf(e,t,i,n),e=null}},h.prototype.Wf=function(t,i){return h.Vf(this,t,i,!0)},h.prototype.Kf=function(t,i,n){var r,s=h.Uf(this,t),e=(r=n?s.Gf:s.xf).jf.lastIndexOf(i);if(-1===e)throw new Error("Can't remove property change listener: does not exist: property name"+JSON.stringify(t));r.jf.splice(e,1)},h.prototype.$f=function(t,i){return h.Kf(this,t,i,!0)},h.prototype.Xf=function(t,i,n){var r,s=h.Uf(this,t);if(!s.isActive){s.isActive=!0,r=n?s.Gf:s.xf;try{o(r,t,i,this)}finally{s.isActive=!1}}},h.prototype.zf=function(t,i){return h.Xf(this,t,i,!0)},h.prototype.Yf=function(s){var e,h,t=this.Jf;if(t){if(r.call(t,s))return}else{if(Array.isArray(this))return;if(!Object.isExtensible(this))throw new Error("Can't make property "+JSON.stringify(s)+" observable on "+this+" because object is not extensible");t={},Object.defineProperty(this,"Jf",{value:t,enumerable:!1,writable:!0,configurable:!0})}"object"==typeof this.Zf?e=this.Zf:(e={},Object.defineProperty(this,"Zf",{value:e,writable:!0,enumerable:!1})),e[s]=this[s];var i,n=this;do{if(h=Object.getOwnPropertyDescriptor(n,s))break;n=Object.getPrototypeOf(n)}while(n);if(h){if(!h.configurable)return;if(!h.writable&&!h.set)return}else h={value:void 0,enumerable:!0,writable:!0,configurable:!0};i="value"in(t[s]=h)?{get:function(){return h.value},set:function(t){var i,n;if(t!==h.value){if(!(n=(i=this.Ff[s]).isActive)){i.isActive=!0;try{o(i.Gf,s,h.value,this)}finally{}}if(h.value=t,e[s]=t,!n)try{o(i.xf,s,t,this)}finally{i.isActive=!1}}},enumerable:h.enumerable,configurable:!0}:{get:h.get,set:function(t){var i,n,r=this[s];if(h.set.call(this,t),(t=this[s])!==r){if(!(n=(i=this.Ff[s]).isActive)){i.isActive=!0;try{o(i.Gf,s,r,this)}finally{}}if(e[s]=t,!n)try{o(i.xf,s,t,this)}finally{i.isActive=!1}}},enumerable:h.enumerable,configurable:!0},Object.defineProperty(this,s,i)},h.Uf=function(t,i){return t.Uf?t.Uf(i):h.prototype.Uf.call(t,i)},h.Bf=function(t,i){return t.Bf?t.Bf(i):h.prototype.Bf.call(t,i)},h.Vf=function(t,i,n,r){if(Object.tc(t))return t.Vf?t.Vf(i,n,r):h.prototype.Vf.call(t,i,n,r)},h.Kf=function(t,i,n,r){if(Object.tc(t))return t.Kf?t.Kf(i,n,r):h.prototype.Kf.call(t,i,n,r)},h.Xf=function(t,i,n,r){if(Object.tc(t))return t.Xf?t.Xf(i,n,r):h.prototype.Xf.call(t,i,n,r)},h.Wf=function(t,i,n){return h.Vf(t,i,n,!0)},h.$f=function(t,i,n){return h.Kf(t,i,n,!0)},h.zf=function(t,i,n){return h.Xf(t,i,n,!0)},h.Yf=function(t,i){return t.Yf?t.Yf(i):h.prototype.Yf.call(t,i)}},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e=n(43),h=n(8),o=(u.DashFilterBitrates=null,u.DashRemoveBitrateSize=!1,u);function u(){}var a=(f.AudioAccounting=!0,f);function f(){}var c,l=(c=e.HiveConfig.DebugLogs,s(v,c),v.TrackerLogs=0,v);function v(){return null!==c&&c.apply(this,arguments)||this}var d=(E.usiz=null,E);function E(){}var w=(p.enabled=!1,p);function p(){}var g=(b.restrictedConnectivityInfo=h.Y.uf,b.hiddenHostnameValue="[Hidden]",b);function b(){}var y=(T.rc=null,T.sc=null,T);function T(){}var O=(m.detectPrivateIP=h.Y.cf,m);function m(){}var _=(R.Dash=o,R.Stats=a,R.DebugLogs=l,R.UDPBroadcast=d,R.SensitiveInfo=g,R.ClientInfo=y,R.ConnInfo=O,R.ec=w,R);function R(){}i.HiveConfig=_,"undefined"!=typeof window&&(void 0===window.HiveConfig&&(window.HiveConfig={}),window.HiveConfig.Dash=_.Dash,window.HiveConfig.Stats=_.Stats,window.HiveConfig.UDPBroadcast=_.UDPBroadcast,window.HiveConfig.DebugLogs=_.DebugLogs,window.HiveConfig.SensitiveInfo=_.SensitiveInfo,window.HiveConfig.ClientInfo=_.ClientInfo,window.HiveConfig.ConnInfo=_.ConnInfo,window.HiveConfig.ec=_.ec)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(8),s=(e.hc="ws://127.0.0.1:8000/hive",e.oc="wss://bee.hivestreaming.com:443/v1/hivejs",e.uc="ws://127.0.0.1:8001/v1/hivejs",e.ac="wss://bee-test.hivestreaming.com:443/v1/hivejs",e.fc="wss://labs-hivejs.test.hivestreaming.net:443/v1/hivejs",e.cc="wss://labs-hivejs.prod.hivestreaming.net:443/v1/hivejs",e.lc="https://api-groot-test.hivestreaming.com/v1/auth/stream",e.vc="https://api-groot-prod.hivestreaming.com/v1/auth/stream",e.dc={iceServers:[{url:"stun:stun.hivestreaming.com:3478"}]},e.Ec=3e4,e.wc=3e5,e.pc=8e4,e.gc=1e3,e.bc=3e4,e.yc=100,e.Tc=1e4,e.Oc=!1,e.mc=!1,e.nf=r.Y.nf,e.lf=r.Y.lf,e._c=250,e);function e(){}i.Rc=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var u=n(4),o=n(21);function h(i,r,s,e){void 0===r&&(r=""),void 0===s&&(s=[]),void 0===e&&(e=!1);function t(n){if(i.hasOwnProperty(n)){var t=i[n];Array.isArray(t)?t.forEach(function(t,i){"object"==typeof t&&h(t,r+"."+n+"["+i+"]",s,e)}):"object"==typeof t?h(t,r+"."+n,s,e):"number"==typeof t&&isNaN(t)&&(s.push(r+"."+n),e||(i[n]=null))}}for(var n in i)t(n);return s}function a(t,i){var n;switch(typeof i){case"number":n=parseInt(t);break;case"boolean":n="true"===t;break;default:n=t}return n}function s(t,i,n,r,s){void 0===r&&(r=!0),void 0===s&&(s={});var e=u.defer();try{var h=new XMLHttpRequest();if(h.open(t,i,r),null!=n&&null!=n&&h.setRequestHeader("Content-Type",n),s)for(var o in s)s.hasOwnProperty(o)&&null!==s[o]&&h.setRequestHeader(o,s[o]);h.onload=function(){200==h.status?e.resolve(h.response):e.reject({status:h.status,reason:h.statusText,body:h.responseText})},h.onerror=function(t){e.reject({status:-1,reason:"Network Error"})},h.send()}catch(t){e.reject({status:-1,reason:t})}return e.promise}i.Ta=function(t,i){return void 0===i&&(i=2),1e6<t?(t/1e6).toFixed(i)+"MB":1e3<t?(t/1e3).toFixed(i)+"KB":t+"B"},i.Sc=function(t,i,n){return void 0===i&&(i=""),void 0===n&&(n=[]),h(t,i,n,!0)},i.Ac=h,i.Ic=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];for(var n=t[0],r=1;r<t.length;r++){var s=new RegExp("\\{"+(r-1)+"\\}","gm");n=n.replace(s,t[r])}return n},i.updateOptions=function(t,i){for(var n in t)if(t.hasOwnProperty(n)&&i.hasOwnProperty(n))if("function"==typeof i[n]&&"string"==typeof t[n])try{var r=window;do{var s=t[n];if("function"==typeof r[s]){i[n]=r[s];break}}while(r!=r.top&&(r=r.parent))}catch(t){}else i[n]=t[n]},i.parseParameterOptions=function(t,i,n){var r=new o(t).query(!0);for(var s in r)try{if(r.hasOwnProperty(s)&&i.hasOwnProperty(s)&&n.hasOwnProperty(i[s])){var e=i[s],h=r[s];n[e]=a(h,n[e])}}catch(t){}},i.Nc=function(i,n){var r=u.defer();return u.Me(function t(){if(!i())return r.resolve(!0);u.when(n(),t,r.reject)}),r.promise},i.Cc=function(t,i,n,r){return void 0===n&&(n=!0),void 0===r&&(r={}),s("GET",t,i,n,r)},i.kc=s,i.Dc=function(t,i,n,r,s){void 0===s&&(s=!0);var e=u.defer();try{var h=new XMLHttpRequest();if(h.open("POST",t,s),null!=n&&null!=n&&h.setRequestHeader("Content-Type",n),null!=r&&null!=r)for(var o in r)r.hasOwnProperty(o)&&null!==r[o]&&h.setRequestHeader(o,r[o]);h.onload=function(){200==h.status?e.resolve(h.response):e.reject({status:h.status,reason:h.response})},h.onerror=function(t){e.reject({status:-1,reason:"Network Error"})},h.send(i)}catch(t){e.reject({status:-1,reason:t})}return e.promise},i.jc=function(){"function"!=typeof Object.assign&&(Object.assign=function(t,i){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),r=1;r<arguments.length;r++){var s=arguments[r];if(null!=s)for(var e in s)Object.prototype.hasOwnProperty.call(s,e)&&(n[e]=s[e])}return n})},i.Sa=function(t){var i=new Uint8Array(t.byteLength);return i.set(new Uint8Array(t),0),i.buffer},i.Mc=function(t,i){var n=0,r=0,s=!1;if(i)for(;r<i.length&&!s;)t>=i.start(r)&&t<i.end(r)&&(n=i.end(r)-t,s=!0),r++;return n}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,s=n(1),e=n(2);i.loggerId="[HiveServices] ";var h=(o.prototype.ia=function(){try{var t=[new Uint8Array([this.service>>8,255&this.service]),new Uint8Array([this.msgId]),this.msg];return new Blob(t,{type:"application/octet-binary"})}catch(t){throw s.ErrorMonitor.getInstance().logError("Error serializing message to send to the services",o.loggerId,e.Js.Zs,t),new Error(t)}},o.Pc=function(t){try{String.fromCharCode.apply(null,new Uint8Array(t));var i=String.fromCharCode.apply(null,new Uint8Array(t.slice(3))),n=new Uint8Array(t.slice(0,2)),r=new Uint8Array(t.slice(2,3));return new o((n[0]<<8)+n[1],r[0],i)}catch(t){throw s.ErrorMonitor.getInstance().logError("Error extracting message from the services",this.loggerId,e.Js.te,t),new Error(t)}},o.loggerId="[Message] ",o);function o(t,i,n){this.msgId=i,this.service=t,this.msg=n}i.Lc=h,i.logger=function(){if(r)return r;var t=window&&window.window?window.window.Hc:void 0;if(void 0!==t&&t.log&&t.debug&&t.info&&t.warn&&t.error&&(r=t),!r){var i=!(void 0===window.console),n=i?emptyFunction.bind(console):function(){};r={log:n,debug:i&&window.console.debug?window.console.debug.bind(console):n,info:i&&window.console.info?window.console.info.bind(console):n,warn:i&&window.console.warn?window.console.warn.bind(console):n,error:i&&window.console.error?window.console.error.bind(console):n}}return r}},function(t,c,i){"use strict";Object.defineProperty(c,"s",{value:!0});var l,n,s=i(4),r=i(201),v=i(36),e=i(3),d=i(23),E=i(0),h=i(203),a=i(210),w=i(5),f=i(6),p=i(1),g=i(2);c.Uc=!1,(n=l=c.Fc||(c.Fc={}))[n.Have=1]="Have",n[n.Chunk=2]="Chunk",n[n.Request=3]="Request",n[n.Cancel=4]="Cancel",n[n.Ack=5]="Ack",n[n.Close=6]="Close",n[n.DoNotHave=7]="DoNotHave",n[n.Gc=8]="OutPartRequest",n[n.xc=9]="OutPartResp",n[n.Bc=10]="UDPHandshakeReq",n[n.UDPHandshakeResponse=11]="UDPHandshakeResponse",n[n.UDPSwitchLeadershipRequest=12]="UDPSwitchLeadershipRequest",n[n.Vc=13]="UDPSwitchAck",n[n.QualityLevelMessage=14]="QualityLevelMessage",n[n.Haves=15]="Haves",n[n.qc=16]="PeerInfo",n[n.Ping=17]="Ping",n[n.Pong=18]="Pong",n[n.Qc=19]="NoPartnerResp";var o=(u.prototype.create=function(t){try{var i=null,n=E.Framework.resolve(E.Framework.v.Kc).Yc(t);return null==n?(this.logger.warn("MSG RECEIVED FROM UNKNOWN SWARM"),null):(i=new h.Wc(n,this.transport.$c,this.transport.otherGuid,this.transport),this.Xc.has(t)||this.Xc.set(t,i),this.Xc.get(t))}catch(t){p.ErrorMonitor.getInstance().logError("Error creating new dispatcher",this.loggerId,g.Yt.Kt,t)}},u.prototype.remove=function(t){this.Xc["delete"](t)},u.prototype.get=function(t){return this.Xc.get(t)},u);function u(t){this.loggerId="[DispatcherManager] ",this.Xc=new e(),this.logger=E.Framework.resolve(E.Framework.v.p).log(),this.transport=t}c.zc=o;var b=(y.prototype.init=function(t,i){this.$c=t,this.otherGuid=i,this.Jc=E.Framework.resolve(E.Framework.v.Zc)},y.prototype.tl=function(){var n=!1;return this.il.Xc.forEach(function(t,i){(t.sender.tl()||t.receiver.tl())&&(n=!0)}),n},y.prototype.reset=function(){this.il.Xc.forEach(function(t,i){t.sender.nl()})},y.prototype.close=function(t){return this.il.remove(t),0==this.il.Xc.length&&this.Jc.disconnect(this.otherGuid),s("ok")},y.prototype.rl=function(i,n,t){var r,s;try{this.sl=E.Framework.time();var e=t.toArrayBuffer(),h=e.byteLength,o=d.ol.hl.el.create(e),u=d.ol.ul(o),a=new v();a.al(i),a.fl(n),a.al(h),a.fl(u.toString()),a.append(e),a.cl(),r=a.toArrayBuffer(),s=i===l.Chunk&&E.Framework.T()?r.byteLength+w.xu.ju.qo:r.byteLength,c.Uc&&this.ll.log(n).debug(this.instance+" SEND MSG ID "+i+","+s+" HASH "+u.toString()+" TO "+this.otherGuid)}catch(t){p.ErrorMonitor.getInstance().logError("Error constructing message",this.loggerId,g.xt.Bt,{vl:l[i]})}try{var f=this.Jc.send(this.otherGuid,r,s);return f||p.ErrorMonitor.getInstance().logError("Error message dropped",this.loggerId,g.xt.Vt,{vl:l[i],otherGuid:this.otherGuid}),f}catch(t){p.ErrorMonitor.getInstance().logError("Error sending message",this.loggerId,g.xt.qt,{vl:l[i],otherGuid:this.otherGuid}),this.ll.log(n).warn("ERROR SENDING MESSAGE TO "+this.otherGuid+" "+t.stack)}},y.prototype.dl=function(){this.il.Xc.forEach(function(t){return t.dl()})},y.prototype.El=function(h){var o=this;c.Uc&&this.ll.log().debug(this.instance+" GOT MSG "+h.byteLength);try{var u=E.Framework.time();this.sl=u,this.wl(h).then(function(t){if(c.Uc&&o.ll.log().debug(o.instance+" RECEIVING "+t.byteLength+" after "+(E.Framework.time()-u)),t.byteLength>y.pl)throw new RangeError("P2P Message too big to be processed");var i=o.message;if(null===i){var n=v.wrap(t),r=n.gl();if(c.Uc&&o.ll.log().debug("MSG ID "+r),r>Object.keys(l).length)return o.ll.log().warn("MSG OF WRONG ID RECEIVED: "+r),void (o.message=null);if((i=o.message=new a.yl()).bl=r,i.swarmId=n.Tl(),i.length=n.gl(),i.hash=n.Tl(),i.receivedData=n.toArrayBuffer(),i.length>y.pl)throw new RangeError("P2P Message too big to be processed");c.Uc&&o.ll.log(i.swarmId).debug("MSG ID "+i.bl+" L "+i.length+" SWID "+i.swarmId+" H "+i.hash+" TR "+i.receivedData.byteLength)}else{if(c.Uc&&o.ll.log().debug("APPENDING TO P2P MESSAGE "+i.bl),null!=i.receivedData.byteLength&&i.receivedData.byteLength>y.pl)throw new RangeError("P2P Message too big to be processed");i.receivedData=f.appendBuffer(i.receivedData,h)}if(i.receivedData.byteLength===i.length){var s=d.ol.hl.el.create(i.receivedData);if(d.ol.ul(s).toString()!==i.hash)return void o.ll.log(i.swarmId).warn(" INTEGRITY CHECK FAILED ");var e=o.il.get(i.swarmId);e||(e=o.il.create(i.swarmId),o.ll.log(i.swarmId).debug("CREATED NEW DISPATCHER FOR "+o.otherGuid)),e&&e.sh(i),i.receivedData=null,o.message=null}})}catch(t){p.ErrorMonitor.getInstance().logError("Error receiving message",this.loggerId,g.xt.Qt,t),this.message=null}},y.prototype.wl=function(i){var t=!E.Framework.T()&&-1<navigator.userAgent.toLowerCase().indexOf("firefox"),n=s.defer();if(t){var r=new FileReader();r.onload=function(t){i=this.result,n.resolve(i)},r.onerror=n.reject,r.readAsArrayBuffer(i)}else n.resolve(i);return n.promise},y.prototype.Ol=function(){return this.sl},y.ml=r.Rl(i(211))._l("HiveMsgs"),y.Sl=0,y.pl=136+Math.ceil(1.2*w.xu.ju.qo),y);function y(){this.loggerId="[Transport] ",this.message=null,this.ll=E.Framework.resolve(E.Framework.v.p),this.il=new o(this),this.instance=y.Sl++,this.sl=E.Framework.time()}c.Al=b},function(t,i){t.exports=void 0},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(3),a=n(4),o=n(0),u=n(29),f=n(61);(e=i.Il||(i.Il={}))[e.STOP=0]="STOP",e[e.IDLE=1]="IDLE",e[e.Nl=2]="PLAY";var c=(l.prototype.close=function(t){t&&this.Cl["delete"](t),0==this.Cl.length&&this.kl.close()},l.prototype.Dl=function(t){return this.Cl.has(t)},l);function l(){this.p2pId=null,this.reportingId=null,this.Cl=new h(),this.logger=o.Framework.resolve(o.Framework.v.p).log(),this.logger.debug("INIT REPORTING"),this.kl=o.Framework.resolve(o.Framework.v.jl),this.Ml=o.Framework.resolve(o.Framework.v.Pl)}i.Ll=c;var v=(d.prototype.Hl=function(){return!(this.store&&this.store.Ul&&this.store.Ul.player)||(this.store.Ul.player.playingTimeMs||0)>=this.threshold},d.prototype.Fl=function(t){this.threshold=t},d);function d(t){this.threshold=0,this.store=t}i.Gl=v;var E=(w.prototype.xl=function(t){this.Bl=t,this.Vl.xl(this.Bl),this.ql.xl(this.Bl)},w.prototype.onStateChange=function(t){this.Ql.onStateChange(t)},w.prototype.Yl=function(){this.Wl.Kl()},w.prototype.Fl=function(t){this.filter.Fl(Number(t)||0)},w.prototype.$l=function(t){this.filter=t,this.Wl.$l(t),this.Ql.$l(t)},w);function w(t,i,n,r){this.ticket=t,this.kl=i,this.Bl=n,this.identity=r,this.Vl=o.Framework.resolve(o.Framework.v.Xl),this.Ql=o.Framework.resolve(o.Framework.v.zl),this.ql=o.Framework.resolve(o.Framework.v.Jl),this.Wl=new u.Zl(this.ql),this.tv=o.Framework.resolve(o.Framework.v.nv),this.$l(new v(this.Vl))}i.rv=E;var p,g=(s(b,p=c),b.prototype.initSession=function(t,i,n,r,s){var e=this,h=a.defer(),o=this.Ml.sv(),u=this.hv.ev(i);return u.pluginId=t,null!=r&&(u.testId=r),null!=u?o.then(function(t){return e.ov(t,u,h,n)}).fail(h.reject):h.reject("Ticket URL not valid"),h.promise},b.prototype.ov=function(s,t,e,i){var h=this;this.p2pId=s.uv(),this.reportingId=s.av();var n=this.kl.init(this.p2pId,t),r=this.hv.resolve(n.fv,t,i);n.promise.then(function(t){r.then(function(t){var i=t.sessionId;if(h.Cl.has(i))n=h.Cl.get(i),h.logger.warn("SESSION ALREADY EXISTING "+n.Vl.ticket);else{var n,r=f["default"].cv();(n=new E(t,h.kl,r,s)).Vl.init(h.reportingId,t,r,i),n.ql.init(h.reportingId,r),n.ql.lv(t),h.Cl.set(i,n),h.logger.debug("SESSION SET ",i),e.resolve(n)}}).fail(function(t){return e.reject(t||"Error resolving the ticket")}),t.onerror(function(t){e.reject("Error establishing connection to Hive Services")})}).fail(function(t){return e.reject(t)}),this.kl.connect()},b);function b(){var t=p.call(this)||this;return t.hv=o.Framework.resolve(o.Framework.v.vv),t}i.dv=g;var y,T=(s(O,y=c),O.prototype.initSession=function(t,i,n,r,s){var e=this,h=this.Ml.sv();return i.pluginId=t,null!=r&&(i.testId=r),h.then(function(t){return e.ov(t,i,null,!1,s)}).fail(a.reject)},O.prototype.ov=function(s,e,t,i,n){var h=this;this.p2pId=s.uv(),this.reportingId=s.av();var r=this.kl.init(this.p2pId,e,n);return this.kl.connect(),r.then(function(t){var i,n=e.sessionId;if(h.Cl.has(n))i=h.Cl.get(n),h.logger.warn("SESSION ALREADY EXISTING "+i.Vl.ticket);else{var r=f["default"].cv();(i=new E(e,h.kl,r,s)).Vl.init(h.reportingId,e,r,n),i.ql.init(h.reportingId,r),i.ql.lv(e),h.Cl.set(n,i),h.logger.debug("SESSION SET ",n)}return i}).fail(function(t){return a.reject(t)})},O);function O(){return null!==y&&y.apply(this,arguments)||this}i.Ev=T},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){this.monitorPort=e.Rc.wv?h.gv.pv:h.gv.bv,this.playerPort=e.Rc.wv?h.gv.yv:h.gv.Tv,this.feedbackPeriod=2e3,this.idleTimePeriod=6e4,this.useSessionCheck=e.Rc.Ov,this.debugLevel="notice",this.isSDNDebug=!1,this.hiveTechOrder=[],this.telemetryId=null,this.silent=!1,this.loggerTimestamp=s.HiveConfig.Framework.LoggerTimestamp,this.testId=null,this.pluginTimeout=o.Y.Xa,this.reportingThreshold=o.Y.wf,this.readyCheckTimeout=0,this.macReadyCheckTimeout=-1,this.onSourceSetCompleted=function(t){},this.onLoadingCompleted=function(t){},this.detectPrivateIP=o.Y.cf,this.authTokenEnabled=!0,this.dashRemoveBitrateSize=!1,this.dashFilterBitrates=null,this.staticPartnerId=null,this.staticCustomerId=null,this.audioMetrics=!0,this.logJsonSnapshots=void 0,this.onActiveSession=function(t){},this.onError=function(t){},this.onSessionStateChange=function(t){}}var s=n(43),e=n(44),h=n(45),o=n(8);i.Options=r;function u(){this.initTimeout=3e4,this.contextMatcher=void 0,this.onError=function(t){return!0},this.onActiveSession=function(t){}}i.HiveTechOptions=u;function a(){this.hivePlayerPort="playerPort",this.hiveMonitorPort="monitorPort",this.hiveSilent="silent",this.hiveDebugLevel="debugLevel",this.isSDNDebug="isSDNDebug",this.hiveDebugTimestamp="loggerTimestamp",this.hiveSetupTimeout="setupTimeout",this.hiveJavaTimeout="initTimeout",this.hiveWarnJavaTimeout="warnSlowRespTimeout",this.hiveTestId="testId",this.hiveDetectPrivateIP="detectPrivateIP",this.hiveAuthTokenEnabled="authTokenEnabled",this.hiveDashRemoveBitrateSize="dashRemoveBitrateSize",this.hiveDashFilterBitrates="dashFilterBitrates",this.hiveLogJsonSnapshots="logJsonSnapshots",this.hiveStaticPartnerId="staticPartnerId",this.hiveStaticCustomerId="staticCustomerId",this.hiveAudioMetrics="audioMetrics"}i.UrlConfigurableOptions=a;var f=(c.enabledRUM=!1,c.enableKeyCombination=!0,c.enabledErrorFilter=!0,c);function c(){}i.ErrorMonitorOptions=f;var l=(v.mv=function(t){"dashRemoveBitrateSize"in t&&t.dashRemoveBitrateSize&&window.HiveConfig&&window.HiveConfig.Dash&&(window.HiveConfig.Dash.DashRemoveBitrateSize=t.dashRemoveBitrateSize),"dashFilterBitrates"in t&&t.dashFilterBitrates&&window.HiveConfig&&window.HiveConfig.Dash&&(window.HiveConfig.Dash.DashFilterBitrates=t.dashFilterBitrates),"staticCustomerId"in t&&t.staticCustomerId&&window.HiveConfig&&window.HiveConfig.ClientInfo&&(window.HiveConfig.ClientInfo.sc=t.staticCustomerId),"staticPartnerId"in t&&t.staticPartnerId&&window.HiveConfig&&window.HiveConfig.ClientInfo&&(window.HiveConfig.ClientInfo.rc=t.staticPartnerId),"audioMetrics"in t&&!t.audioMetrics&&window.HiveConfig&&window.HiveConfig.Stats&&(window.HiveConfig.Stats.AudioAccounting=t.audioMetrics),"detectPrivateIP"in t&&"boolean"==typeof t.detectPrivateIP&&window.HiveConfig&&window.HiveConfig.ConnInfo&&(window.HiveConfig.ConnInfo.detectPrivateIP=t.detectPrivateIP),"logJsonSnapshots"in t&&t.logJsonSnapshots&&window.HiveConfig&&window.HiveConfig.DebugLogs&&(window.HiveConfig.DebugLogs.MetricSnapshotLogs=1,window.HiveConfig.DebugLogs.TrackSnapshotLogs=1,window.HiveConfig.DebugLogs.TrackerLogs=1)},v);function v(){}i._v=l,"undefined"!=typeof window&&(void 0===window.HiveConfig&&(window.HiveConfig={}),window.HiveConfig.ErrorMonitor=f)},function(n,r,s){var e,h,o;!function(t,i){"use strict";n.exports?n.exports=i(s(18),s(18),s(18)):(h=[s(18),s(18),s(18)],void 0===(o="function"==typeof (e=i)?e.apply(r,h):e)||(n.exports=o))}(0,function(o,i,a,n){"use strict";var r=n&&n.Rv;function p(t,i){var n=1<=arguments.length;if(!(this instanceof p))return n?2<=arguments.length?new p(t,i):new p(t):new p();if(void 0===t){if(n)throw new TypeError("undefined is not a valid argument for URI");t="undefined"!=typeof location?location.href+"":""}if(null===t&&n)throw new TypeError("null is not a valid argument for URI");return this.href(t),void 0!==i?this.Pa(i):this}p.version="1.19.2";var t=p.prototype,f=Object.prototype.hasOwnProperty;function u(t){return t.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function h(t){return void 0===t?"Undefined":String(Object.prototype.toString.call(t)).slice(8,-1)}function c(t){return"Array"===h(t)}function l(t,i){var n,r,s={};if("RegExp"===h(i))s=null;else if(c(i))for(n=0,r=i.length;n<r;n++)s[i[n]]=!0;else s[i]=!0;for(n=0,r=t.length;n<r;n++)(s&&void 0!==s[t[n]]||!s&&i.test(t[n]))&&(t.splice(n,1),r--,n--);return t}function v(t,i){var n,r;if(c(i)){for(n=0,r=i.length;n<r;n++)if(!v(t,i[n]))return!1;return!0}var s=h(i);for(n=0,r=t.length;n<r;n++)if("RegExp"===s){if("string"==typeof t[n]&&t[n].match(i))return!0}else if(t[n]===i)return!0;return!1}function d(t,i){if(!c(t)||!c(i))return!1;if(t.length!==i.length)return!1;t.sort(),i.sort();for(var n=0,r=t.length;n<r;n++)if(t[n]!==i[n])return!1;return!0}function E(t){return t.replace(/^\/+|\/+$/g,"")}function s(t){return escape(t)}function e(t){return encodeURIComponent(t).replace(/[!'()*]/g,s).replace(/\*/g,"%2A")}p.Sv=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,Av:null,Iv:p.Iv,Nv:p.Nv,Cv:p.Cv}},p.Iv=!1,p.Nv=!1,p.Cv=!0,p.kv=/^[a-z][a-z0-9.+-]*$/i,p.Dv=/[^a-z0-9\._-]/i,p.jv=/(xn--)/i,p.Mv=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,p.Pv=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,p.Lv=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi,p.Hv={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?«»“”„‘’]+$/,Uv:/(\([^\)]*\)|\[[^\]]*\]|\{[^}]*\}|<[^>]*>)/g},p.Fv={http:"80",Gv:"443",xv:"21",Bv:"70",Vv:"80",qv:"443"},p.Qv=["http","https"],p.Yv=/[^a-zA-Z0-9\.\-:_]/,p.Kv={a:"href",Wv:"cite",link:"href",$v:"href",Xv:"src",form:"action",zv:"src",Jv:"href",Zv:"src",td:"src",source:"src",track:"src",input:"src",nd:"src",video:"src"},p.rd=function(t){if(t&&t.nodeName){var i=t.nodeName.toLowerCase();if("input"!==i||"image"===t.type)return p.Kv[i]}},p.encode=e,p.decode=decodeURIComponent,p.sd=function(){p.encode=escape,p.decode=unescape},p.unicode=function(){p.encode=e,p.decode=decodeURIComponent},p.hd={pathname:{encode:{od:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{od:/[\/\?#]/g,map:{ud:"%2F",ad:"%3F",fd:"%23"}}},ld:{encode:{od:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":",vd:"/",dd:"?",Ed:"#",wd:"[",pd:"]","%40":"@",gd:"!","%24":"$","%26":"&",bd:"'",yd:"(",Td:")",Od:"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}},md:{encode:{od:/%(21|24|27|28|29|2A|2B|2C|3B|3D|40)/gi,map:{gd:"!","%24":"$",bd:"'",yd:"(",Td:")",Od:"*","%2B":"+","%2C":",","%3B":";","%3D":"=","%40":"@"}},decode:{od:/[\/\?#:]/g,map:{ud:"%2F",ad:"%3F",fd:"%23",Rd:"%3A"}}}},p.Sd=function(t,i){var n=p.encode(t+"");return void 0===i&&(i=p.Cv),i?n.replace(/%20/g,"+"):n},p.Ad=function(i,t){i+="",void 0===t&&(t=p.Cv);try{return p.decode(t?i.replace(/\+/g,"%20"):i)}catch(t){return i}};function w(n,r){return function(i){try{return p[r](i+"").replace(p.hd[n][r].od,function(t){return p.hd[n][r].map[t]})}catch(t){return i}}}var g,b={encode:"encode",decode:"decode"};for(g in b)p[g+"PathSegment"]=w("pathname",b[g]),p[g+"UrnPathSegment"]=w("urnpath",b[g]);function y(e,h,o){return function(t){var i;i=o?function(t){return p[h](p[o](t))}:p[h];for(var n=(t+"").split(e),r=0,s=n.length;r<s;r++)n[r]=i(n[r]);return n.join(e)}}function T(n){return function(t,i){return void 0===t?this.Sv[n]||"":(this.Sv[n]=t||null,this._l(!i),this)}}function O(n,r){return function(t,i){return void 0===t?this.Sv[n]||"":(null!==t&&(t+="").charAt(0)===r&&(t=t.substring(1)),this.Sv[n]=t,this._l(!i),this)}}p.Id=y("/","decodePathSegment"),p.Nd=y(":","decodeUrnPathSegment"),p.Cd=y("/","encodePathSegment","decode"),p.kd=y(":","encodeUrnPathSegment","decode"),p.Dd=w("reserved","encode"),p.parse=function(t,i){var n;return i=i||{Iv:p.Iv},-1<(n=t.indexOf("#"))&&(i.Av=t.substring(n+1)||null,t=t.substring(0,n)),-1<(n=t.indexOf("?"))&&(i.query=t.substring(n+1)||null,t=t.substring(0,n)),"//"===t.substring(0,2)?(i.protocol=null,t=t.substring(2),t=p.jd(t,i)):-1<(n=t.indexOf(":"))&&(i.protocol=t.substring(0,n)||null,i.protocol&&!i.protocol.match(p.kv)?i.protocol=void 0:"//"===t.substring(n+1,n+3)?(t=t.substring(n+3),t=p.jd(t,i)):(t=t.substring(n+1),i.urn=!0)),i.path=t,i},p.Md=function(t,i){var n,r,s=(t=(t=t||"").replace(/\\/g,"/")).indexOf("/");if(-1===s&&(s=t.length),"["===t.charAt(0))n=t.indexOf("]"),i.hostname=t.substring(1,n)||null,i.port=t.substring(n+2,s)||null,"/"===i.port&&(i.port=null);else{var e=t.indexOf(":"),h=t.indexOf("/"),o=t.indexOf(":",e+1);-1!==o&&(-1===h||o<h)?(i.hostname=t.substring(0,s)||null,i.port=null):(r=t.substring(0,s).split(":"),i.hostname=r[0]||null,i.port=r[1]||null)}return i.hostname&&"/"!==t.substring(s).charAt(0)&&(s++,t="/"+t),i.Iv&&p.Pd(i.hostname,i.protocol),i.port&&p.Ld(i.port),t.substring(s)||"/"},p.jd=function(t,i){return t=p.Hd(t,i),p.Md(t,i)},p.Hd=function(t,i){var n,r=t.indexOf("/"),s=t.lastIndexOf("@",-1<r?r:t.length-1);return-1<s&&(-1===r||s<r)?(n=t.substring(0,s).split(":"),i.username=n[0]?p.decode(n[0]):null,n.shift(),i.password=n[0]?p.decode(n.join(":")):null,t=t.substring(s+1)):(i.username=null,i.password=null),t},p.Ud=function(t,i){if(!t)return{};if(!(t=t.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,"")))return{};for(var n,r,s,e={},h=t.split("&"),o=h.length,u=0;u<o;u++)n=h[u].split("="),r=p.Ad(n.shift(),i),s=n.length?p.Ad(n.join("="),i):null,f.call(e,r)?("string"!=typeof e[r]&&null!==e[r]||(e[r]=[e[r]]),e[r].push(s)):e[r]=s;return e},p._l=function(t){var i="",n=!1;return t.protocol&&(i+=t.protocol+":"),t.urn||!i&&!t.hostname||(i+="//",n=!0),i+=p.Fd(t)||"","string"==typeof t.path&&("/"!==t.path.charAt(0)&&n&&(i+="/"),i+=t.path),"string"==typeof t.query&&t.query&&(i+="?"+t.query),"string"==typeof t.Av&&t.Av&&(i+="#"+t.Av),i},p.Gd=function(t){var i="";return t.hostname?(p.Pv.test(t.hostname)?i+="["+t.hostname+"]":i+=t.hostname,t.port&&(i+=":"+t.port),i):""},p.Fd=function(t){return p.xd(t)+p.Gd(t)},p.xd=function(t){var i="";return t.username&&(i+=p.encode(t.username)),t.password&&(i+=":"+p.encode(t.password)),i&&(i+="@"),i},p.Bd=function(t,i,n){var r,s,e,h,o="";for(s in t)if(f.call(t,s))if(c(t[s]))for(r={},e=0,h=t[s].length;e<h;e++)void 0!==t[s][e]&&void 0===r[t[s][e]+""]&&(o+="&"+p.Vd(s,t[s][e],n),!0!==i&&(r[t[s][e]+""]=!0));else void 0!==t[s]&&(o+="&"+p.Vd(s,t[s],n));return o.substring(1)},p.Vd=function(t,i,n){return p.Sd(t,n)+(null!==i?"="+p.Sd(i,n):"")},p.qd=function(t,i,n){if("object"==typeof i)for(var r in i)f.call(i,r)&&p.qd(t,r,i[r]);else{if("string"!=typeof i)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===t[i])return void (t[i]=n);"string"==typeof t[i]&&(t[i]=[t[i]]),c(n)||(n=[n]),t[i]=(t[i]||[]).concat(n)}},p.Qd=function(t,i,n){if("object"==typeof i)for(var r in i)f.call(i,r)&&p.Qd(t,r,i[r]);else{if("string"!=typeof i)throw new TypeError("URI.setQuery() accepts an object, string as the name parameter");t[i]=void 0===n?null:n}},p.Yd=function(t,i,n){var r,s,e;if(c(i))for(r=0,s=i.length;r<s;r++)t[i[r]]=void 0;else if("RegExp"===h(i))for(e in t)i.test(e)&&(t[e]=void 0);else if("object"==typeof i)for(e in i)f.call(i,e)&&p.Yd(t,e,i[e]);else{if("string"!=typeof i)throw new TypeError("URI.removeQuery() accepts an object, string, RegExp as the first parameter");void 0!==n?"RegExp"===h(n)?!c(t[i])&&n.test(t[i])?t[i]=void 0:t[i]=l(t[i],n):t[i]!==String(n)||c(n)&&1!==n.length?c(t[i])&&(t[i]=l(t[i],n)):t[i]=void 0:t[i]=void 0}},p.Kd=function(t,i,n,r){switch(h(i)){case"String":break;case"RegExp":for(var s in t)if(f.call(t,s)&&i.test(s)&&(void 0===n||p.Kd(t,s,n)))return!0;return!1;case"Object":for(var e in i)if(f.call(i,e)&&!p.Kd(t,e,i[e]))return!1;return!0;default:throw new TypeError("URI.hasQuery() accepts a string, regular expression or object as the name parameter")}switch(h(n)){case"Undefined":return i in t;case"Boolean":return n===Boolean(c(t[i])?t[i].length:t[i]);case"Function":return!!n(t[i],i,t);case"Array":return!!c(t[i])&&(r?v:d)(t[i],n);case"RegExp":return c(t[i])?!!r&&v(t[i],n):Boolean(t[i]&&t[i].match(n));case"Number":n=String(n);case"String":return c(t[i])?!!r&&v(t[i],n):t[i]===n;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},p.Wd=function(){for(var t=[],i=[],n=0,r=0;r<arguments.length;r++){var s=new p(arguments[r]);t.push(s);for(var e=s.$d(),h=0;h<e.length;h++)"string"==typeof e[h]&&i.push(e[h]),e[h]&&n++}if(!i.length||!n)return new p("");var o=new p("").$d(i);return""!==t[0].path()&&"/"!==t[0].path().slice(0,1)||o.path("/"+o.path()),o.normalize()},p.Xd=function(t,i){var n,r=Math.min(t.length,i.length);for(n=0;n<r;n++)if(t.charAt(n)!==i.charAt(n)){n--;break}return n<1?t.charAt(0)===i.charAt(0)&&"/"===t.charAt(0)?"/":"":("/"===t.charAt(n)&&"/"===i.charAt(n)||(n=t.substring(0,n).lastIndexOf("/")),t.substring(0,n+1))},p.zd=function(t,i,n){var r=(n=n||{}).start||p.Hv.start,s=n.end||p.Hv.end,e=n.trim||p.Hv.trim,h=n.Uv||p.Hv.Uv,o=/[a-z0-9-]=["']?$/i;for(r.lastIndex=0;;){var u=r.exec(t);if(!u)break;var a=u.index;if(n.Jd){var f=t.slice(Math.max(a-3,0),a);if(f&&o.test(f))continue}for(var c=a+t.slice(a).search(s),l=t.slice(a,c),v=-1;;){var d=h.exec(l);if(!d)break;var E=d.index+d[0].length;v=Math.max(v,E)}if(!((l=-1<v?l.slice(0,v)+l.slice(v).replace(e,""):l.replace(e,"")).length<=u[0].length||n.Zd&&n.Zd.test(l))){var w=i(l,a,c=a+l.length,t);void 0!==w?(w=String(w),t=t.slice(0,a)+w+t.slice(c),r.lastIndex=a+w.length):r.lastIndex=c}}return r.lastIndex=0,t},p.Pd=function(t,i){var n=!!t,r=!1;if(!!i&&(r=v(p.Qv,i)),r&&!n)throw new TypeError("Hostname cannot be empty, if protocol is "+i);if(t&&t.match(p.Yv)){if(!o)throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_] and Punycode.js is not available');if(o.tE(t).match(p.Yv))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-:_]')}},p.Ld=function(t){if(t){var i=Number(t);if(!(function(t){return/^[0-9]+$/.test(t)}(i)&&0<i&&i<65536))throw new TypeError('Port "'+t+'" is not a valid port')}},p.Ph=function(t){if(t){var i={Rv:this.Ph()};return n.iE&&"function"==typeof n.iE.Ph&&(i.iE=n.iE.Ph()),n.nE&&"function"==typeof n.nE.Ph&&(i.nE=n.nE.Ph()),n.rE&&"function"==typeof n.rE.Ph&&(i.rE=n.rE.Ph()),i}return n.Rv===this&&(n.Rv=r),this},t._l=function(t){return!0===t?this.sE=!0:void 0!==t&&!this.sE||(this.eE=p._l(this.Sv),this.sE=!1),this},t.clone=function(){return new p(this)},t.valueOf=t.toString=function(){return this._l(!1).eE},t.protocol=T("protocol"),t.username=T("username"),t.password=T("password"),t.hostname=T("hostname"),t.port=T("port"),t.query=O("query","?"),t.Av=O("fragment","#"),t.search=function(t,i){var n=this.query(t,i);return"string"==typeof n&&n.length?"?"+n:n},t.hash=function(t,i){var n=this.Av(t,i);return"string"==typeof n&&n.length?"#"+n:n},t.pathname=function(t,i){if(void 0!==t&&!0!==t)return this.Sv.urn?this.Sv.path=t?p.kd(t):"":this.Sv.path=t?p.Cd(t):"/",this._l(!i),this;var n=this.Sv.path||(this.Sv.hostname?"/":"");return t?(this.Sv.urn?p.Nd:p.Id)(n):n},t.path=t.pathname,t.href=function(t,i){var n;if(void 0===t)return this.toString();this.eE="",this.Sv=p.Sv();var r=t instanceof p,s="object"==typeof t&&(t.hostname||t.path||t.pathname);t.nodeName&&(t=t[p.rd(t)]||"",s=!1);if(!r&&s&&void 0!==t.pathname&&(t=t.toString()),"string"==typeof t||t instanceof String)this.Sv=p.parse(String(t),this.Sv);else{if(!r&&!s)throw new TypeError("invalid input");var e=r?t.Sv:t;for(n in e)"query"!==n&&f.call(this.Sv,n)&&(this.Sv[n]=e[n]);e.query&&this.query(e.query,!1)}return this._l(!i),this},t.is=function(t){var i=!1,n=!1,r=!1,s=!1,e=!1,h=!1,o=!1,u=!this.Sv.urn;switch(this.Sv.hostname&&(u=!1,n=p.Mv.test(this.Sv.hostname),r=p.Pv.test(this.Sv.hostname),e=(s=!(i=n||r))&&a&&a.has(this.Sv.hostname),h=s&&p.Dv.test(this.Sv.hostname),o=s&&p.jv.test(this.Sv.hostname)),t.toLowerCase()){case"relative":return u;case"absolute":return!u;case"domain":case"name":return s;case"sld":return e;case"ip":return i;case"ip4":case"ipv4":case"inet4":return n;case"ip6":case"ipv6":case"inet6":return r;case"idn":return h;case"url":return!this.Sv.urn;case"urn":return!!this.Sv.urn;case"punycode":return o}return null};var m=t.protocol,_=t.port,R=t.hostname;t.protocol=function(t,i){if(t&&!(t=t.replace(/:(\/\/)?$/,"")).match(p.kv))throw new TypeError('Protocol "'+t+"\" contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return m.call(this,t,i)},t.scheme=t.protocol,t.port=function(t,i){return this.Sv.urn?void 0===t?"":this:(void 0!==t&&(0===t&&(t=null),t&&(":"===(t+="").charAt(0)&&(t=t.substring(1)),p.Ld(t))),_.call(this,t,i))},t.hostname=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if(void 0!==t){var n={Iv:this.Sv.Iv};if("/"!==p.Md(t,n))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');t=n.hostname,this.Sv.Iv&&p.Pd(t,this.Sv.protocol)}return R.call(this,t,i)},t.origin=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if(void 0===t){var n=this.protocol();return this.hE()?(n?n+"://":"")+this.hE():""}var r=p(t);return this.protocol(r.protocol()).hE(r.hE())._l(!i),this},t.host=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if(void 0===t)return this.Sv.hostname?p.Gd(this.Sv):"";if("/"!==p.Md(t,this.Sv))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');return this._l(!i),this},t.hE=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if(void 0===t)return this.Sv.hostname?p.Fd(this.Sv):"";if("/"!==p.jd(t,this.Sv))throw new TypeError('Hostname "'+t+'" contains characters other than [A-Z0-9.-]');return this._l(!i),this},t.oE=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if(void 0!==t)return"@"!==t[t.length-1]&&(t+="@"),p.Hd(t,this.Sv),this._l(!i),this;var n=p.xd(this.Sv);return n?n.substring(0,n.length-1):n},t.uE=function(t,i){var n;return void 0===t?this.path()+this.search()+this.hash():(n=p.parse(t),this.Sv.path=n.path,this.Sv.query=n.query,this.Sv.Av=n.Av,this._l(!i),this)},t.aE=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if(void 0===t){if(!this.Sv.hostname||this.is("IP"))return"";var n=this.Sv.hostname.length-this.domain().length-1;return this.Sv.hostname.substring(0,n)||""}var r=this.Sv.hostname.length-this.domain().length,s=this.Sv.hostname.substring(0,r),e=new RegExp("^"+u(s));if(t&&"."!==t.charAt(t.length-1)&&(t+="."),-1!==t.indexOf(":"))throw new TypeError("Domains cannot contain colons");return t&&p.Pd(t,this.Sv.protocol),this.Sv.hostname=this.Sv.hostname.replace(e,t),this._l(!i),this},t.domain=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if("boolean"==typeof t&&(i=t,t=void 0),void 0===t){if(!this.Sv.hostname||this.is("IP"))return"";var n=this.Sv.hostname.match(/\./g);if(n&&n.length<2)return this.Sv.hostname;var r=this.Sv.hostname.length-this.fE(i).length-1;return r=this.Sv.hostname.lastIndexOf(".",r-1)+1,this.Sv.hostname.substring(r)||""}if(!t)throw new TypeError("cannot set domain empty");if(-1!==t.indexOf(":"))throw new TypeError("Domains cannot contain colons");if(p.Pd(t,this.Sv.protocol),!this.Sv.hostname||this.is("IP"))this.Sv.hostname=t;else{var s=new RegExp(u(this.domain())+"$");this.Sv.hostname=this.Sv.hostname.replace(s,t)}return this._l(!i),this},t.fE=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if("boolean"==typeof t&&(i=t,t=void 0),void 0===t){if(!this.Sv.hostname||this.is("IP"))return"";var n=this.Sv.hostname.lastIndexOf("."),r=this.Sv.hostname.substring(n+1);return!0!==i&&a&&a.list[r.toLowerCase()]&&a.get(this.Sv.hostname)||r}var s;if(!t)throw new TypeError("cannot set TLD empty");if(t.match(/[^a-zA-Z0-9-]/)){if(!a||!a.is(t))throw new TypeError('TLD "'+t+'" contains characters other than [A-Z0-9]');s=new RegExp(u(this.fE())+"$"),this.Sv.hostname=this.Sv.hostname.replace(s,t)}else{if(!this.Sv.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");s=new RegExp(u(this.fE())+"$"),this.Sv.hostname=this.Sv.hostname.replace(s,t)}return this._l(!i),this},t.cE=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if(void 0===t||!0===t){if(!this.Sv.path&&!this.Sv.hostname)return"";if("/"===this.Sv.path)return"/";var n=this.Sv.path.length-this.filename().length-1,r=this.Sv.path.substring(0,n)||(this.Sv.hostname?"/":"");return t?p.Id(r):r}var s=this.Sv.path.length-this.filename().length,e=this.Sv.path.substring(0,s),h=new RegExp("^"+u(e));return this.is("relative")||"/"!==(t=t||"/").charAt(0)&&(t="/"+t),t&&"/"!==t.charAt(t.length-1)&&(t+="/"),t=p.Cd(t),this.Sv.path=this.Sv.path.replace(h,t),this._l(!i),this},t.filename=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if("string"!=typeof t){if(!this.Sv.path||"/"===this.Sv.path)return"";var n=this.Sv.path.lastIndexOf("/"),r=this.Sv.path.substring(n+1);return t?p.lE(r):r}var s=!1;"/"===t.charAt(0)&&(t=t.substring(1)),t.match(/\.?\//)&&(s=!0);var e=new RegExp(u(this.filename())+"$");return t=p.Cd(t),this.Sv.path=this.Sv.path.replace(e,t),s?this.vE(i):this._l(!i),this},t.suffix=function(t,i){if(this.Sv.urn)return void 0===t?"":this;if(void 0===t||!0===t){if(!this.Sv.path||"/"===this.Sv.path)return"";var n,r,s=this.filename(),e=s.lastIndexOf(".");return-1===e?"":(n=s.substring(e+1),r=/^[a-z0-9%]+$/i.test(n)?n:"",t?p.lE(r):r)}"."===t.charAt(0)&&(t=t.substring(1));var h,o=this.suffix();if(o)h=t?new RegExp(u(o)+"$"):new RegExp(u("."+o)+"$");else{if(!t)return this;this.Sv.path+="."+p.Cd(t)}return h&&(t=p.Cd(t),this.Sv.path=this.Sv.path.replace(h,t)),this._l(!i),this},t.$d=function(t,i,n){var r=this.Sv.urn?":":"/",s=this.path(),e="/"===s.substring(0,1),h=s.split(r);if(void 0!==t&&"number"!=typeof t&&(n=i,i=t,t=void 0),void 0!==t&&"number"!=typeof t)throw new Error('Bad segment "'+t+'", must be 0-based integer');if(e&&h.shift(),t<0&&(t=Math.max(h.length+t,0)),void 0===i)return void 0===t?h:h[t];if(null===t||void 0===h[t])if(c(i)){h=[];for(var o=0,u=i.length;o<u;o++)(i[o].length||h.length&&h[h.length-1].length)&&(h.length&&!h[h.length-1].length&&h.pop(),h.push(E(i[o])))}else!i&&"string"!=typeof i||(i=E(i),""===h[h.length-1]?h[h.length-1]=i:h.push(i));else i?h[t]=E(i):h.splice(t,1);return e&&h.unshift(""),this.path(h.join(r),n)},t.dE=function(t,i,n){var r,s,e;if("number"!=typeof t&&(n=i,i=t,t=void 0),void 0===i){if(c(r=this.$d(t,i,n)))for(s=0,e=r.length;s<e;s++)r[s]=p.decode(r[s]);else r=void 0!==r?p.decode(r):void 0;return r}if(c(i))for(s=0,e=i.length;s<e;s++)i[s]=p.encode(i[s]);else i="string"==typeof i||i instanceof String?p.encode(i):i;return this.$d(t,i,n)};var S=t.query;return t.query=function(t,i){if(!0===t)return p.Ud(this.Sv.query,this.Sv.Cv);if("function"!=typeof t)return void 0!==t&&"string"!=typeof t?(this.Sv.query=p.Bd(t,this.Sv.Nv,this.Sv.Cv),this._l(!i),this):S.call(this,t,i);var n=p.Ud(this.Sv.query,this.Sv.Cv),r=t.call(this,n);return this.Sv.query=p.Bd(r||n,this.Sv.Nv,this.Sv.Cv),this._l(!i),this},t.Qd=function(t,i,n){var r=p.Ud(this.Sv.query,this.Sv.Cv);if("string"==typeof t||t instanceof String)r[t]=void 0!==i?i:null;else{if("object"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");for(var s in t)f.call(t,s)&&(r[s]=t[s])}return this.Sv.query=p.Bd(r,this.Sv.Nv,this.Sv.Cv),"string"!=typeof t&&(n=i),this._l(!n),this},t.qd=function(t,i,n){var r=p.Ud(this.Sv.query,this.Sv.Cv);return p.qd(r,t,void 0===i?null:i),this.Sv.query=p.Bd(r,this.Sv.Nv,this.Sv.Cv),"string"!=typeof t&&(n=i),this._l(!n),this},t.Yd=function(t,i,n){var r=p.Ud(this.Sv.query,this.Sv.Cv);return p.Yd(r,t,i),this.Sv.query=p.Bd(r,this.Sv.Nv,this.Sv.Cv),"string"!=typeof t&&(n=i),this._l(!n),this},t.Kd=function(t,i,n){var r=p.Ud(this.Sv.query,this.Sv.Cv);return p.Kd(r,t,i,n)},t.EE=t.Qd,t.wE=t.qd,t.pE=t.Yd,t.gE=t.Kd,t.normalize=function(){return this.Sv.urn?this.TE(!1).vE(!1).yE(!1).bE(!1)._l():this.TE(!1).mE(!1).OE(!1).vE(!1).yE(!1).bE(!1)._l()},t.TE=function(t){return"string"==typeof this.Sv.protocol&&(this.Sv.protocol=this.Sv.protocol.toLowerCase(),this._l(!t)),this},t.mE=function(t){return this.Sv.hostname&&(this.is("IDN")&&o?this.Sv.hostname=o.tE(this.Sv.hostname):this.is("IPv6")&&i&&(this.Sv.hostname=i._E(this.Sv.hostname)),this.Sv.hostname=this.Sv.hostname.toLowerCase(),this._l(!t)),this},t.OE=function(t){return"string"==typeof this.Sv.protocol&&this.Sv.port===p.Fv[this.Sv.protocol]&&(this.Sv.port=null,this._l(!t)),this},t.vE=function(t){var i,n=this.Sv.path;if(!n)return this;if(this.Sv.urn)return this.Sv.path=p.kd(this.Sv.path),this._l(!t),this;if("/"===this.Sv.path)return this;var r,s,e="";for("/"!==(n=p.Cd(n)).charAt(0)&&(i=!0,n="/"+n),"/.."!==n.slice(-3)&&"/."!==n.slice(-2)||(n+="/"),n=n.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),i&&(e=(e=n.substring(1).match(/^(\.\.\/)+/)||"")&&e[0]);-1!==(r=n.search(/\/\.\.(\/|$)/));)n=0!==r?(-1===(s=n.substring(0,r).lastIndexOf("/"))&&(s=r),n.substring(0,s)+n.substring(r+3)):n.substring(3);return i&&this.is("relative")&&(n=e+n.substring(1)),this.Sv.path=n,this._l(!t),this},t.RE=t.vE,t.yE=function(t){return"string"==typeof this.Sv.query&&(this.Sv.query.length?this.query(p.Ud(this.Sv.query,this.Sv.Cv)):this.Sv.query=null,this._l(!t)),this},t.bE=function(t){return this.Sv.Av||(this.Sv.Av=null,this._l(!t)),this},t.SE=t.yE,t.AE=t.bE,t.sd=function(){var t=p.encode,i=p.decode;p.encode=escape,p.decode=decodeURIComponent;try{this.normalize()}finally{p.encode=t,p.decode=i}return this},t.unicode=function(){var t=p.encode,i=p.decode;p.encode=e,p.decode=unescape;try{this.normalize()}finally{p.encode=t,p.decode=i}return this},t.readable=function(){var t=this.clone();t.username("").password("").normalize();var i="";if(t.Sv.protocol&&(i+=t.Sv.protocol+"://"),t.Sv.hostname&&(t.is("punycode")&&o?(i+=o.IE(t.Sv.hostname),t.Sv.port&&(i+=":"+t.Sv.port)):i+=t.host()),t.Sv.hostname&&t.Sv.path&&"/"!==t.Sv.path.charAt(0)&&(i+="/"),i+=t.path(!0),t.Sv.query){for(var n="",r=0,s=t.Sv.query.split("&"),e=s.length;r<e;r++){var h=(s[r]||"").split("=");n+="&"+p.Ad(h[0],this.Sv.Cv).replace(/&/g,"%26"),void 0!==h[1]&&(n+="="+p.Ad(h[1],this.Sv.Cv).replace(/&/g,"%26"))}i+="?"+n.substring(1)}return i+=p.Ad(t.hash(),!0)},t.Pa=function(t){var i,n,r,s=this.clone(),e=["protocol","username","password","hostname","port"];if(this.Sv.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(t instanceof p||(t=new p(t)),s.Sv.protocol)return s;if(s.Sv.protocol=t.Sv.protocol,this.Sv.hostname)return s;for(n=0;r=e[n];n++)s.Sv[r]=t.Sv[r];return s.Sv.path?(".."===s.Sv.path.substring(-2)&&(s.Sv.path+="/"),"/"!==s.path().charAt(0)&&(i=(i=t.cE())||(0===t.path().indexOf("/")?"/":""),s.Sv.path=(i?i+"/":"")+s.Sv.path,s.vE())):(s.Sv.path=t.Sv.path,s.Sv.query||(s.Sv.query=t.Sv.query)),s._l(),s},t.NE=function(t){var i,n,r,s,e,h=this.clone().normalize();if(h.Sv.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(t=new p(t).normalize(),i=h.Sv,n=t.Sv,s=h.path(),e=t.path(),"/"!==s.charAt(0))throw new Error("URI is already relative");if("/"!==e.charAt(0))throw new Error("Cannot calculate a URI relative to another relative URI");if(i.protocol===n.protocol&&(i.protocol=null),i.username!==n.username||i.password!==n.password)return h._l();if(null!==i.protocol||null!==i.username||null!==i.password)return h._l();if(i.hostname!==n.hostname||i.port!==n.port)return h._l();if(i.hostname=null,i.port=null,s===e)return i.path="",h._l();if(!(r=p.Xd(s,e)))return h._l();var o=n.path.substring(r.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return i.path=o+i.path.substring(r.length)||"./",h._l()},t.equals=function(t){var i,n,r,s,e,h=this.clone(),o=new p(t),u={};if(h.normalize(),o.normalize(),h.toString()===o.toString())return!0;if(r=h.query(),s=o.query(),h.query(""),o.query(""),h.toString()!==o.toString())return!1;if(r.length!==s.length)return!1;for(e in i=p.Ud(r,this.Sv.Cv),n=p.Ud(s,this.Sv.Cv),i)if(f.call(i,e)){if(c(i[e])){if(!d(i[e],n[e]))return!1}else if(i[e]!==n[e])return!1;u[e]=!0}for(e in n)if(f.call(n,e)&&!u[e])return!1;return!0},t.Iv=function(t){return this.Sv.Iv=!!t,this},t.Nv=function(t){return this.Sv.Nv=!!t,this},t.Cv=function(t){return this.Sv.Cv=!!t,this},p})},function(module,exports,__webpack_require__){var Thrift={CE:"0.9.3",Type:{STOP:0,VOID:1,BOOL:2,BYTE:3,I08:3,DOUBLE:4,I16:6,I32:8,I64:10,STRING:11,UTF7:11,STRUCT:12,MAP:13,SET:14,LIST:15,UTF8:16,UTF16:17},ra:{CALL:1,REPLY:2,EXCEPTION:3,ONEWAY:4},kE:function(t){var i=0;for(var n in t)t.hasOwnProperty(n)&&i++;return i},DE:function(t,i,n){function r(){}r.prototype=i.prototype,t.prototype=new r(),t.prototype.name=n||""}},copyList,copyMap;Thrift.jE=function(t){this.message=t},Thrift.DE(Thrift.jE,Error,"TException"),Thrift.jE.prototype.ME=function(){return this.message},Thrift.PE={LE:0,HE:1,UE:2,FE:3,GE:4,xE:5,BE:6,VE:7,qE:8,QE:9,YE:10},Thrift.KE=function(t,i){this.message=t,this.code="number"==typeof i?i:0},Thrift.DE(Thrift.KE,Thrift.jE,"TApplicationException"),Thrift.KE.prototype.read=function(t){for(;;){var i=t.WE();if(i.ftype==Thrift.Type.STOP)break;switch(i.fid){case 1:i.ftype==Thrift.Type.STRING?(i=t.$E(),this.message=i.value):i=t.XE(i.ftype);break;case 2:i.ftype==Thrift.Type.I32?(i=t.zE(),this.code=i.value):i=t.XE(i.ftype);break;default:i=t.XE(i.ftype)}t.JE()}t.ZE()},Thrift.KE.prototype.write=function(t){t.tw("TApplicationException"),this.message&&(t.iw("message",Thrift.Type.STRING,1),t.nw(this.ME()),t.rw()),this.code&&(t.iw("type",Thrift.Type.I32,2),t.sw(this.code),t.rw()),t.ew(),t.hw()},Thrift.KE.prototype.ow=function(){return this.code},Thrift.ju=Thrift.ca=function(t,i){this.url=t,this.uw=0,this.aw=0,this.fw=i&&i.fw,this.cw="",this.lw=""},Thrift.ca.prototype={vw:function(){try{return new XMLHttpRequest()}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}throw"Your browser doesn't support XHR."},flush:function(t,i){var n=this;if(t&&!i||void 0===this.url||""===this.url)return this.cw;var r,s=this.vw();if(s.overrideMimeType&&s.overrideMimeType("application/vnd.apache.thrift.json; charset=utf-8"),i&&(s.onreadystatechange=(r=i,function(){4==this.readyState&&200==this.status&&(n.ua(this.responseText),r())})),s.open("POST",this.url,!!t),s.setRequestHeader&&(s.setRequestHeader("Accept","application/vnd.apache.thrift.json; charset=utf-8"),s.setRequestHeader("Content-Type","application/vnd.apache.thrift.json; charset=utf-8")),s.send(this.cw),!t||!i){if(4!=s.readyState)throw"encountered an unknown ajax ready state: "+s.readyState;if(200!=s.status)throw"encountered a unknown request status: "+s.status;this.lw=s.responseText,this.dw=this.lw.length,this.uw=this.lw.length,this.aw=0}},Ew:function(i,t,n,r){if("undefined"==typeof jQuery||void 0===jQuery.ww)throw"Thrift.js requires jQuery 1.5+ to use asynchronous requests";var s=this;return jQuery.pw({url:this.url,data:t,type:"POST",gw:!1,contentType:"application/vnd.apache.thrift.json; charset=utf-8",bw:"text thrift",yw:{Tw:function(t){return s.ua(t),r.call(i)}},context:i,success:jQuery.Ow(n).pop()})},ua:function(t){this.lw=t,this.dw=this.lw.length,this.uw=this.lw.length,this.aw=0},isOpen:function(){return!0},open:function(){},close:function(){},read:function(t){var i=this.uw-this.aw;if(0==i)return"";var n=t;i<t&&(n=i);var r=this._w.substr(this.aw,n);return this.aw+=n,r},Rw:function(){return this.lw},write:function(t){this.cw=t},ea:function(){return this.cw}},Thrift.Sw=function(t){this.Aw(t)},Thrift.Sw.prototype={Aw:function(t){this.url=t,this.Iw=null,this.callbacks=[],this.Nw=[],this.cw="",this.lw="",this.Cw=0,this.kw=0},flush:function(t,i){var n,r=this;this.isOpen()?(this.Iw.send(this.cw),this.callbacks.push((n=i,function(t){r.ua(t),n()}))):this.Nw.push({Dw:this.cw,jw:i})},Mw:function(){var n=this;0<this.Nw.length&&(this.Nw.forEach(function(t){var i;this.Iw.send(t.Dw),this.callbacks.push((i=t.jw,function(t){n.ua(t),i()}))}),this.Nw=[])},Pw:function(t){this.Aw(this.url)},Lw:function(t){this.callbacks.length&&this.callbacks.shift()(t.data)},Hw:function(t){!1,this.Iw.close()},ua:function(t){this.lw=t,this.dw=this.lw.length,this.uw=this.lw.length,this.aw=0},isOpen:function(){return this.Iw&&this.Iw.readyState==this.Iw.OPEN},open:function(){this.Iw&&this.Iw.readyState!=this.Iw.CLOSED||(this.Iw=new WebSocket(this.url),this.Iw.onopen=this.Mw.bind(this),this.Iw.onmessage=this.Lw.bind(this),this.Iw.onerror=this.Hw.bind(this),this.Iw.onclose=this.Pw.bind(this))},close:function(){this.Iw.close()},read:function(t){var i=this.uw-this.aw;if(0==i)return"";var n=t;i<t&&(n=i);var r=this._w.substr(this.aw,n);return this.aw+=n,r},Rw:function(){return this.lw},write:function(t){this.cw=t},ea:function(){return this.cw}},Thrift.la=Thrift.Uw=function(t){this.Fw=[],this.Gw=[],this.transport=t},Thrift.Uw.Type={},Thrift.Uw.Type[Thrift.Type.BOOL]='"tf"',Thrift.Uw.Type[Thrift.Type.BYTE]='"i8"',Thrift.Uw.Type[Thrift.Type.I16]='"i16"',Thrift.Uw.Type[Thrift.Type.I32]='"i32"',Thrift.Uw.Type[Thrift.Type.I64]='"i64"',Thrift.Uw.Type[Thrift.Type.DOUBLE]='"dbl"',Thrift.Uw.Type[Thrift.Type.STRUCT]='"rec"',Thrift.Uw.Type[Thrift.Type.STRING]='"str"',Thrift.Uw.Type[Thrift.Type.MAP]='"map"',Thrift.Uw.Type[Thrift.Type.LIST]='"lst"',Thrift.Uw.Type[Thrift.Type.SET]='"set"',Thrift.Uw.xw={},Thrift.Uw.xw.tf=Thrift.Type.BOOL,Thrift.Uw.xw.i8=Thrift.Type.BYTE,Thrift.Uw.xw.i16=Thrift.Type.I16,Thrift.Uw.xw.i32=Thrift.Type.I32,Thrift.Uw.xw.i64=Thrift.Type.I64,Thrift.Uw.xw.dbl=Thrift.Type.DOUBLE,Thrift.Uw.xw.rec=Thrift.Type.STRUCT,Thrift.Uw.xw.str=Thrift.Type.STRING,Thrift.Uw.xw.map=Thrift.Type.MAP,Thrift.Uw.xw.lst=Thrift.Type.LIST,Thrift.Uw.xw.set=Thrift.Type.SET,Thrift.Uw.CE=1,Thrift.Uw.prototype={Bw:function(){return this.transport},na:function(t,i,n){this.Fw=[],this.Gw=[],this.Fw.push([Thrift.Uw.CE,'"'+t+'"',i,n])},sa:function(){var t=this.Fw.pop();this.Vw=this.Fw.pop(),this.Vw.push(t),this.qw="["+this.Vw.join(",")+"]",this.transport.write(this.qw)},tw:function(t){this.Gw.push(this.Fw.length),this.Fw.push({})},hw:function(){var t=this.Gw.pop(),i=this.Fw[t],n="{",r=!0;for(var s in i)r?r=!1:n+=",",n+=s+":"+i[s];n+="}",this.Fw[t]=n},iw:function(t,i,n){this.Gw.push(this.Fw.length),this.Fw.push({Qw:'"'+n+'"',Yw:Thrift.Uw.Type[i]})},rw:function(){var t=this.Fw.pop(),i=this.Fw.pop();this.Fw[this.Fw.length-1][i.Qw]="{"+i.Yw+":"+t+"}",this.Gw.pop()},ew:function(){},Kw:function(t,i,n){this.Gw.push(this.Fw.length),this.Fw.push([Thrift.Uw.Type[t],Thrift.Uw.Type[i],0])},Ww:function(){var t=this.Gw.pop();if(t!=this.Fw.length){(this.Fw.length-t-1)%2!=0&&this.Fw.push("");var i=(this.Fw.length-t-1)/2;this.Fw[t][this.Fw[t].length-1]=i;for(var n="}",r=!0;this.Fw.length>t+1;){var s=this.Fw.pop(),e=this.Fw.pop();r?r=!1:n=","+n,isNaN(e)||(e='"'+e+'"'),n=e+":"+s+n}n="{"+n,this.Fw[t].push(n),this.Fw[t]="["+this.Fw[t].join(",")+"]"}},$w:function(t,i){this.Gw.push(this.Fw.length),this.Fw.push([Thrift.Uw.Type[t],i])},Xw:function(){for(var t=this.Gw.pop();this.Fw.length>t+1;){var i=this.Fw[t+1];this.Fw.splice(t+1,1),this.Fw[t].push(i)}this.Fw[t]="["+this.Fw[t].join(",")+"]"},zw:function(t,i){this.Gw.push(this.Fw.length),this.Fw.push([Thrift.Uw.Type[t],i])},Jw:function(){for(var t=this.Gw.pop();this.Fw.length>t+1;){var i=this.Fw[t+1];this.Fw.splice(t+1,1),this.Fw[t].push(i)}this.Fw[t]="["+this.Fw[t].join(",")+"]"},Zw:function(t){this.Fw.push(t?1:0)},tp:function(t){this.Fw.push(t)},np:function(t){this.Fw.push(t)},sw:function(t){this.Fw.push(t)},rp:function(t){this.Fw.push(t)},sp:function(t){this.Fw.push(t)},nw:function(t){if(null===t)this.Fw.push(null);else{for(var i="",n=0;n<t.length;n++){var r=t.charAt(n);i+='"'===r?'\\"':"\\"===r?"\\\\":"\b"===r?"\\b":"\f"===r?"\\f":"\n"===r?"\\n":"\r"===r?"\\r":"\t"===r?"\\t":r}this.Fw.push('"'+i+'"')}},ep:function(t){this.nw(t)},aa:function(){this.hp=[],this.aw=[],"undefined"!=typeof JSON&&"function"==typeof JSON.parse?this.op=JSON.parse(this.transport.Rw()):"undefined"!=typeof jQuery?this.op=jQuery.up(this.transport.Rw()):this.op=eval(this.transport.Rw());var r={},version=this.op.shift();if(version!=Thrift.Uw.CE)throw"Wrong thrift protocol version: "+version;return r.fname=this.op.shift(),r.ap=this.op.shift(),r.fp=this.op.shift(),this.hp.push(this.op.shift()),r},fa:function(){},cp:function(t){var i={fname:""};return this.hp[this.hp.length-1]instanceof Array&&this.hp.push(this.hp[this.hp.length-1].shift()),i},ZE:function(){this.hp[this.hp.length-2]instanceof Array&&this.hp.pop()},WE:function(){var t={},i=-1,n=Thrift.Type.STOP;for(var r in this.hp[this.hp.length-1])if(null!==r){i=parseInt(r,10),this.aw.push(this.hp.length);var s=this.hp[this.hp.length-1][i];delete this.hp[this.hp.length-1][i],this.hp.push(s);break}if(-1!=i)for(var e in this.hp[this.hp.length-1])null!==Thrift.Uw.xw[e]&&(n=Thrift.Uw.xw[e],this.hp[this.hp.length-1]=this.hp[this.hp.length-1][e]);return t.fname="",t.ftype=n,t.fid=i,t},JE:function(){for(var t=this.aw.pop();this.hp.length>t;)this.hp.pop()},lp:function(){var t=this.hp.pop(),i=t.shift();i instanceof Array&&(this.hp.push(t),i=(t=i).shift());var n={};return n.vp=Thrift.Uw.xw[i],n.dp=Thrift.Uw.xw[t.shift()],n.size=t.shift(),this.aw.push(this.hp.length),this.hp.push(t.shift()),n},Ep:function(){this.JE()},wp:function(){var t=this.hp[this.hp.length-1],i={};return i.pp=Thrift.Uw.xw[t.shift()],i.size=t.shift(),this.aw.push(this.hp.length),this.hp.push(t.shift()),i},gp:function(){this.JE()},bp:function(t,i){return this.wp(t,i)},yp:function(){return this.gp()},Tp:function(){var t=this.zE();return null!==t&&"1"==t.value?t.value=!0:t.value=!1,t},Op:function(){return this.zE()},mp:function(){return this.zE()},zE:function(t){void 0===t&&(t=this.hp[this.hp.length-1]);var i={};if(t instanceof Array)0===t.length?i.value=void 0:i.value=t.shift();else if(t instanceof Object){for(var n in t)if(null!==n){this.hp.push(t[n]),delete t[n],i.value=n;break}}else i.value=t,this.hp.pop();return i},_p:function(){return this.zE()},Rp:function(){return this.zE()},$E:function(){return this.zE()},Sp:function(){return this.$E()},XE:function(t){var i,n;switch(t){case Thrift.Type.STOP:return null;case Thrift.Type.BOOL:return this.Tp();case Thrift.Type.BYTE:return this.Op();case Thrift.Type.I16:return this.mp();case Thrift.Type.I32:return this.zE();case Thrift.Type.I64:return this._p();case Thrift.Type.DOUBLE:return this.Rp();case Thrift.Type.STRING:return this.$E();case Thrift.Type.STRUCT:for(this.cp();(i=this.WE()).ftype!=Thrift.Type.STOP;)this.XE(i.ftype),this.JE();return this.ZE(),null;case Thrift.Type.MAP:for(i=this.lp(),n=0;n<i.size;n++)0<n&&this.hp.length>this.aw[this.aw.length-1]+1&&this.hp.pop(),this.XE(i.vp),this.XE(i.dp);return this.Ep(),null;case Thrift.Type.SET:for(i=this.bp(),n=0;n<i.size;n++)this.XE(i.pp);return this.yp(),null;case Thrift.Type.LIST:for(i=this.wp(),n=0;n<i.size;n++)this.XE(i.pp);return this.gp(),null}}},Thrift.Ap=function(t,i,n,r){Thrift.Uw.call(this,i,n,r),this.Ip=t},Thrift.DE(Thrift.Ap,Thrift.Uw,"multiplexProtocol"),Thrift.Ap.prototype.na=function(t,i,n){i===Thrift.ra.CALL||i===Thrift.ra.ONEWAY?Thrift.Uw.prototype.na.call(this,this.Ip+":"+t,i,n):Thrift.Uw.prototype.na.call(this,t,i,n)},Thrift.Np=function(){this.Cp=0},Thrift.Np.prototype.kp=function(t,i,n){i.Zl&&(i=i.Zl);var r=this;return i.prototype.Dp=function(){return r.Cp+=1,r.Cp},new i(new Thrift.Ap(t,n))},copyList=function(t,i){if(!t)return t;var n,r,s,e=n=void 0===i.shift?i:i[0],h=t.length,o=[];for(r=0;r<h;r++)s=t[r],null===n?o.push(s):n===copyMap||n===copyList?o.push(n(s,i.slice(1))):o.push(new e(s));return o},copyMap=function(t,i){if(!t)return t;var n,r,s=n=void 0===i.shift?i:i[0],e={};for(var h in t)t.hasOwnProperty(h)&&(r=t[h],e[h]=null===n?r:n===copyMap||n===copyList?n(r,i.slice(1)):new s(r));return e},Thrift.jp=copyMap,Thrift.Mp=copyList,module.exports=Thrift},function(t,i){var g,E,e,a,n,h,r,o={userAgent:!1},u={};if(void 0===f||!f)var f={};f.Pp=function(){var t,i,n,r=arguments,s=null;for(t=0;t<r.length;t+=1)for(n=(""+r[t]).split("."),s=f,i="YAHOO"==n[0]?1:0;i<n.length;i+=1)s[n[i]]=s[n[i]]||{},s=s[n[i]];return s},f.log=function(t,i,n){var r=f.Hp.Lp;return!(!r||!r.log)&&r.log(t,i,n)},f.register=function(t,i,n){var r,s,e,h,o,u=f.Ge.Up;for(u[t]||(u[t]={Fp:[],Gp:[]}),r=u[t],s=n.version,e=n._l,h=f.Ge.listeners,r.name=t,r.version=s,r._l=e,r.Fp.push(s),r.Gp.push(e),r.xp=i,o=0;o<h.length;o+=1)h[o](r);i?(i.VERSION=s,i.Bp=e):f.log("mainClass is undefined for module "+t,"warn")},f.Ge=f.Ge||{Up:[],listeners:[]},f.Ge.getVersion=function(t){return f.Ge.Up[t]||null},f.Ge.Vp=function(t){function i(t){var i=0;return parseFloat(t.replace(/\./g,function(){return 1==i++?"":"."}))}var n,r={qp:0,opera:0,Qp:0,Yp:0,chrome:0,Kp:null,Wp:0,$p:0,Xp:0,zp:0,Jp:null,Zp:0,tg:0,ig:o&&o.ng,rg:!1,os:null},s=t||o&&o.userAgent,e=u.location,h=e&&e.href;return r.rg=h&&0===h.toLowerCase().indexOf("https"),s&&(/windows|win32/i.test(s)?r.os="windows":/macintosh/i.test(s)?r.os="macintosh":/rhino/i.test(s)&&(r.os="rhino"),/KHTML/.test(s)&&(r.Yp=1),(n=s.match(/AppleWebKit\/([^\s]*)/))&&n[1]&&(r.Yp=i(n[1]),/ Mobile\//.test(s)?(r.Kp="Apple",(n=s.match(/OS ([^\s]*)/))&&n[1]&&(n=i(n[1].replace("_","."))),r.Jp=n,r.$p=r.zp=r.Xp=0,(n=s.match(/iPad|iPod|iPhone/))&&n[0]&&(r[n[0].toLowerCase()]=r.Jp)):((n=s.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/))&&(r.Kp=n[0]),/webOS/.test(s)&&(r.Kp="WebOS",(n=s.match(/webOS\/([^\s]*);/))&&n[1]&&(r.tg=i(n[1]))),/ Android/.test(s)&&(r.Kp="Android",(n=s.match(/Android ([^\s]*);/))&&n[1]&&(r.Zp=i(n[1])))),(n=s.match(/Chrome\/([^\s]*)/))&&n[1]?r.chrome=i(n[1]):(n=s.match(/AdobeAIR\/([^\s]*)/))&&(r.Wp=n[0])),r.Yp||((n=s.match(/Opera[\s\/]([^\s]*)/))&&n[1]?(r.opera=i(n[1]),(n=s.match(/Version\/([^\s]*)/))&&n[1]&&(r.opera=i(n[1])),(n=s.match(/Opera Mini[^;]*/))&&(r.Kp=n[0])):(n=s.match(/MSIE\s([^;]*)/))&&n[1]?r.qp=i(n[1]):(n=s.match(/Gecko\/([^\s]*)/))&&(r.Qp=1,(n=s.match(/rv:([^\s\)]*)/))&&n[1]&&(r.Qp=i(n[1]))))),r},f.Ge.sg=f.Ge.Vp(),(function(){if(f.Pp("util","widget","example"),"undefined"!=typeof YAHOO_config){var t,i=YAHOO_config.listener,n=f.Ge.listeners,r=!0;if(i){for(t=0;t<n.length;t++)if(n[t]==i){r=!1;break}r&&n.push(i)}}})(),f.lang=f.lang||{},E=f.lang,e=Object.prototype,a=[],n={eg:"&amp;",hg:"&lt;",og:"&gt;",ug:"&quot;",ag:"&#x27;",ud:"&#x2F;",fg:"&#x60;"},h=["toString","valueOf"],r={isArray:function(t){return"[object Array]"===e.toString.apply(t)},cg:function(t){return"boolean"==typeof t},lg:function(t){return"function"==typeof t||"[object Function]"===e.toString.apply(t)},vg:function(t){return null===t},dg:function(t){return"number"==typeof t&&isFinite(t)},tc:function(t){return t&&("object"==typeof t||E.lg(t))||!1},Eg:function(t){return"string"==typeof t},wg:function(t){return void 0===t},pg:f.Ge.sg.qp?function(t,i){var n,r,s;for(n=0;n<h.length;n+=1)s=i[r=h[n]],E.lg(s)&&s!=e[r]&&(t[r]=s)}:function(){},gg:function(t){return t.replace(/[&<>"'\/`]/g,function(t){return n[t]})},extend:function(t,i,n){if(!i||!t)throw new Error("extend failed, please check that all dependencies are included.");function r(){}var s;if(r.prototype=i.prototype,t.prototype=new r(),(t.prototype.constructor=t).bg=i.prototype,i.prototype.constructor==e.constructor&&(i.prototype.constructor=i),n){for(s in n)E.hasOwnProperty(n,s)&&(t.prototype[s]=n[s]);E.pg(t.prototype,n)}},yg:function(t,i){if(!i||!t)throw new Error("Absorb failed, verify dependencies.");var n,r,s=arguments,e=s[2];if(e&&!0!==e)for(n=2;n<s.length;n+=1)t[s[n]]=i[s[n]];else{for(r in i)!e&&r in t||(t[r]=i[r]);E.pg(t,i)}return t},Tg:function(t,i){if(!i||!t)throw new Error("Augment failed, verify dependencies.");var n,r=[t.prototype,i.prototype];for(n=2;n<arguments.length;n+=1)r.push(arguments[n]);return E.yg.apply(this,r),t},dump:function(t,i){var n,r,s=[];if(!E.tc(t))return t+"";if(t instanceof Date||"nodeType"in t&&"tagName"in t)return t;if(E.lg(t))return"f(){...}";if(i=E.dg(i)?i:3,E.isArray(t)){for(s.push("["),n=0,r=t.length;n<r;n+=1)E.tc(t[n])?s.push(0<i?E.dump(t[n],i-1):"{...}"):s.push(t[n]),s.push(", ");1<s.length&&s.pop(),s.push("]")}else{for(n in s.push("{"),t)E.hasOwnProperty(t,n)&&(s.push(n+" => "),E.tc(t[n])?s.push(0<i?E.dump(t[n],i-1):"{...}"):s.push(t[n]),s.push(", "));1<s.length&&s.pop(),s.push("}")}return s.join("")},Og:function(t,i,n,r){for(var s,e,h,o,u,a,f,c,l,v=[],d=t.length;!((s=t.lastIndexOf("{",d))<0)&&!((e=t.indexOf("}",s))<s+1);)a=null,-1<(h=(o=f=t.substring(s+1,e)).indexOf(" "))&&(a=o.substring(h+1),o=o.substring(0,h)),u=i[o],n&&(u=n(o,u,a)),E.tc(u)?u=E.isArray(u)?E.dump(u,parseInt(a,10)):(-1<(c=(a=a||"").indexOf("dump"))&&(a=a.substring(4)),"[object Object]"===(l=u.toString())||-1<c?E.dump(u,parseInt(a,10)):l):E.Eg(u)||E.dg(u)||(u="~-"+v.length+"-~",v[v.length]=f),t=t.substring(0,s)+u+t.substring(e+1),!1===r&&(d=s-1);for(s=v.length-1;0<=s;s-=1)t=t.replace(new RegExp("~-"+s+"-~"),"{"+v[s]+"}","g");return t},trim:function(i){try{return i.replace(/^\s+|\s+$/g,"")}catch(t){return i}},mg:function(){var t,i={},n=arguments,r=n.length;for(t=0;t<r;t+=1)E.yg(i,n[t],!0);return i},_g:function(t,i,n,r,s){t=t||0,i=i||{};var e,h,o=n,u=r;if(E.Eg(n)&&(o=i[n]),!o)throw new TypeError("method undefined");return E.wg(r)||E.isArray(u)||(u=[r]),e=function(){o.apply(i,u||a)},h=s?setInterval(e,t):setTimeout(e,t),{interval:s,cancel:function(){this.interval?clearInterval(h):clearTimeout(h)}}},Rg:function(t){return E.tc(t)||E.Eg(t)||E.dg(t)||E.cg(t)}},E.hasOwnProperty=e.hasOwnProperty?function(t,i){return t&&t.hasOwnProperty&&t.hasOwnProperty(i)}:function(t,i){return!E.wg(t[i])&&t.constructor.prototype[i]!==t[i]},r.yg(E,r,!0),(f.util.Lang=E).Sg=E.Tg,f.Sg=E.Tg,f.extend=E.extend,f.register("yahoo",f,{version:"2.9.0",_l:"2800"});var c,s,l,v,d,w,p,b,y,T,O,m,_,R,S,A,I=I||(c=Math,l=(s={}).hl={},v=l.Ag={extend:function(t){N.prototype=this;var i=new N();return t&&i.Ig(t),i.hasOwnProperty("init")||(i.init=function(){i.Ng.init.apply(this,arguments)}),(i.init.prototype=i).Ng=this,i},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},Ig:function(t){for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},d=l.el=v.extend({init:function(t,i){t=this.Cg=t||[],this.kg=null!=i?i:4*t.length},toString:function(t){return(t||p).stringify(this)},concat:function(t){var i=this.Cg,n=t.Cg,r=this.kg,s=t.kg;if(this.Dg(),r%4)for(var e=0;e<s;e++){var h=n[e>>>2]>>>24-e%4*8&255;i[r+e>>>2]|=h<<24-(r+e)%4*8}else for(e=0;e<s;e+=4)i[r+e>>>2]=n[e>>>2];return this.kg+=s,this},Dg:function(){var t=this.Cg,i=this.kg;t[i>>>2]&=4294967295<<32-i%4*8,t.length=c.ceil(i/4)},clone:function(){var t=v.clone.call(this);return t.Cg=this.Cg.slice(0),t},random:function(t){for(var i=[],n=0;n<t;n+=4)i.push(4294967296*c.random()|0);return new d.init(i,t)}}),w=s.jg={},p=w.Mg={stringify:function(t){for(var i=t.Cg,n=t.kg,r=[],s=0;s<n;s++){var e=i[s>>>2]>>>24-s%4*8&255;r.push((e>>>4).toString(16)),r.push((15&e).toString(16))}return r.join("")},parse:function(t){for(var i=t.length,n=[],r=0;r<i;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new d.init(n,i/2)}},b=w.Pg={stringify:function(t){for(var i=t.Cg,n=t.kg,r=[],s=0;s<n;s++){var e=i[s>>>2]>>>24-s%4*8&255;r.push(String.fromCharCode(e))}return r.join("")},parse:function(t){for(var i=t.length,n=[],r=0;r<i;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new d.init(n,i)}},y=w.Lg={stringify:function(t){try{return decodeURIComponent(escape(b.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return b.parse(unescape(encodeURIComponent(t)))}},T=l.Hg=v.extend({reset:function(){this.Ug=new d.init(),this.Fg=0},Gg:function(t){"string"==typeof t&&(t=y.parse(t)),this.Ug.concat(t),this.Fg+=t.kg},xg:function(t){var i=this.Ug,n=i.Cg,r=i.kg,s=this.blockSize,e=r/(4*s),h=(e=t?c.ceil(e):c.max((0|e)-this.Bg,0))*s,o=c.min(4*h,r);if(h){for(var u=0;u<h;u+=s)this.Vg(n,u);var a=n.splice(0,h);i.kg-=o}return new d.init(a,o)},clone:function(){var t=v.clone.call(this);return t.Ug=this.Ug.clone(),t},Bg:0}),l.qg=T.extend({Qg:v.extend(),init:function(t){this.Qg=this.Qg.extend(t),this.reset()},reset:function(){T.reset.call(this),this.Yg()},update:function(t){return this.Gg(t),this.xg(),this},Kg:function(t){return t&&this.Gg(t),this.Wg()},blockSize:16,$g:function(n){return function(t,i){return new n.init(i).Kg(t)}},Xg:function(n){return function(t,i){return new O.zg.init(n,i).Kg(t)}}}),O=s.Jg={},s);function N(){}!function(e){function m(t,i,n,r,s,e,h){return((t=t+(i&n|~i&r)+s+h)<<e|t>>>32-e)+i}function _(t,i,n,r,s,e,h){return((t=t+(i&r|n&~r)+s+h)<<e|t>>>32-e)+i}function R(t,i,n,r,s,e,h){return((t=t+(i^n^r)+s+h)<<e|t>>>32-e)+i}function S(t,i,n,r,s,e,h){return((t=t+(n^(i|~r))+s+h)<<e|t>>>32-e)+i}for(var t=I,i=(r=t.hl).el,n=r.qg,r=t.Jg,A=[],s=0;s<64;s++)A[s]=4294967296*e.abs(e.sin(s+1))|0;r=r.ul=n.extend({Yg:function(){this.Zg=new i.init([1732584193,4023233417,2562383102,271733878])},Vg:function(t,i){for(var n=0;n<16;n++){var r=t[h=i+n];t[h]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}n=this.Zg.Cg;var s,e,h=t[i+0],o=(r=t[i+1],t[i+2]),u=t[i+3],a=t[i+4],f=t[i+5],c=t[i+6],l=t[i+7],v=t[i+8],d=t[i+9],E=t[i+10],w=t[i+11],p=t[i+12],g=t[i+13],b=t[i+14],y=t[i+15],T=n[0],O=S(O=S(O=S(O=S(O=R(O=R(O=R(O=R(O=_(O=_(O=_(O=_(O=m(O=m(O=m(O=m(O=n[1],e=m(e=n[2],s=m(s=n[3],T=m(T,O,e,s,h,7,A[0]),O,e,r,12,A[1]),T,O,o,17,A[2]),s,T,u,22,A[3]),e=m(e,s=m(s,T=m(T,O,e,s,a,7,A[4]),O,e,f,12,A[5]),T,O,c,17,A[6]),s,T,l,22,A[7]),e=m(e,s=m(s,T=m(T,O,e,s,v,7,A[8]),O,e,d,12,A[9]),T,O,E,17,A[10]),s,T,w,22,A[11]),e=m(e,s=m(s,T=m(T,O,e,s,p,7,A[12]),O,e,g,12,A[13]),T,O,b,17,A[14]),s,T,y,22,A[15]),e=_(e,s=_(s,T=_(T,O,e,s,r,5,A[16]),O,e,c,9,A[17]),T,O,w,14,A[18]),s,T,h,20,A[19]),e=_(e,s=_(s,T=_(T,O,e,s,f,5,A[20]),O,e,E,9,A[21]),T,O,y,14,A[22]),s,T,a,20,A[23]),e=_(e,s=_(s,T=_(T,O,e,s,d,5,A[24]),O,e,b,9,A[25]),T,O,u,14,A[26]),s,T,v,20,A[27]),e=_(e,s=_(s,T=_(T,O,e,s,g,5,A[28]),O,e,o,9,A[29]),T,O,l,14,A[30]),s,T,p,20,A[31]),e=R(e,s=R(s,T=R(T,O,e,s,f,4,A[32]),O,e,v,11,A[33]),T,O,w,16,A[34]),s,T,b,23,A[35]),e=R(e,s=R(s,T=R(T,O,e,s,r,4,A[36]),O,e,a,11,A[37]),T,O,l,16,A[38]),s,T,E,23,A[39]),e=R(e,s=R(s,T=R(T,O,e,s,g,4,A[40]),O,e,h,11,A[41]),T,O,u,16,A[42]),s,T,c,23,A[43]),e=R(e,s=R(s,T=R(T,O,e,s,d,4,A[44]),O,e,p,11,A[45]),T,O,y,16,A[46]),s,T,o,23,A[47]),e=S(e,s=S(s,T=S(T,O,e,s,h,6,A[48]),O,e,l,10,A[49]),T,O,b,15,A[50]),s,T,f,21,A[51]),e=S(e,s=S(s,T=S(T,O,e,s,p,6,A[52]),O,e,u,10,A[53]),T,O,E,15,A[54]),s,T,r,21,A[55]),e=S(e,s=S(s,T=S(T,O,e,s,v,6,A[56]),O,e,y,10,A[57]),T,O,c,15,A[58]),s,T,g,21,A[59]),e=S(e,s=S(s,T=S(T,O,e,s,a,6,A[60]),O,e,w,10,A[61]),T,O,o,15,A[62]),s,T,d,21,A[63]);n[0]=n[0]+T|0,n[1]=n[1]+O|0,n[2]=n[2]+e|0,n[3]=n[3]+s|0},Wg:function(){var t=this.Ug,i=t.Cg,n=8*this.Fg,r=8*t.kg;i[r>>>5]|=128<<24-r%32;var s=e.floor(n/4294967296);for(i[15+(r+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),i[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),t.kg=4*(i.length+1),this.xg(),i=(t=this.Zg).Cg,n=0;n<4;n++)r=i[n],i[n]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);return t},clone:function(){var t=n.clone.call(this);return t.Zg=this.Zg.clone(),t}}),t.ul=n.$g(r),t.tb=n.Xg(r)}(Math),_=(A=(m=I).hl).el,R=A.qg,S=[],A=m.Jg.ib=R.extend({Yg:function(){this.Zg=new _.init([1732584193,4023233417,2562383102,271733878,3285377520])},Vg:function(t,i){for(var n=this.Zg.Cg,r=n[0],s=n[1],e=n[2],h=n[3],o=n[4],u=0;u<80;u++){if(u<16)S[u]=0|t[i+u];else{var a=S[u-3]^S[u-8]^S[u-14]^S[u-16];S[u]=a<<1|a>>>31}a=(r<<5|r>>>27)+o+S[u],a=u<20?a+(1518500249+(s&e|~s&h)):u<40?a+(1859775393+(s^e^h)):u<60?a+((s&e|s&h|e&h)-1894007588):a+((s^e^h)-899497514),o=h,h=e,e=s<<30|s>>>2,s=r,r=a}n[0]=n[0]+r|0,n[1]=n[1]+s|0,n[2]=n[2]+e|0,n[3]=n[3]+h|0,n[4]=n[4]+o|0},Wg:function(){var t=this.Ug,i=t.Cg,n=8*this.Fg,r=8*t.kg;return i[r>>>5]|=128<<24-r%32,i[14+(64+r>>>9<<4)]=Math.floor(n/4294967296),i[15+(64+r>>>9<<4)]=n,t.kg=4*i.length,this.xg(),this.Zg},clone:function(){var t=R.clone.call(this);return t.Zg=this.Zg.clone(),t}}),m.ib=R.$g(A),m.nb=R.Xg(A);var C,k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",D="=";function j(t){var i,n,r,s="",e=0;for(i=0;i<t.length&&t.charAt(i)!=D;++i)(r=k.indexOf(t.charAt(i)))<0||(e=0==e?(s+=G(r>>2),n=3&r,1):1==e?(s+=G(n<<2|r>>4),n=15&r,2):2==e?(s+=G(n),s+=G(r>>2),n=3&r,3):(s+=G(n<<2|r>>4),s+=G(15&r),0));return 1==e&&(s+=G(n<<2)),s}function M(t,i,n){null!=t&&("number"==typeof t?this.rb(t,i,n):null==i&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,i))}function P(){return new M(null)}C="Microsoft Internet Explorer"==o.appName?(M.prototype.sb=function(t,i,n,r,s,e){for(var h=32767&i,o=i>>15;0<=--e;){var u=32767&this[t],a=this[t++]>>15,f=o*u+a*h;s=((u=h*u+((32767&f)<<15)+n[r]+(1073741823&s))>>>30)+(f>>>15)+o*a+(s>>>30),n[r++]=1073741823&u}return s},30):"Netscape"!=o.appName?(M.prototype.sb=function(t,i,n,r,s,e){for(;0<=--e;){var h=i*this[t++]+n[r]+s;s=Math.floor(h/67108864),n[r++]=67108863&h}return s},26):(M.prototype.sb=function(t,i,n,r,s,e){for(var h=16383&i,o=i>>14;0<=--e;){var u=16383&this[t],a=this[t++]>>14,f=o*u+a*h;s=((u=h*u+((16383&f)<<14)+n[r]+s)>>28)+(f>>14)+o*a,n[r++]=268435455&u}return s},28),M.prototype.eb=C,M.prototype.hb=(1<<C)-1,M.prototype.ob=1<<C;M.prototype.ub=Math.pow(2,52),M.prototype.ab=52-C,M.prototype.fb=2*C-52;var L,H,U="0123456789abcdefghijklmnopqrstuvwxyz",F=new Array();for(L="0".charCodeAt(0),H=0;H<=9;++H)F[L++]=H;for(L="a".charCodeAt(0),H=10;H<36;++H)F[L++]=H;for(L="A".charCodeAt(0),H=10;H<36;++H)F[L++]=H;function G(t){return U.charAt(t)}function x(t){var i=P();return i.cb(t),i}function B(t){var i,n=1;return 0!=(i=t>>>16)&&(t=i,n+=16),0!=(i=t>>8)&&(t=i,n+=8),0!=(i=t>>4)&&(t=i,n+=4),0!=(i=t>>2)&&(t=i,n+=2),0!=(i=t>>1)&&(t=i,n+=1),n}function V(t){this.lb=t}function q(t){this.lb=t,this.vb=t.Eb(),this.wb=32767&this.vb,this.pb=this.vb>>15,this.gb=(1<<t.eb-15)-1,this.bb=2*t.t}function Q(t,i){return new M(t,i)}function Y(t,i,n){for(var r="",s=0;r.length<i;)r+=n(String.fromCharCode.apply(String,t.concat([(4278190080&s)>>24,(16711680&s)>>16,(65280&s)>>8,255&s]))),s+=1;return r}V.prototype.yb=function(t){return t.Tb<0||0<=t.Ob(this.lb)?t.mb(this.lb):t},V.prototype._b=function(t){return t},V.prototype.reduce=function(t){t.Rb(this.lb,null,t)},V.prototype.Sb=function(t,i,n){t.Ab(i,n),this.reduce(n)},V.prototype.Ib=function(t,i){t.Nb(i),this.reduce(i)},q.prototype.yb=function(t){var i=P();return t.abs().Cb(this.lb.t,i),i.Rb(this.lb,null,i),t.Tb<0&&0<i.Ob(M.ZERO)&&this.lb.kb(i,i),i},q.prototype._b=function(t){var i=P();return t.Db(i),this.reduce(i),i},q.prototype.reduce=function(t){for(;t.t<=this.bb;)t[t.t++]=0;for(var i=0;i<this.lb.t;++i){var n=32767&t[i],r=n*this.wb+((n*this.pb+(t[i]>>15)*this.wb&this.gb)<<15)&t.hb;for(t[n=i+this.lb.t]+=this.lb.sb(0,r,t,i,0,this.lb.t);t[n]>=t.ob;)t[n]-=t.ob,t[++n]++}t.Dg(),t.jb(this.lb.t,t),0<=t.Ob(this.lb)&&t.kb(this.lb,t)},q.prototype.Sb=function(t,i,n){t.Ab(i,n),this.reduce(n)},q.prototype.Ib=function(t,i){t.Nb(i),this.reduce(i)},M.prototype.Db=function(t){for(var i=this.t-1;0<=i;--i)t[i]=this[i];t.t=this.t,t.Tb=this.Tb},M.prototype.cb=function(t){this.t=1,this.Tb=t<0?-1:0,0<t?this[0]=t:t<-1?this[0]=t+this.ob:this.t=0},M.prototype.fromString=function(t,i){var n;if(16==i)n=4;else if(8==i)n=3;else if(256==i)n=8;else if(2==i)n=1;else if(32==i)n=5;else{if(4!=i)return void this.Mb(t,i);n=2}this.t=0,this.Tb=0;for(var r,s,e=t.length,h=!1,o=0;0<=--e;){var u=8==n?255&t[e]:(r=e,void 0,null==(s=F[t.charCodeAt(r)])?-1:s);u<0?"-"==t.charAt(e)&&(h=!0):(h=!1,0==o?this[this.t++]=u:o+n>this.eb?(this[this.t-1]|=(u&(1<<this.eb-o)-1)<<o,this[this.t++]=u>>this.eb-o):this[this.t-1]|=u<<o,(o+=n)>=this.eb&&(o-=this.eb))}8==n&&0!=(128&t[0])&&(this.Tb=-1,0<o&&(this[this.t-1]|=(1<<this.eb-o)-1<<o)),this.Dg(),h&&M.ZERO.kb(this,this)},M.prototype.Dg=function(){for(var t=this.Tb&this.hb;0<this.t&&this[this.t-1]==t;)--this.t},M.prototype.Cb=function(t,i){var n;for(n=this.t-1;0<=n;--n)i[n+t]=this[n];for(n=t-1;0<=n;--n)i[n]=0;i.t=this.t+t,i.Tb=this.Tb},M.prototype.jb=function(t,i){for(var n=t;n<this.t;++n)i[n-t]=this[n];i.t=Math.max(this.t-t,0),i.Tb=this.Tb},M.prototype.Pb=function(t,i){var n,r=t%this.eb,s=this.eb-r,e=(1<<s)-1,h=Math.floor(t/this.eb),o=this.Tb<<r&this.hb;for(n=this.t-1;0<=n;--n)i[n+h+1]=this[n]>>s|o,o=(this[n]&e)<<r;for(n=h-1;0<=n;--n)i[n]=0;i[h]=o,i.t=this.t+h+1,i.Tb=this.Tb,i.Dg()},M.prototype.Lb=function(t,i){i.Tb=this.Tb;var n=Math.floor(t/this.eb);if(n>=this.t)i.t=0;else{var r=t%this.eb,s=this.eb-r,e=(1<<r)-1;i[0]=this[n]>>r;for(var h=n+1;h<this.t;++h)i[h-n-1]|=(this[h]&e)<<s,i[h-n]=this[h]>>r;0<r&&(i[this.t-n-1]|=(this.Tb&e)<<s),i.t=this.t-n,i.Dg()}},M.prototype.kb=function(t,i){for(var n=0,r=0,s=Math.min(t.t,this.t);n<s;)r+=this[n]-t[n],i[n++]=r&this.hb,r>>=this.eb;if(t.t<this.t){for(r-=t.Tb;n<this.t;)r+=this[n],i[n++]=r&this.hb,r>>=this.eb;r+=this.Tb}else{for(r+=this.Tb;n<t.t;)r-=t[n],i[n++]=r&this.hb,r>>=this.eb;r-=t.Tb}i.Tb=r<0?-1:0,r<-1?i[n++]=this.ob+r:0<r&&(i[n++]=r),i.t=n,i.Dg()},M.prototype.Ab=function(t,i){var n=this.abs(),r=t.abs(),s=n.t;for(i.t=s+r.t;0<=--s;)i[s]=0;for(s=0;s<r.t;++s)i[s+n.t]=n.sb(0,r[s],i,s,0,n.t);i.Tb=0,i.Dg(),this.Tb!=t.Tb&&M.ZERO.kb(i,i)},M.prototype.Nb=function(t){for(var i=this.abs(),n=t.t=2*i.t;0<=--n;)t[n]=0;for(n=0;n<i.t-1;++n){var r=i.sb(n,i[n],t,2*n,0,1);(t[n+i.t]+=i.sb(n+1,2*i[n],t,2*n+1,r,i.t-n-1))>=i.ob&&(t[n+i.t]-=i.ob,t[n+i.t+1]=1)}0<t.t&&(t[t.t-1]+=i.sb(n,i[n],t,2*n,0,1)),t.Tb=0,t.Dg()},M.prototype.Rb=function(t,i,n){var r=t.abs();if(!(r.t<=0)){var s=this.abs();if(s.t<r.t)return null!=i&&i.cb(0),void (null!=n&&this.Db(n));null==n&&(n=P());var e=P(),h=this.Tb,o=t.Tb,u=this.eb-B(r[r.t-1]);0<u?(r.Pb(u,e),s.Pb(u,n)):(r.Db(e),s.Db(n));var a=e.t,f=e[a-1];if(0!=f){var c=f*(1<<this.ab)+(1<a?e[a-2]>>this.fb:0),l=this.ub/c,v=(1<<this.ab)/c,d=1<<this.fb,E=n.t,w=E-a,p=null==i?P():i;for(e.Cb(w,p),0<=n.Ob(p)&&(n[n.t++]=1,n.kb(p,n)),M.ONE.Cb(a,p),p.kb(e,e);e.t<a;)e[e.t++]=0;for(;0<=--w;){var g=n[--E]==f?this.hb:Math.floor(n[E]*l+(n[E-1]+d)*v);if((n[E]+=e.sb(0,g,n,w,0,a))<g)for(e.Cb(w,p),n.kb(p,n);n[E]<--g;)n.kb(p,n)}null!=i&&(n.jb(a,i),h!=o&&M.ZERO.kb(i,i)),n.t=a,n.Dg(),0<u&&n.Lb(u,n),h<0&&M.ZERO.kb(n,n)}}},M.prototype.Eb=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var i=3&t;return 0<(i=(i=(i=(i=i*(2-(15&t)*i)&15)*(2-(255&t)*i)&255)*(2-((65535&t)*i&65535))&65535)*(2-t*i%this.ob)%this.ob)?this.ob-i:-i},M.prototype.Hb=function(){return 0==(0<this.t?1&this[0]:this.Tb)},M.prototype.exp=function(t,i){if(4294967295<t||t<1)return M.ONE;var n=P(),r=P(),s=i.yb(this),e=B(t)-1;for(s.Db(n);0<=--e;)if(i.Ib(n,r),0<(t&1<<e))i.Sb(r,s,n);else{var h=n;n=r,r=h}return i._b(n)},M.prototype.toString=function(t){if(this.Tb<0)return"-"+this.Ub().toString(t);var i;if(16==t)i=4;else if(8==t)i=3;else if(2==t)i=1;else if(32==t)i=5;else{if(4!=t)return this.Fb(t);i=2}var n,r=(1<<i)-1,s=!1,e="",h=this.t,o=this.eb-h*this.eb%i;if(0<h--)for(o<this.eb&&0<(n=this[h]>>o)&&(s=!0,e=G(n));0<=h;)o<i?(n=(this[h]&(1<<o)-1)<<i-o,n|=this[--h]>>(o+=this.eb-i)):(n=this[h]>>(o-=i)&r,o<=0&&(o+=this.eb,--h)),0<n&&(s=!0),s&&(e+=G(n));return s?e:"0"},M.prototype.Ub=function(){var t=P();return M.ZERO.kb(this,t),t},M.prototype.abs=function(){return this.Tb<0?this.Ub():this},M.prototype.Ob=function(t){var i=this.Tb-t.Tb;if(0!=i)return i;var n=this.t;if(0!=(i=n-t.t))return this.Tb<0?-i:i;for(;0<=--n;)if(0!=(i=this[n]-t[n]))return i;return 0},M.prototype.Gb=function(){return this.t<=0?0:this.eb*(this.t-1)+B(this[this.t-1]^this.Tb&this.hb)},M.prototype.mb=function(t){var i=P();return this.abs().Rb(t,null,i),this.Tb<0&&0<i.Ob(M.ZERO)&&t.kb(i,i),i},M.prototype.xb=function(t,i){var n;return n=t<256||i.Hb()?new V(i):new q(i),this.exp(t,n)},M.ZERO=x(0),M.ONE=x(1);var K=20;function W(){this.n=null,this.e=0,this.d=null,this.Bb=null,this.Vb=null,this.qb=null,this.Qb=null,this.Yb=null}W.prototype.Kb=function(t){return t.xb(this.e,this.n)},W.prototype.Wb=function(t,i){this.$b=!0,"string"!=typeof t?(this.n=t,this.e=i):null!=t&&null!=i&&0<t.length&&0<i.length?(this.n=Q(t,16),this.e=parseInt(i,16)):alert("Invalid RSA public key")},W.prototype.encrypt=function(t){var i=function(t,i){if(i<t.length+11)return alert("Message too long for RSA"),null;for(var n=new Array(),r=t.length-1;0<=r&&0<i;){var s=t.charCodeAt(r--);s<128?n[--i]=s:127<s&&s<2048?(n[--i]=63&s|128,n[--i]=s>>6|192):(n[--i]=63&s|128,n[--i]=s>>6&63|128,n[--i]=s>>12|224)}n[--i]=0;for(var e=new SecureRandom(),h=new Array();2<i;){for(h[0]=0;0==h[0];)e.Xb(h);n[--i]=h[0]}return n[--i]=2,n[--i]=0,new M(n)}(t,this.n.Gb()+7>>3);if(null==i)return null;var n=this.Kb(i);if(null==n)return null;var r=n.toString(16);return 0==(1&r.length)?r:"0"+r},W.prototype.zb=function(t,i){var n=function(t,i,n){if(t.length+2*K+2>i)throw"Message too long for RSA";var r,s="";for(r=0;r<i-t.length-2*K-2;r+=1)s+="\0";var e=rstr_sha1("")+s+"\x01"+t,h=new Array(K);new SecureRandom().Xb(h);var o=Y(h,e.length,n||rstr_sha1),u=[];for(r=0;r<e.length;r+=1)u[r]=e.charCodeAt(r)^o.charCodeAt(r);var a=Y(u,h.length,rstr_sha1),f=[0];for(r=0;r<h.length;r+=1)f[r+1]=h[r]^a.charCodeAt(r);return new M(f.concat(u))}(t,this.n.Gb()+7>>3,i);if(null==n)return null;var r=this.Kb(n);if(null==r)return null;var s=r.toString(16);return 0==(1&s.length)?s:"0"+s},W.prototype.type="RSA",void 0!==g&&g||(g={}),void 0!==g.Jb&&g.Jb||(g.Jb={}),g.Jb.Zb=new(function(){this.ty=function(t){var i=t.toString(16);return i.length%2==1&&(i="0"+i),i},this.iy=function(t){var i=t.toString(16);if("-"!=i.substr(0,1))i.length%2==1?i="0"+i:i.match(/^[0-7]/)||(i="00"+i);else{var n=i.substr(1).length;n%2==1?n+=1:i.match(/^[0-7]/)||(n+=2);for(var r="",s=0;s<n;s++)r+="f";i=new M(r,16).xor(t).add(M.ONE).toString(16).replace(/^-/,"")}return i},this.ny=function(t,i){g.Jb;var n=I.jg.Mg.parse(t),r=I.jg.sy.stringify(n).replace(/(.{64})/g,"$1\r\n");return"-----BEGIN "+i+"-----\r\n"+(r=r.replace(/\r\n$/,""))+"\r\n-----END "+i+"-----\r\n"},this.ey=function(t){var i=g.Jb,n=Object.keys(t);if(1!=n.length)throw"key of param shall be only one.";var r=n[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+r+":"))throw"undefined key: "+r;if("bool"==r)return new i.hy(t[r]);if("int"==r)return new i.oy(t[r]);if("bitstr"==r)return new i.uy(t[r]);if("octstr"==r)return new i.ay(t[r]);if("null"==r)return new i.ly(t[r]);if("oid"==r)return new i.vy(t[r]);if("enum"==r)return new i.Ey(t[r]);if("utf8str"==r)return new i.wy(t[r]);if("numstr"==r)return new i.py(t[r]);if("prnstr"==r)return new i.gy(t[r]);if("telstr"==r)return new i.by(t[r]);if("ia5str"==r)return new i.yy(t[r]);if("utctime"==r)return new i.Ty(t[r]);if("gentime"==r)return new i.Oy(t[r]);if("seq"==r){for(var s=t[r],e=[],h=0;h<s.length;h++){var o=i.Zb.ey(s[h]);e.push(o)}return new i.my({array:e})}if("set"==r){for(s=t[r],e=[],h=0;h<s.length;h++)o=i.Zb.ey(s[h]),e.push(o);return new i._y({array:e})}if("tag"==r){var u=t[r];if("[object Array]"===Object.prototype.toString.call(u)&&3==u.length){var a=i.Zb.ey(u[2]);return new i.Ry({tag:u[0],Sy:u[1],Ay:a})}var f={};if(void 0!==u.Sy&&(f.Sy=u.Sy),void 0!==u.tag&&(f.tag=u.tag),void 0===u.Ay)throw"obj shall be specified for 'tag'.";return f.Ay=i.Zb.ey(u.Ay),new i.Ry(f)}},this.Iy=function(t){return this.ey(t).Ny()}})(),g.Jb.Zb.Cy=function(t){for(var i="",n=parseInt(t.substr(0,2),16),r=(i=Math.floor(n/40)+"."+n%40,""),s=2;s<t.length;s+=2){var e=("00000000"+parseInt(t.substr(s,2),16).toString(2)).slice(-8);(r+=e.substr(1,7),"0"==e.substr(0,1))&&(i=i+"."+new M(r,2).toString(10),r="")}return i},g.Jb.Zb.ky=function(t){function o(t){var i=t.toString(16);return 1==i.length&&(i="0"+i),i}function i(t){var i="",n=new M(t,10).toString(2),r=7-n.length%7;7==r&&(r=0);for(var s="",e=0;e<r;e++)s+="0";for(n=s+n,e=0;e<n.length-1;e+=7){var h=n.substr(e,7);e!=n.length-7&&(h="1"+h),i+=o(parseInt(h,2))}return i}if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var n="",r=t.split("."),s=40*parseInt(r[0])+parseInt(r[1]);n+=o(s),r.splice(0,2);for(var e=0;e<r.length;e++)n+=i(r[e]);return n},g.Jb.Dy=function(){this.jy=function(){if(void 0===this.My||null==this.My)throw"this.hV is null or undefined.";if(this.My.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.My;var t=this.My.length/2,i=t.toString(16);if(i.length%2==1&&(i="0"+i),t<128)return i;var n=i.length/2;if(15<n)throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16);return(128+n).toString(16)+i},this.Ny=function(){return null!=this.Py&&!this.Ly||(this.My=this.Hy(),this.Uy=this.jy(),this.Py=this.Fy+this.Uy+this.My,this.Ly=!1),this.Py},this.Gy=function(){return this.Ny(),this.My},this.Hy=function(){return""}},g.Jb.xy=function(t){g.Jb.xy.bg.constructor.call(this),(this.By=function(){return this.Tb},this.Vy=function(t){this.Py=null,this.Ly=!0,this.Tb=t,this.My=stohex(this.Tb)},this.qy=function(t){this.Py=null,this.Ly=!0,this.Tb=null,this.My=t},this.Hy=function(){return this.My},void 0!==t&&("string"==typeof t?this.Vy(t):void 0!==t.str?this.Vy(t.str):void 0!==t.Qy&&this.qy(t.Qy)))},f.lang.extend(g.Jb.xy,g.Jb.Dy),g.Jb.Yy=function(t){g.Jb.Yy.bg.constructor.call(this),(this.Ky=function(t){return utc=t.getTime()+6e4*t.getTimezoneOffset(),new Date(utc)},this.Wy=function(t,i,n){var r=this.$y,s=this.Ky(t),e=String(s.getFullYear());"utc"==i&&(e=e.substr(2,2));var h=e+r(String(s.getMonth()+1),2)+r(String(s.getDate()),2)+r(String(s.getHours()),2)+r(String(s.getMinutes()),2)+r(String(s.getSeconds()),2);if(!0===n){var o=s.getMilliseconds();if(0!=o){var u=r(String(o),3);h=h+"."+(u=u.replace(/[0]+$/,""))}}return h+"Z"},this.$y=function(t,i){return t.length>=i?t:new Array(i-t.length+1).join("0")+t},this.By=function(){return this.Tb},this.Vy=function(t){this.Py=null,this.Ly=!0,this.Tb=t,this.My=stohex(t)},this.Xy=function(t,i,n,r,s,e){var h=new Date(Date.UTC(t,i-1,n,r,s,e,0));this.zy(h)},this.Hy=function(){return this.My})},f.lang.extend(g.Jb.Yy,g.Jb.Dy),g.Jb.Jy=function(t){g.Jb.xy.bg.constructor.call(this),(this.Zy=function(t){this.Py=null,this.Ly=!0,this.tT=t},this.iT=function(t){this.Py=null,this.Ly=!0,this.tT.push(t)},this.tT=new Array(),void 0!==t&&void 0!==t.array&&(this.tT=t.array))},f.lang.extend(g.Jb.Jy,g.Jb.Dy),g.Jb.hy=function(){g.Jb.hy.bg.constructor.call(this),this.Fy="01",this.Py="0101ff"},f.lang.extend(g.Jb.hy,g.Jb.Dy),g.Jb.oy=function(t){g.Jb.oy.bg.constructor.call(this),this.Fy="02",this.nT=function(t){this.Py=null,this.Ly=!0,this.My=g.Jb.Zb.iy(t)},this.rT=function(t){var i=new M(String(t),10);this.nT(i)},this.sT=function(t){this.My=t},this.Hy=function(){return this.My},void 0!==t&&(void 0!==t.eT?this.nT(t.eT):void 0!==t["int"]?this.rT(t["int"]):"number"==typeof t?this.rT(t):void 0!==t.Qy&&this.sT(t.Qy))},f.lang.extend(g.Jb.oy,g.Jb.Dy),g.Jb.uy=function(t){g.Jb.uy.bg.constructor.call(this),this.Fy="03",this.hT=function(t){this.Py=null,this.Ly=!0,this.My=t},this.oT=function(t,i){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var n="0"+t;this.Py=null,this.Ly=!0,this.My=n+i},this.uT=function(t){var i=8-(t=t.replace(/0+$/,"")).length%8;8==i&&(i=0);for(var n=0;n<=i;n++)t+="0";var r="";for(n=0;n<t.length-1;n+=8){var s=t.substr(n,8),e=parseInt(s,2).toString(16);1==e.length&&(e="0"+e),r+=e}this.Py=null,this.Ly=!0,this.My="0"+i+r},this.aT=function(t){for(var i="",n=0;n<t.length;n++)1==t[n]?i+="1":i+="0";this.uT(i)},this.fT=function(t){for(var i=new Array(t),n=0;n<t;n++)i[n]=!1;return i},this.Hy=function(){return this.My},void 0!==t&&("string"==typeof t&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.hT(t):void 0!==t.Qy?this.hT(t.Qy):void 0!==t.cT?this.uT(t.cT):void 0!==t.array&&this.aT(t.array))},f.lang.extend(g.Jb.uy,g.Jb.Dy),g.Jb.ay=function(t){g.Jb.ay.bg.constructor.call(this,t),this.Fy="04"},f.lang.extend(g.Jb.ay,g.Jb.xy),g.Jb.ly=function(){g.Jb.ly.bg.constructor.call(this),this.Fy="05",this.Py="0500"},f.lang.extend(g.Jb.ly,g.Jb.Dy),g.Jb.vy=function(t){function o(t){var i=t.toString(16);return 1==i.length&&(i="0"+i),i}function e(t){var i="",n=new M(t,10).toString(2),r=7-n.length%7;7==r&&(r=0);for(var s="",e=0;e<r;e++)s+="0";for(n=s+n,e=0;e<n.length-1;e+=7){var h=n.substr(e,7);e!=n.length-7&&(h="1"+h),i+=o(parseInt(h,2))}return i}g.Jb.vy.bg.constructor.call(this),this.Fy="06",this.sT=function(t){this.Py=null,this.Ly=!0,this.Tb=null,this.My=t},this.lT=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var i="",n=t.split("."),r=40*parseInt(n[0])+parseInt(n[1]);i+=o(r),n.splice(0,2);for(var s=0;s<n.length;s++)i+=e(n[s]);this.Py=null,this.Ly=!0,this.Tb=null,this.My=i},this.vT=function(t){if(void 0===g.Jb.wT.ET.dT[t])throw"DERObjectIdentifier oidName undefined: "+t;var i=g.Jb.wT.ET.dT[t];this.lT(i)},this.Hy=function(){return this.My},void 0!==t&&("string"==typeof t&&t.match(/^[0-2].[0-9.]+$/)?this.lT(t):void 0!==g.Jb.wT.ET.dT[t]?this.lT(g.Jb.wT.ET.dT[t]):void 0!==t.pT?this.lT(t.pT):void 0!==t.Qy?this.sT(t.Qy):void 0!==t.name&&this.vT(t.name))},f.lang.extend(g.Jb.vy,g.Jb.Dy),g.Jb.Ey=function(t){g.Jb.Ey.bg.constructor.call(this),this.Fy="0a",this.nT=function(t){this.Py=null,this.Ly=!0,this.My=g.Jb.Zb.iy(t)},this.rT=function(t){var i=new M(String(t),10);this.nT(i)},this.sT=function(t){this.My=t},this.Hy=function(){return this.My},void 0!==t&&(void 0!==t["int"]?this.rT(t["int"]):"number"==typeof t?this.rT(t):void 0!==t.Qy&&this.sT(t.Qy))},f.lang.extend(g.Jb.Ey,g.Jb.Dy),g.Jb.wy=function(t){g.Jb.wy.bg.constructor.call(this,t),this.Fy="0c"},f.lang.extend(g.Jb.wy,g.Jb.xy),g.Jb.py=function(t){g.Jb.py.bg.constructor.call(this,t),this.Fy="12"},f.lang.extend(g.Jb.py,g.Jb.xy),g.Jb.gy=function(t){g.Jb.gy.bg.constructor.call(this,t),this.Fy="13"},f.lang.extend(g.Jb.gy,g.Jb.xy),g.Jb.by=function(t){g.Jb.by.bg.constructor.call(this,t),this.Fy="14"},f.lang.extend(g.Jb.by,g.Jb.xy),g.Jb.yy=function(t){g.Jb.yy.bg.constructor.call(this,t),this.Fy="16"},f.lang.extend(g.Jb.yy,g.Jb.xy),g.Jb.Ty=function(t){g.Jb.Ty.bg.constructor.call(this,t),this.Fy="17",this.zy=function(t){this.Py=null,this.Ly=!0,this.gT=t,this.Tb=this.Wy(this.gT,"utc"),this.My=stohex(this.Tb)},this.Hy=function(){return void 0===this.gT&&void 0===this.Tb&&(this.gT=new Date(),this.Tb=this.Wy(this.gT,"utc"),this.My=stohex(this.Tb)),this.My},void 0!==t&&(void 0!==t.str?this.Vy(t.str):"string"==typeof t&&t.match(/^[0-9]{12}Z$/)?this.Vy(t):void 0!==t.Qy?this.qy(t.Qy):void 0!==t.gT&&this.zy(t.gT))},f.lang.extend(g.Jb.Ty,g.Jb.Yy),g.Jb.Oy=function(t){g.Jb.Oy.bg.constructor.call(this,t),this.Fy="18",this.bT=!1,this.zy=function(t){this.Py=null,this.Ly=!0,this.gT=t,this.Tb=this.Wy(this.gT,"gen",this.bT),this.My=stohex(this.Tb)},this.Hy=function(){return void 0===this.gT&&void 0===this.Tb&&(this.gT=new Date(),this.Tb=this.Wy(this.gT,"gen",this.bT),this.My=stohex(this.Tb)),this.My},void 0!==t&&(void 0!==t.str?this.Vy(t.str):"string"==typeof t&&t.match(/^[0-9]{14}Z$/)?this.Vy(t):void 0!==t.Qy?this.qy(t.Qy):void 0!==t.gT&&this.zy(t.gT),!0===t.yT&&(this.bT=!0))},f.lang.extend(g.Jb.Oy,g.Jb.Yy),g.Jb.my=function(t){g.Jb.my.bg.constructor.call(this,t),this.Fy="30",this.Hy=function(){for(var t="",i=0;i<this.tT.length;i++)t+=this.tT[i].Ny();return this.My=t,this.My}},f.lang.extend(g.Jb.my,g.Jb.Jy),g.Jb._y=function(t){g.Jb._y.bg.constructor.call(this,t),this.Fy="31",this.TT=!0,this.Hy=function(){for(var t=new Array(),i=0;i<this.tT.length;i++){var n=this.tT[i];t.push(n.Ny())}return 1==this.TT&&t.sort(),this.My=t.join(""),this.My},void 0!==t&&void 0!==t.OT&&0==t.OT&&(this.TT=!1)},f.lang.extend(g.Jb._y,g.Jb.Jy),g.Jb.Ry=function(t){g.Jb.Ry.bg.constructor.call(this),this.Fy="a0",this.My="",this.mT=!0,this._T=null,this.RT=function(t,i,n){this.Fy=i,this.mT=t,this._T=n,this.mT?(this.My=this._T.Ny(),this.Py=null,this.Ly=!0):(this.My=null,this.Py=n.Ny(),this.Py=this.Py.replace(/^../,i),this.Ly=!1)},this.Hy=function(){return this.My},void 0!==t&&(void 0!==t.tag&&(this.Fy=t.tag),void 0!==t.Sy&&(this.mT=t.Sy),void 0!==t.Ay&&(this._T=t.Ay,this.RT(this.mT,this.Fy,this._T)))},f.lang.extend(g.Jb.Ry,g.Jb.Dy),void 0!==g&&g||(g={}),void 0!==g.crypto&&g.crypto||(g.crypto={}),g.crypto.ST=new(function(){this.AT={sha1:"3021300906052b0e03021a05000414",IT:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",NT:"3041300d060960864801650304020205000430",CT:"3051300d060960864801650304020305000440",kT:"3020300c06082a864886f70d020205000410",DT:"3020300c06082a864886f70d020505000410",jT:"3021300906052b2403020105000414"},this.MT={DT:"cryptojs",sha1:"cryptojs",IT:"cryptojs",sha256:"cryptojs",NT:"cryptojs",CT:"cryptojs",jT:"cryptojs",PT:"cryptojs",LT:"cryptojs",HT:"cryptojs",UT:"cryptojs",FT:"cryptojs",GT:"cryptojs",xT:"cryptojs",BT:"cryptojs/jsrsa",VT:"cryptojs/jsrsa",qT:"cryptojs/jsrsa",QT:"cryptojs/jsrsa",YT:"cryptojs/jsrsa",KT:"cryptojs/jsrsa",WT:"cryptojs/jsrsa",$T:"cryptojs/jsrsa",XT:"cryptojs/jsrsa",zT:"cryptojs/jsrsa",JT:"cryptojs/jsrsa",ZT:"cryptojs/jsrsa",tO:"cryptojs/jsrsa",iO:"cryptojs/jsrsa",nO:"cryptojs/jsrsa",rO:"cryptojs/jsrsa",sO:"cryptojs/jsrsa",eO:"cryptojs/jsrsa",hO:"cryptojs/jsrsa",oO:"cryptojs/jsrsa",uO:"cryptojs/jsrsa",aO:"cryptojs/jsrsa",fO:"cryptojs/jsrsa",cO:"cryptojs/jsrsa"},this.lO={DT:I.Jg.ul,sha1:I.Jg.ib,IT:I.Jg.vO,sha256:I.Jg.dO,NT:I.Jg.EO,CT:I.Jg.wO,jT:I.Jg.pO},this.gO=function(t,i){if(void 0===this.AT[i])throw"alg not supported in Util.DIGESTINFOHEAD: "+i;return this.AT[i]+t},this.bO=function(t,i,n){var r=this.gO(t,i),s=n/4;if(r.length+22>s)throw"key is too short for SigAlg: keylen="+n+","+i;for(var e="00"+r,h="",o=s-"0001".length-e.length,u=0;u<o;u+=2)h+="ff";return"0001"+h+e},this.yO=function(t,i){return new g.crypto.OO({mO:i}).TO(t)},this._O=function(t,i){return new g.crypto.OO({mO:i}).RO(t)},this.sha1=function(t){return new g.crypto.OO({mO:"sha1",SO:"cryptojs"}).TO(t)},this.sha256=function(t){return new g.crypto.OO({mO:"sha256",SO:"cryptojs"}).TO(t)},this.AO=function(t){return new g.crypto.OO({mO:"sha256",SO:"cryptojs"}).RO(t)},this.CT=function(t){return new g.crypto.OO({mO:"sha512",SO:"cryptojs"}).TO(t)},this.IO=function(t){return new g.crypto.OO({mO:"sha512",SO:"cryptojs"}).RO(t)},this.DT=function(t){return new g.crypto.OO({mO:"md5",SO:"cryptojs"}).TO(t)},this.jT=function(t){return new g.crypto.OO({mO:"ripemd160",SO:"cryptojs"}).TO(t)},this.NO=function(t){}})(),g.crypto.OO=function(t){this.CO=function(i,t){if(null!=i&&void 0===t&&(t=g.crypto.ST.MT[i]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(i)&&"cryptojs"==t){try{this.kO=g.crypto.ST.lO[i].create()}catch(t){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+t}this.DO=function(t){this.kO.update(t)},this.jO=function(t){var i=I.jg.Mg.parse(t);this.kO.update(i)},this.digest=function(){return this.kO.Kg().toString(I.jg.Mg)},this.TO=function(t){return this.DO(t),this.digest()},this.RO=function(t){return this.jO(t),this.digest()}}if(-1!=":sha256:".indexOf(i)&&"sjcl"==t){try{this.kO=new sjcl.hash.sha256()}catch(t){throw"setAlgAndProvider hash alg set fail alg="+i+"/"+t}this.DO=function(t){this.kO.update(t)},this.jO=function(t){var i=sjcl.PO.Qy.MO(t);this.kO.update(i)},this.digest=function(){var t=this.kO.Kg();return sjcl.PO.Qy.LO(t)},this.TO=function(t){return this.DO(t),this.digest()},this.RO=function(t){return this.jO(t),this.digest()}}},this.DO=function(t){throw"updateString(str) not supported for this alg/prov: "+this.HO+"/"+this.UO},this.jO=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.HO+"/"+this.UO},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.HO+"/"+this.UO},this.TO=function(t){throw"digestString(str) not supported for this alg/prov: "+this.HO+"/"+this.UO},this.RO=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.HO+"/"+this.UO},void 0!==t&&void 0!==t.mO&&(this.HO=t.mO,void 0===t.SO&&(this.UO=g.crypto.ST.MT[this.HO]),this.CO(this.HO,this.UO))},g.crypto.FO=function(t){this.CO=function(t,i){if(null==(t=t.toLowerCase())&&(t="hmacsha1"),"hmac"!=(t=t.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+t;void 0===i&&(i=g.crypto.ST.MT[t]),this.GO=t+"/"+i;var n=t.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(n)&&"cryptojs"==i){try{var r=g.crypto.ST.lO[n];this.mac=I.Jg.zg.create(r,this.xO)}catch(t){throw"setAlgAndProvider hash alg set fail hashAlg="+n+"/"+t}this.DO=function(t){this.mac.update(t)},this.jO=function(t){var i=I.jg.Mg.parse(t);this.mac.update(i)},this.BO=function(){return this.mac.Kg().toString(I.jg.Mg)},this.VO=function(t){return this.DO(t),this.BO()},this.qO=function(t){return this.jO(t),this.BO()}}},this.DO=function(t){throw"updateString(str) not supported for this alg/prov: "+this.GO},this.jO=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.GO},this.BO=function(){throw"digest() not supported for this alg/prov: "+this.GO},this.VO=function(t){throw"digestString(str) not supported for this alg/prov: "+this.GO},this.qO=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.GO},this.QO=function(t){if("string"==typeof t){var i=t;return t.length%2!=1&&t.match(/^[0-9A-Fa-f]+$/)||(i=rstrtohex(t)),void (this.xO=I.jg.Mg.parse(i))}if("object"!=typeof t)throw"KJUR.crypto.Mac unsupported password type: "+t;i=null;if(void 0!==t.Qy){if(t.Qy.length%2!=0||!t.Qy.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+t.Qy;i=t.Qy}if(void 0!==t.YO&&(i=utf8tohex(t.YO)),void 0!==t.KO&&(i=rstrtohex(t.KO)),void 0!==t.WO&&(i=j(t.WO)),void 0!==t.$O&&(i=b64utohex(t.$O)),null==i)throw"KJUR.crypto.Mac unsupported password type: "+t;this.xO=I.jg.Mg.parse(i)},void 0!==t&&(void 0!==t.xO&&this.QO(t.xO),void 0!==t.mO&&(this.HO=t.mO,void 0===t.SO&&(this.UO=g.crypto.ST.MT[this.HO]),this.CO(this.HO,this.UO)))},g.crypto.Signature=function(t){var i=null;if(this.XO=function(){this.HO.match(/^(.+)with(.+)$/)&&(this.zO=RegExp.$1.toLowerCase(),this.JO=RegExp.$2.toLowerCase())},this.ZO=function(t,i){for(var n="",r=i/4-t.length,s=0;s<r;s++)n+="0";return n+t},this.CO=function(t,i){if(this.XO(),"cryptojs/jsrsa"!=i)throw"provider not supported: "+i;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.zO)){try{this.kO=new g.crypto.OO({mO:this.zO})}catch(t){throw"setAlgAndProvider hash alg set fail alg="+this.zO+"/"+t}this.init=function(t,i){var n=null;try{n=void 0===i?KEYUTIL.getKey(t):KEYUTIL.getKey(t,i)}catch(t){throw"init failed:"+t}if(!0===n.tm)this.im=n,this.state="SIGN";else{if(!0!==n.$b)throw"init failed.:"+n;this.nm=n,this.state="VERIFY"}},this.rm=function(t){"string"==typeof t.sm&&"string"==typeof t.em?(this.sm=t.sm,this.em=t.em):this.im=t,this.state="SIGN"},this.hm=function(t){"string"==typeof t.om&&"string"==typeof t.em?(this.om=t.om,this.em=t.em):t instanceof g.crypto.um?this.nm=t:t instanceof W&&(this.nm=t),this.state="VERIFY"},this.am=function(t){var i=new X509();i.fm(t),this.nm=i.cm,this.state="VERIFY"},this.DO=function(t){this.kO.DO(t)},this.jO=function(t){this.kO.jO(t)},this.sign=function(){if(this.lm=this.kO.digest(),void 0!==this.sm&&void 0!==this.em){var t=new g.crypto.um({curve:this.em});this.vm=t.dm(this.lm,this.sm)}else if(this.im instanceof W&&"rsaandmgf1"==this.JO)this.vm=this.im.Em(this.lm,this.zO,this.wm);else if(this.im instanceof W&&"rsa"==this.JO)this.vm=this.im.pm(this.lm,this.zO);else if(this.im instanceof g.crypto.um)this.vm=this.im.pm(this.lm);else{if(!(this.im instanceof g.crypto.gm))throw"Signature: unsupported public key alg: "+this.JO;this.vm=this.im.pm(this.lm)}return this.vm},this.bm=function(t){return this.DO(t),this.sign()},this.dm=function(t){return this.jO(t),this.sign()},this.verify=function(t){if(this.lm=this.kO.digest(),void 0!==this.om&&void 0!==this.em)return new g.crypto.um({curve:this.em}).ym(this.lm,t,this.om);if(this.nm instanceof W&&"rsaandmgf1"==this.JO)return this.nm.Tm(this.lm,t,this.zO,this.wm);if(this.nm instanceof W&&"rsa"==this.JO)return this.nm.Om(this.lm,t);if(this.nm instanceof g.crypto.um)return this.nm.Om(this.lm,t);if(this.nm instanceof g.crypto.gm)return this.nm.Om(this.lm,t);throw"Signature: unsupported public key alg: "+this.JO}}},this.init=function(t,i){throw"init(key, pass) not supported for this alg:prov="+this.mm},this.hm=function(t){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.mm},this.am=function(t){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.mm},this.rm=function(t){throw"initSign(prvKey) not supported for this alg:prov="+this.mm},this.DO=function(t){throw"updateString(str) not supported for this alg:prov="+this.mm},this.jO=function(t){throw"updateHex(hex) not supported for this alg:prov="+this.mm},this.sign=function(){throw"sign() not supported for this alg:prov="+this.mm},this.bm=function(t){throw"digestString(str) not supported for this alg:prov="+this.mm},this.dm=function(t){throw"digestHex(hex) not supported for this alg:prov="+this.mm},this.verify=function(t){throw"verify(hSigVal) not supported for this alg:prov="+this.mm},void 0!==(this._m=t)&&(void 0!==t.mO&&(this.HO=t.mO,void 0===t.SO?this.UO=g.crypto.ST.MT[this.HO]:this.UO=t.SO,this.mm=this.HO+":"+this.UO,this.CO(this.HO,this.UO),this.XO()),void 0!==t.Rm&&(this.wm=t.Rm),void 0!==t.Sm)){if(void 0!==t.Am)throw"both prvkeypem and prvkeypas parameters not supported";try{(i=new W()).Im(t.Sm),this.rm(i)}catch(t){throw"fatal error to load pem private key: "+t}}},g.crypto.ET=new function(){this.Nm={Cm:"rsaEncryption",km:"ecPublicKey",Dm:"dsa",jm:"secp256r1",Mm:"secp192k1",Pm:"secp224r1",Lm:"secp256k1",Hm:"secp521r1",Um:"secp384r1",Fm:"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}}();var $=new RegExp("");function X(t,i){for(var n="",r=i/4-t.length,s=0;s<r;s++)n+="0";return n+t}function z(t,i){var n,r=(n=t,g.crypto.ST.yO(n,i));return this.pm(r,i)}function J(t){return z.call(this,t,"sha1")}function Z(t){return z.call(this,t,"sha256")}function tt(t,i,n){for(var r="",s=0;r.length<i;)r+=hextorstr(n(rstrtohex(t+String.fromCharCode.apply(String,[(4278190080&s)>>24,(16711680&s)>>16,(65280&s)>>8,255&s])))),s+=1;return r}function it(t,i,n){var r,s=(r=rstrtohex(t),g.crypto.ST._O(r,i));return void 0===n&&(n=-1),this.Em(s,i,n)}function nt(t,i,n){return function(t,i,n){var r=new W();return r.Wb(i,n),r.Kb(t)}(t,i,n).toString(16).replace(/^1f+00/,"")}function rt(t){for(var i in g.crypto.ST.AT){var n=g.crypto.ST.AT[i],r=n.length;if(t.substring(0,r)==n)return[i,t.substring(r)]}return[]}function st(t,i){return function(t,i,n,r){var s=rt(nt(i,n,r));if(0==s.length)return!1;var e,h=s[0];return s[1]==(e=t,g.crypto.ST.yO(e,h))}(i,Q(t,16),this.n.toString(16),this.e.toString(16))}function et(t,i){var n=Q(i=(i=i.replace($,"")).replace(/[ \n]+/g,""),16);if(n.Gb()>this.n.Gb())return 0;var r=rt(this.Kb(n).toString(16).replace(/^1f+00/,""));if(0==r.length)return!1;var s,e=r[0];return r[1]==(s=t,g.crypto.ST.yO(s,e))}function ht(t,i,n,r){var s,e=(s=rstrtohex(t),g.crypto.ST._O(s,n));return void 0===r&&(r=-1),this.Tm(e,i,n,r)}$.compile("[^0-9a-f]","gi"),W.prototype.pm=function(t,i){var n=Q(g.crypto.ST.bO(t,i,this.n.Gb()),16);return X(this.Gm(n).toString(16),this.n.Gb())},W.prototype.bm=z,W.prototype.xm=J,W.prototype.Bm=Z,W.prototype.sign=z,W.prototype.Vm=J,W.prototype.qm=Z,W.prototype.Em=function(t,i,n){function r(t){return g.crypto.ST._O(t,i)}var s,e=hextorstr(t),h=e.length,o=this.n.Gb()-1,u=Math.ceil(o/8);if(-1===n||void 0===n)n=h;else if(-2===n)n=u-h-2;else if(n<-2)throw"invalid salt length";if(u<h+n+2)throw"data too long";var a="";0<n&&(a=new Array(n),new SecureRandom().Xb(a),a=String.fromCharCode.apply(String,a));var f=hextorstr(r(rstrtohex("\0\0\0\0\0\0\0\0"+e+a))),c=[];for(s=0;s<u-n-h-2;s+=1)c[s]=0;var l=String.fromCharCode.apply(String,c)+"\x01"+a,v=tt(f,l.length,r),d=[];for(s=0;s<l.length;s+=1)d[s]=l.charCodeAt(s)^v.charCodeAt(s);var E=65280>>8*u-o&255;for(d[0]&=~E,s=0;s<h;s++)d.push(f.charCodeAt(s));return d.push(188),X(this.Gm(new M(d)).toString(16),this.n.Gb())},W.prototype.Qm=it,W.prototype.Ym=it,W.Km=-1,W.Wm=-2,W.prototype.Om=function(t,i){var n=Q(i=(i=i.replace($,"")).replace(/[ \n]+/g,""),16);if(n.Gb()>this.n.Gb())return 0;var r=rt(this.Kb(n).toString(16).replace(/^1f+00/,""));return 0!=r.length&&(r[0],r[1]==t)},W.prototype.$m=et,W.prototype.Xm=st,W.prototype.verify=et,W.prototype.zm=st,W.prototype.Tm=function(t,i,n,r){var s=new M(i,16);if(s.Gb()>this.n.Gb())return!1;function e(t){return g.crypto.ST._O(t,n)}var h,o=hextorstr(t),u=o.length,a=this.n.Gb()-1,f=Math.ceil(a/8);if(-1===r||void 0===r)r=u;else if(-2===r)r=f-u-2;else if(r<-2)throw"invalid salt length";if(f<u+r+2)throw"data too long";var c=this.Kb(s).Jm();for(h=0;h<c.length;h+=1)c[h]&=255;for(;c.length<f;)c.unshift(0);if(188!==c[f-1])throw"encoded message does not end in 0xbc";var l=(c=String.fromCharCode.apply(String,c)).substr(0,f-u-1),v=c.substr(l.length,u),d=65280>>8*f-a&255;if(0!=(l.charCodeAt(0)&d))throw"bits beyond keysize not zero";var E=tt(v,l.length,e),w=[];for(h=0;h<l.length;h+=1)w[h]=l.charCodeAt(h)^E.charCodeAt(h);w[0]&=~d;var p=f-u-r-2;for(h=0;h<p;h+=1)if(0!==w[h])throw"leftmost octets not zero";if(1!==w[p])throw"0x01 marker not found";return v===hextorstr(e(rstrtohex("\0\0\0\0\0\0\0\0"+o+String.fromCharCode.apply(String,w.slice(-r)))))},W.prototype.Zm=ht,W.prototype.t_=ht,W.i_=-2,i.n_=M,i.r_=W,i.Signature=g.crypto.Signature,i.OO=g.crypto.OO,i.ol=I,i.s_=j,i.e_=function(t){var i,n=j(t),r=new Array();for(i=0;2*i<n.length;++i)r[i]=parseInt(n.substring(2*i,2*i+2),16);return r}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,e=n(0),s=n(6);(r=i.h_||(i.h_={}))[r.o_=0]="UPPER_LAYER",r[r.u_=1]="CDN",r[r.a_=2]="CDN_PREFETCH",r[r.f_=3]="CDN_COMPENSATION",r[r.c_=4]="P2P",r[r.l_=5]="P2P_PREFETCH";var h=function(){this.v_=!1,this.d_=0,this.E_=0,this.w_=0,this.p_=0,this.g_=0,this.p2pAgenTrafficSuccessQt=0,this.b_=0,this.srcOtherRespQt=0,this.y_=0,this.T_=0,this.O_=0,this.m_=0};i.__=h;var o=(u.prototype.R_=function(){return this.type},u.prototype.S_=function(){return this.A_.S_()},u.prototype.I_=function(){return this.A_.I_()},u.prototype.N_=function(){return this.I_()+"-"+this.C_},u.prototype.k_=function(){return this.A_.D_()},u.prototype.j_=function(){return this.A_.M_()},u.prototype.P_=function(){return Math.max(1,this.L_.m_-this.L_.O_)},u.prototype.H_=function(){return Math.max(1,this.L_.m_-this.L_.T_)},u.prototype.U_=function(){return 0!=this.L_.g_?new s.ma(this.P_(),this.L_.g_):new s.ma(this.H_(),this.L_.E_)},u.prototype.getResponse=function(){return this.xhr?this.xhr.response:this.F_},u.prototype.G_=function(){return this.responseText},u.prototype.x_=function(){return this.L_.d_},u.prototype.B_=function(){throw new Error("Not implemented")},u.prototype.V_=function(){return this.A_},u);function u(t,i,n,r,s){this.q_=!1,this.type=void 0,this.L_=new h(),this.Q_=!1,this.Y_=!1,this.K_="",this.F_=new ArrayBuffer(0),this.W_=0,this.type=n,this.X_=t,this.C_=i,this.z_=s,this.A_=r,this.L_.y_=e.Framework.time()}i.J_=o},function(t,i,n){var j=n(22),M=window.hive;void 0===M&&(M=window.hive={}),void 0===M.services&&(M.services={}),void 0===M.services.protocol&&(M.services.protocol={}),void 0===M.services.protocol.tracker&&(M.services.protocol.tracker={}),M.services.protocol.tracker.TrackerPeerStreamState={1:"PLAYER",Z_:1,2:"P2P_AGENT",tR:2,3:"PREFETCHER_FIRST_TIER",iR:3,4:"PREFETCHER_SECOND_TIER",nR:4},M.services.protocol.tracker.TrackerRankType={1:"Global",Global:1,2:"InternalAs",rR:2,3:"ExternalAs",sR:3,4:"LocalityAs",eR:4},M.services.protocol.tracker.TrackerAsType={1:"Internal",hR:1,2:"External",External:2,3:"Locality",oR:"3"},M.services.protocol.tracker.TrackerPeerStreamInfo=function(t){this.state=null,this.bitrate=null,this.delta=null,this.qualityLevel=null,t&&(void 0!==t.state&&null!==t.state&&(this.state=t.state),void 0!==t.bitrate&&null!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.delta&&null!==t.delta&&(this.delta=t.delta),void 0!==t.qualityLevel&&null!==t.qualityLevel&&(this.qualityLevel=t.qualityLevel))},M.services.protocol.tracker.TrackerPeerStreamInfo.prototype={},M.services.protocol.tracker.TrackerPeerStreamInfo.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.I32?this.state=t.zE().value:t.XE(n);break;case 2:n==j.Type.I32?this.bitrate=t.zE().value:t.XE(n);break;case 3:n==j.Type.I32?this.delta=t.zE().value:t.XE(n);break;case 4:n==j.Type.STRING?this.qualityLevel=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerPeerStreamInfo.prototype.write=function(t){t.tw("TrackerPeerStreamInfo"),null!==this.state&&void 0!==this.state&&(t.iw("state",j.Type.I32,1),t.sw(this.state),t.rw()),null!==this.bitrate&&void 0!==this.bitrate&&(t.iw("bitrate",j.Type.I32,2),t.sw(this.bitrate),t.rw()),null!==this.delta&&void 0!==this.delta&&(t.iw("delta",j.Type.I32,3),t.sw(this.delta),t.rw()),null!==this.qualityLevel&&void 0!==this.qualityLevel&&(t.iw("qualityLevel",j.Type.STRING,4),t.nw(this.qualityLevel),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerPeerInfo=function(t){this.guid=null,this.internalAs=null,this.externalAs=null,this.nat=null,this.bandwidth=null,this.watchingBitrate=null,this.privateIp=null,this.publicIp=null,this.streams=null,this.rankValue=null,this.timestamp=null,this.publicIpString=null,this.privateIpString=null,this.watchingQualityLevel=null,this.localityGroupId=null,t&&(void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.internalAs&&null!==t.internalAs&&(this.internalAs=t.internalAs),void 0!==t.externalAs&&null!==t.externalAs&&(this.externalAs=t.externalAs),void 0!==t.nat&&null!==t.nat&&(this.nat=t.nat),void 0!==t.bandwidth&&null!==t.bandwidth&&(this.bandwidth=t.bandwidth),void 0!==t.watchingBitrate&&null!==t.watchingBitrate&&(this.watchingBitrate=t.watchingBitrate),void 0!==t.privateIp&&null!==t.privateIp&&(this.privateIp=t.privateIp),void 0!==t.publicIp&&null!==t.publicIp&&(this.publicIp=t.publicIp),void 0!==t.streams&&null!==t.streams&&(this.streams=t.streams),void 0!==t.rankValue&&null!==t.rankValue&&(this.rankValue=t.rankValue),void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.publicIpString&&null!==t.publicIpString&&(this.publicIpString=t.publicIpString),void 0!==t.privateIpString&&null!==t.privateIpString&&(this.privateIpString=t.privateIpString),void 0!==t.watchingQualityLevel&&null!==t.watchingQualityLevel&&(this.watchingQualityLevel=t.watchingQualityLevel),void 0!==t.localityGroupId&&null!==t.localityGroupId&&(this.localityGroupId=t.localityGroupId))},M.services.protocol.tracker.TrackerPeerInfo.prototype={},M.services.protocol.tracker.TrackerPeerInfo.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.STRING?this.guid=t.Sp().value:t.XE(n);break;case 2:n==j.Type.I32?this.internalAs=t.zE().value:t.XE(n);break;case 3:n==j.Type.I32?this.externalAs=t.zE().value:t.XE(n);break;case 4:n==j.Type.I32?this.nat=t.zE().value:t.XE(n);break;case 5:n==j.Type.I32?this.bandwidth=t.zE().value:t.XE(n);break;case 6:n==j.Type.I32?this.watchingBitrate=t.zE().value:t.XE(n);break;case 7:n==j.Type.STRUCT?(this.privateIp=new InetAddress(),this.privateIp.read(t)):t.XE(n);break;case 8:n==j.Type.STRUCT?(this.publicIp=new InetAddress(),this.publicIp.read(t)):t.XE(n);break;case 9:if(n==j.Type.LIST){var s,e;this.streams=[];(e=t.wp()).pp,s=e.size;for(var h=0;h<s;++h){var o=null;(o=new M.services.protocol.tracker.TrackerPeerStreamInfo()).read(t),this.streams.push(o)}t.gp()}else t.XE(n);break;case 10:n==j.Type.DOUBLE?this.rankValue=t.Rp().value:t.XE(n);break;case 11:n==j.Type.I64?this.timestamp=t._p().value:t.XE(n);break;case 12:n==j.Type.STRING?this.publicIpString=t.$E().value:t.XE(n);break;case 13:n==j.Type.STRING?this.privateIpString=t.$E().value:t.XE(n);break;case 14:n==j.Type.STRING?this.watchingQualityLevel=t.$E().value:t.XE(n);break;case 15:n==j.Type.I32?this.localityGroupId=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerPeerInfo.prototype.write=function(t){if(t.tw("TrackerPeerInfo"),null!==this.guid&&void 0!==this.guid&&(t.iw("guid",j.Type.STRING,1),t.ep(this.guid),t.rw()),null!==this.internalAs&&void 0!==this.internalAs&&(t.iw("internalAs",j.Type.I32,2),t.sw(this.internalAs),t.rw()),null!==this.externalAs&&void 0!==this.externalAs&&(t.iw("externalAs",j.Type.I32,3),t.sw(this.externalAs),t.rw()),null!==this.nat&&void 0!==this.nat&&(t.iw("nat",j.Type.I32,4),t.sw(this.nat),t.rw()),null!==this.bandwidth&&void 0!==this.bandwidth&&(t.iw("bandwidth",j.Type.I32,5),t.sw(this.bandwidth),t.rw()),null!==this.watchingBitrate&&void 0!==this.watchingBitrate&&(t.iw("watchingBitrate",j.Type.I32,6),t.sw(this.watchingBitrate),t.rw()),null!==this.privateIp&&void 0!==this.privateIp&&(t.iw("privateIp",j.Type.STRUCT,7),this.privateIp.write(t),t.rw()),null!==this.publicIp&&void 0!==this.publicIp&&(t.iw("publicIp",j.Type.STRUCT,8),this.publicIp.write(t),t.rw()),null!==this.streams&&void 0!==this.streams){for(var i in t.iw("streams",j.Type.LIST,9),t.$w(j.Type.STRUCT,this.streams.length),this.streams)this.streams.hasOwnProperty(i)&&(i=this.streams[i]).write(t);t.Xw(),t.rw()}null!==this.rankValue&&void 0!==this.rankValue&&(t.iw("rankValue",j.Type.DOUBLE,10),t.sp(this.rankValue),t.rw()),null!==this.timestamp&&void 0!==this.timestamp&&(t.iw("timestamp",j.Type.I64,11),t.rp(this.timestamp),t.rw()),null!==this.publicIpString&&void 0!==this.publicIpString&&(t.iw("publicIpString",j.Type.STRING,12),t.nw(this.publicIpString),t.rw()),null!==this.privateIpString&&void 0!==this.privateIpString&&(t.iw("privateIpString",j.Type.STRING,13),t.nw(this.privateIpString),t.rw()),null!==this.watchingQualityLevel&&void 0!==this.watchingQualityLevel&&(t.iw("watchingQualityLevel",j.Type.STRING,14),t.nw(this.watchingQualityLevel),t.rw()),null!==this.localityGroupId&&void 0!==this.localityGroupId&&(t.iw("localityGroupId",j.Type.I32,15),t.sw(this.localityGroupId),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.CustomerKey=function(t){this.partnerId=null,this.customerId=null,t&&(void 0!==t.partnerId&&null!==t.partnerId&&(this.partnerId=t.partnerId),void 0!==t.customerId&&null!==t.customerId&&(this.customerId=t.customerId))},M.services.protocol.tracker.CustomerKey.prototype={},M.services.protocol.tracker.CustomerKey.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.STRING?this.partnerId=t.$E().value:t.XE(n);break;case 2:n==j.Type.STRING?this.customerId=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.CustomerKey.prototype.write=function(t){t.tw("CustomerKey"),null!==this.partnerId&&void 0!==this.partnerId&&(t.iw("partnerId",j.Type.STRING,1),t.nw(this.partnerId),t.rw()),null!==this.customerId&&void 0!==this.customerId&&(t.iw("customerId",j.Type.STRING,2),t.nw(this.customerId),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerAsQuery=function(t){this.asType=null,this.asn=null,t&&(void 0!==t.asType&&null!==t.asType&&(this.asType=t.asType),void 0!==t.asn&&null!==t.asn&&(this.asn=t.asn))},M.services.protocol.tracker.TrackerAsQuery.prototype={},M.services.protocol.tracker.TrackerAsQuery.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.I32?this.asType=t.zE().value:t.XE(n);break;case 2:n==j.Type.I32?this.asn=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerAsQuery.prototype.write=function(t){t.tw("TrackerAsQuery"),null!==this.asType&&void 0!==this.asType&&(t.iw("asType",j.Type.I32,1),t.sw(this.asType),t.rw()),null!==this.asn&&void 0!==this.asn&&(t.iw("asn",j.Type.I32,2),t.sw(this.asn),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerBitrateQuery=function(t){this.bitrate=null,this.asn=null,this.streamState=null,t&&(void 0!==t.bitrate&&null!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.asn&&null!==t.asn&&(this.asn=t.asn),void 0!==t.streamState&&null!==t.streamState&&(this.streamState=t.streamState))},M.services.protocol.tracker.TrackerBitrateQuery.prototype={},M.services.protocol.tracker.TrackerBitrateQuery.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.I32?this.bitrate=t.zE().value:t.XE(n);break;case 2:n==j.Type.STRUCT?(this.asn=new M.services.protocol.tracker.TrackerAsQuery(),this.asn.read(t)):t.XE(n);break;case 3:n==j.Type.I32?this.streamState=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerBitrateQuery.prototype.write=function(t){t.tw("TrackerBitrateQuery"),null!==this.bitrate&&void 0!==this.bitrate&&(t.iw("bitrate",j.Type.I32,1),t.sw(this.bitrate),t.rw()),null!==this.asn&&void 0!==this.asn&&(t.iw("asn",j.Type.STRUCT,2),this.asn.write(t),t.rw()),null!==this.streamState&&void 0!==this.streamState&&(t.iw("streamState",j.Type.I32,3),t.sw(this.streamState),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerQualityLevelQuery=function(t){this.qualityLevel=null,this.asn=null,this.streamState=null,t&&(void 0!==t.qualityLevel&&null!==t.qualityLevel&&(this.qualityLevel=t.qualityLevel),void 0!==t.asn&&null!==t.asn&&(this.asn=t.asn),void 0!==t.streamState&&null!==t.streamState&&(this.streamState=t.streamState))},M.services.protocol.tracker.TrackerQualityLevelQuery.prototype={},M.services.protocol.tracker.TrackerQualityLevelQuery.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.STRING?this.qualityLevel=t.$E().value:t.XE(n);break;case 2:n==j.Type.STRUCT?(this.asn=new M.services.protocol.tracker.TrackerAsQuery(),this.asn.read(t)):t.XE(n);break;case 3:n==j.Type.I32?this.streamState=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerQualityLevelQuery.prototype.write=function(t){t.tw("TrackerQualityLevelQuery"),null!==this.qualityLevel&&void 0!==this.qualityLevel&&(t.iw("qualityLevel",j.Type.STRING,1),t.nw(this.qualityLevel),t.rw()),null!==this.asn&&void 0!==this.asn&&(t.iw("asn",j.Type.STRUCT,2),this.asn.write(t),t.rw()),null!==this.streamState&&void 0!==this.streamState&&(t.iw("streamState",j.Type.I32,3),t.sw(this.streamState),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerRankQuery=function(t){this.rankType=null,this.asQuery=null,t&&(void 0!==t.rankType&&null!==t.rankType&&(this.rankType=t.rankType),void 0!==t.asQuery&&null!==t.asQuery&&(this.asQuery=t.asQuery))},M.services.protocol.tracker.TrackerRankQuery.prototype={},M.services.protocol.tracker.TrackerRankQuery.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.I32?this.rankType=t.zE().value:t.XE(n);break;case 2:n==j.Type.STRUCT?(this.asQuery=new M.services.protocol.tracker.TrackerAsQuery(),this.asQuery.read(t)):t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerRankQuery.prototype.write=function(t){t.tw("TrackerRankQuery"),null!==this.rankType&&void 0!==this.rankType&&(t.iw("rankType",j.Type.I32,1),t.sw(this.rankType),t.rw()),null!==this.asQuery&&void 0!==this.asQuery&&(t.iw("asQuery",j.Type.STRUCT,2),this.asQuery.write(t),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerQuery=function(t){this.random=null,this.asns=null,this.watchers=null,this.streamers=null,this.rankings=null,this.watchersForQualityLevel=null,this.streamersForQualityLevel=null,t&&(void 0!==t.random&&null!==t.random&&(this.random=t.random),void 0!==t.asns&&null!==t.asns&&(this.asns=t.asns),void 0!==t.watchers&&null!==t.watchers&&(this.watchers=t.watchers),void 0!==t.streamers&&null!==t.streamers&&(this.streamers=t.streamers),void 0!==t.rankings&&null!==t.rankings&&(this.rankings=t.rankings),void 0!==t.watchersForQualityLevel&&null!==t.watchersForQualityLevel&&(this.watchersForQualityLevel=t.watchersForQualityLevel),void 0!==t.streamersForQualityLevel&&null!==t.streamersForQualityLevel&&(this.streamersForQualityLevel=t.streamersForQualityLevel))},M.services.protocol.tracker.TrackerQuery.prototype={},M.services.protocol.tracker.TrackerQuery.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.I32?this.random=t.zE().value:t.XE(n);break;case 2:if(n==j.Type.MAP){var s,e;this.asns={};(e=t.lp()).vp,e.dp,s=e.size;for(var h=0;h<s;++h){0<h&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var o,u=null;(u=new M.services.protocol.tracker.TrackerAsQuery()).read(t),o=t.zE().value,this.asns[u]=o}t.Ep()}else t.XE(n);break;case 3:if(n==j.Type.MAP){var a,f;this.watchers={};(f=t.lp()).vp,f.dp,a=f.size;for(var c=0;c<a;++c){0<c&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var l,v=null;(v=new M.services.protocol.tracker.TrackerBitrateQuery()).read(t),l=t.zE().value,this.watchers[v]=l}t.Ep()}else t.XE(n);break;case 4:if(n==j.Type.MAP){var d,E;this.streamers={};(E=t.lp()).vp,E.dp,d=E.size;for(var w=0;w<d;++w){0<w&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var p,g=null;(g=new M.services.protocol.tracker.TrackerBitrateQuery()).read(t),p=t.zE().value,this.streamers[g]=p}t.Ep()}else t.XE(n);break;case 5:if(n==j.Type.LIST){var b,y;this.rankings=[];(y=t.wp()).pp,b=y.size;for(var T=0;T<b;++T){var O;O=t.zE().value,this.rankings.push(O)}t.gp()}else t.XE(n);break;case 6:if(n==j.Type.MAP){var m,_;this.watchersForQualityLevel={};(_=t.lp()).vp,_.dp,m=_.size;for(var R=0;R<m;++R){0<R&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var S,A=null;(A=new M.services.protocol.tracker.TrackerQualityLevelQuery()).read(t),S=t.zE().value,this.watchersForQualityLevel[A]=S}t.Ep()}else t.XE(n);break;case 7:if(n==j.Type.MAP){var I,N;this.streamersForQualityLevel={};(N=t.lp()).vp,N.dp,I=N.size;for(var C=0;C<I;++C){0<C&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var k,D=null;(D=new M.services.protocol.tracker.TrackerQualityLevelQuery()).read(t),k=t.zE().value,this.streamersForQualityLevel[D]=k}t.Ep()}else t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerQuery.prototype.write=function(t){if(t.tw("TrackerQuery"),null!==this.random&&void 0!==this.random&&(t.iw("random",j.Type.I32,1),t.sw(this.random),t.rw()),null!==this.asns&&void 0!==this.asns){for(var i in t.iw("asns",j.Type.MAP,2),t.Kw(j.Type.STRUCT,j.Type.I32,j.kE(this.asns)),this.asns)if(this.asns.hasOwnProperty(i)){var n=this.asns[i];n.key.write(t),t.sw(n.value)}t.Ww(),t.rw()}if(null!==this.watchers&&void 0!==this.watchers){for(var r in t.iw("watchers",j.Type.MAP,3),t.Kw(j.Type.STRUCT,j.Type.I32,j.kE(this.watchers)),this.watchers)if(this.watchers.hasOwnProperty(r)){var s=this.watchers[r];s.key.write(t),t.sw(s.value)}t.Ww(),t.rw()}if(null!==this.streamers&&void 0!==this.streamers){for(var e in t.iw("streamers",j.Type.MAP,4),t.Kw(j.Type.STRUCT,j.Type.I32,j.kE(this.streamers)),this.streamers)if(this.streamers.hasOwnProperty(e)){var h=this.streamers[e];h.key.write(t),t.sw(h.value)}t.Ww(),t.rw()}if(null!==this.rankings&&void 0!==this.rankings){for(var o in t.iw("rankings",j.Type.LIST,5),t.$w(j.Type.I32,this.rankings.length),this.rankings)this.rankings.hasOwnProperty(o)&&(o=this.rankings[o],t.sw(o));t.Xw(),t.rw()}if(null!==this.watchersForQualityLevel&&void 0!==this.watchersForQualityLevel){for(var u in t.iw("watchersForQualityLevel",j.Type.MAP,6),t.Kw(j.Type.STRUCT,j.Type.I32,j.kE(this.watchersForQualityLevel)),this.watchersForQualityLevel)if(this.watchersForQualityLevel.hasOwnProperty(u)){var a=this.watchersForQualityLevel[u];a.key.write(t),t.sw(a.value)}t.Ww(),t.rw()}if(null!==this.streamersForQualityLevel&&void 0!==this.streamersForQualityLevel){for(var f in t.iw("streamersForQualityLevel",j.Type.MAP,7),t.Kw(j.Type.STRUCT,j.Type.I32,j.kE(this.streamersForQualityLevel)),this.streamersForQualityLevel)if(this.streamersForQualityLevel.hasOwnProperty(f)){var c=this.streamersForQualityLevel[f];c.key.write(t),t.sw(c.value)}t.Ww(),t.rw()}t.ew(),t.hw()},M.services.protocol.tracker.TrackerPeerRankingKey=function(t){this.rankType=null,this.internalAs=null,this.externalAs=null,t&&(void 0!==t.rankType&&null!==t.rankType&&(this.rankType=t.rankType),void 0!==t.internalAs&&null!==t.internalAs&&(this.internalAs=t.internalAs),void 0!==t.externalAs&&null!==t.externalAs&&(this.externalAs=t.externalAs))},M.services.protocol.tracker.TrackerPeerRankingKey.prototype={},M.services.protocol.tracker.TrackerPeerRankingKey.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.I32?this.rankType=t.zE().value:t.XE(n);break;case 2:n==j.Type.I32?this.internalAs=t.zE().value:t.XE(n);break;case 3:n==j.Type.I32?this.externalAs=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerPeerRankingKey.prototype.write=function(t){t.tw("TrackerPeerRankingKey"),null!==this.rankType&&void 0!==this.rankType&&(t.iw("rankType",j.Type.I32,1),t.sw(this.rankType),t.rw()),null!==this.internalAs&&void 0!==this.internalAs&&(t.iw("internalAs",j.Type.I32,2),t.sw(this.internalAs),t.rw()),null!==this.externalAs&&void 0!==this.externalAs&&(t.iw("externalAs",j.Type.I32,3),t.sw(this.externalAs),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerPeerRanking=function(t){this.key=null,this.ranking=null,this.groupSize=null,this.cumulatedRankValue=null,this.totalOfRankValues=null,t&&(void 0!==t.key&&null!==t.key&&(this.key=t.key),void 0!==t.ranking&&null!==t.ranking&&(this.ranking=t.ranking),void 0!==t.groupSize&&null!==t.groupSize&&(this.groupSize=t.groupSize),void 0!==t.cumulatedRankValue&&null!==t.cumulatedRankValue&&(this.cumulatedRankValue=t.cumulatedRankValue),void 0!==t.totalOfRankValues&&null!==t.totalOfRankValues&&(this.totalOfRankValues=t.totalOfRankValues))},M.services.protocol.tracker.TrackerPeerRanking.prototype={},M.services.protocol.tracker.TrackerPeerRanking.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.STRUCT?(this.key=new M.services.protocol.tracker.TrackerPeerRankingKey(),this.key.read(t)):t.XE(n);break;case 2:n==j.Type.I32?this.ranking=t.zE().value:t.XE(n);break;case 3:n==j.Type.I32?this.groupSize=t.zE().value:t.XE(n);break;case 4:n==j.Type.DOUBLE?this.cumulatedRankValue=t.Rp().value:t.XE(n);break;case 5:n==j.Type.DOUBLE?this.totalOfRankValues=t.Rp().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerPeerRanking.prototype.write=function(t){t.tw("TrackerPeerRanking"),null!==this.key&&void 0!==this.key&&(t.iw("key",j.Type.STRUCT,1),this.key.write(t),t.rw()),null!==this.ranking&&void 0!==this.ranking&&(t.iw("ranking",j.Type.I32,2),t.sw(this.ranking),t.rw()),null!==this.groupSize&&void 0!==this.groupSize&&(t.iw("groupSize",j.Type.I32,3),t.sw(this.groupSize),t.rw()),null!==this.cumulatedRankValue&&void 0!==this.cumulatedRankValue&&(t.iw("cumulatedRankValue",j.Type.DOUBLE,4),t.sp(this.cumulatedRankValue),t.rw()),null!==this.totalOfRankValues&&void 0!==this.totalOfRankValues&&(t.iw("totalOfRankValues",j.Type.DOUBLE,5),t.sp(this.totalOfRankValues),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerRequest=function(t){this.info=null,this.contentId=null,this.query=null,this.streamType=null,this.sessionId=null,this.customerKey=null,t&&(void 0!==t.info&&null!==t.info&&(this.info=t.info),void 0!==t.contentId&&null!==t.contentId&&(this.contentId=t.contentId),void 0!==t.query&&null!==t.query&&(this.query=t.query),void 0!==t.streamType&&null!==t.streamType&&(this.streamType=t.streamType),void 0!==t.sessionId&&null!==t.sessionId&&(this.sessionId=t.sessionId),void 0!==t.customerKey&&null!==t.customerKey&&(this.customerKey=t.customerKey))},M.services.protocol.tracker.TrackerRequest.prototype={},M.services.protocol.tracker.TrackerRequest.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.STRUCT?(this.info=new M.services.protocol.tracker.TrackerPeerInfo(),this.info.read(t)):t.XE(n);break;case 2:n==j.Type.STRING?this.contentId=t.$E().value:t.XE(n);break;case 3:n==j.Type.STRUCT?(this.query=new M.services.protocol.tracker.TrackerQuery(),this.query.read(t)):t.XE(n);break;case 4:n==j.Type.I32?this.streamType=t.zE().value:t.XE(n);break;case 5:n==j.Type.STRING?this.sessionId=t.$E().value:t.XE(n);break;case 6:n==j.Type.STRUCT?(this.customerKey=new M.services.protocol.tracker.CustomerKey(),this.customerKey.read(t)):t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerRequest.prototype.write=function(t){t.tw("TrackerRequest"),null!==this.info&&void 0!==this.info&&(t.iw("info",j.Type.STRUCT,1),this.info.write(t),t.rw()),null!==this.contentId&&void 0!==this.contentId&&(t.iw("contentId",j.Type.STRING,2),t.nw(this.contentId),t.rw()),null!==this.query&&void 0!==this.query&&(t.iw("query",j.Type.STRUCT,3),this.query.write(t),t.rw()),null!==this.streamType&&void 0!==this.streamType&&(t.iw("streamType",j.Type.I32,4),t.sw(this.streamType),t.rw()),null!==this.sessionId&&void 0!==this.sessionId&&(t.iw("sessionId",j.Type.STRING,5),t.nw(this.sessionId),t.rw()),null!==this.customerKey&&void 0!==this.customerKey&&(t.iw("customerKey",j.Type.STRUCT,6),this.customerKey.write(t),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerResponse=function(t){this.infos=null,this.rankings=null,this.peerInfo=null,this.sessionId=null,t&&(void 0!==t.infos&&null!==t.infos&&(this.infos=t.infos),void 0!==t.rankings&&null!==t.rankings&&(this.rankings=t.rankings),void 0!==t.peerInfo&&null!==t.peerInfo&&(this.peerInfo=t.peerInfo),void 0!==t.sessionId&&null!==t.sessionId&&(this.sessionId=t.sessionId))},M.services.protocol.tracker.TrackerResponse.prototype={},M.services.protocol.tracker.TrackerResponse.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:if(n==j.Type.LIST){var s,e;this.infos=[];(e=t.wp()).pp,s=e.size;for(var h=0;h<s;++h){var o=null;(o=new M.services.protocol.tracker.TrackerPeerInfo()).read(t),this.infos.push(o)}t.gp()}else t.XE(n);break;case 2:if(n==j.Type.LIST){var u,a;this.rankings=[];(a=t.wp()).pp,u=a.size;for(var f=0;f<u;++f){var c=null;(c=new M.services.protocol.tracker.TrackerPeerRanking()).read(t),this.rankings.push(c)}t.gp()}else t.XE(n);break;case 3:n==j.Type.STRUCT?(this.peerInfo=new M.services.protocol.tracker.TrackerPeerInfo(),this.peerInfo.read(t)):t.XE(n);break;case 4:n==j.Type.STRING?this.sessionId=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerResponse.prototype.write=function(t){if(t.tw("TrackerResponse"),null!==this.infos&&void 0!==this.infos){for(var i in t.iw("infos",j.Type.LIST,1),t.$w(j.Type.STRUCT,this.infos.length),this.infos)this.infos.hasOwnProperty(i)&&(i=this.infos[i]).write(t);t.Xw(),t.rw()}if(null!==this.rankings&&void 0!==this.rankings){for(var n in t.iw("rankings",j.Type.LIST,2),t.$w(j.Type.STRUCT,this.rankings.length),this.rankings)this.rankings.hasOwnProperty(n)&&(n=this.rankings[n]).write(t);t.Xw(),t.rw()}null!==this.peerInfo&&void 0!==this.peerInfo&&(t.iw("peerInfo",j.Type.STRUCT,3),this.peerInfo.write(t),t.rw()),null!==this.sessionId&&void 0!==this.sessionId&&(t.iw("sessionId",j.Type.STRING,4),t.nw(this.sessionId),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerStoreIndexKey=function(t){this.timestamp=null,this.contentId=null,this.asType=null,this.asn=null,this.bitrate=null,this.streamState=null,this.rankType=null,this.qualityLevel=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.contentId&&null!==t.contentId&&(this.contentId=t.contentId),void 0!==t.asType&&null!==t.asType&&(this.asType=t.asType),void 0!==t.asn&&null!==t.asn&&(this.asn=t.asn),void 0!==t.bitrate&&null!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.streamState&&null!==t.streamState&&(this.streamState=t.streamState),void 0!==t.rankType&&null!==t.rankType&&(this.rankType=t.rankType),void 0!==t.qualityLevel&&null!==t.qualityLevel&&(this.qualityLevel=t.qualityLevel))},M.services.protocol.tracker.TrackerStoreIndexKey.prototype={},M.services.protocol.tracker.TrackerStoreIndexKey.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.I32?this.timestamp=t.zE().value:t.XE(n);break;case 2:n==j.Type.STRING?this.contentId=t.$E().value:t.XE(n);break;case 3:n==j.Type.I32?this.asType=t.zE().value:t.XE(n);break;case 4:n==j.Type.I32?this.asn=t.zE().value:t.XE(n);break;case 5:n==j.Type.I32?this.bitrate=t.zE().value:t.XE(n);break;case 6:n==j.Type.I32?this.streamState=t.zE().value:t.XE(n);break;case 7:n==j.Type.I32?this.rankType=t.zE().value:t.XE(n);break;case 8:n==j.Type.STRING?this.qualityLevel=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerStoreIndexKey.prototype.write=function(t){t.tw("TrackerStoreIndexKey"),null!==this.timestamp&&void 0!==this.timestamp&&(t.iw("timestamp",j.Type.I32,1),t.sw(this.timestamp),t.rw()),null!==this.contentId&&void 0!==this.contentId&&(t.iw("contentId",j.Type.STRING,2),t.nw(this.contentId),t.rw()),null!==this.asType&&void 0!==this.asType&&(t.iw("asType",j.Type.I32,3),t.sw(this.asType),t.rw()),null!==this.asn&&void 0!==this.asn&&(t.iw("asn",j.Type.I32,4),t.sw(this.asn),t.rw()),null!==this.bitrate&&void 0!==this.bitrate&&(t.iw("bitrate",j.Type.I32,5),t.sw(this.bitrate),t.rw()),null!==this.streamState&&void 0!==this.streamState&&(t.iw("streamState",j.Type.I32,6),t.sw(this.streamState),t.rw()),null!==this.rankType&&void 0!==this.rankType&&(t.iw("rankType",j.Type.I32,7),t.sw(this.rankType),t.rw()),null!==this.qualityLevel&&void 0!==this.qualityLevel&&(t.iw("qualityLevel",j.Type.STRING,8),t.nw(this.qualityLevel),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerStoreRankPeer=function(t){this.guid=null,this.rank=null,this.key=null,t&&(void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.rank&&null!==t.rank&&(this.rank=t.rank),void 0!==t.key&&null!==t.key&&(this.key=t.key))},M.services.protocol.tracker.TrackerStoreRankPeer.prototype={},M.services.protocol.tracker.TrackerStoreRankPeer.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.STRING?this.guid=t.Sp().value:t.XE(n);break;case 2:n==j.Type.DOUBLE?this.rank=t.Rp().value:t.XE(n);break;case 3:n==j.Type.STRUCT?(this.key=new M.services.protocol.tracker.TrackerPeerRankingKey(),this.key.read(t)):t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerStoreRankPeer.prototype.write=function(t){t.tw("TrackerStoreRankPeer"),null!==this.guid&&void 0!==this.guid&&(t.iw("guid",j.Type.STRING,1),t.ep(this.guid),t.rw()),null!==this.rank&&void 0!==this.rank&&(t.iw("rank",j.Type.DOUBLE,2),t.sp(this.rank),t.rw()),null!==this.key&&void 0!==this.key&&(t.iw("key",j.Type.STRUCT,3),this.key.write(t),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerRequestQueueKey=function(t){this.guid=null,this.contentId=null,this.partner=null,this.customer=null,t&&(void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.contentId&&null!==t.contentId&&(this.contentId=t.contentId),void 0!==t.partner&&null!==t.partner&&(this.partner=t.partner),void 0!==t.customer&&null!==t.customer&&(this.customer=t.customer))},M.services.protocol.tracker.TrackerRequestQueueKey.prototype={},M.services.protocol.tracker.TrackerRequestQueueKey.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.STRING?this.guid=t.Sp().value:t.XE(n);break;case 2:n==j.Type.STRING?this.contentId=t.$E().value:t.XE(n);break;case 3:n==j.Type.STRING?this.partner=t.$E().value:t.XE(n);break;case 4:n==j.Type.STRING?this.customer=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerRequestQueueKey.prototype.write=function(t){t.tw("TrackerRequestQueueKey"),null!==this.guid&&void 0!==this.guid&&(t.iw("guid",j.Type.STRING,1),t.ep(this.guid),t.rw()),null!==this.contentId&&void 0!==this.contentId&&(t.iw("contentId",j.Type.STRING,2),t.nw(this.contentId),t.rw()),null!==this.partner&&void 0!==this.partner&&(t.iw("partner",j.Type.STRING,3),t.nw(this.partner),t.rw()),null!==this.customer&&void 0!==this.customer&&(t.iw("customer",j.Type.STRING,4),t.nw(this.customer),t.rw()),t.ew(),t.hw()},M.services.protocol.tracker.TrackerRequestQueueMessage=function(t){this.timestamp=null,this.request=null,this.response=null,this.guid=null,this.contentId=null,this.partner=null,this.customer=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.request&&null!==t.request&&(this.request=t.request),void 0!==t.response&&null!==t.response&&(this.response=t.response),void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.contentId&&null!==t.contentId&&(this.contentId=t.contentId),void 0!==t.partner&&null!==t.partner&&(this.partner=t.partner),void 0!==t.customer&&null!==t.customer&&(this.customer=t.customer))},M.services.protocol.tracker.TrackerRequestQueueMessage.prototype={},M.services.protocol.tracker.TrackerRequestQueueMessage.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==j.Type.STOP)break;switch(r){case 1:n==j.Type.I64?this.timestamp=t._p().value:t.XE(n);break;case 2:n==j.Type.STRUCT?(this.request=new M.services.protocol.tracker.TrackerRequest(),this.request.read(t)):t.XE(n);break;case 3:n==j.Type.STRUCT?(this.response=new M.services.protocol.tracker.TrackerResponse(),this.response.read(t)):t.XE(n);break;case 4:n==j.Type.STRING?this.guid=t.Sp().value:t.XE(n);break;case 5:n==j.Type.STRING?this.contentId=t.$E().value:t.XE(n);break;case 6:n==j.Type.STRING?this.partner=t.$E().value:t.XE(n);break;case 7:n==j.Type.STRING?this.customer=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},M.services.protocol.tracker.TrackerRequestQueueMessage.prototype.write=function(t){t.tw("TrackerRequestQueueMessage"),null!==this.timestamp&&void 0!==this.timestamp&&(t.iw("timestamp",j.Type.I64,1),t.rp(this.timestamp),t.rw()),null!==this.request&&void 0!==this.request&&(t.iw("request",j.Type.STRUCT,2),this.request.write(t),t.rw()),null!==this.response&&void 0!==this.response&&(t.iw("response",j.Type.STRUCT,3),this.response.write(t),t.rw()),null!==this.guid&&void 0!==this.guid&&(t.iw("guid",j.Type.STRING,4),t.ep(this.guid),t.rw()),null!==this.contentId&&void 0!==this.contentId&&(t.iw("contentId",j.Type.STRING,5),t.nw(this.contentId),t.rw()),null!==this.partner&&void 0!==this.partner&&(t.iw("partner",j.Type.STRING,6),t.nw(this.partner),t.rw()),null!==this.customer&&void 0!==this.customer&&(t.iw("customer",j.Type.STRING,7),t.nw(this.customer),t.rw()),t.ew(),t.hw()}},function(t,i,o){"use strict";Object.defineProperty(i,"s",{value:!0});var h=o(55),v=o(4),u=o(3),n=o(123);i.uR=n.uR;var a=o(0),f=o(20);i.Options=f.Options,i.UrlConfigurableOptions=f.UrlConfigurableOptions;var c=o(125);i.TechName=c.TechName;var d=o(28);i.HiveSession=d.HiveSession,i.HivePluginReference=d.HivePluginReference,i.HiveSessionError=d.HiveSessionError,i.HiveSessionErrorCode=d.HiveSessionErrorCode,i.MainStatusCode=d.MainStatusCode;var l=o(43),r=o(46);i.HiveRequestFactory=r.HiveRequestFactory;var s=o(127),E=o(75),w=o(128),e=o(129),p=o(47);i.HiveSessionInternal=p.HiveSessionInternal;var g=o(15);i.BasicUtils=g;var b=o(15),y=o(130),T=o(29);i.PlayerEvents=T.PlayerEvents;var O=o(134),m=o(136),_=o(92);i.StatsJS=_.StatsJS;var R=o(61),S=o(1),A=o(2),I=o(62);i.Ticket=I.Ticket;var N=o(44),C=o(14),k=o(32);i.aR=k.aR;var D=o(8);i.Y=D.Y;var j=o(175);i.fR=j.fR;var M,P,L=o(6),H=D.Y.Wa,U=D.Y.Ka,F=D.Y.Ya;F&&o(13).HiveConfig,(P=M=M||{}).HTML5="html5",P.NATIVE="native_hls",P.FLASH="flash",i.cR=M;var G=(x.prototype.options=function(){return this.options_},x.prototype.logger=function(){return this.activeSession?this.logger_.log(this.activeSession.id):this.logger_.log()},x.prototype.loggerLevel=function(t){if("string"==typeof t&&this.logger_.lR(t),this.logger)return this.logger_.level},x.prototype.getPluginId=function(){return this.pluginId},x.prototype.getPluginId4Java=function(){return this.pluginId4Java},x.prototype.getCoreVersion=function(){return H},x.prototype.updateCommsForInitSessions=function(){for(var t=0,i=this.initializedSessions;t<i.length;t++){var n=i[t];n.tech.setPlugin(this),"HiveJS"===n.tech.getName()&&n.tech.vR&&n.tech.vR.setPlugin(this)}},x.prototype.validateHiveTechs=function(t){var i=new _.StatsJS(this,t);if(this.hiveTechs.set(_.StatsJS.dR,i),F){var n=o(176).HiveJS;this.hiveTechs.set(n.dR,new n(this,t,i))}if(U){var r=o(241).HiveJava;this.hiveTechs.set(r.dR,new r(this,t))}var s=t.hiveTechOrder;if(!s||s instanceof Array)if(s&&0<s.length)for(var e=s.length;e--;){var h=s[e];"string"!=typeof h||-1==this.defaultHiveTechOrder.indexOf(h)?(!1,s.splice(e,1)):"string"==typeof h&&this.hiveTechs.has(h)||!1}else s=this.defaultHiveTechOrder;else!1,s=this.defaultHiveTechOrder;t.hiveTechOrder=s},x.prototype.resolveTicketPromise=function(r){var s=this;this.logger().notice(this.loggerId+"resolving "+r);var i=v.defer();if(!r)return i.reject(d.HiveSessionError.getHiveSessionError("",d.HiveSessionErrorCode.TICKET_ERROR,"No ticket provided.")),i.promise;this.extractErrorMonitorTags(r);var t=this.getOrderedTechs().values();0==t.length&&(S.ErrorMonitor.getInstance().logError("Error initializing all Techs",this.loggerId,A.ie.se),i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.NO_TECH_AVAILABLE)));var e,h,o=!1,u=!1,a=0,f=null;return b.Nc(function(){return!o&&!u&&a<t.length&&!e},function(){var n=t[a++];return n.resetTech(),(n.needsReportingInstance()&&!h?s.verifyTicket(r,s.options().testId):v.resolve(null)).then(function(t){null!=t&&(h=t).Fl(s.options().reportingThreshold);var i=n.getInitSessionTimeout();return n.initSession(r,h).timeout(i,"["+n.getName()+"] Error: initialization timed out after "+i+"ms").then(function(t){f=t,s.onInitializeSession(f,n),o=!0,!n.needsReportingInstance()&&h&&h.ql.reset(),S.ErrorMonitor.getInstance().rt({sessionId:f.id}),t.notifyStateChange(p.ER.INITIALIZED),s.logger().notice(s.loggerId+"initializing Session:["+f.id+"] Ticket:"+f.ticket.toString()+" HiveTech:["+f.tech.getName()+"]"),v.resolve(!0)},function(t){t instanceof Error&&(t=new d.HiveTechError(d.wR.TIMEOUT_ERROR,t.message),n.onTechTimeout(t)),t.ticketUrl=r,u=!n.onError(t),s.logger().debug(s.loggerId+"tech "+n.getName()+": "+t.message),v.resolve(!0)})},function(t){e=t,v.resolve(!0)})}).then(function(){e?i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.TICKET_ERROR,e)):u?i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.TECH_ERROR)):o?i.resolve(f):(S.ErrorMonitor.getInstance().logError("Error initializing all Techs",s.loggerId,A.ie.se),i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.NO_TECH_AVAILABLE)))})["catch"](function(t){S.ErrorMonitor.getInstance().logError("Error resolving ticket promise",s.loggerId,A.ie.re,t),i.reject(d.HiveSessionError.getHiveSessionError(r,d.HiveSessionErrorCode.GENERIC_ERROR,t.toString()))}).done(),i.promise},x.prototype.authenticate=function(f){var c=this,t=D.Y["if"]?C.Rc.lc:C.Rc.vc;if(!this.validateTokens(f))return v.reject({code:"Init Error",reason:JSON.stringify({code:"C_INVALID_DATA",description:"There are missing data in among the videoId, JWT or manifest lists"})});var l=new Date().getTime();return b.Dc(t,JSON.stringify(f)).then(function(t){var i=Date.now();c.logger().warn("[Timing] Authentication request to service",i-l);var u=JSON.parse(t);c.logger().debug("Response: ",u),c.options().hiveTechOrder=u.techs;var n=v.defer(),r=c.getOrderedTechs().values(),a=!1,s=0,e=[];return b.Nc(function(){return 0<e.length?(n.resolve(e),!1):!a&&s<r.length||(S.ErrorMonitor.getInstance().logError("Error initializing all Techs",c.loggerId,A.ie.se),n.reject({code:"Init Error",reason:JSON.stringify({code:"C_"+d.HiveSessionErrorCode[d.HiveSessionErrorCode.NO_TECH_AVAILABLE],description:"No Tech successfully initialized"})}),!1)},function(){var o=r[s++];return o.resetTech(),v.allSettled(u.validated.map(function(t){var h=t.videoId;if(0===f.filter(function(t){return t.videoId===h}).length)return S.ErrorMonitor.getInstance().logError("No Token found for the specific videoId",c.loggerId,A.ie.ee,{videoId:h}),v.reject(!1);var i=t.manifests;return c.logger().debug("Manifests: ",i),v.allSettled(i.map(function(r){var t,i=o.getInitSessionTimeout(),s=Date.now();if(o.needsReportingInstance()){var n=I.Ticket.pR(u.partnerId,u.customerId,u.validated[0].videoId);n.gR(r.uri),n.bR=l,n.yR=new Date().getTime(),t=R["default"].getInstance().initSession(c.pluginId,n,!1,"",u.connectionEndpoint)}else t=v.resolve(null);var e=Date.now();return t.then(function(n){var t=Date.now();return c.logger().warn("[Timing] Init RI for "+o.getName(),t-s),n&&c.updatePlayerInfo(n),o.initSession(u.ticketEndpoint+"/"+r.jwt,n).timeout(i).then(function(t){c.onInitializeSession(t,o),a=!0,"HiveJava"===o.getName()&&t.ticket.TR(u.partnerId,u.customerId,h),!o.needsReportingInstance()&&n&&n.ql.reset(),S.ErrorMonitor.getInstance().rt({sessionId:t.id}),c.logger().notice(c.loggerId+"initializing Session:["+t.id+"] Ticket:"+t.ticket.toString()+" HiveTech:["+t.tech.getName()+"]"),t.ticket.originalManifest=r.uri;var i=Date.now();return c.logger().warn("[Timing] Init Tech Successful for "+o.getName(),i-e),t})}).fail(function(t){return t=c.handleTechError(t,o,e),v.reject(t)})})).then(function(t){return c.extractResolved(t,!1)})})).then(function(t){var i=c.extractResolved(t,[],!1);i instanceof Array&&(e=i)})}).done(),n.promise}).fail(function(t){return c.logger().debug("Authentication Failed",t),v.reject(t)})},x.prototype.handleTechError=function(t,i,n){this.logger().debug(this.loggerId+" init Session failed:",t.message),t instanceof Error&&(t=new d.HiveTechError(d.wR.TIMEOUT_ERROR,t.message),i.onTechTimeout(t)),this.logger().debug(this.loggerId+"tech "+i.getName()+": "+t.message);var r=Date.now();return this.logger().warn("[Timing] Init Tech Failed for "+i.getName(),r-n),t},x.prototype.validateTokens=function(t){return 0!==t.length&&t.every(function(t,i,n){return t.jwt&&t.videoId&&0<t.manifests.length})},x.prototype.extractResolved=function(t,i,n){void 0===n&&(n=!0);for(var r=[],s=0,e=t;s<e.length;s++){var h=e[s];"fulfilled"===h.state&&(n?r.push(h.value):r=r.concat(h.value))}return 0<r.length?r:v.reject(i)},x.prototype.verifyTicket=function(i,t){var n=this;return R["default"].getInstance().initSession(this.pluginId,i,!1,t).then(function(t){return n.logger().debug(n.loggerId+"verified ticket "+i),n.updatePlayerInfo(t),t})["catch"](function(t){return v.reject("Ticket not verified, error: "+t.message)})},x.prototype.getOrderedTechs=function(){for(var t=JSON.parse(JSON.stringify(this.options().hiveTechOrder)),i=new u(),n=0,r=t;n<r.length;n++){var s=r[n];this.hiveTechs.has(s)&&i.set(s,this.hiveTechs.get(s))}return i},x.prototype.extractErrorMonitorTags=function(t){var i=S.ErrorMonitor.getInstance();try{var n=I.Ticket.OR(t);n.mR()&&n._R()&&n.RR()?i.setTags([n.mR(),n._R(),n.RR()]):i.logError("Ticket not valid, we could not resolve the triple partnerId/CustomerId/ContentId",this.loggerId,A.ie.he,{partnerId:n.mR(),customerId:n._R(),contentId:n.RR()})}catch(t){this.logger().warn(this.loggerId+" "+t.message,t),i.notify(t)}},x.prototype.updatePlayerInfo=function(t){var i={commVersion:H,pluginName:this.getPluginName(),pluginVersion:this.getPluginVersion(),playerTech:this.getPlayerTech(),playerVersion:this.getPlayerVersion(),telemetryId:this.getTelemetryId()};t.ql.updatePlayerInfo(i)},x.prototype.addTechEvent=function(t){this.activeSession&&this.activeSession.tech?(t.sessionId=this.activeSession.id,this.activeSession.tech.handleTechEvent(this.activeSession,t)):this.techEvents.push(t)},x.prototype.flushTechEvents=function(){var t=this.techEvents;return this.techEvents=new Array(),t},x.prototype.beforeUnloadClose=function(){this.destroyHivePlugin(!1)},x.prototype.registerCloseSession=function(){var t=window;this.beforeUnloadClose=this.beforeUnloadClose.bind(this),t.addEventListener?t.addEventListener("beforeunload",this.beforeUnloadClose,!1):t.attachEvent("onbeforeunload",this.beforeUnloadClose)},x.prototype.unRegisterCloseSession=function(){var t=window;t.removeEventListener?t.removeEventListener("beforeunload",this.beforeUnloadClose,!1):t.detachEvent("onbeforeunload",this.beforeUnloadClose)},x.prototype.closeHiveSession=function(t,i){void 0===i&&(i=!0),this.logger().debug("Manually Closing Session"+(t?" because: "+t:"")),this.eventBinder.SR(),r.HiveRequestFactory.clearPluginState(this.pluginId),this.resetSession(!0,i)},x.prototype.destroyHivePlugin=function(t){return void 0===t&&(t=!0),this.unRegisterCloseSession(),this.eventBinder.SR(!0),this.closeHiveSession("Invoked Plugin Destroy",t),e.VisibilityChangeListener.getInstance(this.logger()).cleanListeners(),a.Framework.P(),this.options_.onLoadingCompleted=null,this.options_.onSourceSetCompleted=null,this.options_.onActiveSession=null,this.options_.onError=null,S.ErrorMonitor.getInstance().ot(),a.Framework._},x.prototype.resetSession=function(t,i){var n=this;void 0===i&&(i=!0),this.onCloseSession(t,i),!1===t?this.activeSession&&this.initializedSessions.every(function(t){return t.id!==n.activeSession.id})&&this.initializedSessions.unshift(this.activeSession):this.initializedSessions.length=0,this.stopPeriodicFeedback(),this.activeSession=null,this.lastEvent=null,this.totalBufferingTime=0,this.lastBufferingStart=0},x.prototype.onInitializeSession=function(t,i){t.tech=i,this.initializedSessions.push(t)},x.prototype.onActivateSession=function(t,i){var n=this;if(void 0===i&&(i=!1),null==this.activeSession){for(var r=t||this.getPlayerSource(),s=0;s<this.initializedSessions.length;s++){var e=this.initializedSessions[s];if(e.isActive(r,i)){if(this.activeSession=e,this.activeSession.reportingInstance?this.activeSession.reportingInstance.kl.AR(this.activeSession.ticket):this.resetInitializedSessions(),this.activeSession.tech.onActiveSession(this.activeSession),this.activeSession.notifyStateChange(p.ER.ACTIVE),this.logger().notice(this.loggerId+"activating Session:["+this.activeSession.id+"] Ticket:"+this.activeSession.ticket.toString()+" HiveTech:["+this.activeSession.tech.getName()+"]"),this.options().onActiveSession)try{this.options().onActiveSession(e.toHiveSession())}catch(t){S.ErrorMonitor.getInstance().logError(this.loggerId+" exception in user-defined Generic onActiveSession callback: "+t,this.loggerId,A.ie.oe)}break}}if(this.activeSession)return this.initializedSessions.forEach(function(t){t!=n.activeSession&&t.getReportingInstance().then(function(t){return t.Yl()})}),!(this.initializedSessions.length=0);S.ErrorMonitor.getInstance().logError("No matching session found",this.loggerId,A.ie.ne,{playerSource:r,initializedSessions:this.initializedSessions.map(function(t){return t.manifest})}),this.resetSession()}return!1},x.prototype.getActiveSession=function(){if(this.activeSession)return this.activeSession.toHiveSession()},x.prototype.resetInitializedSessions=function(){this.initializedSessions.forEach(function(t){t.reportingInstance&&t.close(!0)})},x.prototype.isSessionActive=function(){if(null!=this.activeSession){if(this.activeSession.isActive(this.getPlayerSource()))return!0;var t="Session src mismatch: "+this.getPlayerSource()+" != "+this.activeSession.manifest;this.logger().warn(this.loggerId+t),this.closeHiveSession(t)}return!1},x.prototype.onCloseSession=function(i,n){var r=this;void 0===i&&(i=!1),void 0===n&&(n=!0),null!=this.activeSession?(this.logger().notice(this.loggerId+"Stopping session ["+this.activeSession.id+"]"),this.activeSession.close(i,n)):0<this.initializedSessions.length?this.initializedSessions.forEach(function(t){r.logger().notice(r.loggerId+"Attempt to stopping session ["+t.id+"]"),t.close(i,n)}):R["default"].getInstance().close()},x.prototype.startPeriodicFeedback=function(){var t=this;null==this.periodicFeedbackEvent&&(this.periodicFeedbackEvent=setInterval(function(){t.sendStatsFeedback(!0)},this.options().feedbackPeriod),this.sendStatsFeedback())},x.prototype.stopPeriodicFeedback=function(){clearInterval(this.periodicFeedbackEvent),this.periodicFeedbackEvent=null},x.prototype.getPlayingTime=function(t){return void 0===t&&(t=!1),this.playingStateCounter.Qu(void 0,t?this.options().feedbackPeriod:void 0)},x.prototype.sendStatsFeedback=function(t){var i=this;if(void 0===t&&(t=!1),this.isSessionActive()){if(!this.isActive())return void this.resetSession();var n=this.getWindowSize(),r=new s.HivePlayerStats(this.getCurrentTime(),this.getBufferLen(),this.totalBufferingTime,n.width,n.height,this.isFullscreen(),this.getPlayingTime(t));this.activeSession.updateIdleState(this.statsChecker.check(r)),this.activeSession.tech.handleStats(this.activeSession,r).fail(function(t){i.logger().warn(i.loggerId+"stats handling failed",t),i.stopPeriodicFeedback()})}},x.prototype.registerGenericEvents=function(){var n=this;try{e.VisibilityChangeListener.getInstance(this.logger()).setVisibilityChangeListener(function(t){var i=n.getPotentialSession();i&&!i.isIdle()&&(n.onEventFeedback(t?T.PlayerEvents.VISIBLE:T.PlayerEvents.HIDDEN),n.logger().debug(t?"visible":"hidden"))})}catch(t){S.ErrorMonitor.getInstance().logError("error setting up the visibilityChange listener",this.loggerId,A.ie.ue,{error:t})}},x.prototype.onStartBuffering=function(t,i){void 0===i&&(i=!1),(i||this.isSessionActive())&&this.lastBufferingStart<=0&&(this.lastBufferingStart=Date.now(),null!=t&&!t||this.onEventFeedback(T.PlayerEvents.BUFFERING))},x.prototype.onEndBuffering=function(){var t=0==this.totalBufferingTime;if(0<this.lastBufferingStart){var i=Date.now()-this.lastBufferingStart;return this.totalBufferingTime+=i,this.logger().debug(this.loggerId+"reporting new buffering event of "+i),this.lastBufferingStart=0,t&&this.sendStatsFeedback(),!0}return!1},x.prototype.onError=function(t,i,n){void 0===n&&(n=!0),this.onEventFeedback(T.PlayerEvents.ERROR,{code:-1,"player-code":t}),n&&this.closeHiveSession(i)},x.prototype.onEventFeedback=function(t,i){var n=this,r=this.getPotentialSession();if(null!=r&&(r==this.activeSession||r.tech.getName()!==c.IR[c.IR.HiveJava])){switch(t){case T.PlayerEvents.PLAYING:this.playingStateCounter.start();break;case T.PlayerEvents.PAUSED:case T.PlayerEvents.SKIP:case T.PlayerEvents.BUFFERING:case T.PlayerEvents.STOPPED:this.playingStateCounter.stop()}r.tech.handleEvent(r,t,i).fail(function(t){n.logger().warn(n.loggerId+"error in forwarding player event to tech",t)})}},x.prototype.filterEvent=function(t,i){t!==this.lastEvent&&this.onEventFeedback(t,i),this.lastEvent=t},x.prototype.getPotentialSession=function(){return this.activeSession?this.activeSession:this.initializedSessions&&0<this.initializedSessions.length?this.initializedSessions[0]:void 0},x.prototype.initStatusCode=function(){this.statusCode=0},x.prototype.setStatusCode=function(t,i){this.initStatusCode(),this.statusCode+=t<<28,i&&0===t&&(this.statusCode+=1<<4*(6-c.IR[i.getName()])),0<t&&S.ErrorMonitor.getInstance().logError("Status Code Error",this.loggerId,A.ie.ae,{code:d.NR(t)},["Plugin Error Code",d.NR(t)])},x.prototype.getStatusCode=function(){return this.statusCode},x.prototype.getTelemetryId=function(){return this.options().telemetryId},x.prototype.getPluginName=function(){return D.Y.$a},x.prototype.getPluginVersion=function(){return D.Y.za},x);function x(t){this.defaultHiveTechOrder=[c.IR[c.IR.HiveJava],c.IR[c.IR.HiveJS],c.IR[c.IR.StatsJS]],this.hiveTechs=new u(),this.techEvents=new Array(),this.initializedSessions=new Array(),this.activeSession=null,this.totalBufferingTime=0,this.lastBufferingStart=0,this.loggerId="[HiveComm] ",this.statusCode=0,this.playingStateCounter=new L.Ku(),this.eventBinder=new j.fR(this),this.pluginId=h.CR(),a.Framework.m("peer0",new O.kR(),new m.DR()),this.pluginId4Java=E.SessionStorageUtil.getItem("hivePluginId"),this.pluginId4Java||(this.pluginId4Java=Math.abs(Math.floor(68719476736*Math.random())).toString(16),E.SessionStorageUtil.setItem("hivePluginId",this.pluginId4Java));var i=S.ErrorMonitor.getInstance(D.Y.za);this.options_=new f.Options(),this.validateHiveTechs(t),b.updateOptions(t,this.options_),b.parseParameterOptions(window.location.href,new f.UrlConfigurableOptions(),this.options_),f._v.mv(this.options_),this.logger_=a.Framework.resolve(a.Framework.v.p),l.HiveConfig.Framework.LoggerTimestamp=this.options().loggerTimestamp,this.options().isSDNDebug&&(this.options().debugLevel="debug"),this.logger_.lR(this.options().debugLevel),i.nt(this.logger_.log()),this.options().onError&&i.et(this.options().onError);var n=a.Framework.resolve(a.Framework.v.Pl),r=a.Framework.resolve(a.Framework.v.jR);n.sv().then(function(t){i.setUser(t.uv()),i.rt({reportingGuid:t.av()}),i.rt({p2pId:t.uv()})});var s={};new y.MR(this),r.getConnectivityInfo().then(function(t){s={pIPAddr:t.getNetworkChanged().getPrivateIp()},i.rt({privateIp:s.pIPAddr})}),window.Hc=this.logger_.log(),this.registerCloseSession(),this.pluginReference=new d.HivePluginReference(this);var e=this.options().idleTimePeriod>this.options().feedbackPeriod?this.options().idleTimePeriod:N.Rc.du;this.statsChecker=new w.StatsChecker(e),this.registerGenericEvents()}i.Plugin=G,"undefined"!=typeof window&&(window.HiveRequestFactory=r.HiveRequestFactory),i.PR=A.ie,i.logError=function(t,i,n,r,s){var e=S.ErrorMonitor.getInstance();e.logError.apply(e,arguments)}},function(t,i,n){t.exports=function s(e,h,o){function u(n,t){if(!h[n]){if(!e[n]){if(a)return a(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var r=h[n]={exports:{}};e[n][0].call(r.exports,function(t){var i=e[n][1][t];return u(i||t)},r,r.exports,s,e,h,o)}return h[n].exports}for(var a=!1,t=0;t<o.length;t++)u(o[t]);return u}({1:[function(t,i,n){var r=t("./kernel");n.F=r.F;var s=t("./type_binding");n.LR=s.LR;var e=t("./type_binding_scope");n.HR=e.HR},{"./kernel":2,"./type_binding":4,"./type_binding_scope":5}],2:[function(t,i,n){var r=t("./type_binding_scope"),s=t("./lookup"),e=function(){function t(){this.UR=new s.FR()}return t.prototype.bind=function(t){this.UR.add(t.GR,t)},t.prototype.xR=function(i){try{this.UR.remove(i)}catch(t){throw new Error("Could not resolve service "+i)}},t.prototype.U=function(){this.UR=new s.FR()},t.prototype.resolve=function(t){if(!this.UR.BR(t))return null;var i=this.UR.get(t)[0];if(i.scope===r.HR.VR&&null!==i.gw)return i.gw;var n=this.qR(i.QR);return i.gw=n},t.prototype.YR=function(t){var i,n,r,s,e,h;return e=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,h=/([^\s,]+)/g,i=t.toString().replace(e,""),n=i.indexOf("(")+1,r=i.indexOf(")"),null===(s="function"==typeof Map&&-1!==i.indexOf("class")&&-1===i.indexOf("constructor")?null:i.slice(n,r).match(h))&&(s=[]),s},t.prototype.qR=function(t){var i=this.YR(t);if(0===i.length)return new t();for(var n=[],r=null,s=0;s<i.length;s++){var e=i[s];r=this.resolve(e),n.push(r)}return this.KR(t,n)},t.prototype.KR=function(t,i){return new(Function.prototype.bind.apply(t,[null].concat(i)))()},t}();n.F=e},{"./lookup":3,"./type_binding_scope":5}],3:[function(t,i,n){var s=function(t,i){this.key=t,this.value=new Array(),this.value.push(i)},r=function(){function t(){this.WR=new Array()}return t.prototype.$R=function(t){for(var i=-1,n=0;n<this.WR.length;n++){var r=this.WR[n];r.key===t&&(i=n)}return i},t.prototype.add=function(t,i){if(null==t)throw new Error("Argument Null");if(null==i)throw new Error("Argument Null");var n=this.$R(t);if(-1!==n){var r=this.WR[n];r.key===t&&r.value.push(i)}else this.WR.push(new s(t,i))},t.prototype.get=function(t){if(null==t)throw new Error("Argument Null");var i=this.$R(t);if(-1===i)throw new Error("Key Not Found");var n=this.WR[i];return n.key===t?n.value:void 0},t.prototype.remove=function(t){if(null==t)throw new Error("Argument Null");var i=this.$R(t);if(-1===i)throw new Error("Key Not Found");this.WR.splice(i,1)},t.prototype.BR=function(t){if(null==t)throw new Error("Argument Null");var i=this.$R(t);return-1!==i},t}();n.FR=r},{}],4:[function(t,i,n){var r=t("./type_binding_scope"),s=function(t,i,n){if(this.GR=t,this.QR=i,this.gw=null,void 0===n)this.scope=r.HR.XR;else{if(!r.HR[n])throw new Error("Invalid scope type "+n);this.scope=n}};n.LR=s},{"./type_binding_scope":5}],5:[function(t,i,n){var r;!function(t){t[t.XR=0]="Transient",t[t.VR=1]="Singleton"}(r=r||{}),n.HR=r},{}]},{},[1])(1)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){this.savings=0,this.cdnRequests=0,this.cdnResponses=0,this.cdnResponseErrors=0,this.cdnResponseBytes=0,this.p2pRequests=0,this.p2pResponses=0,this.p2pResponseErrors=0,this.p2pResponseBytes=0,this.p2pPartnerTotalSentBytes=0,this.partners={}}i.HiveClientStats=r;function s(){this.uuid="",this.sentBytes=0,this.receivedBytes=0,this.successTransfers=0,this.failedTransfers=0,this.rateReceived=0,this.lastUpdated=0}i.HivePartnerStats=s;function e(){}var h,o,u,a;i.HiveSession=e,(o=h=i.HiveSessionErrorCode||(i.HiveSessionErrorCode={}))[o.GENERIC_ERROR=0]="GENERIC_ERROR",o[o.NO_TECH_AVAILABLE=1]="NO_TECH_AVAILABLE",o[o.NO_TECH_RESOLVED=2]="NO_TECH_RESOLVED",o[o.TECH_ERROR=3]="TECH_ERROR",o[o.TICKET_ERROR=4]="TICKET_ERROR",(a=u=u||{})[a["Generic Undefined Error"]=0]="Generic Undefined Error",a[a["No Tech available to resolve the ticket"]=1]="No Tech available to resolve the ticket",a[a["No available Tech could resolved the ticket"]=2]="No available Tech could resolved the ticket",a[a["Stopped resolving session on last tech onError"]=3]="Stopped resolving session on last tech onError",a[a["The ticket could not be resolved"]=4]="The ticket could not be resolved";var f=(c.getHiveSessionErrorMessage=function(t){return u[t]},c.getHiveSessionError=function(t,i,n){var r=new c();return r.ticketUrl=t,r.code=i,r.message=c.getHiveSessionErrorMessage(i),r.detailedMessage=n,r},c.HiveSessionErrorCode=h,c);function c(){}i.HiveSessionError=f;function l(t,i){this.code=t,this.message=i}var v,d,E;i.HiveTechError=l,(v=i.wR||(i.wR={}))[v.NOT_READY=0]="NOT_READY",v[v.PLUGIN_ERROR=1]="PLUGIN_ERROR",v[v.SESSION_ERROR=2]="SESSION_ERROR",v[v.TICKET_ERROR=3]="TICKET_ERROR",v[v.VERSION_ERROR=4]="VERSION_ERROR",v[v.TIMEOUT_ERROR=5]="TIMEOUT_ERROR",(E=d=i.MainStatusCode||(i.MainStatusCode={}))[E.OK=0]="OK",E[E.HIVE_NOT_ALLOWED=1]="HIVE_NOT_ALLOWED",E[E.TICKET_NOT_RESOLVED=2]="TICKET_NOT_RESOLVED",E[E.TIMEOUT_RESOLVING_TICKET=3]="TIMEOUT_RESOLVING_TICKET",i.NR=function(t){switch(t){case d.OK:return"OK";case d.HIVE_NOT_ALLOWED:return"HIVE_NOT_ALLOWED";case d.TICKET_NOT_RESOLVED:return"TICKET_NOT_RESOLVED";case d.TIMEOUT_RESOLVING_TICKET:return"TIMEOUT_RESOLVING_TICKET";default:return}};var w=(p.prototype.getPluginStatusCode=function(){return this.hivePlugin.getStatusCode()},p);function p(t){this.hivePlugin=t}i.HivePluginReference=w},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e=n(76),h=n(60),o=n(4),u=n(0),a=n(14),f=n(16),c=n(13),l=n(77),v=n(131),d=n(132),E=n(133),w=(p.zR="hive-client-track",p.JR="trackevent",p.ZR="NULLID",p.tS="",p);function p(){}var g,b="[TRACK] ";(g=i.PlayerEvents||(i.PlayerEvents={}))[g.PLAYING=0]="PLAYING",g[g.BUFFERING=1]="BUFFERING",g[g.PAUSED=2]="PAUSED",g[g.SKIP=3]="SKIP",g[g.STOPPED=4]="STOPPED",g[g.ERROR=5]="ERROR",g[g.WINDOW_SIZE=6]="WINDOW_SIZE",g[g.FULLSCREEN=7]="FULLSCREEN",g[g.VISIBLE=8]="VISIBLE",g[g.HIDDEN=9]="HIDDEN",g[g.iS=10]="MUTED",g[g.nS=11]="LANGUAGE_SWITCH";function y(){}i.rS=y;var T,O=function(){this.type=2},m=(T=v.sS,s(_,T),_.prototype.eS=function(i,t){var n;this.sessions.forEach(function(t){t.sessionId==i&&(n=t)}),n||((n=new E.hS()).sessionId=i,n.events=[],this.sessions.push(n)),n.events.push(t)},_);function _(){var t=T.call(this)||this;return t.sessions=new Array(),t}var R=(S.prototype.oS=function(t){this.client=t},S.prototype.init=function(t,i){this.uS=t,this.xl(i),this.logger.debug(b+"INIT ID: "+t)},S.prototype.xl=function(t){this.Bl=t},S.prototype.updatePlayerInfo=function(t){this.aS=t},S.prototype.lv=function(t){var i=new N(t,this);this.fS.push(i),this.cS=null,this.client.lS(!0)},S.prototype.manifestRequested=function(t,i,n){if(!this.cS)for(var r=0;r<this.fS.length;r++){var s=this.fS[r];if(s.ticket.sessionId===t){this.logger.debug(b+"Activating Track for session "+t),this.cS=s;break}}if(this.cS)if(this.cS.ticket.sessionId==t){if(!this.cS.vS){var e=new k(t,i,n);this.cS.dS(e),this.client.lS()}}else this.logger.warn(b+"ignoring manifest not matching event "+this.cS.ticket.sessionId+" != "+t)},S.prototype.ES=function(t,i,n){null!=this.cS&&(this.cS.vS||this.cS.wS.push(new G(t,i,n)))},S.prototype.pS=function(t,i,n){this.gS.push(new P(t,i,n)),this.client.lS()},S.prototype.handleTechEvent=function(t,i,n){this.bS.push(new U(t,i,n)),this.client.lS()},S.prototype.yS=function(t){var i=this;t&&t.forEach(function(t){i.bS.push(t)})},S.prototype.TS=function(){var t=new d.qc();c.HiveConfig.ClientInfo.rc&&c.HiveConfig.ClientInfo.sc?(t.partnerId=c.HiveConfig.ClientInfo.rc,t.customerId=c.HiveConfig.ClientInfo.sc):this.cS&&(t.partnerId=this.cS.ticket.mR(),t.customerId=this.cS.ticket._R()),t.version=this.Bl.name+"_"+this.Bl.version;var i=new h.OS();return i.mS(navigator.userAgent),t.os=i._S().name+" "+i._S().version,this.aS&&(t.commVersion=this.aS.commVersion,t.pluginName=this.aS.pluginName,t.pluginVersion=this.aS.pluginVersion,t.playerTech=this.aS.playerTech,t.playerVersion=this.aS.playerVersion,this.aS.telemetryId&&(t.telemetryId=this.aS.telemetryId)),t},S.prototype.RS=function(){return this.cS?this.cS:this.fS&&0<this.fS.length?this.fS[this.fS.length-1]:void 0},S.prototype.IS=function(t){var n=this;if(void 0===t&&(t=!0),0==this.fS.length&&0==this.gS.length)return t?o.reject("nothing to send"):(this.logger.debug(b+" NOTHING TO SEND"),null);var r=new l.NS();r.app=w.zR,r.createdAt=u.Framework.time(),r.guid=this.uS,r.name=w.JR;var i=this.RS();if(i){var s=i.ticket.CS().replace(/[\[\]]/g,"");r.tags=[s],r.tags.push(i.ticket.mR()),r.tags.push(i.ticket._R())}else r.tags=new Array();var e=new m();if(e.peer=this.TS(),this.fS.forEach(function(t){t.vS||e.eS(t.ticket.sessionId,t)}),this.gS.forEach(function(t){e.eS(t.sessionId,t)}),this.bS.forEach(function(t){e.eS(t.sessionId,t)}),r.data=e,t)return this.kS.getConnectivityInfo().then(function(t){var i=n.DS(t);return e.eS("null",i),r}).fail(function(t){return r});var h=this.DS(this.kS.jS());return e.eS("null",h),r},S.prototype.DS=function(t){var i=new O();i.ts=u.Framework.time();var n=t.getNetworkChanged();return n.getPublicIp()&&(i.pubIp=n.getPublicIp()),n.getPrivateIp()&&(i.privIp=e.SensitiveInfoUtils.getPrivateIp(n)),t.getHostName()&&(i.hostname=e.SensitiveInfoUtils.getHostname(t)),n.getCidr()&&(i.netmask=n.getCidr()),n.getNic()&&(i.nic=n.getNic()),n.getNicName()&&(i.nicName=n.getNicName()),n.getMacAddress()&&(i.mac=n.getMacAddress()),i},S.prototype.MS=function(){return navigator.userAgent},S.prototype.reset=function(){this.fS=new Array(),this.gS=new Array(),this.bS=new Array()},S.prototype.PS=function(t){},S);function S(){this.logger=u.Framework.resolve(u.Framework.v.p).log(),this.kS=u.Framework.resolve(u.Framework.v.jR),this.fS=new Array(),this.gS=new Array(),this.bS=new Array()}i.LS=R;var A=(I.prototype.lS=function(t){void 0===t&&(t=!1);var i=t?a.Rc.pc:a.Rc.wc;this.HS?i<this.US-new Date().getTime()&&(u.Framework.clearTimeout(this.HS),this.US=null,this.FS(i)):this.FS(i)},I.prototype.Kl=function(){this.HS&&(u.Framework.clearTimeout(this.HS),this.US=this.HS=null)},I.prototype.FS=function(t,i){var n=this;void 0===i&&(i=!1),this.HS=u.Framework.setTimeout(function(){n.GS()},t,i),this.US=new Date().getTime()+t},I.prototype.GS=function(t){var i=this;void 0===t&&(t=!0),this.HS=null,this.US=null;var n=this.ql.IS(t);t?(this.logger.debug(b+"TAKING A TRACK SNAPSHOT"),n.then(function(t){return i.forward(t)}).fail(function(t){i.logger.debug(b+" ERROR GENERATING/SENDING THE TRACK SNAPSHOT: ",t)})["finally"](function(){return i.ql.reset()}).done()):(this.logger.debug(b+"FLUSHING TRACK SNAPSHOT"),this.forward(n),this.ql.reset())},I.prototype.forward=function(t){if(!this.filter||this.filter.Hl()){if(this.client&&this.client.xS()&&t){var i=JSON.stringify(t);switch(this.BS){case 0:default:this.logger.debug(b+"TRACK EVENT");break;case 1:this.logger.debug(b+"TRACK EVENT:"+i)}var n=new f.Lc(HiveStreamingServices.VS,2,i);this.client.xS().send(n)}}else this.logger.debug(b+"SKIPPING SNAPSHOT")},I.prototype.qS=function(t){void 0===t&&(t=!0),t?(this.Kl(),this.FS(a.Rc.gc,!0)):this.GS(!1)},I.prototype.$l=function(t){this.filter=t},I);function I(t){this.BS=isNaN(c.HiveConfig.DebugLogs.TrackSnapshotLogs)?0:c.HiveConfig.DebugLogs.TrackSnapshotLogs,this.ql=t,this.logger=u.Framework.resolve(u.Framework.v.p).log(),this.client=u.Framework.resolve(u.Framework.v.jl),this.ql.oS(this)}i.Zl=A;var N=(C.prototype.dS=function(t){this.manifests.push(t)},C.prototype.toJSON=function(){var n={type:0,ticket:{}};n.ticket.url=this.ticket.QS(),n.ticket.reqTs=this.ticket.bR,n.ticket.respTs=this.ticket.yR,n.ticket.userAgent=this.ql.MS(),null!=this.ticket.testId&&(n.ticket.testId=this.ticket.testId),n.manifests=[],this.manifests.forEach(function(t){var i={};i.url=t.url,i.respTs=t.yR,i.respCode=t.respCode,n.manifests.push(i)});var i=-1,r=-1,s=-1;return this.wS.forEach(function(t){0<t.YS&&(-1==i&&(i=t.ts,r=t.YS),s=t.YS)}),-1!=i&&(n.playTs=i),-1!=s&&(n.buffTime=s),-1!=r&&(n.initBuffTime=r),n},C);function C(t,i){this.createdAt=new Date().getTime(),this.vS=!1,this.ticket=t,this.manifests=new Array(),this.wS=new Array(),this.ql=i}i.KS=N;var k=function(t,i,n){this.eventId=t,this.url=i,this.yR=new Date().getTime(),this.respCode=n},D=(j.prototype.toJSON=function(){var t={};return t.type=this.WS+this.event,t.ts=this.ts,this.$S&&(t.parameters=this.$S),t},j);function j(t,i,n,r){this.ts=new Date().getTime(),this.sessionId=t,this.sessionId||(this.sessionId="null"),this.event=i,this.$S=n,r&&(this.ts=r)}var M,P=(s(L,M=D),L);function L(t,i,n,r){var s=M.call(this,t,i,n,r)||this;return s.WS=100,s}var H,U=(s(F,H=D),F);function F(t,i,n,r){var s=H.call(this,t,i,n,r)||this;return s.WS=200,s}i.XS=U;var G=function(t,i,n){this.ts=new Date().getTime(),this.playingPoint=t,this.zS=i,this.YS=n}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,s,e=n(43),h=n(3);(s=r=i.JS||(i.JS={}))[s.off=0]="off",s[s.error=1]="error",s[s.warn=2]="warn",s[s.notice=3]="notice",s[s.info=4]="info",s[s.debug=5]="debug",s[s.trace=6]="trace";var o=(u.prototype.lR=function(t,i){e.HiveConfig.Framework.HiveDebugLevel&&null!=r[e.HiveConfig.Framework.HiveDebugLevel]?this.level=r[e.HiveConfig.Framework.HiveDebugLevel]:null!=r[t]?this.level=r[t]:!1,this.ZS(i)},u.prototype.ZS=function(t){var i={log:this.tA(this.logger.log,r.error,t),error:this.tA(this.logger.error,r.error,t),warn:this.tA(this.logger.warn,r.warn,t),notice:this.tA(this.logger.info,r.notice,t),info:this.tA(this.logger.info,r.info,t),debug:this.tA(this.logger.debug,r.debug,t),trace:this.tA(this.logger.trace,r.trace,t)};t?this.iA.set(t,i):this.nA=i},u.prototype.tA=function(t,i,n){if(!(this.level>=i))return function(){};try{return e.HiveConfig.Framework.LoggerTimestamp?n?Function.prototype.bind.call(t,console,"S["+n+"] %s",this.timestamp):Function.prototype.bind.call(t,console,"%s",this.timestamp):n?Function.prototype.bind.call(t,console,"S["+n+"]"):Function.prototype.bind.call(t,console)}catch(t){}},u.prototype.log=function(t){return t?(this.iA.has(t)||this.lR(r[this.level],t),this.iA.get(t)):this.nA},u);function u(){this.timestamp=function(){},this.iA=new h(),this.level=r.debug,this.timestamp.toString=function(){var t=new Date();return"["+(("0"+t.getUTCHours()).slice(-2)+":"+("0"+t.getUTCMinutes()).slice(-2)+":"+("0"+t.getUTCSeconds()).slice(-2)+":"+("00"+t.getUTCMilliseconds()).slice(-3))+"]"},this.logger="undefined"==typeof console?{log:function(){}}:console,this.logger.trace||(this.logger.trace=this.logger.log),this.logger.debug||(this.logger.debug=this.logger.log),this.logger.info||(this.logger.info=this.logger.log),this.logger.warn||(this.logger.warn=this.logger.log),this.logger.error||(this.logger.error=this.logger.log),this.lR(r[this.level])}i.rA=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(7),f=n(23),s=(e.sA=function(t){return new e(t.eA,t.hA,!0,t.id,t.duration,t.qualityLevel,!0)},e.prototype.S_=function(){return this.oA},e.prototype.uA=function(){return this.aA},e.prototype.getDuration=function(){return this.duration},e.prototype.getQualityLevel=function(){return this.qualityLevel},e.prototype.M_=function(){return this.fA},e.prototype.cA=function(){return this.lA},e.prototype.I_=function(){return this.vA},e.prototype.D_=function(){return this.url},e.prototype.toString=function(){return r.xa[this.S_()]+"-"+this.I_()},e);function e(t,i,n,r,s,e,h,o){var u=(o||t).replace(/http(s)?:\/\//,""),a=f.ol.ib(u).toString(f.ol.jg.Mg);this.url=t,this.oA=i,this.lA=n,this.aA=r,this.duration=s,this.qualityLevel=e,this.fA=h,this.vA=[a,r,e?e.id:null].join("-")}i.dA=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.getInstance=function(){return this.instance||(this.instance=new s()),this.instance},s.prototype.register=function(t,i,n){n=n||t.getPluginId();var r=this.EA(n);r.plugin=t,i&&r.sessions.push(i)},s.prototype.unregister=function(t,i){var n=t.getPluginId(),r=this.EA(n),s=r.sessions.length;r.plugin?s?(r.sessions=r.sessions.filter(function(t){return t.id!==i.id}),s===r.sessions.length?t.logger().warn(this.loggerId+" Attempt to unregister a not found session (pluginId = "+n+", sessionId = "+i.id+")"):t.logger().debug(this.loggerId+" Unregistered session (pluginId = "+n+", sessionId = "+i.id+")")):t.logger().warn(this.loggerId+" Attempt to unregister a session for plugin with no sessions (pluginId = "+n+", sessionId = "+i.id+")"):!1},s.prototype.clear=function(){this.store={}},s.prototype.EA=function(t){var i=this.store[t];return i||(i={plugin:null,sessions:[]},this.store[t]=i),i},s.prototype.wA=function(){var t=Object.keys(this.store);if(!t.length)return null;var i=this.store[t[0]].plugin;return i?i.getPluginId():null},s.prototype.pA=function(t){return this.EA(t).plugin},s.prototype.gA=function(t){return this.EA(t).sessions},s);function s(){this.loggerId="[SessionRegistry] ",this.store={}}i.aR=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var s=n(152),e=n(170),r=(h.bA=function(t,i,n){return this.yA(t,i,n)||-1!=t.indexOf(h.TA)},h.yA=function(t,i,n){var r=-1!=t.toLowerCase().indexOf(h.OA.toLowerCase())||-1!=t.toLowerCase().indexOf(h.mA.toLowerCase());if(n){if(n.test(t))return!0;!r&&i&&i.warn(this.loggerId+"Context matcher set to "+n+" failed against "+t)}return r},h._A=function(t,i){var n=i.replace("_definst_/","").match(new RegExp(t.replace(".mpd","")+h.RA));return n&&0<n.length},h.SA=function(t,i,n,r){return 0<t.indexOf(h.mA)?new e.AA(i,n,r):new s.IA(i,n,r)},h.loggerId="[DASH] ",h.NA=1,h.CA=2,h.kA=2e3,h.DA=3e4,h.jA=1e4,h.MA=!0,h.PA=!0,h.LA=500,h.HA=16,h.UA=3,h.FA=10,h.DASH_METADATA_MIN_FRAGMENTS=3,h.OA="(format=mpd-time-csf)",h.mA=".mpd",h.RA="_.*.mpd",h.TA=".m4s",h.GA=".ism/",h);function h(){}i.Dash=r},function(t,i,n){"use strict";n(10);var s=n(153),r=n(11),e=n(59),h=n(12);function o(t,n,r,i){if(!(this instanceof o))return new o(t,n,r,i);n=n||Object.equals,r=r||Object.compare,i=i||Function._e,this.Re=n,this._f=r,this.Ae=i,this.store=new s(null,function(t,i){return n(t.key,i.key)},function(t,i){return r(t.key,i.key)}),this.length=0,this.hiveAddEach(t)}(t.exports=o).SortedMap=o,Object.hiveAddEach(o.prototype,r.prototype),Object.hiveAddEach(o.prototype,e.prototype),Object.hiveAddEach(o.prototype,h.prototype),o.prototype.Ne=function(t){return new this.constructor(t,this.Re,this._f,this.Ae)},o.prototype.log=function(t,r,i,n){r=r||this.Ce,this.store.log(t,function(t,i,n){r(t.value,i,n)},i,n)},o.prototype.Ce=function(t,i){i(" key: "+t.key),i(" value: "+t.value)}},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(103),o=n(186),u=(e=o.xA,s(a,e),a.prototype.send=function(){if(this.readyState!==this.OPENED)throw new Error("The object's state must be OPENED.");if(!this.pluginId){var t=Object.keys(a.BA);0<t.length&&(this.pluginId=a.BA[t[0]])}h["default"].getInstance().request(this,this.pluginId)},a.prototype.abort=function(){h["default"].getInstance().abort(this,this.pluginId)},a.Sl=0,a);function a(t){var i=e.call(this,t)||this;return i.DONE=4,i.LOADING=3,i.HEADERS_RECEIVED=2,i.OPENED=1,i.UNSENT=0,i.internal=!1,i.id=a.Sl++,i}i.VA=u},function(t,i,n){var r,s,e;s=[n(202)],void 0===(e="function"==typeof (r=function(u){"use strict";var d=function(t,i,n){if(void 0===t&&(t=d.qA),void 0===i&&(i=d.QA),void 0===n&&(n=d.YA),!n){if((t|=0)<0)throw RangeError("Illegal capacity");i=!!i,n=!!n}this.buffer=0===t?e:new ArrayBuffer(t),this.view=0===t?null:new Uint8Array(this.buffer),this.offset=0,this.KA=-1,this.WA=t,this.$A=void 0!==i&&!!i,this.XA=!!n};d.VERSION="4.1.0",d.zA=!0,d.JA=!1,d.qA=16,d.QA=d.JA,d.YA=!1,d.ZA=u||null;var h=d.prototype;h.tI,Object.defineProperty(h,"tI",{value:!0,enumerable:!1,configurable:!1});var e=new ArrayBuffer(0),n=String.fromCharCode;function o(t){var i=0;return function(){return i<t.length?t.charCodeAt(i++):null}}function a(){var t=[],i=[];return function(){if(0===arguments.length)return i.join("")+n.apply(String,t);1024<t.length+arguments.length&&(i.push(n.apply(String,t)),t.length=0),Array.prototype.push.apply(t,arguments)}}function r(t,i,n,r,s){var e,h,o=8*s-r-1,u=(1<<o)-1,a=u>>1,f=-7,c=n?s-1:0,l=n?-1:1,v=t[i+c];for(c+=l,e=v&(1<<-f)-1,v>>=-f,f+=o;0<f;e=256*e+t[i+c],c+=l,f-=8);for(h=e&(1<<-f)-1,e>>=-f,f+=r;0<f;h=256*h+t[i+c],c+=l,f-=8);if(0===e)e=1-a;else{if(e===u)return h?NaN:1/0*(v?-1:1);h+=Math.pow(2,r),e-=a}return(v?-1:1)*h*Math.pow(2,e-r)}function s(t,i,n,r,s,e){var h,o,u,a=8*e-s-1,f=(1<<a)-1,c=f>>1,l=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,v=r?0:e-1,d=r?1:-1,E=i<0||0===i&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(o=isNaN(i)?1:0,h=f):(h=Math.floor(Math.log(i)/Math.LN2),i*(u=Math.pow(2,-h))<1&&(h--,u*=2),2<=(i+=1<=h+c?l/u:l*Math.pow(2,1-c))*u&&(h++,u/=2),f<=h+c?(o=0,h=f):1<=h+c?(o=(i*u-1)*Math.pow(2,s),h+=c):(o=i*Math.pow(2,c-1)*Math.pow(2,s),h=0));8<=s;t[n+v]=255&o,v+=d,o/=256,s-=8);for(h=h<<s|o,a+=s;0<a;t[n+v]=255&h,v+=d,h/=256,a-=8);t[n+v-d]|=128*E}d.iI=function(){return Uint8Array},d.nI=function(t,i,n){return new d(t,i,n)},d.concat=function(t,i,n,r){"boolean"!=typeof i&&"string"==typeof i||(r=n,n=i,i=void 0);for(var s,e=0,h=0,o=t.length;h<o;++h)d.rI(t[h])||(t[h]=d.wrap(t[h],i)),0<(s=t[h].WA-t[h].offset)&&(e+=s);if(0===e)return new d(0,n,r);var u,a=new d(e,n,r);for(h=0;h<o;)(s=(u=t[h++]).WA-u.offset)<=0||(a.view.set(u.view.subarray(u.offset,u.WA),a.offset),a.offset+=s);return a.WA=a.offset,a.offset=0,a},d.rI=function(t){return!0===(t&&t.tI)},d.type=function(){return ArrayBuffer},d.wrap=function(t,i,n,r){if("string"!=typeof i&&(r=n,n=i,i=void 0),"string"==typeof t)switch(void 0===i&&(i="utf8"),i){case"base64":return d.sI(t,n);case"hex":return d.eI(t,n);case"binary":return d.hI(t,n);case"utf8":return d.oI(t,n);case"debug":return d.uI(t,n);default:throw Error("Unsupported encoding: "+i)}if(null===t||"object"!=typeof t)throw TypeError("Illegal buffer");var s;if(d.rI(t))return(s=h.clone.call(t)).KA=-1,s;if(t instanceof Uint8Array)s=new d(0,n,r),0<t.length&&(s.buffer=t.buffer,s.offset=t.byteOffset,s.WA=t.byteOffset+t.byteLength,s.view=new Uint8Array(t.buffer));else if(t instanceof ArrayBuffer)s=new d(0,n,r),0<t.byteLength&&(s.buffer=t,s.offset=0,s.WA=t.byteLength,s.view=0<t.byteLength?new Uint8Array(t):null);else{if("[object Array]"!==Object.prototype.toString.call(t))throw TypeError("Illegal buffer");(s=new d(t.length,n,r)).WA=t.length;for(var e=0;e<t.length;++e)s.view[e]=t[e]}return s},h.aI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+t>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+"+t+") <= "+this.buffer.byteLength)}var r=this.slice(i,i+t);return n&&(this.offset+=t),r},h.fI=h.append,h.cI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=1;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=1,this.view[i]=t,n&&(this.offset+=1),this},h.tp=h.cI,h.lI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n=this.view[t];return 128==(128&n)&&(n=-(255-n+1)),i&&(this.offset+=1),n},h.Op=h.lI,h.vI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=1;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=1,this.view[i]=t,n&&(this.offset+=1),this},h.dI=h.vI,h.EI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n=this.view[t];return i&&(this.offset+=1),n},h.wI=h.EI,h.pI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=2;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=2,this.$A?(this.view[i+1]=(65280&t)>>>8,this.view[i]=255&t):(this.view[i]=(65280&t)>>>8,this.view[i+1]=255&t),n&&(this.offset+=2),this},h.gI=h.pI,h.bI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+2) <= "+this.buffer.byteLength)}var n=0;return this.$A?(n=this.view[t],n|=this.view[t+1]<<8):(n=this.view[t]<<8,n|=this.view[t+1]),32768==(32768&n)&&(n=-(65535-n+1)),i&&(this.offset+=2),n},h.yI=h.bI,h.TI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=2;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=2,this.$A?(this.view[i+1]=(65280&t)>>>8,this.view[i]=255&t):(this.view[i]=(65280&t)>>>8,this.view[i+1]=255&t),n&&(this.offset+=2),this},h.OI=h.TI,h.mI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+2) <= "+this.buffer.byteLength)}var n=0;return this.$A?(n=this.view[t],n|=this.view[t+1]<<8):(n=this.view[t]<<8,n|=this.view[t+1]),i&&(this.offset+=2),n},h._I=h.mI,h.RI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=4;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=4,this.$A?(this.view[i+3]=t>>>24&255,this.view[i+2]=t>>>16&255,this.view[i+1]=t>>>8&255,this.view[i]=255&t):(this.view[i]=t>>>24&255,this.view[i+1]=t>>>16&255,this.view[i+2]=t>>>8&255,this.view[i+3]=255&t),n&&(this.offset+=4),this},h.al=h.RI,h.SI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var n=0;return this.$A?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0):(n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),n|=0,i&&(this.offset+=4),n},h.gl=h.SI,h.AI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=4;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=4,this.$A?(this.view[i+3]=t>>>24&255,this.view[i+2]=t>>>16&255,this.view[i+1]=t>>>8&255,this.view[i]=255&t):(this.view[i]=t>>>24&255,this.view[i+1]=t>>>16&255,this.view[i+2]=t>>>8&255,this.view[i+3]=255&t),n&&(this.offset+=4),this},h.II=h.AI,h.NI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var n=0;return this.$A?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0):(n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),i&&(this.offset+=4),n},h.CI=h.NI,u&&(h.kI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"==typeof t)t=u.rb(t);else if("string"==typeof t)t=u.fromString(t);else if(!(t&&t instanceof u))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=u.rb(t):"string"==typeof t&&(t=u.fromString(t)),i+=8;var r=this.buffer.byteLength;r<i&&this.resize((r*=2)>i?r:i),i-=8;var s=t.low,e=t.high;return this.$A?(this.view[i+3]=s>>>24&255,this.view[i+2]=s>>>16&255,this.view[i+1]=s>>>8&255,this.view[i]=255&s,i+=4,this.view[i+3]=e>>>24&255,this.view[i+2]=e>>>16&255,this.view[i+1]=e>>>8&255,this.view[i]=255&e):(this.view[i]=e>>>24&255,this.view[i+1]=e>>>16&255,this.view[i+2]=e>>>8&255,this.view[i+3]=255&e,i+=4,this.view[i]=s>>>24&255,this.view[i+1]=s>>>16&255,this.view[i+2]=s>>>8&255,this.view[i+3]=255&s),n&&(this.offset+=8),this},h.DI=h.kI,h.jI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var n=0,r=0;this.$A?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0);var s=new u(n,r,!1);return i&&(this.offset+=8),s},h.MI=h.jI,h.LI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"==typeof t)t=u.rb(t);else if("string"==typeof t)t=u.fromString(t);else if(!(t&&t instanceof u))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=u.rb(t):"string"==typeof t&&(t=u.fromString(t)),i+=8;var r=this.buffer.byteLength;r<i&&this.resize((r*=2)>i?r:i),i-=8;var s=t.low,e=t.high;return this.$A?(this.view[i+3]=s>>>24&255,this.view[i+2]=s>>>16&255,this.view[i+1]=s>>>8&255,this.view[i]=255&s,i+=4,this.view[i+3]=e>>>24&255,this.view[i+2]=e>>>16&255,this.view[i+1]=e>>>8&255,this.view[i]=255&e):(this.view[i]=e>>>24&255,this.view[i+1]=e>>>16&255,this.view[i+2]=e>>>8&255,this.view[i+3]=255&e,i+=4,this.view[i]=s>>>24&255,this.view[i+1]=s>>>16&255,this.view[i+2]=s>>>8&255,this.view[i+3]=255&s),n&&(this.offset+=8),this},h.HI=h.LI,h.UI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var n=0,r=0;this.$A?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0);var s=new u(n,r,!0);return i&&(this.offset+=8),s},h.FI=h.UI),h.GI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t)throw TypeError("Illegal value: "+t+" (not a number)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=4;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=4,s(this.view,t,i,this.$A,23,4),n&&(this.offset+=4),this},h.xI=h.GI,h.BI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var n=r(this.view,t,this.$A,23,4);return i&&(this.offset+=4),n},h.VI=h.BI,h.qI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t)throw TypeError("Illegal value: "+t+" (not a number)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}i+=8;var r=this.buffer.byteLength;return r<i&&this.resize((r*=2)>i?r:i),i-=8,s(this.view,t,i,this.$A,52,8),n&&(this.offset+=8),this},h.sp=h.qI,h.QI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var n=r(this.view,t,this.$A,52,8);return i&&(this.offset+=8),n},h.Rp=h.QI,d.YI=5,d.KI=function(t){return(t>>>=0)<128?1:t<16384?2:t<1<<21?3:t<1<<28?4:5},d.WI=function(t){return((t|=0)<<1^t>>31)>>>0},d.$I=function(t){return t>>>1^-(1&t)|0},h.XI=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var r,s=d.KI(t);i+=s;var e=this.buffer.byteLength;for(e<i&&this.resize((e*=2)>i?e:i),i-=s,t>>>=0;128<=t;)r=127&t|128,this.view[i++]=r,t>>>=7;return this.view[i++]=t,n?(this.offset=i,this):s},h.zI=function(t,i){return this.XI(d.WI(t),i)},h.JI=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n,r=0,s=0;do{if(!this.XA&&t>this.WA){var e=Error("Truncated");throw e.ZI=!0,e}n=this.view[t++],r<5&&(s|=(127&n)<<7*r),++r}while(0!=(128&n));return s|=0,i?(this.offset=t,s):{value:s,length:r}},h.tN=function(t){var i=this.JI(t);return"object"==typeof i?i.value=d.$I(i.value):i=d.$I(i),i},u&&(d.iN=10,d.nN=function(t){"number"==typeof t?t=u.rb(t):"string"==typeof t&&(t=u.fromString(t));var i=t.rN()>>>0,n=t.sN(28).rN()>>>0,r=t.sN(56).rN()>>>0;return 0==r?0==n?i<16384?i<128?1:2:i<1<<21?3:4:n<16384?n<128?5:6:n<1<<21?7:8:r<128?9:10},d.eN=function(t){return"number"==typeof t?t=u.rb(t,!1):"string"==typeof t?t=u.fromString(t,!1):!1!==t.hN&&(t=t.oN()),t.shiftLeft(1).xor(t.aN(63)).uN()},d.fN=function(t){return"number"==typeof t?t=u.rb(t,!1):"string"==typeof t?t=u.fromString(t,!1):!1!==t.hN&&(t=t.oN()),t.sN(1).xor(t.and(u.ONE).oN().Ub()).oN()},h.cN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("number"==typeof t)t=u.rb(t);else if("string"==typeof t)t=u.fromString(t);else if(!(t&&t instanceof u))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=u.rb(t,!1):"string"==typeof t?t=u.fromString(t,!1):!1!==t.hN&&(t=t.oN());var r=d.nN(t),s=t.rN()>>>0,e=t.sN(28).rN()>>>0,h=t.sN(56).rN()>>>0;i+=r;var o=this.buffer.byteLength;switch(o<i&&this.resize((o*=2)>i?o:i),i-=r,r){case 10:this.view[i+9]=h>>>7&1;case 9:this.view[i+8]=9!==r?128|h:127&h;case 8:this.view[i+7]=8!==r?e>>>21|128:e>>>21&127;case 7:this.view[i+6]=7!==r?e>>>14|128:e>>>14&127;case 6:this.view[i+5]=6!==r?e>>>7|128:e>>>7&127;case 5:this.view[i+4]=5!==r?128|e:127&e;case 4:this.view[i+3]=4!==r?s>>>21|128:s>>>21&127;case 3:this.view[i+2]=3!==r?s>>>14|128:s>>>14&127;case 2:this.view[i+1]=2!==r?s>>>7|128:s>>>7&127;case 1:this.view[i]=1!==r?128|s:127&s}return n?(this.offset+=r,this):r},h.lN=function(t,i){return this.cN(d.eN(t),i)},h.vN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n=t,r=0,s=0,e=0,h=0;if(h=this.view[t++],r=127&h,128&h&&(h=this.view[t++],r|=(127&h)<<7,(128&h||this.XA&&void 0===h)&&(h=this.view[t++],r|=(127&h)<<14,(128&h||this.XA&&void 0===h)&&(h=this.view[t++],r|=(127&h)<<21,(128&h||this.XA&&void 0===h)&&(h=this.view[t++],s=127&h,(128&h||this.XA&&void 0===h)&&(h=this.view[t++],s|=(127&h)<<7,(128&h||this.XA&&void 0===h)&&(h=this.view[t++],s|=(127&h)<<14,(128&h||this.XA&&void 0===h)&&(h=this.view[t++],s|=(127&h)<<21,(128&h||this.XA&&void 0===h)&&(h=this.view[t++],e=127&h,(128&h||this.XA&&void 0===h)&&(h=this.view[t++],e|=(127&h)<<7,128&h||this.XA&&void 0===h))))))))))throw Error("Buffer overrun");var o=u.LO(r|s<<28,s>>>4|e<<24,!1);return i?(this.offset=t,o):{value:o,length:t-n}},h.dN=function(t){var i=this.vN(t);return i&&i.value instanceof u?i.value=d.fN(i.value):i=d.fN(i),i}),h.fl=function(t,i){var n=void 0===i;n&&(i=this.offset);var r,s=t.length;if(!this.XA){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");for(r=0;r<s;++r)if(0===t.charCodeAt(r))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}s=c.EN(o(t))[1],i+=s+1;var e=this.buffer.byteLength;return e<i&&this.resize((e*=2)>i?e:i),i-=s+1,c.wN(o(t),function(t){this.view[i++]=t}.bind(this)),this.view[i++]=0,n?(this.offset=i,this):s},h.Tl=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n,r=t,s=-1;return c.pN(function(){if(0===s)return null;if(t>=this.WA)throw RangeError("Illegal range: Truncated data, "+t+" < "+this.WA);return 0===(s=this.view[t++])?null:s}.bind(this),n=a(),!0),i?(this.offset=t,n()):{string:n(),length:t-r}},h.gN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var r,s=i;r=c.EN(o(t),this.XA)[1],i+=4+r;var e=this.buffer.byteLength;if(e<i&&this.resize((e*=2)>i?e:i),i-=4+r,this.$A?(this.view[i+3]=r>>>24&255,this.view[i+2]=r>>>16&255,this.view[i+1]=r>>>8&255,this.view[i]=255&r):(this.view[i]=r>>>24&255,this.view[i+1]=r>>>16&255,this.view[i+2]=r>>>8&255,this.view[i+3]=255&r),i+=4,c.wN(o(t),function(t){this.view[i++]=t}.bind(this)),i!==s+4+r)throw RangeError("Illegal range: Truncated data, "+i+" == "+(i+4+r));return n?(this.offset=i,this):i-s},h.bN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+4) <= "+this.buffer.byteLength)}var n,r=0,s=t;this.$A?(r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0);var e,h=(t+=4)+r;return c.pN(function(){return t<h?this.view[t++]:null}.bind(this),e=a(),this.XA),n=e(),i?(this.offset=t,n):{string:n,length:t-s}},d.yN="c",d.TN="b",h.ON=function(t,i){var n,r=void 0===i;if(r&&(i=this.offset),!this.XA){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var s=i;n=c.EN(o(t))[1],i+=n;var e=this.buffer.byteLength;return e<i&&this.resize((e*=2)>i?e:i),i-=n,c.wN(o(t),function(t){this.view[i++]=t}.bind(this)),r?(this.offset=i,this):i-s},h.nw=h.ON,d.mN=function(t){return c.EN(o(t))[0]},d._N=function(t){return c.EN(o(t))[1]},d.RN=d._N,h.SN=function(t,i,n){"number"==typeof i&&(n=i,i=void 0);var r=void 0===n;if(r&&(n=this.offset),void 0===i&&(i=d.yN),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal length: "+t+" (not an integer)");if(t|=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var s,e=0,h=n;if(i===d.yN){if(s=a(),c.AN(function(){return e<t&&n<this.WA?this.view[n++]:null}.bind(this),function(t){++e,c.IN(t,s)}),e!==t)throw RangeError("Illegal range: Truncated data, "+e+" == "+t);return r?(this.offset=n,s()):{string:s(),length:n-h}}if(i!==d.TN)throw TypeError("Unsupported metrics: "+i);if(!this.XA){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+t>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+"+t+") <= "+this.buffer.byteLength)}var o=n+t;if(c.pN(function(){return n<o?this.view[n++]:null}.bind(this),s=a(),this.XA),n!==o)throw RangeError("Illegal range: Truncated data, "+n+" == "+o);return r?(this.offset=n,s()):{string:s(),length:n-h}},h.$E=h.SN,h.NN=function(t,i){var n=void 0===i;if(n&&(i=this.offset),!this.XA){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: "+i+" (not an integer)");if((i>>>=0)<0||i+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+i+" (+0) <= "+this.buffer.byteLength)}var r,s,e=i;r=c.EN(o(t),this.XA)[1],s=d.KI(r),i+=s+r;var h=this.buffer.byteLength;if(h<i&&this.resize((h*=2)>i?h:i),i-=s+r,i+=this.XI(r,i),c.wN(o(t),function(t){this.view[i++]=t}.bind(this)),i!==e+r+s)throw RangeError("Illegal range: Truncated data, "+i+" == "+(i+r+s));return n?(this.offset=i,this):i-e},h.CN=function(t){var i=void 0===t;if(i&&(t=this.offset),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var n,r=this.JI(t),s=t;t+=r.length,r=r.value;var e=t+r,h=a();return c.pN(function(){return t<e?this.view[t++]:null}.bind(this),h,this.XA),n=h(),i?(this.offset=t,n):{string:n,length:t-s}},h.append=function(t,i,n){"number"!=typeof i&&"string"==typeof i||(n=i,i=void 0);var r=void 0===n;if(r&&(n=this.offset),!this.XA){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}t instanceof d||(t=d.wrap(t,i));var s=t.WA-t.offset;if(s<=0)return this;n+=s;var e=this.buffer.byteLength;return e<n&&this.resize((e*=2)>n?e:n),n-=s,this.view.set(t.view.subarray(t.offset,t.WA),n),t.offset+=s,r&&(this.offset+=s),this},h.kN=function(t,i){return t.append(this,i),this},h.assert=function(t){return this.XA=!t,this},h.DN=function(){return this.buffer.byteLength},h.clear=function(){return this.offset=0,this.WA=this.buffer.byteLength,this.KA=-1,this},h.clone=function(t){var i=new d(0,this.$A,this.XA);return t?(i.buffer=new ArrayBuffer(this.buffer.byteLength),i.view=new Uint8Array(i.buffer)):(i.buffer=this.buffer,i.view=this.view),i.offset=this.offset,i.KA=this.KA,i.WA=this.WA,i},h.compact=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.WA),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}if(0===t&&i===this.buffer.byteLength)return this;var n=i-t;if(0==n)return this.buffer=e,this.view=null,0<=this.KA&&(this.KA-=t),this.offset=0,this.WA=0,this;var r=new ArrayBuffer(n),s=new Uint8Array(r);return s.set(this.view.subarray(t,i)),this.buffer=r,this.view=s,0<=this.KA&&(this.KA-=t),this.offset=0,this.WA=n,this},h.jN=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.WA),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}if(t===i)return new d(0,this.$A,this.XA);var n=i-t,r=new d(n,this.$A,this.XA);return r.offset=0,r.WA=n,0<=r.KA&&(r.KA-=t),this.Db(r,0,t,i),r},h.Db=function(t,i,n,r){var s,e;if(!this.XA&&!d.rI(t))throw TypeError("Illegal target: Not a ByteBuffer");if(i=(e=void 0===i)?t.offset:0|i,n=(s=void 0===n)?this.offset:0|n,r=void 0===r?this.WA:0|r,i<0||i>t.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+i+" <= "+t.buffer.byteLength);if(n<0||r>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+n+" <= "+this.buffer.byteLength);var h=r-n;return 0==h?t:(t.MN(i+h),t.view.set(this.view.subarray(n,r),i),s&&(this.offset+=h),e&&(t.offset+=h),this)},h.MN=function(t){var i=this.buffer.byteLength;return i<t?this.resize((i*=2)>t?i:t):this},h.fill=function(t,i,n){var r=void 0===i;if(r&&(i=this.offset),"string"==typeof t&&0<t.length&&(t=t.charCodeAt(0)),void 0===i&&(i=this.offset),void 0===n&&(n=this.WA),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal value: "+t+" (not an integer)");if(t|=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal begin: Not an integer");if(i>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,i<0||n<i||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+n+" <= "+this.buffer.byteLength)}if(n<=i)return this;for(;i<n;)this.view[i++]=t;return r&&(this.offset=i),this},h.cl=function(){return this.WA=this.offset,this.offset=0,this},h.mark=function(t){if(t=void 0===t?this.offset:t,!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return this.KA=t,this},h.order=function(t){if(!this.XA&&"boolean"!=typeof t)throw TypeError("Illegal littleEndian: Not a boolean");return this.$A=!!t,this},h.PN=function(t){return this.$A=void 0===t||!!t,this},h.LN=function(t){return this.$A=void 0!==t&&!t,this},h.prepend=function(t,i,n){"number"!=typeof i&&"string"==typeof i||(n=i,i=void 0);var r=void 0===n;if(r&&(n=this.offset),!this.XA){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}t instanceof d||(t=d.wrap(t,i));var s=t.WA-t.offset;if(s<=0)return this;var e=s-n;if(0<e){var h=new ArrayBuffer(this.buffer.byteLength+e),o=new Uint8Array(h);o.set(this.view.subarray(n,this.buffer.byteLength),s),this.buffer=h,this.view=o,this.offset+=e,0<=this.KA&&(this.KA+=e),this.WA+=e,n+=e}else new Uint8Array(this.buffer);return this.view.set(t.view.subarray(t.offset,t.WA),n-s),t.offset=t.WA,r&&(this.offset-=s),this},h.HN=function(t,i){return t.prepend(this,i),this},h.UN=function(t){"function"!=typeof t&&(t=emptyFunction.bind(console)),t(this.toString()+"\n-------------------------------------------------------------------\n"+this.FN(!0))},h.GN=function(){return this.WA-this.offset},h.reset=function(){return 0<=this.KA?(this.offset=this.KA,this.KA=-1):this.offset=0,this},h.resize=function(t){if(!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal capacity: "+t+" (not an integer)");if((t|=0)<0)throw RangeError("Illegal capacity: 0 <= "+t)}if(this.buffer.byteLength<t){var i=new ArrayBuffer(t),n=new Uint8Array(i);n.set(this.view),this.buffer=i,this.view=n}return this},h.reverse=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.WA),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}return t===i||Array.prototype.reverse.call(this.view.subarray(t,i)),this},h.XE=function(t){if(!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal length: "+t+" (not an integer)");t|=0}var i=this.offset+t;if(!this.XA&&(i<0||i>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+t+" <= "+this.buffer.byteLength);return this.offset=i,this},h.slice=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.WA),!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}var n=this.clone();return n.offset=t,n.WA=i,n},h.toBuffer=function(t){var i=this.offset,n=this.WA;if(!this.XA){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal offset: Not an integer");if(i>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal limit: Not an integer");if(n>>>=0,i<0||n<i||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+n+" <= "+this.buffer.byteLength)}if(!t&&0===i&&n===this.buffer.byteLength)return this.buffer;if(i===n)return e;var r=new ArrayBuffer(n-i);return new Uint8Array(r).set(new Uint8Array(this.buffer).subarray(i,n),0),r},h.toArrayBuffer=h.toBuffer,h.toString=function(t,i,n){if(void 0===t)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.KA+",limit="+this.WA+",capacity="+this.DN()+")";switch("number"==typeof t&&(n=i=t="utf8"),t){case"utf8":return this.xN(i,n);case"base64":return this.toBase64(i,n);case"hex":return this.BN(i,n);case"binary":return this.VN(i,n);case"debug":return this.FN();case"columns":return this.qN();default:throw Error("Unsupported encoding: "+t)}};var f=function(){for(var t={},s=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],h=[],i=0,n=s.length;i<n;++i)h[s[i]]=i;return t.encode=function(t,i){for(var n,r;null!==(n=t());)i(s[n>>2&63]),r=(3&n)<<4,null!==(n=t())?(i(s[63&((r|=n>>4&15)|n>>4&15)]),r=(15&n)<<2,null!==(n=t())?(i(s[63&(r|n>>6&3)]),i(s[63&n])):(i(s[63&r]),i(61))):(i(s[63&r]),i(61),i(61))},t.decode=function(t,i){var n,r,s;function e(t){throw Error("Illegal character code: "+t)}for(;null!==(n=t());)if(void 0===(r=h[n])&&e(n),null!==(n=t())&&(void 0===(s=h[n])&&e(n),i(r<<2>>>0|(48&s)>>4),null!==(n=t()))){if(void 0===(r=h[n])){if(61===n)break;e(n)}if(i((15&s)<<4>>>0|(60&r)>>2),null!==(n=t())){if(void 0===(s=h[n])){if(61===n)break;e(n)}i((3&r)<<6>>>0|s)}}},t.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)},t}();h.toBase64=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.WA),i|=0,(t|=0)<0||i>this.DN||i<t)throw RangeError("begin, end");var n;return f.encode(function(){return t<i?this.view[t++]:null}.bind(this),n=a()),n()},d.sI=function(t,i){if("string"!=typeof t)throw TypeError("str");var n=new d(t.length/4*3,i),r=0;return f.decode(o(t),function(t){n.view[r++]=t}),n.WA=r,n},d.btoa=function(t){return d.hI(t).toBase64()},d.atob=function(t){return d.sI(t).VN()},h.VN=function(t,i){if(void 0===t&&(t=this.offset),void 0===i&&(i=this.WA),i|=0,(t|=0)<0||i>this.DN()||i<t)throw RangeError("begin, end");if(t===i)return"";for(var n=[],r=[];t<i;)n.push(this.view[t++]),1024<=n.length&&(r.push(String.fromCharCode.apply(String,n)),n=[]);return r.join("")+String.fromCharCode.apply(String,n)},d.hI=function(t,i){if("string"!=typeof t)throw TypeError("str");for(var n,r=0,s=t.length,e=new d(s,i);r<s;){if(255<(n=t.charCodeAt(r)))throw RangeError("illegal char code: "+n);e.view[r++]=n}return e.WA=s,e},h.FN=function(t){for(var i,n=-1,r=this.buffer.byteLength,s="",e="",h="";n<r;){if(-1!==n&&(i=this.view[n],s+=i<16?"0"+i.toString(16).toUpperCase():i.toString(16).toUpperCase(),t&&(e+=32<i&&i<127?String.fromCharCode(i):".")),++n,t&&0<n&&n%16==0&&n!==r){for(;s.length<51;)s+=" ";h+=s+e+"\n",s=e=""}n===this.offset&&n===this.WA?s+=n===this.KA?"!":"|":n===this.offset?s+=n===this.KA?"[":"<":n===this.WA?s+=n===this.KA?"]":">":s+=n===this.KA?"'":t||0!==n&&n!==r?" ":""}if(t&&" "!==s){for(;s.length<51;)s+=" ";h+=s+e+"\n"}return t?h:s},d.uI=function(t,i,n){for(var r,s,e=t.length,h=new d((e+1)/3|0,i,n),o=0,u=0,a=!1,f=!1,c=!1,l=!1,v=!1;o<e;){switch(r=t.charAt(o++)){case"!":if(!n){if(f||c||l){v=!0;break}f=c=l=!0}h.offset=h.KA=h.WA=u,a=!1;break;case"|":if(!n){if(f||l){v=!0;break}f=l=!0}h.offset=h.WA=u,a=!1;break;case"[":if(!n){if(f||c){v=!0;break}f=c=!0}h.offset=h.KA=u,a=!1;break;case"<":if(!n){if(f){v=!0;break}f=!0}h.offset=u,a=!1;break;case"]":if(!n){if(l||c){v=!0;break}l=c=!0}h.WA=h.KA=u,a=!1;break;case">":if(!n){if(l){v=!0;break}l=!0}h.WA=u,a=!1;break;case"'":if(!n){if(c){v=!0;break}c=!0}h.KA=u,a=!1;break;case" ":a=!1;break;default:if(!n&&a){v=!0;break}if(s=parseInt(r+t.charAt(o++),16),!n&&(isNaN(s)||s<0||255<s))throw TypeError("Illegal str: Not a debug encoded string");h.view[u++]=s,a=!0}if(v)throw TypeError("Illegal str: Invalid symbol at "+o)}if(!n){if(!f||!l)throw TypeError("Illegal str: Missing offset or limit");if(u<h.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+u+" < "+e)}return h},h.BN=function(t,i){if(t=void 0===t?this.offset:t,i=void 0===i?this.WA:i,!this.XA){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof i||i%1!=0)throw TypeError("Illegal end: Not an integer");if(i>>>=0,t<0||i<t||i>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+i+" <= "+this.buffer.byteLength)}for(var n,r=new Array(i-t);t<i;)(n=this.view[t++])<16?r.push("0",n.toString(16)):r.push(n.toString(16));return r.join("")},d.eI=function(t,i,n){if(!n){if("string"!=typeof t)throw TypeError("Illegal str: Not a string");if(t.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var r,s=t.length,e=new d(s/2|0,i),h=0,o=0;h<s;h+=2){if(r=parseInt(t.substring(h,h+2),16),!n&&(!isFinite(r)||r<0||255<r))throw TypeError("Illegal str: Contains non-hex characters");e.view[o++]=r}return e.WA=o,e};var c=function(){var r={QN:1114111,YN:function(t,i){var n=null;for("number"==typeof t&&(n=t,t=function(){return null});null!==n||null!==(n=t());)n<128?i(127&n):(n<2048?i(n>>6&31|192):(n<65536?i(n>>12&15|224):(i(n>>18&7|240),i(n>>12&63|128)),i(n>>6&63|128)),i(63&n|128)),n=null},AN:function(t,i){for(var n,r,s,e,h=function(t){t=t.slice(0,t.indexOf(null));var i=Error(t.toString());throw i.name="TruncatedError",i.bytes=t,i};null!==(n=t());)if(0==(128&n))i(n);else if(192==(224&n))null===(r=t())&&h([n,r]),i((31&n)<<6|63&r);else if(224==(240&n))null!==(r=t())&&null!==(s=t())||h([n,r,s]),i((15&n)<<12|(63&r)<<6|63&s);else{if(240!=(248&n))throw RangeError("Illegal starting byte: "+n);null!==(r=t())&&null!==(s=t())&&null!==(e=t())||h([n,r,s,e]),i((7&n)<<18|(63&r)<<12|(63&s)<<6|63&e)}},KN:function(t,i){for(var n,r=null;null!==(n=null!==r?r:t());)55296<=n&&n<=57343&&null!==(r=t())&&56320<=r&&r<=57343?(i(1024*(n-55296)+r-56320+65536),r=null):i(n);null!==r&&i(r)},IN:function(t,i){var n=null;for("number"==typeof t&&(n=t,t=function(){return null});null!==n||null!==(n=t());)n<=65535?i(n):(i(55296+((n-=65536)>>10)),i(n%1024+56320)),n=null},wN:function(t,i){r.KN(t,function(t){r.YN(t,i)})},pN:function(t,i){r.AN(t,function(t){r.IN(t,i)})},WN:function(t){return t<128?1:t<2048?2:t<65536?3:4},$N:function(t){for(var i,n=0;null!==(i=t());)n+=i<128?1:i<2048?2:i<65536?3:4;return n},EN:function(t){var i=0,n=0;return r.KN(t,function(t){++i,n+=t<128?1:t<2048?2:t<65536?3:4}),[i,n]}};return r}();return h.xN=function(i,n){if(void 0===i&&(i=this.offset),void 0===n&&(n=this.WA),!this.XA){if("number"!=typeof i||i%1!=0)throw TypeError("Illegal begin: Not an integer");if(i>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,i<0||n<i||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+i+" <= "+n+" <= "+this.buffer.byteLength)}var t;try{c.pN(function(){return i<n?this.view[i++]:null}.bind(this),t=a())}catch(t){if(i!==n)throw RangeError("Illegal range: Truncated data, "+i+" != "+n)}return t()},d.oI=function(t,i,n){if(!n&&"string"!=typeof t)throw TypeError("Illegal str: Not a string");var r=new d(c.EN(o(t),!0)[1],i,n),s=0;return c.wN(o(t),function(t){r.view[s++]=t}),r.WA=s,r},d})?r.apply(i,s):r)||(t.exports=e)},function(t,i){var n,r,s=t.exports={};function e(){throw new Error("setTimeout has not been defined")}function h(){throw new Error("clearTimeout has not been defined")}function o(i){if(n===setTimeout)return setTimeout(i,0);if((n===e||!n)&&setTimeout)return n=setTimeout,setTimeout(i,0);try{return n(i,0)}catch(t){try{return n.call(null,i,0)}catch(t){return n.call(this,i,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:e}catch(t){n=e}try{r="function"==typeof clearTimeout?clearTimeout:h}catch(t){r=h}}();var u,a=[],f=!1,c=-1;function l(){f&&u&&(f=!1,u.length?a=u.concat(a):c=-1,a.length&&v())}function v(){if(!f){var t=o(l);f=!0;for(var i=a.length;i;){for(u=a,a=[];++c<i;)u&&u[c].XN();c=-1,i=a.length}u=null,f=!1,(function(i){if(r===clearTimeout)return clearTimeout(i);if((r===h||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(i);try{r(i)}catch(t){try{return r.call(null,i)}catch(t){return r.call(this,i)}}})(t)}}function d(t,i){this.zN=t,this.array=i}function E(){}s.Me=function(t){var i=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)i[n-1]=arguments[n];a.push(new d(t,i)),1!==a.length||f||o(v)},d.prototype.XN=function(){this.zN.apply(null,this.array)},s.title="browser",s.JN=!0,s.Ge={},s.ZN=[],s.version="",s.Fp={},s.on=E,s.addListener=E,s.tC=E,s.off=E,s.removeListener=E,s.iC=E,s.nh=E,s.nC=E,s.rC=E,s.listeners=function(t){return[]},s.sC=function(t){throw new Error("process.binding is not supported")},s.eC=function(){return"/"},s.hC=function(t){throw new Error("process.chdir is not supported")},s.oC=function(){return 0}},function(t,i,n){"use strict";var h=n(39);t.exports=Object,Object.empty=Object.freeze(Object.create(null)),Object.tc=function(t){return Object(t)===t},Object.uC=function(t){return t&&"function"==typeof t.valueOf&&(t=t.valueOf()),t};var r=new h();Object.hash=function(t){return t&&"function"==typeof t.hash?""+t.hash():Object(t)===t?(r.has(t)||r.set(t,Math.random().toString(36).slice(2)),r.get(t)):""+t};var s=Object.prototype.hasOwnProperty;Object.aC=function(t,i){return s.call(t,i)},Object.has=function(t,i){if("object"!=typeof t)throw new Error("Object.has can't accept non-object: "+typeof t);if(t&&"function"==typeof t.has)return t.has(i);if("string"==typeof i)return i in t&&t[i]!==Object.prototype[i];throw new Error("Key must be a string for Object.has on plain objects")},Object.get=function(t,i,n){if("object"!=typeof t)throw new Error("Object.get can't accept non-object: "+typeof t);return t&&"function"==typeof t.get?t.get(i,n):Object.has(t,i)?t[i]:n},Object.set=function(t,i,n){t&&"function"==typeof t.set?t.set(i,n):t[i]=n},Object.hiveAddEach=function(n,i){if(i)if("function"!=typeof i.forEach||i.hasOwnProperty("forEach"))if("number"==typeof i.length)for(var t=0;t<i.length;t++)n[t]=i[t];else Object.keys(i).forEach(function(t){n[t]=i[t]});else!0===i.isMap?i.forEach(function(t,i){n[i]=t}):i.forEach(function(t){n[t[0]]=t[1]});return n},Object.forEach=function(t,i,n){for(var r,s=Object.keys(t),e=0;r=s[e];e++)i.call(n,t[r],r,t)},Object.map=function(t,i,n){for(var r,s=Object.keys(t),e=0,h=[];r=s[e];e++)h.push(i.call(n,t[r],r,t));return h},Object.values=function(t){return Object.map(t,Function.identity)},Object.concat=function(){for(var t={},i=0;i<arguments.length;i++)Object.hiveAddEach(t,arguments[i]);return t},Object.from=Object.concat,Object.is=function(t,i){return t===i?0!==t||1/t==1/i:t!=t&&i!=i},Object.equals=function(t,i,n,r){if(n=n||Object.equals,(t=Object.uC(t))===(i=Object.uC(i)))return!0;if(Object.tc(t)){if((r=r||new h()).has(t))return!0;r.set(t,!0)}if(Object.tc(t)&&"function"==typeof t.equals)return t.equals(i,n,r);if(Object.tc(i)&&"function"==typeof i.equals)return i.equals(t,n,r);if(Object.tc(t)&&Object.tc(i)&&Object.getPrototypeOf(t)===Object.prototype&&Object.getPrototypeOf(i)===Object.prototype){for(var s in t)if(!n(t[s],i[s],n,r))return!1;for(var s in i)if(!(s in t&&n(i[s],t[s],n,r)))return!1;return!0}return t!=t&&i!=i||(!t||!i)&&t===i},Object.compare=function(t,i){if((t=Object.uC(t))===(i=Object.uC(i)))return 0;var n=typeof t,r=typeof i;return"number"==n&&"number"==r?t-i:"string"==n&&"string"==r?t<i?-1/0:1/0:t&&"function"==typeof t.compare?t.compare(i):i&&"function"==typeof i.compare?-i.compare(t):0},Object.clone=function(t,i,n){if(t=Object.uC(t),n=n||new h(),void 0===i)i=1/0;else if(0===i)return t;if(Object.tc(t)){if(!n.has(t))if(t&&"function"==typeof t.clone)n.set(t,t.clone(i,n));else{var r=Object.getPrototypeOf(t);if(null!==r&&r!==Object.prototype)throw new Error("Can't clone "+t);var s=Object.create(r);for(var e in n.set(t,s),t)s[e]=Object.clone(t[e],i-1,n)}return n.get(t)}return t},Object.clear=function(t){if(t&&"function"==typeof t.clear)t.clear();else for(var i=Object.keys(t),n=i.length;n;)delete t[i[--n]];return t}},function(T,t){!function(){"use strict";if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.fC=E);var i=!1;if("function"==typeof WeakMap){var n=WeakMap;if(!("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent))){var t=new n(),r=Object.freeze({});if(t.set(r,1),1===t.get(r))return T.exports=WeakMap;i=!0}}Object.prototype.hasOwnProperty;var s=Object.getOwnPropertyNames,e=Object.defineProperty,h=Object.isExtensible,o="weakmap:",u=o+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var a=new ArrayBuffer(25),f=new Uint8Array(a);crypto.getRandomValues(f),u=o+"rand:"+Array.prototype.map.call(f,function(t){return(t%36).toString(36)}).join("")+"___"}if(e(Object,"getOwnPropertyNames",{value:function(t){return s(t).filter(w)}}),"getPropertyNames"in Object){var c=Object.cC;e(Object,"getPropertyNames",{value:function(t){return c(t).filter(w)}})}!function(){var i=Object.freeze;e(Object,"freeze",{value:function(t){return p(t),i(t)}});var n=Object.seal;e(Object,"seal",{value:function(t){return p(t),n(t)}});var r=Object.preventExtensions;e(Object,"preventExtensions",{value:function(t){return p(t),r(t)}})}();var l=!1,v=0,d=function(){this instanceof d||b();var s=[],e=[],h=v++;return Object.create(d.prototype,{lC:{value:g(function(t,i){var n,r=p(t);return r?h in r?r[h]:i:0<=(n=s.indexOf(t))?e[n]:i})},vC:{value:g(function(t){var i=p(t);return i?h in i:0<=s.indexOf(t)})},dC:{value:g(function(t,i){var n,r=p(t);return r?r[h]=i:0<=(n=s.indexOf(t))?e[n]=i:(n=s.length,e[n]=i,s[n]=t),this})},EC:{value:g(function(t){var i,n,r=p(t);return r?h in r&&delete r[h]:!((i=s.indexOf(t))<0)&&(n=s.length-1,s[i]=void 0,e[i]=e[n],s[i]=s[n],s.length=n,e.length=n,!0)})}})};d.prototype=Object.create(Object.prototype,{get:{value:function(t,i){return this.lC(t,i)},writable:!0,configurable:!0},has:{value:function(t){return this.vC(t)},writable:!0,configurable:!0},set:{value:function(t,i){return this.dC(t,i)},writable:!0,configurable:!0},"delete":{value:function(t){return this.EC(t)},writable:!0,configurable:!0}}),"function"==typeof n?(i&&"undefined"!=typeof Proxy&&(Proxy=void 0),y.prototype=d.prototype,T.exports=y,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})):("undefined"!=typeof Proxy&&(Proxy=void 0),T.exports=d)}function E(t){t.wC&&t.wC(E)}function w(t){return!(t.substr(0,o.length)==o&&"___"===t.substr(t.length-3))}function p(t){if(t!==Object(t))throw new TypeError("Not an object: "+t);var i=t[u];if(i&&i.key===t)return i;if(h(t)){i={key:t};try{return e(t,u,{value:i,writable:!1,enumerable:!1,configurable:!1}),i}catch(t){return}}}function g(t){return t.prototype=null,Object.freeze(t)}function b(){l||"undefined"==typeof console||(l=!0,!1)}function y(){this instanceof d||b();var t,r=new n(),s=void 0,e=!1;return t=i?function(t,i){return r.set(t,i),r.has(t)||(s=s||new d()).set(t,i),this}:function(i,n){if(e)try{r.set(i,n)}catch(t){(s=s||new d()).dC(i,n)}else r.set(i,n);return this},Object.create(d.prototype,{lC:{value:g(function(t,i){return s?r.has(t)?r.get(t):s.lC(t,i):r.get(t,i)})},vC:{value:g(function(t){return r.has(t)||!!s&&s.vC(t)})},dC:{value:g(t)},EC:{value:g(function(t){var i=!!r["delete"](t);return s&&s.EC(t)||i})},wC:{value:g(function(t){if(t!==E)throw new Error("bogus call to permitHostObjects___");e=!0})}})}}()},function(t,i,n){"use strict";var r=n(39),s=n(58),e=new r();function h(){throw new Error("Can't construct. RangeChanges is a mixin.")}(t.exports=h).prototype.pC=function(){return e.has(this)||e.set(this,s()),e.get(this)},h.prototype.gC=function(t){var i=this.pC();return t=t||"",i.has(t)||i.set(t,{isActive:!1,xf:[],Gf:[]}),i.get(t)},h.prototype.bC=function(t,i,n){!this.Qf&&this.qf&&this.qf();var r=this.gC(i);(n?r.Gf:r.xf).push(t),Object.defineProperty(this,"yC",{value:!0,writable:!0,configurable:!0,enumerable:!1});var s=this;return function(){s&&(s.TC(t,i,n),s=null)}},h.prototype.TC=function(t,i,n){var r,s=this.gC(i),e=(r=n?s.Gf:s.xf).lastIndexOf(t);if(-1===e)throw new Error("Can't remove range change listener: does not exist: token "+JSON.stringify(i));r.splice(e,1)},h.prototype.OC=function(s,e,h,o){var t=this.pC(),u="Range"+(o?"WillChange":"Change");t.forEach(function(t,i){if(!t.isActive){var n;t.isActive=!0,n=o?t.Gf:t.xf;var r="handle"+(i.slice(0,1).toUpperCase()+i.slice(1))+u;try{n.slice().forEach(function(t){if(!(n.indexOf(t)<0))if(t[r])t[r](s,e,h,this,o);else{if(!t.call)throw new Error("Handler "+t+" has no method "+r+" and is not callable");t.call(this,s,e,h,this,o)}},this)}finally{t.isActive=!1}}},this)},h.prototype.mC=function(t,i){return this.bC(t,i,!0)},h.prototype._C=function(t,i){return this.TC(t,i,!0)},h.prototype.RC=function(t,i,n){return this.OC(t,i,n,!0)}},function(t,i){function n(){throw new Error("Can't construct. GenericSet is a mixin.")}(t.exports=n).prototype.SC=!0,n.prototype.AC=function(t){var i=this.Ne(this);return i.hiveAddEach(t),i},n.prototype.IC=function(i){return this.Ne(this.filter(function(t){return i.has(t)}))},n.prototype.NC=function(t){var i=this.Ne(this);return i.Of(t),i},n.prototype.CC=function(t){var i=this.AC(t),n=this.IC(t);return i.NC(n)},n.prototype.kC=function(t){return+this["delete"](t)},n.prototype.equals=function(t,n){var r=this;return t&&"function"==typeof t.reduce&&this.length===t.length&&t.reduce(function(t,i){return t&&r.has(i,n)},!0)},n.prototype.toJSON=function(){return this.toArray()},n.prototype.contains=function(t){return this.has(t)},n.prototype.remove=function(t){return this["delete"](t)},n.prototype.toggle=function(t){this.has(t)?this["delete"](t):this.hiveAdd(t)}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.DC="CACHE",s.jC="CENTRAL_FRAGMENT",s.jR="CONNECTIVITY_INFO_PROVIDER",s.MC="CONTEXT_RESOLVER",s.PC="DCACHE",s.LC="FALLBACK_REQUESTER",s.HC="FRAGMENT_METADATA_METRICS_PROVIDER",s.UC="HTTP_MANAGER",s.FC="HTTP_REQUEST",s.Pl="IDENTITY_PROVIDER",s.GC="IN_PARTNERSHIP",s.xC="IN_PREFETCHER_PARTNERSHIP",s.BC="IP_SPOOFING",s.VC="LIVE_CACHE",s.qC="LOCALITY_CLIENT",s.QC="LOCALITY_SCORE",s.p="LOGGER",s.YC="MEMBERSHIP",s.NETWORK="NETWORK",s.KC="PEER_NODE_INFO",s.WC="OBJECT_INDEX",s.$C="OUT_PARTNERSHIP",s.XC="OUT_PREFETCHER_PARTNERSHIP",s.zC="P2P_REQUESTER",s.JC="P2P_VIDEO_PREFETCHER",s.ZC="PARTNERSHIP",s.Kc="PEER",s.tk="PEER_CONNECTIVITY_INFO",s.ik="PICKER",s.nk="PREFETCH_MANAGER",s.rk="REPORTING",s.sk="REQUEST_TRACKER",s.ek="RESPONDER",s.Zc="RTC_MANAGER",s.hk="SCORE_UPDATER",s.uk="SERVER_MANAGER",s.jl="SERVICES_CLIENT",s.ak="SNAP_STATS_MANAGER",s.zl="STATS_CLIENT",s.nv="STATS_NODE_INFO",s.Xl="STATS_STORE",s.fk="STREAM_INFO_METRICS_PROVIDER",s.vv="TICKET_RESOLVER",s.l="TIMER",s.ck="TRACKER_CLIENT",s.lk="TRACKER_MANAGER",s.vk="TRACK_CLIENT",s.Jl="TRACK_MANAGER",s.dk="TRANSPORT",s.Ek="UDP_BROADCASTER",s.wk="UDP_DISCOVERY",s.sf="UDP_LEADER_ELECTION",s.pk="VOD_CACHE",s.gk="QUALITY_LEVEL_TRACKER",s.bk="QUALITY_LEVEL_METRICS_PROVIDER",s);function s(){}i.v=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.LoggerTimestamp=!0,s);function s(){}var e=(h.MetricSnapshotLogs=0,h.TrackSnapshotLogs=0,h);function h(){}var o=(u.Framework=r,u.DebugLogs=e,u);function u(){}i.HiveConfig=o,"undefined"!=typeof window&&(void 0===window.HiveConfig&&(window.HiveConfig={}),window.HiveConfig.Framework=o.Framework,window.HiveConfig.DebugLogs=o.DebugLogs)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.wv="undefined"!=typeof location&&"https:"===location.protocol,s.Ov=!0,s.yk=1e4,s.du=6e4,s.Tk="X-Hive-TestId",s);function s(){}i.Rc=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.Ok="127.0.0.1",s.Tv=8999,s.yv=8998,s.bv=8899,s.pv=8898,s.mk="//{0}:{1}/?callback={2}{3}hivePluginId={4}",s._k="//{0}:{1}/?callback={2}",s.Ov=!0,s.Rk=/((http|https):\/\/(.*):([0-9]*)\/([0-9a-z-]*).ism\/)(.*)/,s.Sk="2013.1.1",s.Ak="2018.1",s);function s(){}i.gv=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(1),s=(e.prototype.createXMLHttpRequest=function(){if(!this.pluginId){if(0===Object.keys(e.handlers).length)return e.logError("No registered default HiveRequestFactory tech",e.loggerId),new XMLHttpRequest();this.pluginId=Object.keys(e.handlers)[0]}var t=e.handlers[this.pluginId];if(!t)return e.logError("no registered HiveRequestFactory tech for plugin",{pluginId:this.pluginId}),new XMLHttpRequest();var i=t.delegate;return t.manifestRequested?i.createRequest(this.pluginId):(t.manifestRequested=!0,i.createManifestRequest(this.pluginId))},e.register=function(t){var i=t.getName(),n=t.getPluginId();this.handlers[n]||(this.handlers[n]={tech:i,delegate:t,manifestRequested:!1})},e.clear=function(){this.handlers={}},e.clearPlugin=function(t){this.handlers[t]&&delete this.handlers[t]},e.clearPluginState=function(t){this.handlers[t]&&(this.handlers[t].manifestRequested=!1)},e.logError=function(t,i){this.errorLogged||(this.errorLogged=!0,r.ErrorMonitor.getInstance().logError(t,i))},e.loggerId="[HiveRequestFactory]",e.handlers={},e.errorLogged=!1,e);function e(t){this.pluginId=t}i.HiveRequestFactory=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,s,e=n(4),h=n(1),o=n(28),u=n(2);(s=r=i.ER||(i.ER={})).INITIALIZED="INITIALIZED",s.ACTIVE="ACTIVE",s.IDLE="IDLE",s.CLOSED="CLOSED";var a=(f.prototype.isActive=function(t,i){return void 0===i&&(i=!1),null!==this.tech&&this.tech.isActive(t,this,i)},f.prototype.updateIdleState=function(t){if(this.idle!=t){this.idle=t,this.tech&&this.tech.onStateChange(this,t);var i=this.idle?r.IDLE:r.ACTIVE;this.notifyStateChange(i)}},f.prototype.getTechName=function(){return this.tech&&this.tech.getName()||void 0},f.prototype.isIdle=function(){return this.idle},f.prototype.close=function(t,i){void 0===i&&(i=!0),this.idle=!0,null!=this.tech&&this.tech.closeSession(this,t,i),this.notifyStateChange(r.CLOSED)},f.prototype.toString=function(){return this.ticket.toString()},f.prototype.toHiveSession=function(){var t=new o.HiveSession();return t.id=this.id,t.ticketUrl=this.ticketUrl,t.manifest=this.manifest,t.tech=this.tech.getName(),t},f.prototype.getReportingInstance=function(){return this.deferReportingInstance.promise},f.prototype.setReportingInstance=function(t){this.reportingInstance=t,this.deferReportingInstance.resolve(this.reportingInstance)},f.prototype.notifyStateChange=function(t){if(this.stateChangeCb)try{this.stateChangeCb({id:this.id,state:t,time:Date.now()})}catch(t){h.ErrorMonitor.getInstance().logError(this.loggerId+" exception in user-defined Generic onSessionStateChange callback: "+t,this.loggerId,u.ie.fe)}},f.prototype.supportsXhrInterception=function(){return!!this.tech&&this.tech.supportsXhrInterception()},f);function f(t,i,n,r,s){this.loggerId="[HiveSessionInternal]",this.idle=!1,this.ticketUrl=t,this.ticket=i,this.manifest=n,"function"==typeof s&&(this.stateChangeCb=s),this.deferReportingInstance=e.defer(),this.reportingInstance=r,this.reportingInstance&&this.deferReportingInstance.resolve(this.reportingInstance)}i.HiveSessionInternal=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.from=function(t){return new s(t.id,t.bitrate)},s.prototype.Ob=function(t){return this.id===t.id?0:this.Ik-t.Ik},s.prototype.Nk=function(){this.Ck=[this.bitrate]},s);function s(t,i,n,r,s){this.id=t,this.bitrate=i,this.Ik=null,this.Ck=[i],this.width=n,this.height=r,this.label=s}i.QualityLevel=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(77),o=n(0),r=n(16),s=n(3),e=n(13),u=(a.oS=function(t,i,n){this.client=t,this.kk=i,this.guid=n},a.Dk=function(t,i,n,r,s){var e=new h.NS();e.app=t||"CustomSnapshot",e.guid=r||this.guid,e.createdAt=o.Framework.time(),e.name=n,e.tags=i||this.kk,e.data="string"==typeof s?JSON.parse(s):s,this.send(e)},a.send=function(t){var i=new r.Lc(HiveStreamingServices.VS,2,JSON.stringify(t));this.client&&this.jk&&this.client.xS().send(i)},a.Mk=function(t,i,n,r,s,e){try{var h=t+(i?i.join():"")+n+r,o=this.Pk.has(h)?this.Pk.get(h):[];o.push("string"==typeof s?JSON.parse(s):s),o.length>=e?(this.Dk(t,i,n,r,{buffer:o}),this.Pk["delete"](h)):this.Pk.set(h,o)}catch(t){}},a.jk=e.HiveConfig.ec.enabled,a.Pk=new s(),a);function a(){}i.Lk=u},function(t,i,n){"use strict";function r(t,i){for(var n=0;n<i.length;n++){var r=i[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(i,"s",{value:!0});var s=(function(t,i,n){return i&&r(t.prototype,i),n&&r(t,n),t}(e,[{key:"test",get:function(){return this.Hk}},{key:"converter",get:function(){return this.Uk}}]),e);function e(t,i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,e),this.Hk=t,this.Uk=i}i["default"]=s},function(t,i,n){"use strict";function r(t,i){for(var n=0;n<i.length;n++){var r=i[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,s),this.init()}Object.defineProperty(i,"s",{value:!0});var e=new(function(t,i,n){return i&&r(t.prototype,i),n&&r(t,n),t}(s,[{key:"init",value:function(){this.Fk="BaseURL",this.Gk="SegmentBase",this.xk="SegmentTemplate",this.Bk="SegmentList",this.Vk="SegmentURL",this.qk="SegmentTimeline",this.Qk="segmentProfiles",this.Yk="AdaptationSet",this.Kk="Representation",this.Wk="RepresentationIndex",this.$k="SubRepresentation",this.Xk="Initialization",this.zk="initialization",this.MPD="MPD",this.zo="Period",this.Jk="AssetIdentifier",this.Zk="EventStream",this.tD="id",this.iD="profiles",this.nD="serviceLocation",this.rD="range",this.sD="index",this.eD="media",this.hD="byteRange",this.oD="indexRange",this.uD="mediaRange",this.aD="value",this.fD="contentType",this.cD="mimeType",this.lD="BitstreamSwitching",this.vD="bitstreamSwitching",this.dD="codecs",this.ED="dependencyId",this.wD="mediaStreamStructureId",this.pD="Metrics",this.gD="metrics",this.rk="Reporting",this.bD="width",this.yD="height",this.TD="sar",this.OD="frameRate",this.mD="audioSamplingRate",this._D="maximumSAPPeriod",this.RD="startWithSAP",this.SD="maxPlayoutRate",this.AD="codingDependency",this.ID="scanType",this.ND="FramePacking",this.CD="AudioChannelConfiguration",this.kD="ContentProtection",this.DD="EssentialProperty",this.jD="SupplementalProperty",this.MD="InbandEventStream",this.PD="Accessibility",this.LD="Role",this.HD="Rating",this.UD="ContentComponent",this.FD="Subset",this.GD="lang",this.xD="Viewpoint",this.BD="Role_asArray",this.VD="Accessibility_asArray",this.qD="AudioChannelConfiguration_asArray",this.QD="ContentProtection_asArray",this.YD="main",this.KD="dynamic",this.WD="static",this.$D="mediaPresentationDuration",this.XD="minimumUpdatePeriod",this.zD="codecPrivateData",this.JD="bandwidth",this.ZD="sourceURL",this.tj="timescale",this.ij="duration",this.nj="startNumber",this.rj="presentationTimeOffset",this.sj="availabilityStartTime",this.ej="availabilityEndTime",this.hj="timeShiftBufferDepth",this.oj="maxSegmentDuration",this.uj="presentationTime",this.aj="minBufferTime",this.fj="maxSubsegmentDuration",this.cj="start",this.lj="availabilityTimeOffset",this.vj="availabilityTimeComplete",this.dj="cenc:default_KID",this.Ej="dvb:priority",this.wj="dvb:weight",this.pj="suggestedPresentationDelay",this.gj="ServiceDescription",this.bj="Scope",this.yj="Latency",this.Tj="PlaybackRate"}}]),s)();i["default"]=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(172),s=(e.bA=function(t,i,n){return this.yA(t,i,n)||-1!=t.indexOf(e.TA)},e.yA=function(t,i,n){var r=-1!=t.toLowerCase().indexOf(e.OA.toLowerCase())||-1!=t.toLowerCase().indexOf(e.Oj.toLowerCase())||-1!=t.toLowerCase().indexOf(e.mj.toLowerCase());if(n){if(n.test(t))return!0;!r&&i&&i.warn(this.loggerId+"Context matcher set to "+n+" failed against "+t)}return r},e.SA=function(t,i){return new r._j(t,i)},e.loggerId="[HLS] ",e.Rj=1,e.Sj=2,e.Aj=3e4,e.Ij=4e3,e.Nj=500,e.Cj=!0,e.kj=1e4,e.Dj=16,e.jj=3,e.OA=".m3u8",e.Oj="(format=m3u8-aapl-v3)",e.mj="(video,format=m3u8-aapl-v3,audiotrack=audio)",e.TA=".ts",e);function e(){}i.Mj=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.Pj=55,s.Lj=6e5,s.Hj=5,s.Uj=10,s.Fj=2,s.Gj=10,s.xj="dist",s.Bj="../scenarios/BrokenUdp",s.Vj=null,s.qj=null,s.Qj=null,s.Yj=!0,s.Kj=!0,s.Wj=6e4,s);function s(){}i.$j=r;var e=(h.Xj="BwEmulation",h);function h(){}i.zj=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var a,r,v,s,f=n(66),c=n(3),l=n(24),d=n(0),E=n(5),e=n(7),w=n(9),p=n(1),g=n(2),b=n(185);(r=a=i.Jj||(i.Jj={}))[r.Z_=0]="PLAYER",r[r.Zj=1]="LAN",r[r.tM=2]="SITE",(s=v=v||{})[s.Zj=0]="LAN",s[s.tM=1]="SITE",s[s.AS=2]="AS",s[s.Qa=3]="OTHER";var h=function(){this.iM=!1,this.oA=null,this.prefetchDelay=-1,this.nM=0};i.rM=h;var o=(u.prototype.init=function(t){this.logger=d.Framework.resolve(d.Framework.v.p).log(t.sessionId),this.sM=t.eM,this.hM=t.hM,this.oM=t.oM,this.gw=t.gw,this.pluginId=t.reportingInstance.ticket.pluginId,this.tv=t.tv,this.partnership=t.partnership,this.uM=t.uM,this.aM=t.aM},u.prototype.AR=function(){this.isActive=!0},u.prototype.fM=function(t,i){this.context=t,this.cM=i,this.uM.fM(i)},u.prototype.lM=function(t){return this.vM.has(t.id)},u.prototype.dM=function(){return this.cM},u.prototype.EM=function(i,t,n){var r=this;try{var s=new f();this.vM.forEach(function(t,i){s.hiveAdd(i)});var e=new f();if(e.hiveAddEach(i.keys()),this.cM.wM()){var h=this.cM.wM().getQualityLevel();if(e.hiveAdd(h.id),e.forEach(function(t){s["delete"](t)}),n){var o=[];s.forEach(function(t){r.vM.has(t)&&r.vM.get(t).pM==a.tM&&(o.push(t),e.hiveAdd(t))}),o.forEach(function(t){s["delete"](t)})}var u=new c();e.forEach(function(t){r.vM.has(t)&&r.vM.get(t).pM==a.tM?u.set(t,a.tM):u.set(t,i.get(t))}),this.gM(s),this.bM(u,t)}}catch(t){p.ErrorMonitor.getInstance().logError("Error updating the prefetch sessions",this.loggerId,g.Is.Ns,t)}},u.prototype.bM=function(t,r){var s=this;t.forEach(function(t,i){var n=s.cM.yM().get(i);n&&s.TM(n,t,r)})},u.prototype.gM=function(t){var n=this;t.forEach(function(t){var i=n.vM.get(t).qualityLevel;n.tv.OM(i),n.logger.debug(n.loggerId+"Remove unwanted quality level "+t),n.vM["delete"](t)})},u.prototype.TM=function(t,i,n){this.vM.has(t.id)?this.mM(t,n):this.vM.has(t.id)||this._M(t,i,n)},u.prototype.mM=function(t,i){try{var n=this.vM.get(t.id);n.type=i,n.type!=a.tM&&(n.prefetchDelay=-1),this.tv.RM(t,n)}catch(t){p.ErrorMonitor.getInstance().logError("Error configuring already existing prefetch sessions",this.loggerId,g.Is.Cs,t)}},u.prototype._M=function(t,i,n){var r=this;try{var s=new h();s.oA=null,s.type=n,s.qualityLevel=t,s.pM=i,this.vM.set(t.id,s),this.vM.forEach(function(t,i){r.logger.debug(r.loggerId+"ABT "+i+" S "+a[t.type]+" PREF REASON "+a[t.pM])}),this.tv.RM(t,s)}catch(t){p.ErrorMonitor.getInstance().logError("Error constructing a new prefetch session",this.loggerId,g.Is.ks,t)}},u.prototype.SM=function(n){var r=this;if(this.vM.has(n.getQualityLevel().id)){var t=this.vM.get(n.getQualityLevel().id);0<t.prefetchDelay&&t.AM&&(t.prefetchDelay=n.getDuration()-(d.Framework.time()-t.AM)-t.nM,t.nM=50),t.oA=n,this.IM(n.getQualityLevel()),this.vM.forEach(function(t,i){t&&t.type!=a.Z_&&i!=n.getQualityLevel().id&&r.NM(t,r.vM.get(i).qualityLevel)})}},u.prototype.NM=function(t,i){if(t.type!=a.Z_){var n=this.cM.wM();if(null!=n){var r=this.cM.CM(n.uA(),i,e.xa.Va);null==r?(this.logger.debug(this.loggerId+"PREFETCHING "+i+" MISSING METADATA "),this.iM(i)):(t.oA=r,this.IM(r.getQualityLevel()))}else this.logger.debug(this.loggerId+"PLAYER NOT PLAYING "),this.iM(i)}},u.prototype.kM=function(t){var i=this.vM.get(t.id);i&&i.iM&&(null!=i.oA?(this.logger.debug(this.loggerId+"RESTART PREFETCHING ON AVAILABLE METADATA"),i.iM=!1,this.IM(i.qualityLevel)):(i.iM=!1,this.NM(i,t)))},u.prototype.DM=function(t){var n=this;t?this.kM(t):this.vM.forEach(function(t,i){n.kM(n.vM.get(i).qualityLevel)})},u.prototype.IM=function(t){var i=this.cM.wM();if(i){var n=this.vM.get(t.id);if(n){if(n.oA&&i.getQualityLevel().id===t.id){var r=this.jM(n.oA.uA(),t);this.tv.setDelta(r)}this.MM(n)}}else p.ErrorMonitor.getInstance().logError("Error attempting prefetch before having a player request",this.loggerId,g.Is.js)},u.prototype.MM=function(t){if(t.oA){var i=this.PM(t.oA);if(null!=i)this.LM(i,t);else{var n=t.qualityLevel;this.logger.debug(this.loggerId+"PREFETCHING "+n.id+" STOPPED BECAUSE OF MISSING METADATA "),this.vM.get(n.id).iM=!0,this.iM(n)}}else t.iM=!0,this.iM(t.qualityLevel)},u.prototype.LM=function(h,t){var o=this,i=this.HM(h,t.type);if(i.jk)try{this.UM.has(h.I_())&&d.Framework.clearTimeout(this.UM.get(h.I_()));var n=i.type==l.h_.a_,r=1;if(n){var s=Math.max(0,t.prefetchDelay);r=this.uM.FM(t.type,h.getQualityLevel(),h.uA(),s)}this.logger.debug(this.loggerId+"PREFETCHING "+h.D_()+" CDN PREFETCH "+n+" IN "+r+" MSECS");var u=this.vM.get(h.getQualityLevel().id);u.oA=h;var e=d.Framework.setTimeout(function(){o.UM["delete"](h.I_());var s=new b.GM(o.pluginId);s.url=h.D_(),u.AM=d.Framework.time(),o.xM=0;var e=o.hM.BM(s,h,o.context,i.type);e&&(e.Q_=t.type==a.tM||t.type==a.Zj,s.onerror=s.onload=function(){if(e.R_()==l.h_.a_&&(!s.status||s.status<200||299<s.status)){var t=o.vM.get(h.getQualityLevel().id);s=null;var i=t.oA.getDuration(),n=t.oA.getDuration()+E.xu.Nu.uo,r=Math.floor(d.Framework.random()*(n-i))+i;t.prefetchDelay=r-(d.Framework.time()-t.AM),t.nM=0,o.IM(t.oA.getQualityLevel())}})},r);this.UM.set(h.I_(),e)}catch(t){p.ErrorMonitor.getInstance().logError("Error requesting for prefetch",this.loggerId,g.Is.Ls,t)}},u.prototype.VM=function(){var n=this;this.UM.forEach(function(t,i){n.logger.debug(n.loggerId+"Clearing delayed prefetch timer id "+t),d.Framework.clearTimeout(t),n.UM["delete"](i)}),this.isActive=!1},u.prototype.iM=function(t){this.vM.has(t.id)&&(this.vM.get(t.id).iM=!0,this.cM.qM(t))},u.prototype.PM=function(t){try{var i=this.vM.get(t.getQualityLevel().id),n=t,r=this.QM(n);return r&&r.I_()!=t.I_()?r:r&&r.I_()==i.oA.I_()?t:null}catch(t){return p.ErrorMonitor.getInstance().logError("Error forwarding to next segment",this.loggerId,g.Is.Ms,t),null}},u.prototype.QM=function(t){if(null==t)return null;var i=this.gw.YM(),n=t;if(i)for(;null!=n&&-1!=i.indexOf(n.I_());)if(!(n=this.cM.KM(n)))return n;return n},u.prototype.HM=function(t,i){try{var n=this.WM(t),r=n?l.h_.l_:l.h_.a_,s=!1;s=i!=a.Z_?!this.UM.has(t.I_())||r!=l.h_.a_:r==l.h_.l_;var e=this.cM.$M(),h=this.XM(t.uA(),t.getQualityLevel(),r),o=i==a.tM;return this.logger.debug(this.loggerId+"PREFETCHING "+l.h_[r]+" (LAN LEADER: "+this.tv.zM()+" SITE LEADER: "+o+") CHECKS FOR "+t.I_()+" [HAVES:"+n+" NOTBUFFERING:"+e+" DISTANCE:"+h.valid+"("+h.JM+")]"),{jk:s&&e&&h.valid&&this.isActive,type:r}}catch(t){return p.ErrorMonitor.getInstance().logError("Error checking if allowed to prefetch",this.loggerId,g.Is.Ps,t),{jk:!1,type:l.h_.a_}}},u.prototype.XM=function(t,i,n){try{var r=this.cM.ZM(t,i);return r<=this.cM.tP()?{JM:r,valid:!0}:{JM:r,valid:!1}}catch(t){return p.ErrorMonitor.getInstance().logError("Error checking the player distance",this.loggerId,g.Is.Hs,t),{JM:0,valid:!1}}},u.prototype.jM=function(t,i){var n=this.cM.wM();if(null==n)return-1;var r=n.uA();return this.cM.iP(r,i,t,i)},u.prototype.WM=function(t){var i=t.I_(),n=t.getDuration(),r=t.uA(),s=t.getQualityLevel();if(this.sM.contains(i)){var e=this.sM.nP(i),h=this.sM.rP(i);if(h.length>=E.xu.Nu.lo){if(E.xu.Nu.Eo){var o=[];o[v.Zj]=[],o[v.tM]=[],o[v.AS]=[],o[v.Qa]=[];var u=this.tv.sP(),a=this.tv.eP();h.forEach(function(t){if(t.hP.peerInfo.type!=w.pf.bf){var i=t.hP.peerInfo.internalAs;if(0!=u&&i&&u==i)o[v.tM].push(t);else{if(E.xu.Nu.Ao){var n=t.hP.peerInfo.externalAs;if(0!=a&&a===n)return void o[v.AS].push(t)}t.hP.peerInfo.type==w.pf.gf&&o[v.Qa].push(t)}}else o[v.Zj].push(t)});var f=null,c=!1,l=!0;return 0<o[v.Zj].length&&(c=this.oP?!this.uP(o[v.Zj],i):(f=v.Zj,!0)),!this.tv.zM()&&this.tv.aP()||0<o[v.tM].length&&(f=v.tM,c=!0),!this.tv.fP()&&this.tv.cP()&&0<o[v.AS].length&&(f=v.AS,c=!0),0<o[v.Qa].length&&(this.tv.lP()||!(this.tv.fP()||this.tv.cP()&&E.xu.Nu.Ao))&&(f=v.Qa,c=!0),c&&f>=E.xu.Nu.Io&&(l=this.vP(o[f],e,n,r,s)),!(!c||!l||(this.logger.debug("down from "+v[f]+" with haves : "+o[v.Zj].length+" "+o[v.tM].length+" "+o[v.AS].length+" "+o[v.Qa].length),0))}return!0}}return!1},u.prototype.vP=function(t,e,h,o,u){var a=this;return t.some(function(t){var i=t.dP();if(0<i){var n=e.size/i,r=a.cM.ZM(o,u),s=!1;return r<h?(s=n<=r*E.xu.Nu.No,a.logger.debug("can download from "+t.guid+" size: "+e.size+" rate: "+i+" dTime: "+n+" fDistance: "+r*E.xu.Nu.No)):(s=n<=h*E.xu.Nu.No,a.logger.debug("can download from "+t.guid+" size: "+e.size+" rate: "+i+" dTime: "+n+" fDuration: "+h*E.xu.Nu.No)),s}})},u.prototype.uP=function(t,i){try{return this.tv.EP().length>E.xu.Nu._o&&(this.tv.wP(),t.length==E.xu.Nu.mo&&t[0].guid==this.tv.pP().uuid&&d.Framework.random()>E.xu.Nu.Ro&&this.xM<E.xu.Nu.So&&(this.logger.debug("SKIP PREFETCH CYCLE "+this.xM+" TO OFFLOAD LEADER"),this.xM++,!0))}catch(t){return p.ErrorMonitor.getInstance().logError("Error deciding to offload the leader",this.loggerId,g.Is.Us,t),!1}},u.prototype.gP=function(t,i){try{t.bP=t.X_.id,t.X_=i,this.logger.debug(this.loggerId+"UPGRADE "+l.h_[t.R_()]+" REQ "+t.C_+" FOR "+t.A_.I_()),t.R_()==l.h_.l_?(t.L_.p2pAgenTrafficSuccessQt=t.W_,t.Y_?(t.type=l.h_.c_,this.oM.yP(t)||(this.logger.debug(this.loggerId+"SET REQUEST TIMED-OUT WAS 0. CDN COMPENSATION"),this.oM.TP(t.OP,"TIMED-OUT"))):(t.type=l.h_.o_,this.logger.debug(this.loggerId+"THE HIVE REQ "+t.I_()+" ARRIVED BEFORE THE P2P_PREFETCH INITIALIZED. CHANGE REQUEST TYPE TO "+l.h_[t.R_()]))):t.R_()==l.h_.a_&&(t.type=l.h_.o_)}catch(t){p.ErrorMonitor.getInstance().logError("Error upgrading prefetch",this.loggerId,g.Is.Fs,t)}},u);function u(){this.loggerId="[Prefetcher] ",this.oP=!0,this.xM=0,this.isActive=!0,this.UM=new c(),this.vM=new c()}i.mP=o},function(t,i,n){var r=n(115),s=n(116),e=s;e._P=r,e.CR=s,t.exports=e},function(t,i){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,i,n){"use strict";t.exports=o;n(10);var r=n(11),s=n(72),e=n(12),h=n(40);function o(t,i,n){if(!(this instanceof o))return new o(t,i,n);var r=this.head=new this.Node();(r.next=r).RP=r,this.Re=i||Object.equals,this.Ae=n||Function._e,this.length=0,this.hiveAddEach(t)}function u(t){this.head=t,this.SP=t.next}function a(t){this.value=t,this.RP=null,this.next=null}o.AP=o,Object.hiveAddEach(o.prototype,r.prototype),Object.hiveAddEach(o.prototype,s.prototype),Object.hiveAddEach(o.prototype,e.prototype),Object.hiveAddEach(o.prototype,h.prototype),o.prototype.Ne=function(t){return new this.constructor(t,this.Re,this.Ae)},o.prototype.find=function(t,i,n){i=i||this.Re;for(var r=this.head,s=this.IP(n,r.next);s!==r;){if(i(s.value,t))return s;s=s.next}},o.prototype.findLast=function(t,i,n){i=i||this.Re;for(var r=this.head,s=this.IP(n,r.RP);s!==r;){if(i(s.value,t))return s;s=s.RP}},o.prototype.has=function(t,i){return!!this.find(t,i)},o.prototype.get=function(t,i){var n=this.find(t,i);return n?n.value:this.Ae(t)},o.prototype["delete"]=function(t,i){var n=this.findLast(t,i);if(n){if(this.yC){var r=[],s=[t];this.RC(r,s,n.index)}return n["delete"](),this.length--,this.yC&&(this.NP(n.next,n.index),this.OC(r,s,n.index)),!0}return!1},o.prototype.kC=function(t,i){i=i||this.Re;for(var n=this.head,r=n.next,s=0;r!==n;)i(t,r.value)&&(r["delete"](),s++),r=r.next;return this.length-=s,s},o.prototype.clear=function(){var t,i;this.yC&&(i=this.toArray(),t=[],this.RC(t,i,0)),this.head.next=this.head.RP=this.head,this.length=0,this.yC&&this.OC(t,i,0)},o.prototype.hiveAdd=function(t){var i=new this.Node(t);return this.yC&&(i.index=this.length,this.RC([t],[],i.index)),this.head.CP(i),this.length++,this.yC&&this.OC([t],[],i.index),!0},o.prototype.push=function(){var t=this.head;if(this.yC){var i=Array.prototype.slice.call(arguments),n=[],r=this.length;this.RC(i,n,r);var s=this.head.RP}for(var e=0;e<arguments.length;e++){var h=arguments[e],o=new this.Node(h);t.CP(o)}this.length+=arguments.length,this.yC&&(this.NP(s.next,void 0===s.index?0:s.index+1),this.OC(i,n,r))},o.prototype.unshift=function(){if(this.yC){var t=Array.prototype.slice.call(arguments),i=[];this.RC(t,i,0)}for(var n=this.head,r=0;r<arguments.length;r++){var s=arguments[r],e=new this.Node(s);n.kP(e),n=e}this.length+=arguments.length,this.yC&&(this.NP(this.head.next,0),this.OC(t,i,0))},o.prototype.pop=function(){var t,i=this.head;if(i.RP!==i){if(t=i.RP.value,this.yC){var n=[],r=[t],s=this.length-1;this.RC(n,r,s)}i.RP["delete"](),this.length--,this.yC&&this.OC(n,r,s)}return t},o.prototype.shift=function(){var t,i=this.head;if(i.RP!==i){if(t=i.next.value,this.yC){var n=[],r=[t];this.RC(n,r,0)}i.next["delete"](),this.length--,this.yC&&(this.NP(this.head.next,0),this.OC(n,r,0))}return t},o.prototype.DP=function(){if(this.head!==this.head.next)return this.head.next.value},o.prototype.jP=function(t){this.head!==this.head.next?this.head.next.value=t:this.push(t)},o.prototype.kf=function(){return this.DP()},o.prototype.IP=function(t,i){var n=this.head;if("number"!=typeof t)return t||i;var r=t;if(0<=r)for(t=n.next;r&&(r--,(t=t.next)!=n););else for(t=n;r<0&&(r++,(t=t.RP)!=n););return t},o.prototype.slice=function(t,i){var n=[],r=this.head;for(t=this.IP(t,r.next),i=this.IP(i,r);t!==i&&t!==r;)n.push(t.value),t=t.next;return n},o.prototype.splice=function(t,i){return this.MP(t,i,Array.prototype.slice.call(arguments,2))},o.prototype.MP=function(t,i,n){var r=t;t=this.IP(t,this.head),null==i&&(i=1/0),n=Array.from(n);for(var s,e,h=[],o=t;i--&&0<=i&&o!==this.head;)h.push(o.value),o=o.next;this.yC&&(s=t===this.head?this.length:t.RP===this.head?0:t.index,e=t.RP,this.RC(n,h,s));o=t;var u=0;for(o=t;u<h.length;u++,o=o.next)o["delete"]();null==r&&o===this.head&&(o=this.head.next);for(u=0;u<n.length;u++){var a=new this.Node(n[u]);o.CP(a)}return this.length+=n.length-h.length,this.yC&&(t===this.head?this.NP(this.head.next,0):this.NP(e.next,e.index+1),this.OC(n,h,s)),h},o.prototype.reverse=function(){if(this.yC){var t=this.toArray(),i=t.reversed();this.RC(i,t,0)}var n=this.head;do{var r=n.next;n.next=n.RP,n.RP=r,n=n.next}while(n!==this.head);return this.yC&&this.OC(i,t,0),this},o.prototype.sort=function(){this.MP(0,this.length,this.Nf())},o.prototype.reduce=function(t,i){for(var n=arguments[2],r=this.head,s=r.next;s!==r;)i=t.call(n,i,s.value,s,this),s=s.next;return i},o.prototype.reduceRight=function(t,i){for(var n=arguments[2],r=this.head,s=r.RP;s!==r;)i=t.call(n,i,s.value,s,this),s=s.RP;return i},o.prototype.NP=function(t,i){for(;t!==this.head;)t.index=i++,t=t.next},o.prototype.qf=function(){this.head.index=-1,this.NP(this.head.next,0),this.yC=!0},o.prototype.Df=function(){return new u(this.head)},u.prototype.PP=null,Object.defineProperty(u.prototype,"LP",{get:function(){return this.PP||(this.PP={done:!1,value:null})}}),u.prototype.next=function(){if(this.SP===this.head)this.LP.done=!0,this.LP.value=void 0;else{var t=this.SP.value;this.SP=this.SP.next,this.LP.value=t}return this.LP},(o.prototype.Node=a).prototype["delete"]=function(){this.RP.next=this.next,this.next.RP=this.RP},a.prototype.CP=function(t){var i=this.RP;(((this.RP=t).RP=i).next=t).next=this},a.prototype.kP=function(t){var i=this.next;(((this.next=t).next=i).RP=t).RP=this}},function(t,i,n){"use strict";n(10);var r=n(11),s=n(59),e=n(12);function h(t,i){if(!(this instanceof h))return new h(t,i);i=i||Function._e,this.Ae=i,this.store=Object.create(null),this.length=0,this.hiveAddEach(t)}(t.exports=h).HP=h,Object.hiveAddEach(h.prototype,r.prototype),Object.hiveAddEach(h.prototype,s.prototype),Object.hiveAddEach(h.prototype,e.prototype),h.prototype.Ne=function(t){return new this.constructor(t,this.Ae)},h.prototype.UP=function(t){if("string"!=typeof t)throw new TypeError("key must be a string but Got "+t)},Object.defineProperty(h.prototype,"FP",{writable:!0}),Object.defineProperty(h.prototype,"GP",{get:function(){return this.hasOwnProperty("$__proto__")&&void 0!==this.xP}}),Object.defineProperty(h.prototype,"xP",{get:function(){return this.FP},set:function(t){this.FP=t}}),h.prototype.get=function(t,i){return this.UP(t),"__proto__"===t?this.GP?this.xP:1<arguments.length?i:this.Ae(t):t in this.store?this.store[t]:1<arguments.length?i:this.Ae(t)},h.prototype.set=function(t,i){this.UP(t);var n="__proto__"===t;return(n?this.GP:t in this.store)?(this.BP&&this.VP(t,n?this.xP:this.store[t]),n?this.xP=i:this.store[t]=i,this.BP&&this.qP(t,i),!1):(this.BP&&this.VP(t,void 0),this.length++,n?this.xP=i:this.store[t]=i,this.BP&&this.qP(t,i),!0)},h.prototype.has=function(t){return this.UP(t),"__proto__"===t?this.GP:t in this.store},h.prototype["delete"]=function(t){return this.UP(t),"__proto__"===t?!!this.GP&&(this.BP&&this.VP(t,this.xP),this.xP=void 0,this.length--,this.BP&&this.qP(t,void 0),!0):t in this.store&&(this.BP&&this.VP(t,this.store[t]),delete this.store[t],this.length--,this.BP&&this.qP(t,void 0),!0)},h.prototype.clear=function(){var t;for(t in this.GP&&(this.BP&&this.VP("__proto__",this.xP),this.xP=void 0,this.BP&&this.qP("__proto__",void 0)),this.store)this.BP&&this.VP(t,this.store[t]),delete this.store[t],this.BP&&this.qP(t,void 0);this.length=0},h.prototype.reduce=function(t,i,n){this.GP&&(i=t.call(n,i,"$__proto__","__proto__",this));var r=this.store;for(var s in this.store)i=t.call(n,i,r[s],s,this);return i},h.prototype.reduceRight=function(n,t,r){var s=this,e=this.store;return t=Object.keys(this.store).reduceRight(function(t,i){return n.call(r,t,e[i],i,s)},t),this.GP?n.call(r,t,this.xP,"__proto__",s):t},h.prototype.kf=function(){var t;for(t in this.store)return this.store[t];return this.xP},h.prototype.toJSON=function(){return this.mf()}},function(t,i,n){"use strict";var r=n(38),s=n(120),e=n(12);function h(){throw new Error("Can't construct. GenericMap is a mixin.")}function o(t,i){this.key=t,this.value=i}t.exports=h,r.hiveAddEach(h.prototype,s.prototype),r.hiveAddEach(h.prototype,e.prototype),h.prototype.isMap=!0,h.prototype.hiveAddEach=function(i){if(i&&r(i)===i)if("function"==typeof i.forEach)!0===i.isMap?i.forEach(function(t,i){this.set(i,t)},this):i.forEach(function(t){this.set(t[0],t[1])},this);else if("number"==typeof i.length)for(var t=0;t<i.length;t++)this.hiveAdd(i[t],t);else r.keys(i).forEach(function(t){this.set(t,i[t])},this);else if(i&&"number"==typeof i.length)for(t=0;t<i.length;t++)this.hiveAdd(i[t],t);return this},h.prototype.get=function(t,i){var n=this.store.get(new this.QP(t));return n?n.value:1<arguments.length?i:this.Ae(t)},h.prototype.set=function(t,i){var n=new this.QP(t,i),r=this.store.get(n),s=!1;return r?(this.BP&&this.VP(t,r.value),r.value=i):(this.BP&&this.VP(t,void 0),this.store.hiveAdd(n)&&(this.length++,s=!0)),this.BP&&this.qP(t,i),s},h.prototype.hiveAdd=function(t,i){return this.set(i,t)},h.prototype.has=function(t){return this.store.has(new this.QP(t))},h.prototype["delete"]=function(t){var i=new this.QP(t);if(this.store.has(i)){var n=this.store.get(i).value;return this.BP&&this.VP(t,n),this.store["delete"](i),this.length--,this.BP&&this.qP(t,void 0),!0}return!1},h.prototype.clear=function(){var t;this.BP&&(this.forEach(function(t,i){this.VP(i,t)},this),t=this.keys()),this.store.clear(),this.length=0,this.BP&&t.forEach(function(t){this.qP(t)},this)},h.prototype.reduce=function(n,t,r){return this.store.reduce(function(t,i){return n.call(r,t,i.value,i.key,this)},t,this)},h.prototype.reduceRight=function(n,t,r){return this.store.reduceRight(function(t,i){return n.call(r,t,i.value,i.key,this)},t,this)},h.prototype.keys=function(){return this.map(function(t,i){return i})},h.prototype.values=function(){return this.map(Function.identity)},h.prototype.entries=function(){return this.map(function(t,i){return[i,t]})},h.prototype.items=function(){return this.entries()},h.prototype.equals=function(i,n){return n=n||r.equals,this===i||(i&&"function"==typeof i.every?i.length===this.length&&i.every(function(t,i){return n(this.get(i),t)},this):r.keys(i).length===this.length&&r.keys(i).every(function(t){return n(this.get(t),i[t])},this))},h.prototype.toJSON=function(){return this.entries()},(h.prototype.QP=o).prototype.equals=function(t){return r.equals(this.key,t.key)&&r.equals(this.value,t.value)},o.prototype.compare=function(t){return r.compare(this.key,t.key)}},function(T,O,m){var _;!function(s,c){"use strict";var t="undefined",i="model",n="name",r="type",e="vendor",h="version",o="architecture",u="console",a="mobile",f="tablet",l="smarttv",v="wearable",d={extend:function(t,i){var n={};for(var r in t)i[r]&&i[r].length%2==0?n[r]=i[r].concat(t[r]):n[r]=t[r];return n},has:function(t,i){return"string"==typeof t&&-1!==i.toLowerCase().indexOf(t.toLowerCase())},YP:function(t){return t.toLowerCase()},KP:function(t){return"string"==typeof t?t.replace(/[^\d\.]/g,"").split(".")[0]:c},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},E={WP:function(t,i){for(var n,r,s,e,h,o,u=0;u<i.length&&!h;){var a=i[u],f=i[u+1];for(n=r=0;n<a.length&&!h;)if(h=a[n++].exec(t))for(s=0;s<f.length;s++)o=h[++r],"object"==typeof (e=f[s])&&0<e.length?2==e.length?"function"==typeof e[1]?this[e[0]]=e[1].call(this,o):this[e[0]]=e[1]:3==e.length?"function"!=typeof e[1]||e[1].exec&&e[1].test?this[e[0]]=o?o.replace(e[1],e[2]):c:this[e[0]]=o?e[1].call(this,o,e[2]):c:4==e.length&&(this[e[0]]=o?e[3].call(this,o.replace(e[1],e[2])):c):this[e]=o||c;u+=2}},str:function(t,i){for(var n in i)if("object"==typeof i[n]&&0<i[n].length){for(var r=0;r<i[n].length;r++)if(d.has(i[n][r],t))return"?"===n?c:n}else if(d.has(i[n],t))return"?"===n?c:n;return t}},w={JN:{$P:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419",ad:"/"}}},XP:{zP:{JP:{ZP:["SD","KF"]}},tL:{JP:{iL:"7373KT"},vendor:{nL:"APA",rL:"Sprint"}}},os:{sL:{version:{eL:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",hL:["NT 5.1","NT 5.2"],oL:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],uL:"ARM"}}}},p={JN:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[n,h],[/(opios)[\/\s]+([\w\.]+)/i],[[n,"Opera Mini"],h],[/\s(opr)\/([\w\.]+)/i],[[n,"Opera"],h],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[n,h],[/(konqueror)\/([\w\.]+)/i],[[n,"Konqueror"],h],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[n,"IE"],h],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[n,"Edge"],h],[/(yabrowser)\/([\w\.]+)/i],[[n,"Yandex"],h],[/(puffin)\/([\w\.]+)/i],[[n,"Puffin"],h],[/(focus)\/([\w\.]+)/i],[[n,"Firefox Focus"],h],[/(opt)\/([\w\.]+)/i],[[n,"Opera Touch"],h],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[n,"UCBrowser"],h],[/(comodo_dragon)\/([\w\.]+)/i],[[n,/_/g," "],h],[/(windowswechat qbcore)\/([\w\.]+)/i],[[n,"WeChat(Win) Desktop"],h],[/(micromessenger)\/([\w\.]+)/i],[[n,"WeChat"],h],[/(brave)\/([\w\.]+)/i],[[n,"Brave"],h],[/(qqbrowserlite)\/([\w\.]+)/i],[n,h],[/(QQ)\/([\d\.]+)/i],[n,h],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[n,h],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[n,h],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[n,h],[/(MetaSr)[\/\s]?([\w\.]+)/i],[n],[/(LBBROWSER)/i],[n],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[h,[n,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[h,[n,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[n,h],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[h,[n,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[n,/(.+)/,"$1 WebView"],h],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[n,/(.+(?:g|us))(.+)/,"$1 $2"],h],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[h,[n,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[n,"Sailfish Browser"],h],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[n,h],[/(dolfin)\/([\w\.]+)/i],[[n,"Dolphin"],h],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[n,"Chrome"],h],[/(coast)\/([\w\.]+)/i],[[n,"Opera Coast"],h],[/fxios\/([\w\.-]+)/i],[h,[n,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[h,[n,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[h,n],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[n,"GSA"],h],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[n,[h,E.str,w.JN.$P.version]],[/(webkit|khtml)\/([\w\.]+)/i],[n,h],[/(navigator|netscape)\/([\w\.-]+)/i],[[n,"Netscape"],h],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[n,h]],aL:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[o,"amd64"]],[/(ia32(?=;))/i],[[o,d.YP]],[/((?:i[346]|x)86)[;\)]/i],[[o,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[o,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[o,/ower/,"",d.YP]],[/(sun4\w)[;\)]/i],[[o,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[o,d.YP]]],XP:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[i,e,[r,f]],[/applecoremedia\/[\w\.]+ \((ipad)/],[i,[e,"Apple"],[r,f]],[/(apple\s{0,1}tv)/i],[[i,"Apple TV"],[e,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[e,i,[r,f]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[i,[e,"Amazon"],[r,f]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[i,E.str,w.XP.zP.JP],[e,"Amazon"],[r,a]],[/android.+aft([bms])\sbuild/i],[i,[e,"Amazon"],[r,l]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[i,e,[r,a]],[/\((ip[honed|\s\w*]+);/i],[i,[e,"Apple"],[r,a]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[e,i,[r,a]],[/\(bb10;\s(\w+)/i],[i,[e,"BlackBerry"],[r,a]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[i,[e,"Asus"],[r,f]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[e,"Sony"],[i,"Xperia Tablet"],[r,f]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[i,[e,"Sony"],[r,a]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[e,i,[r,u]],[/android.+;\s(shield)\sbuild/i],[i,[e,"Nvidia"],[r,u]],[/(playstation\s[34portablevi]+)/i],[i,[e,"Sony"],[r,u]],[/(sprint\s(\w+))/i],[[e,E.str,w.XP.tL.vendor],[i,E.str,w.XP.tL.JP],[r,a]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[e,[i,/_/g," "],[r,a]],[/(nexus\s9)/i],[i,[e,"HTC"],[r,f]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[i,[e,"Huawei"],[r,a]],[/(microsoft);\s(lumia[\s\w]+)/i],[e,i,[r,a]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[i,[e,"Microsoft"],[r,u]],[/(kin\.[onetw]{3})/i],[[i,/\./g," "],[e,"Microsoft"],[r,a]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[i,[e,"Motorola"],[r,a]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[i,[e,"Motorola"],[r,f]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[e,d.trim],[i,d.trim],[r,l]],[/hbbtv.+maple;(\d+)/i],[[i,/^/,"SmartTV"],[e,"Samsung"],[r,l]],[/\(dtv[\);].+(aquos)/i],[i,[e,"Sharp"],[r,l]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[e,"Samsung"],i,[r,f]],[/smart-tv.+(samsung)/i],[e,[r,l],i],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[e,"Samsung"],i,[r,a]],[/sie-(\w*)/i],[i,[e,"Siemens"],[r,a]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[e,"Nokia"],i,[r,a]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[i,[e,"Acer"],[r,f]],[/android.+([vl]k\-?\d{3})\s+build/i],[i,[e,"LG"],[r,f]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[e,"LG"],i,[r,f]],[/(lg) netcast\.tv/i],[e,i,[r,l]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[i,[e,"LG"],[r,a]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[e,i,[r,f]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[i,[e,"Lenovo"],[r,f]],[/(lenovo)[_\s-]?([\w-]+)/i],[e,i,[r,a]],[/linux;.+((jolla));/i],[e,i,[r,a]],[/((pebble))app\/[\d\.]+\s/i],[e,i,[r,v]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[e,i,[r,a]],[/crkey/i],[[i,"Chromecast"],[e,"Google"]],[/android.+;\s(glass)\s\d/i],[i,[e,"Google"],[r,v]],[/android.+;\s(pixel c)[\s)]/i],[i,[e,"Google"],[r,f]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[i,[e,"Google"],[r,a]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[i,/_/g," "],[e,"Xiaomi"],[r,a]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[i,/_/g," "],[e,"Xiaomi"],[r,f]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[i,[e,"Meizu"],[r,a]],[/(mz)-([\w-]{2,})/i],[[e,"Meizu"],i,[r,a]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[i,[e,"OnePlus"],[r,a]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[i,[e,"RCA"],[r,f]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[i,[e,"Dell"],[r,f]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[i,[e,"Verizon"],[r,f]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[e,"Barnes & Noble"],i,[r,f]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[i,[e,"NuVision"],[r,f]],[/android.+;\s(k88)\sbuild/i],[i,[e,"ZTE"],[r,f]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[i,[e,"Swiss"],[r,a]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[i,[e,"Swiss"],[r,f]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[i,[e,"Zeki"],[r,f]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[e,"Dragon Touch"],i,[r,f]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[i,[e,"Insignia"],[r,f]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[i,[e,"NextBook"],[r,f]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[e,"Voice"],i,[r,a]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[e,"LvTel"],i,[r,a]],[/android.+;\s(PH-1)\s/i],[i,[e,"Essential"],[r,a]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[i,[e,"Envizen"],[r,f]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[e,i,[r,f]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[i,[e,"MachSpeed"],[r,f]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[e,i,[r,f]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[i,[e,"Rotor"],[r,f]],[/android.+(KS(.+))\s+build/i],[i,[e,"Amazon"],[r,f]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[e,i,[r,f]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[r,d.YP],e,i],[/[\s\/\(](smart-?tv)[;\)]/i],[[r,l]],[/(android[\w\.\s\-]{0,9});.+build/i],[i,[e,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[h,[n,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)/i],[[n,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[n,h],[/rv\:([\w\.]{1,9}).+(gecko)/i],[h,n]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[n,h],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[n,[h,E.str,w.os.sL.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[n,"Windows"],[h,E.str,w.os.sL.version]],[/\((bb)(10);/i],[[n,"BlackBerry"],h],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[n,h],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[n,"Symbian"],h],[/\((series40);/i],[n],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[n,"Firefox OS"],h],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[n,h],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[n,"Chromium OS"],h],[/(sunos)\s?([\w\.\d]*)/i],[[n,"Solaris"],h],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[n,h],[/(haiku)\s(\w+)/i],[n,h],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[h,/_/g,"."],[n,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[n,"Mac OS"],[h,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[n,h]]},g=function(t,i){if("object"==typeof t&&(i=t,t=c),!(this instanceof g))return new g(t,i).fL();var n=t||(s&&s.navigator&&s.navigator.userAgent?s.navigator.userAgent:""),r=i?d.extend(p,i):p;return this.cL=function(){var t={name:c,version:c};return E.WP.call(t,n,r.JN),t.KP=d.KP(t.version),t},this.lL=function(){var t={vL:c};return E.WP.call(t,n,r.aL),t},this.dL=function(){var t={vendor:c,JP:c,type:c};return E.WP.call(t,n,r.XP),t},this.EL=function(){var t={name:c,version:c};return E.WP.call(t,n,r.engine),t},this._S=function(){var t={name:c,version:c};return E.WP.call(t,n,r.os),t},this.fL=function(){return{sg:this.wL(),JN:this.cL(),engine:this.EL(),os:this._S(),XP:this.dL(),aL:this.lL()}},this.wL=function(){return n},this.mS=function(t){return n=t,this},this};g.VERSION="0.7.20",g.pL={gL:n,bL:"major",VERSION:h},g.yL={TL:o},g.OL={mL:i,VENDOR:e,_L:r,RL:u,SL:a,AL:l,IL:f,NL:v,CL:"embedded"},g.kL={gL:n,VERSION:h},g.DL={gL:n,VERSION:h},typeof O!=t?(typeof T!=t&&T.exports&&(O=T.exports=g),O.OS=g):(_=function(){return g}.call(O,m,O,T))===c||(T.exports=_);var b=s&&(s.jQuery||s.jL);if(typeof b!=t&&!b.sg){var y=new g();b.sg=y.fL(),b.sg.get=function(){return y.wL()},b.sg.set=function(t){y.mS(t);var i=y.fL();for(var n in i)b.sg[n]=i[n]}}}("object"==typeof window?window:this)},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(78),o=n(0),u=(e=h["default"],s(a,e),a);function a(){return e.call(this,"STATS",o.Framework.v.rk)||this}i["default"]=new u()},function(t,i,n){"use strict";var s=this&&this.ML||function(){return(s=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var s in i=arguments[n])Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s]);return t}).apply(this,arguments)};Object.defineProperty(i,"s",{value:!0});var r=n(55),e=n(21),h=n(23),o=(u.pR=function(t,i,n){var r=new u();return r.partnerId=t,r.customerId=i,r.contentId=n,r},u.OR=function(t){var i=new u(t),n=e(t),r=n.path().split("/").slice(3);return i.partnerId=r[0],i.customerId=r[1],i.contentId=r[2],i.PL=r[3],i.searchParams=s({},i.searchParams,n.query(!0)),i},u.prototype.LL=function(t){this.contentId=t.ContentId,this.partnerId=t.SiteId,this.customerId=t.CROId,this.HL=t.Signature,this.UL=t.SourceURL,this.searchParams=s({},this.searchParams,t.SourceURLParams)},u.prototype.TR=function(t,i,n){this.partnerId=t,this.customerId=i,this.contentId=n},u.prototype.FL=function(){var t=this.contentId+this.partnerId+this.customerId+this.UL,i=new h.r_();i.Wb("b6614c3e4cd1d14eed6b39ef2bf6b9a3e3d6dfcd26699d7270d887923bcbf83efb3dadb717c0bafb1d48dce361eb369b7cc46e57405ebfbdd86c3175532fe56cc77f473d345b2cb6feafb5ab0e24f364a3d259f27e4a2fd97468265bddfd3ddd3ac64251db650ca0280af2b2c45e8b1c8f040f2c433ac0a157d2b3fd91517253","010001");var n=h.s_(this.HL);return i.$m(t,n)},u.prototype.mR=function(){return this.partnerId},u.prototype._R=function(){return this.customerId},u.prototype.RR=function(){return this.contentId},u.prototype.GL=function(){return this.PL},u.prototype.QS=function(){return this.ticketUrl},u.prototype.xL=function(){return this.UL},u.prototype.BL=function(t){this.UL=t},u.prototype.VL=function(){return this.qL||(this.qL=this.UL?e(this.UL).query(this.searchParams).valueOf():null),this.qL},u.prototype.gR=function(t){this.qL=t},u.prototype.QL=function(){return this.searchParams},u.prototype.CS=function(){return"["+this.partnerId+"/"+this.customerId+"/"+this.contentId+"]"},u.prototype.YL=function(){return[this.partnerId,this.customerId,this.contentId]},u.prototype.KL=function(){return this.UL+"-["+this.partnerId+"/"+this.customerId+"/"+this.contentId+"]"},u.prototype.toString=function(){return this.CS()},u);function u(t){this.testId=null,this.originalManifest=null,this.ticketUrl=t,this.sessionId=r.CR(),this.ticketUrl&&(this.WL=-1<t.indexOf("api-test"))}i.Ticket=o},function(t,i,n){"use strict";var r;Object.defineProperty(i,"s",{value:!0}),(r=i.$L||(i.$L={}))[r.XL=0]="CREATED",r[r.zL=1]="STARTED",r[r.JL=2]="SUCCEEDED",r[r.ZL=3]="ABORTED",r[r.tH=4]="FAILED"},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(t,i,n,r,s,e){this.id=t,this.qualityLevel=i,this.duration=n,this.url=r,this.eA=s,this.hA=e}i.iH=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(34),s=n(31),h=n(0),a=n(183),e=n(7),u=n(24),f=n(54),o=n(5),d=n(2),E=n(1),c=n(48),l=n(187),v=(w.prototype.nH=function(t,i){try{var n=0,r=0;if(this.rH.length<i)return!0;for(var s=this.rH.keys().reverse(),e=s[0],h=this.rH.get(e).getQualityLevel(),o=s.slice(1),u=0;u<o.length;u++){var a=o[u],f=this.rH.get(a),c=f.sH,l=f.getQualityLevel(),v=Math.abs(c-e);if(l.id!==h.id)return!1;if(v<t){if(++r>=i)return!1}else{if(++n>i)return!0;r=Math.max(0,r-1),e=c,h=l}}return!1}catch(t){return E.ErrorMonitor.getInstance().logError("Error calculating if the player is in buffering mode",this.eH,d.dr.Er,t),!1}},w.prototype.hH=function(t,i){if(this.oH(i)){var n=this.wM();if(n){var r=t.getQualityLevel(),s=n.getQualityLevel();0<r.Ob(s)?this.aH.uH(!0):r.Ob(s)<0&&this.aH.uH(!1)}else this.aH.uH(!0);if(this.rH.length>o.xu.Cu.Co){var e=this.rH.keys()[0];this.rH["delete"](e)}this.rH.set(h.Framework.time(),t)}return this.fH(t,i)},w.prototype.fH=function(t,i){var n=new a.cH();try{if(this.lH.lM(t.getQualityLevel())){if(this.dH.vH(t.I_())){n.EH=!0;var r=this.dH.wH(t.I_());this.pH(i,r,n)}if(this.dH.gH(t.I_()))for(var s=this.dH.bH(t.I_()),e=0,h=s;e<h.length;e++){var o=h[e];this.pH(i,o.R_(),n),n.yH=!0}}else{var u=f.Jj.Z_;this.tv.zM()&&(u=f.Jj.Zj),this.lH.TM(t.getQualityLevel(),u,u)}return n}catch(t){return E.ErrorMonitor.getInstance().logError("Error configuring the request directive",this.eH,d.dr.wr,t),new a.cH()}},w.prototype.pH=function(t,i,n){t!=u.h_.a_&&t!=u.h_.l_||i!=u.h_.o_&&i!=u.h_.l_&&i!=u.h_.a_||(n.TH=!0)},w.prototype.oH=function(t){return t!=u.h_.l_&&t!=u.h_.a_},w.prototype.OH=function(t,i,n){var r=[];try{for(var s=this.dH.bH(i.I_()),e=0,h=s;e<h.length;e++){var o=h[e];o.R_()!=u.h_.o_&&(this.lH.gP(o,t),r.push(o.bP))}return r}catch(t){return E.ErrorMonitor.getInstance().logError("Error attempting to upgrade prefetch",this.eH,d.dr.pr,t),[]}},w.prototype.mH=function(t){this.dH.mH(t)},w.prototype._H=function(t,i){this.dH._H(t,i)},w.prototype.RH=function(t){this.dH.RH(t)},w.prototype.SH=function(t){this.dH.AH(t)},w.prototype.IH=function(t){this.dH.NH()||this.lH.IM(t)},w.prototype.wM=function(){var t=this.rH.keys();return 0<t.length?this.rH.get(t[t.length-1]):null},w.prototype.CH=function(){var t=this.rH.keys();if(0<t.length)return t[t.length-1]},w.prototype.kH=function(t){var i=c.QualityLevel.from(t.qualityLevel);this.IH(i)},w.prototype.DH=function(t){switch(t.S_()){case e.xa.Ba:this.jH(t);break;case e.xa.Va:this._H(t.I_(),t.N_()),this.jH(t)}},w.prototype.jH=function(t){var i=this.metadata.MH(t.k_());i&&this.PH.add(i,t.x_())},w.prototype.wP=function(){return this.ticket},w.prototype.LH=function(){return this.lH},w.prototype.HH=function(){return this.metadata.HH()},w.prototype.UH=function(){return this.FH},w.prototype.GH=function(){return this.xH},w.prototype.getMetadata=function(){return this.metadata},w.prototype.getStreamProtocol=function(){return this.metadata.getStreamProtocol()},w.prototype.S_=function(t){return this.metadata.S_(t)},w.prototype.M_=function(t){var i=this.S_(t);if(i==e.xa.Va||i==e.xa.Ba)return!0},w.prototype.CM=function(t,i,n){var r=this.metadata.BH(t,i);return null!=r?new s.dA(r.eA,n,!0,t,r.duration,i,!0,this.getContextId()):null},w.prototype.KM=function(i){try{var t=i.D_(),n=this.metadata.VH(t);return null!=n?this.V_(n.eA):null}catch(t){return E.ErrorMonitor.getInstance().logError("Error getting the next entity",this.eH,d.dr.kn,{detailedError:t,url:i.D_()}),null}},w.prototype.qH=function(t){this.metadata.qH(t)},w.prototype.yM=function(){return this.metadata.yM()},w.prototype.QH=function(){return this.YH},w);function w(t,i){this.eH="[VideoContext] ",this.rH=new r(),this.logger=h.Framework.resolve(h.Framework.v.p).log(i.sessionId),this.PH=i.reportingInstance.Vl.PH,this.ticket=t,this.UL=t.VL(),this.tv=i.tv,this.aH=i.KH,this.dH=i.dH,this.lH=i.WH,this.lH.fM(this,this),this.YH=new l.$H()}i.XH=v},function(t,i,n){"use strict";t.exports=h;n(10);var s=n(184),r=n(41),e=n(12);function h(t,i,n,r){if(!(this instanceof h))return new h(t,i,n,r);s.call(this,t,i,n,r)}((h.SortedArraySet=h).prototype=Object.create(s.prototype)).constructor=h,Object.hiveAddEach(h.prototype,r.prototype),Object.hiveAddEach(h.prototype,e.prototype),h.prototype.zH=!0,h.prototype.hiveAdd=function(t){return!this.has(t)&&(s.prototype.hiveAdd.call(this,t),!0)},h.prototype.reduce=function(r,t){var s=this,e=arguments[2];return this.array.reduce(function(t,i,n){return r.call(e,t,i,n,s)},t)},h.prototype.reduceRight=function(r,t){var s=this,e=arguments[2];return this.array.reduceRight(function(t,i,n){return r.call(e,t,i,n,s)},t)}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.JH=function(t,i){var n=t.tU.ZH(!1),r=i.tU.ZH(!1);return r<n?1:n<r?0:-1},s);function s(){}i.iU=r;var e=(h.JH=function(t,i){var n=t.nU.ZH(!1),r=i.nU.ZH(!1);return r<n?1:n<r?0:-1},h);function h(){}i.rU=e},function(t,i){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);t.exports=function(){return n(r),r}}else{var s=new Array(16);t.exports=function(){for(var t,i=0;i<16;i++)0==(3&i)&&(t=4294967296*Math.random()),s[i]=t>>>((3&i)<<3)&255;return s}}},function(t,i){for(var s=[],n=0;n<256;++n)s[n]=(n+256).toString(16).substr(1);t.exports=function(t,i){var n=i||0,r=s;return[r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],"-",r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]],r[t[n++]]].join("")}},function(t,i,n){"use strict";n(71);var r=n(11),e=n(72),s=n(39);t.exports=Array;var u=Array.prototype.splice,a=Array.prototype.slice;function h(t,i){Array.prototype[t]||Object.defineProperty(Array.prototype,t,{value:i,writable:!0,configurable:!0,enumerable:!1})}function o(t,i,n){this.array=t,this.start=null==i?0:i,this.end=n}Array.empty=[],Object.freeze&&Object.freeze(Array.empty),Array.from=Array.from||function(t){var i=[];return i.hiveAddEach(t),i},Array.If=function(t){for(var i=[],n=1/0,r=0;r<t.length;r++){var s=t[r];t[r]=s.toArray(),s.length<n&&(n=s.length)}for(r=0;r<t.length;r++){s=t[r];for(var e=0;e<s.length;e++)e<n&&e in s&&(i[e]=i[e]||[],i[e][r]=s[e])}return i},h("hiveAddEach",r.prototype.hiveAddEach),h("deleteEach",r.prototype.Of),h("toArray",r.prototype.toArray),h("toObject",r.prototype.mf),h("all",r.prototype.all),h("any",r.prototype.Th),h("min",r.prototype.min),h("max",r.prototype.max),h("sum",r.prototype.Ju),h("average",r.prototype.Rf),h("only",r.prototype.only),h("flatten",r.prototype.Sf),h("zip",r.prototype.Af),h("enumerate",r.prototype.enumerate),h("group",r.prototype.group),h("sorted",r.prototype.Nf),h("reversed",r.prototype.reversed),h("constructClone",function(t){var i=new this.constructor();return i.hiveAddEach(t),i}),h("has",function(t,i){return-1!==this.find(t,i)}),h("set",function(t,i){return this[t]=i,!0}),h("hiveAdd",function(t){return this.push(t),!0}),h("delete",function(t,i){var n=this.find(t,i);return-1!==n&&(this.splice(n,1),!0)}),h("deleteAll",function(t,i){i=i||this.Re||Object.equals;for(var n=0,r=0;r<this.length;)i(t,this[r])?(this.MP(r,1),n++):r++;return n}),h("find",function(t,i){i=i||this.Re||Object.equals;for(var n=0;n<this.length;n++)if(n in this&&i(t,this[n]))return n;return-1}),h("findLast",function(t,i){i=i||this.Re||Object.equals;var n=this.length;do if(--n in this&&i(this[n],t))return n;while(0<n);return-1}),h("swap",function(t,i,n){var r,s,e,h,o;if(t>this.length&&(this.length=t),void 0===n)return void 0!==i?u.call(this,t,i):void 0!==t?u.call(this,t):[];if(r=[t,i],Array.isArray(n)||(n=a.call(n)),e=0,(s=n.length)<1e3){for(;e<s;e++)r[e+2]=n[e];return u.apply(this,r)}for(o=u.apply(this,r);e<s;){for(r=[t+e,0],h=2;h<1002&&e<s;h++,e++)r[h]=n[e];u.apply(this,r)}return o}),h("peek",function(){return this[0]}),h("poke",function(t){0<this.length&&(this[0]=t)}),h("peekBack",function(){if(0<this.length)return this[this.length-1]}),h("pokeBack",function(t){0<this.length&&(this[this.length-1]=t)}),h("one",function(){for(var t in this)if(Object.aC(this,t))return this[t]}),Array.prototype.clear||h("clear",function(){return this.length=0,this}),h("compare",function(t,i){var n,r,s;if(i=i||Object.compare,this===t)return 0;if(!t||!Array.isArray(t))return e.prototype.compare.call(this,t,i);for(r=Math.min(this.length,t.length),n=0;n<r;n++)if(n in this){if(!(n in t))return-1;if(s=i(this[n],t[n]))return s}else if(n in t)return 1;return this.length-t.length}),h("equals",function(t,i){i=i||Object.equals;var n=0,r=this.length;if(this===t)return!0;if(!t||!Array.isArray(t))return e.prototype.equals.call(this,t);if(r!==t.length)return!1;for(;n<r;++n)if(n in this){if(!(n in t))return!1;if(!i(this[n],t[n]))return!1}else if(n in t)return!1;return!0}),h("clone",function(t,i){if(null==t)t=1/0;else if(0===t)return this;if((i=i||new s()).has(this))return i.get(this);var n=new Array(this.length);for(var r in i.set(this,n),this)n[r]=Object.clone(this[r],t-1,i);return n}),h("iterate",function(t,i){return new o(this,t,i)}),h("Iterator",o),o.prototype.PP=null,Object.defineProperty(o.prototype,"LP",{get:function(){return this.PP||(this.PP={done:!1,value:null})}}),o.prototype.next=function(){return this.start===(null==this.end?this.array.length:this.end)?(this.LP.done=!0,this.LP.value=void 0):this.LP.value=this.array[this.start++],this.LP}},function(t,i){t.exports=Function,Function._e=function(){},Function.identity=function(t){return t},Function.Cf=function(n,r){r=r||Object.compare,n=n||Function.identity;function t(t,i){return r(n(t),n(i))}return t.compare=r,t.Cf=n,t},Function.get=function(i){return function(t){return Object.get(t,i)}}},function(t,i,n){var e=n(38);function r(){throw new Error("Can't construct. GenericOrder is a mixin.")}(t.exports=r).prototype.equals=function(t,i){if(i=i||this.Re||e.equals,this===t)return!0;return!t?!1:this.length===t.length&&this.Af(t).every(function(t){return i(t[0],t[1])})},r.prototype.compare=function(t,r){if(r=r||this._f||e.compare,this===t)return 0;if(!t)return 1;var s=Math.min(this.length,t.length),i=this.Af(t).reduce(function(t,i,n){return 0===t?s<=n?t:r(i[0],i[1]):t},0);return 0===i?this.length-t.length:i},r.prototype.toJSON=function(){return this.toArray()}},function(t,i,n){"use strict";n(10);var r=n(57),s=n(121),e=n(11),h=n(41),o=n(12),u=n(40),a=n(122);function f(t,n,i,r){if(!(this instanceof f))return new f(t,n,i,r);n=n||Object.equals,i=i||Object.hash,r=r||Function._e,this.Re=n,this.Se=i,this.Ae=r,this.order=new this.sU(void 0,n),this.store=new this.eU(void 0,function(t,i){return n(t.value,i.value)},function(t){return i(t.value)}),this.length=0,this.hiveAddEach(t)}(t.exports=f).Set=f,Object.hiveAddEach(f.prototype,e.prototype),Object.hiveAddEach(f.prototype,h.prototype),Object.hiveAddEach(f.prototype,o.prototype),Object.hiveAddEach(f.prototype,u.prototype),Object.defineProperty(f.prototype,"size",e.Ie),f.prototype.sU=r,f.prototype.eU=s,f.prototype.Ne=function(t){return new this.constructor(t,this.Re,this.Se,this.Ae)},f.prototype.has=function(t){var i=new this.order.Node(t);return this.store.has(i)},f.prototype.get=function(t,i){if(i)throw new Error("Set#get does not support second argument: equals");var n=new this.order.Node(t);return(n=this.store.get(n))?n.value:this.Ae(t)},f.prototype.hiveAdd=function(t){var i=new this.order.Node(t);if(this.store.has(i))return!1;var n=this.length;return this.yC&&this.RC([t],[],n),this.order.hiveAdd(t),i=this.order.head.RP,this.store.hiveAdd(i),this.length++,this.yC&&this.OC([t],[],n),!0},f.prototype["delete"]=function(t,i){if(i)throw new Error("Set#delete does not support second argument: equals");var n=new this.order.Node(t);return!!this.store.has(n)&&(n=this.store.get(n),this.yC&&this.RC([],[t],n.index),this.store["delete"](n),this.order.splice(n,1),this.length--,this.yC&&this.OC([],[t],n.index),!0)},f.prototype.pop=function(){if(this.length){var t=this.order.head.RP.value;return this["delete"](t),t}},f.prototype.shift=function(){if(this.length){var t=this.order.head.next.value;return this["delete"](t),t}},f.prototype.kf=function(){if(0<this.length)return this.store.kf().value},f.prototype.clear=function(){var t;this.yC&&(t=this.toArray(),this.RC([],t,0)),this.store.clear(),this.order.clear(),this.length=0,this.yC&&this.OC([],t,0)},f.prototype.reduce=function(n,t){var r=arguments[2],i=this.order,s=0;return i.reduce(function(t,i){return n.call(r,t,i,s++,this)},t,this)},f.prototype.reduceRight=function(n,t){var r=arguments[2],i=this.order,s=this.length-1;return i.reduceRight(function(t,i){return n.call(r,t,i,s--,this)},t,this)},f.prototype.Df=function(){return this.order.Df()},f.prototype.values=function(){return new a(this)},f.prototype.log=function(){var t=this.store;return t.log.apply(t,arguments)},f.prototype.qf=function(){this.order.qf()}},function(t,i,n){"use strict";function r(){}(t.exports=r).hU={IC:"+",oU:"-",uU:"+",aU:"+",fU:".",cU:"'",lU:"+",vU:"|"},r.dU={IC:"\u254b",oU:"\u2501",uU:"\u253b",aU:"\u2533",fU:"\u256d",cU:"\u2570",lU:"\u2523",vU:"\u2503"},r.EU={IC:"\u254b",oU:"\u2501",uU:"\u253b",aU:"\u2533",fU:"\u250f",cU:"\u2517",lU:"\u2523",vU:"\u2503"}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.getItem=function(t){try{return window.sessionStorage?window.sessionStorage.getItem(t):null}catch(t){return null}},s.setItem=function(t,i){try{return!!window.sessionStorage&&(window.sessionStorage.setItem(t,i),!0)}catch(t){return!1}},s.removeItem=function(t){try{window.sessionStorage&&window.sessionStorage.removeItem(t)}catch(t){return null}},s);function s(){}i.SessionStorageUtil=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(13),s=(e.getPrivateIp=function(t){var i=t.getPrivateIp();return r.HiveConfig.SensitiveInfo.restrictedConnectivityInfo&&i&&(i=i.replace(/[0-9]*$/,"0")),i},e.getHostname=function(t){return r.HiveConfig.SensitiveInfo.restrictedConnectivityInfo?r.HiveConfig.SensitiveInfo.hiddenHostnameValue:t.getHostName()},e);function e(){}i.SensitiveInfoUtils=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.NS=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(8),e=(h.prototype.getInstance=function(){return r.Framework.resolve(this.tag)},h.prototype.getName=function(){return this.name},h.prototype.getVersion=function(){return this.version},h.prototype.cv=function(){return o.wU(this)},h);function h(t,i){this.version=s.Y.Wa,this.name=t,this.tag=i}i["default"]=e;var o=(u.wU=function(t){return new u(t.getName(),t.getVersion())},u);function u(t,i){this.name=t,this.version=i}i.pU=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var f=n(76),r=n(3),h=n(22);n(137),n(138);var c=n(0),s=n(14),o=n(16),u=n(19),e=n(13),a=n(1),l=n(15),v="[SNAP] ",d=function(){this.metrics=new hive.snapshots.Metrics(),this.gU=new hive.snapshots.Traffic(),this.bU=new r(),this.yU=new r(),this.TU=new r(),this.OU=new r(),this.player=new hive.snapshots.Player()};i.mU=d;var E=(w.prototype.init=function(t,i,n,r){this.logger=c.Framework.resolve(c.Framework.v.p).log(r),this.kS=c.Framework.resolve(c.Framework.v.jR),this._U=c.Framework.resolve(c.Framework.v.fk),this.PH=c.Framework.resolve(c.Framework.v.HC),this.logger.debug(v+"INIT STATS STORE - ID: "+t),this.uS=t,this.ticket=i,this.xl(n)},w.prototype.RU=function(t){this.testId=t},w.prototype.SU=function(t){this.AU=t},w.prototype.IU=function(t){this.NU=t},w.prototype.CU=function(t){this.kU=t},w.prototype.xl=function(t){this.Bl=t},w.prototype.DU=function(t){this.tv=t},w.prototype.jU=function(){this.Ul=new d(),this.uS=null,this.ticket=null,this.reset()},w.prototype.reset=function(){this.MU=new d(),this.PU(this.MU.gU),this.LU(this.MU),this.responseInfo.source=[]},w.prototype.PU=function(t){t.reqN=0,t.respFallbackN=0,t.respFallbackErrN=0,t.respP2pN=0,t.reqOtherN=0,t.respFallbackOtherN=0,t.respFallbackOthertErrN=0,t.srcReqN=0,t.srcRespN=0,t.srcRespErrN=0,t.srcReqQt=0,t.srcRespQt=0,t.srcOverQt=0,t.srcOtherReqN=0,t.srcOtherRespN=0,t.srcOtherRespErrN=0,t.srcOtherReqQt=0,t.srcOtherRespQt=0,t.srcOtherOverQt=0,t.p2pSubReqN=0,t.p2pSubRespN=0,t.p2pSubRespPartN=0,t.p2pSubRespErrN=0,t.p2pSubRespExpN=0,t.p2pSubReqQt=0,t.p2pSubRespQt=0,t.p2pDirectQt=0,t.p2pRelayQt=0,t.p2pNatQt=0,t.p2pUdpbQt=0,t.fallAgentRespN=0,t.fallAgentPredHitN=0,t.fallAgentFailedRespN=0,t.fallAgenTrafficSuccessQt=0,t.p2pAgentPredHitN=0,t.p2pAgentPredMissN=0,t.p2pAgentPredPartialHitN=0,t.p2pAgenTrafficSuccessQt=0,t.p2pAgenTrafficFailureQt=0},w.prototype.LU=function(t){t.metrics.videoBufN=0,t.metrics.videoBufQt=0,t.metrics.clientBufferMs=0,t.metrics.lookupNotFound=0,t.metrics.lookupTotal=0,t.metrics.lookupLatency=0,t.metrics.lookupReqAccept=0,t.metrics.lookupReqEstablished=0,t.metrics.lookupFailed=0,t.player.bufferingN=0,t.player.bufferingMs=0,t.player.playingTimeMs=0},w.prototype.jf=function(t){var n=this;void 0===t&&(t=!0);var r=new hive.snapshots.MetricSnapshot();r.timestamp=c.Framework.time(),r.guid=this.uS,r.sessionId=this.ticket.sessionId,r.eventId=new EventId(),r.eventId.partnerId=this.ticket.mR(),r.eventId.customerId=this.ticket._R(),r.eventId.contentId=this.ticket.RR();try{var i=new hive.snapshots.ClientInfo();i.clientType=this.HU();var s=this.Bl.version.split(".");if(i.majorVersion=parseInt(s[0]),i.minorVersion=parseInt(s[1]),i.patchVersion=parseInt(s[2]),r.client=i,null!=this.testId){var e=new TestInfo();e.testId=this.testId,r.testInfo=e}}catch(t){this.logger.warn(v+"error setting Snapshot ClientInfo",t)}if(this.tv){var h=new hive.snapshots.AgentInfo();h.firstTierBitrates=this.tv.UU().map(function(t){return t.bitrate}),h.secondTierBitrates=this.tv.FU().map(function(t){return t.bitrate}),r.agentInfo=h}r.streamInfo=this._U.GU(),r.fragments=this.PH.GU(),r.traffic=[];var o=new hive.snapshots.TrafficKey();if(r.traffic.push({key:o,value:this.MU.gU}),this.MU.bU.forEach(function(t,i){var n=new hive.snapshots.TrafficKey();n.qualityLevelId=i,r.traffic.push({key:n,value:t})}),r.metrics=this.MU.metrics,this.AU&&(r.metrics.clientBufferMs=this.AU.min()),this.NU&&(r.metrics.trackerLatency=this.NU.min()),this.kU&&(r.metrics.sourceLatency=this.kU.min()),r.player=this.MU.player,0<this.responseInfo.source.length&&(r.responseInfo=this.responseInfo),this.xU){var u=this.xU.BU();this.MU.metrics.prtOutN=u.VU+u.qU,this.MU.metrics.prtInN=u.QU+u.YU;var a=this.xU.KU();a.forEach(function(t,i){n.WU(i,t,r)}),this.MU.OU.filter(function(t,i){return!a.has(i)}).forEach(function(t,i){n.WU(i,t,r)})}return r.connInfo=new hive.snapshots.ConnectivityInfo(),t?this.kS.getConnectivityInfo().then(function(t){return r.connInfo.privateIp=f.SensitiveInfoUtils.getPrivateIp(t.getNetworkChanged()),n.$U(n.XU(r))}).fail(function(t){return n.$U(n.XU(r))}):(r.connInfo.privateIp=f.SensitiveInfoUtils.getPrivateIp(this.kS.jS().getNetworkChanged()),this.$U(r))},w.prototype.XU=function(t){return t.connInfo.internalAs=this.zU,t.connInfo.externalAs=this.JU,t.connInfo.publicIp=this.ZU,t},w.prototype.$U=function(t,i){void 0===i&&(i=[]);var n=l.Sc(t,"snapshot");return n.length&&a.ErrorMonitor.getInstance().logError("NaN found in MetricSnapshot",v,{keysWithNaN:n,snapshot:t}),i.length=0,i.push.apply(i,n),t},w.prototype.HU=function(){var t;switch(this.Bl.name){case"JS":t=ClientType.tF;break;case"PROXY":t=ClientType.iF;break;default:t=ClientType.nF}return t},w.prototype.WU=function(t,i,n){var r=this.MU.yU.get(t);i.traffic=r,n.partners||(n.partners=[]);var s=new hive.snapshots.PartnerKey();s.partnerGuid=t,n.partners.push({key:s,value:i})},w.prototype.rF=function(t,i){0<t&&(this.MU.metrics.videoBufN++,this.MU.metrics.videoBufQt+=t,this.MU.player.bufferingN++,this.MU.player.bufferingMs+=t),this.MU.player.playerBufferMs=i},w.prototype.sF=function(t){0<t&&(this.MU.player.playingTimeMs+=t,this.Ul.player.playingTimeMs+=t)},w.prototype.eF=function(){return this.MU.gU},w.prototype.hF=function(){return this.Ul.gU},w.prototype.oF=function(t){return this.Ul.bU.has(t.id)||this.Ul.bU.set(t.id,new hive.snapshots.Traffic()),this.Ul.bU.get(t.id)},w.prototype.uF=function(t){if(!this.MU.bU.has(t.id)){var i=new hive.snapshots.Traffic();this.PU(i),this.MU.bU.set(t.id,i)}return this.MU.bU.get(t.id)},w.prototype.aF=function(){var t=new hive.snapshots.PartnerTraffic();return t.p2pSuccReq=0,t.p2pFailReq=0,t.p2pPartReq=0,t.p2pSuccReceived=0,t.p2pSuccReceivedLow=0,t.p2pFailReceived=0,t.p2pSuccResp=0,t.p2pFailResp=0,t.p2pPartResp=0,t.p2pSuccSent=0,t.p2pSuccSentLow=0,t.p2pFailSent=0,t},w.prototype.fF=function(t,i){return i.yU.has(t)||i.yU.set(t,this.aF()),i.yU.get(t)},w.prototype.cF=function(t){return this.fF(t,this.MU)},w.prototype.lF=function(t){return this.fF(t,this.Ul)},w.prototype.vF=function(t){this.kS=t},w.prototype.dF=function(t){this.xU=t},w.prototype.PS=function(t){},w.prototype.EF=function(i){var n=!1;this.responseInfo.source.forEach(function(t){t.statusCode==i&&(t.count++,n=!0)}),n||this.responseInfo.source.push(new hive.snapshots.ResponseInfo({statusCode:i,count:1}))},w);function w(){this.ticket=null,this.zU=0,this.JU=0,this.testId=null,this.responseInfo=new hive.snapshots.ServiceResponseInfo(),this.jU()}i.eU=E;var p=(g.prototype.init=function(t,i){this.logger=c.Framework.resolve(c.Framework.v.p).log(i),this.logger.debug(v+"INIT CLIENT STATS"),this.store=t,this.wF()},g.prototype.wF=function(){var t=this;-1<this.pF&&c.Framework.clearInterval(this.pF),this.pF=c.Framework.setInterval(function(){t.snapshot()},s.Rc.Ec)},g.prototype.onStateChange=function(t){this.state=t},g.prototype.gF=function(){if(this.store)return this.snapshot(!1)},g.prototype.reset=function(t){c.Framework.clearInterval(this.pF),this.store&&(!1===t?this.store.reset():this.store.jU())},g.prototype.snapshot=function(t){var i=this;void 0===t&&(t=!0);var n=this.store.jf(t);t?(this.logger.debug(v+"TAKING SNAPSHOT"),n.then(function(t){return i.forward(t)}).fail(function(t){i.logger.warn(v+"ERROR FORWARDING SNAPSHOT",t)})["finally"](function(){i.store.reset()})):(this.logger.debug(v+"FLUSHING SNAPSHOT"),this.forward(n))},g.prototype.forward=function(t){var i=this;if(this.state!==u.Il.IDLE&&this.state!==u.Il.STOP)if(!this.filter||this.filter.Hl()){if(this.client&&this.client.xS()){switch(this.bF){case 0:default:this.logger.debug(v+"SENDING SNAPSHOT");break;case 1:this.logger.debug(v+"SENDING SNAPSHOT "+JSON.stringify(t));break;case 2:this.logger.debug(v+"SENDING SNAPSHOT",t);break;case 3:this.logger.debug(v+"SENDING SNAPSHOT "+JSON.stringify(t),t)}this.protocol.na("SNAPSHOT",h.ra.ONEWAY,0),t.write(this.protocol),this.protocol.sa();var n=this.transport.ea(),r=this.ha(n,",",4),s=n.slice(r+1,n.length-1),e=new o.Lc(HiveStreamingServices.VS,1,s);this.client.xS().send(e).fail(function(t){i.logger.warn(v+"PROBLEM: ",t)})}}else this.logger.debug(v+"SKIPPING SNAPSHOT");else this.logger.debug(v+"not send - state "+u.Il[this.state])},g.prototype.ha=function(t,i,n){return t.split(i,n).join(i).length},g.prototype.$l=function(t){this.filter=t},g);function g(){this.bF=isNaN(e.HiveConfig.DebugLogs.MetricSnapshotLogs)?0:e.HiveConfig.DebugLogs.MetricSnapshotLogs,this.state=u.Il.Nl,this.client=c.Framework.resolve(c.Framework.v.jl),this.transport=new h.ca(),this.protocol=new h.la(this.transport)}i.Zl=p},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var h=n(4),o=n(21),u=n(139),e=n(0),a=n(14),f=n(16),c=n(8).Y["if"],l=(v.prototype.init=function(t,n){var r=this;if(this.yF)this.yF.then(function(){var t={partnerId:n.mR(),customerId:n._R(),contentId:n.RR(),secret:n.GL()},i=new f.Lc(HiveStreamingServices.TF,1,JSON.stringify(t));r.connection.send(i)});else{var i=h.defer(),s=a.Rc.oc;n.WL&&(c?s=a.Rc.ac:(this.logger.warn("[HiveComm] Error trying to resolve test ticket against production services - use production ticket or test plugin"),i.reject(new Error("test ticket in production"))));var e=new o(s).qd({"connection-id":t,partner_id:n.mR(),customer_id:n._R(),content_id:n.RR(),ticket:n.GL()}).toString();this.connection=new u.OF(e,a.Rc.bc,a.Rc.yc,a.Rc.Tc),this.connection.onconnect(function(){r.logger.debug("HIVE SERVICES CONNECTED"),i.resolve(r.connection)}),this.connection.onerror(function(){r.logger.warn("Hive Services Connection failed"),i.reject(r.connection)}),this.yF=i.promise}return{fv:this.connection,promise:this.yF}},v.prototype.connect=function(){this.connection&&this.connection.connect(!0)},v.prototype.AR=function(t){},v.prototype.xS=function(){return this.connection},v.prototype.close=function(){this.connection&&(this.yF=null,this.connection.close(!1))},v);function v(){this.logger=e.Framework.resolve(e.Framework.v.p).log(),this.logger.debug("INIT SERVICE CLIENT")}i.mF=l;var d,E=(s(w,d=l),w.prototype.init=function(t,i,n){var r=this;if(this.yF)return this.yF;var s=h.defer(),e=new o(n).qd({"connection-id":t}).toString();return this.logger.debug(this.loggerId+" Connecting to serviceEndpoint "+e),this.connection=new u.OF(e,a.Rc.bc,a.Rc.yc,a.Rc.Tc),this.connection.onconnect(function(){r.logger.debug("HIVE SERVICES CONNECTED"),s.resolve(r.connection)}),this.connection.on(HiveStreamingServices.TF,0,function(t){r.logger.debug("FAKED RESOLVING")}),this.connection.onerror(function(){r.logger.warn("Hive Services Connection failed"),s.reject(r.connection)}),this.yF=s.promise,this.yF},w);function w(){var t=null!==d&&d.apply(this,arguments)||this;return t.loggerId="[ServicesClientViaToken]",t}i._F=E},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0}),n(140);var s=n(4),r=n(3),e=n(0),h=n(62),o=n(141),u=(a.prototype.resolve=function(t,i){var n=this,r=s.defer();return t&&(t.on(HiveStreamingServices.TF,0,function(t){n.RF(t)}),t.on(HiveStreamingServices.TF,2,function(t){n.RF(t)}),this.SF.set(i,new o.AF(r))),r.promise},a.prototype.RF=function(t){var r=this,s=new Date().getTime(),e=JSON.parse(t.msg),h=!1;this.SF.forEach(function(t,i){if(r.IF(i,e)){h=!0;var n=r.verifyTicket(i,e);n?(n.bR=t.bR,n.yR=s,t.NF.resolve(n)):t.NF.reject("Ticket verification failed"),r.SF["delete"](n)}}),h||this.logger.warn("no pending ticket matching: "+t.msg)},a.prototype.ev=function(t){return new RegExp("^https?://api(?:-test)?.hivestreaming.com/v1/events/(?:wildcard/)?").test(t)?h.Ticket.OR(t):null},a.prototype.IF=function(t,i){return t.mR()===i.SiteId&&t._R()===i.CROId&&t.RR()===i.ContentId},a.prototype.verifyTicket=function(t,i){return t.LL(i),t.FL()?t:null},a);function a(){this.SF=new r(),this.logger=(e.Framework.resolve(e.Framework.v.p)||console).log(),this.logger.debug("INIT TICKET RESOLVER")}i.CF=u},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e=n(55),o=n(4),h=n(0),u=n(14),a=n(142),f=(c.prototype.kF=function(){var t=this,i=o.defer(),n=indexedDB.open(this.DF);return n.onupgradeneeded=function(){n.result.createObjectStore(t.jF,{keyPath:"id"})},n.onsuccess=function(){var t=n.result;i.resolve(t)},n.onerror=function(t){i.reject(t)},i.promise},c.prototype.sv=function(){var s=this;if(this.MF)return this.MF;var e=o.defer();if(this.uS)e.resolve(new a.PF(this.uS));else if(u.Rc.nf&&this.indexedDB){var h=setTimeout(function(){s.logger.warn("[HiveComm] timeout retrieving persistent ID - generating random one"),s.uS=s.LF(),s.logger.debug("[HiveComm] Generated UUID: "+s.uS),e.resolve(new a.PF(s.uS))},4e3);try{this.kF().then(function(n){var r=n.transaction(s.jF,"readwrite").objectStore(s.jF).get("MYID");r.onsuccess=function(){if(clearTimeout(h),s.uS)e.resolve(new a.PF(s.uS));else if(null!=r.result&&u.Rc.nf){var t=r.result.value;s.logger.debug("[HiveComm] Retrieved persistent UUID: "+t),s.uS=t,n.close(),e.resolve(new a.PF(s.uS))}else{var i=s.LF();s.HF(n,i),e.resolve(new a.PF(s.uS))}},r.onerror=function(t){clearTimeout(h),s.uS||(s.logger.warn("[HiveComm] error retrieving persistent UUID: "+t),s.uS=s.LF(),s.logger.debug("[HiveComm] Generated UUID: "+s.uS)),e.resolve(new a.PF(s.uS))}}).fail(function(t){clearTimeout(h),s.uS||(s.logger.warn("[HiveComm] error opening indexedDB - generating random id. Error: "+t),s.uS=s.LF(),s.logger.debug("[HiveComm] Generated UUID: "+s.uS)),e.resolve(new a.PF(s.uS))})}catch(t){this.uS=this.LF(),this.logger.debug("[HiveComm] Persistence error - Generate UUID: "+this.uS,t),e.resolve(new a.PF(this.uS))}}else this.uS=this.LF(),this.logger.debug("[HiveComm] Persistence disabled - Generate UUID: "+this.uS),e.resolve(new a.PF(this.uS));return this.MF=e.promise,this.MF},c.prototype.HF=function(t,i){var n=this,r=t.transaction(this.jF,"readwrite");r.objectStore(this.jF).put({id:"MYID",value:i}),r.oncomplete=function(){n.logger.debug("[HiveComm] completed UUID persistence"),t.close()},this.logger.debug("[HiveComm] Generated UUID: "+i),this.uS=i},c.prototype.LF=function(){return e.CR()},c);function c(){this.jF="IdentityStore",this.DF="IdentityDB",this.uS=null,this.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,h.Framework&&h.Framework.resolve(h.Framework.v.p)?this.logger=h.Framework.resolve(h.Framework.v.p).log():this.logger=console}i.UF=f;var l,v=(s(d,l=f),d.prototype.sv=function(){var s=this;if(this.FF)return this.FF;var e=o.defer();return l.prototype.sv.call(this).then(function(t){var i=s.LF(),n=t.av(),r=new a.PF(i,n);e.resolve(r)}).fail(function(t){var i=s.LF(),n=new a.PF(i);e.resolve(n)}),this.FF=e.promise,this.FF},d);function d(){return l.call(this)||this}i.GF=v},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.xF=function(t){this.hostname=t},s.prototype.getHostName=function(){return this.hostname},s.prototype.BF=function(t){this.nc=t},s.prototype.getNetworkChanged=function(){return this.nc},s);function s(){}i.VF=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),f=n(48),c=n(7),s=(e.prototype.add=function(t,i){var n,r=i.id,s=i.bitrate,e=i.width,h=i.height,o=i.label,u=new f.QualityLevel(r,s,e,h,o);switch(t){case c.xa.Va:n=this.qF;break;case c.xa.Ba:n=this.QF;break;default:return u}var a=n.find(function(t){return t.id===r});return a?((u=a).bitrate!==s&&(u.bitrate=s,u.Ck.push(s)),u.width!==e&&(u.width=e),u.height!==h&&(u.height=h),u.label!==o&&(u.label=o)):(n.push(u),this.YF(n)),u},e.prototype.get=function(i){return this.qF.find(function(t){return t.id===i})},e.prototype.getAll=function(t){switch(t){case c.xa.Va:return this.qF;case c.xa.Ba:return this.QF;default:return this.QF.concat(this.qF)}},e.prototype.KF=function(t){return this.getAll(t).reduce(function(t,i){return t.set(i.id,i.Ik),t},new r())},e.prototype.reset=function(){this.qF=[],this.QF=[]},e.prototype.YF=function(t){t.sort(function(t,i){return t.bitrate-i.bitrate}).forEach(function(t,i){return t.Ik=i})},e);function e(){this.qF=[],this.QF=[]}i.WF=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=hive.snapshots.QualityLevel,s=(e.prototype.$F=function(t){this.XF=t},e.prototype.GU=function(){if(!this.XF)return[];var t=this.XF.getAll(),i=t.map(function(t){var i=new r();return i.id=t.id,i.width=t.width||null,i.height=t.height||null,i.label=t.label||null,i.bitrates=t.Ck.filter(function(t){return null!=t}),i});return t.forEach(function(t){return t.Nk()}),i},e);function e(){}i.zF=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(6),s=(e.prototype.JF=function(t){this.watchingQualityLevel=t},e.prototype.ZF=function(){return this.watchingQualityLevel},e.prototype.tG=function(){return this.iG},e);function e(){this.iG=new r.ma()}i.nG=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=hive.snapshots.FragmentMetadata,s=n(7),e=(h.prototype.add=function(t,i){var n=new r();switch(n.url=t.eA,n.size=i,n.duration=t.duration,n.qualityLevelId=t.qualityLevel.id,t.hA){case s.xa.Ba:n.contentType=ContentType.Ba;break;case s.xa.Va:n.contentType=ContentType.Va;break;default:n.contentType=null}this.metrics.push(n)},h.prototype.GU=function(){var t=this.metrics;return this.metrics=[],t},h);function h(){this.metrics=[]}i.rG=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=(e.prototype.init=function(t,i){this.sG=t,this.eG=i},e.prototype.hG=function(t){this.eG=t},e.prototype.$F=function(t){this.oG.$F(t)},e.prototype.GU=function(){var t=this.sG,i=this.eG,n=new hive.snapshots.StreamInfo();return n.url=t.VL(),n.streamProtocol=i.getStreamProtocol(),n.streamType=i.UH()?StreamType.LIVE:StreamType.VOD,n.qualityLevels=this.oG.GU(),n},e);function e(){this.oG=r.Framework.resolve(r.Framework.v.bk)}i.uG=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(0),e=n(143),h=n(1),o=(u.prototype.aG=function(){var t=new e.fG();this.cG.BF(t)},u.prototype.jS=function(){return this.cG},u.prototype.getConnectivityInfo=function(){var i=this;if(!this.connInfo)return r.reject("ConnInfo helper undefined");var n=setTimeout(function(){return i.logger.warn(i.loggerId+"Get connectivity info expired"),i.cG?r.resolve(i.cG):r.reject("expired")},2e3);try{return this.connInfo.getConnectivityInfo().then(function(t){return clearTimeout(n),i.cG=t}).fail(function(t){return i.logger.debug(i.loggerId+" get connectivity info failed with error 1: ",t),i.cG?i.cG:r.reject(t)})}catch(t){return this.logger.debug(this.loggerId+" get connectivity info failed with error 2:",t),r.reject(t)}},u.prototype.lG=function(t,i,n){},u.prototype.vG=function(t){},u);function u(){this.loggerId="[PreloadConnectivityInfoProvider] ",this.connInfo=window.myConnInfo,this.logger=s.Framework.resolve(s.Framework.v.p).log(),this.cG=s.Framework.resolve(s.Framework.v.tk),this.connInfo||h.ErrorMonitor.getInstance().logError("helper undefined",this.loggerId),this.aG()}i.dG=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.EG=function(t){this.publicIp=t},s.prototype.getPublicIp=function(){return this.publicIp},s.prototype.wG=function(t){this.macAddress=t},s.prototype.getMacAddress=function(){return this.macAddress},s.prototype.pG=function(t){this.nic=t},s.prototype.getNic=function(){return this.nic},s.prototype.gG=function(t){this.nicName=t},s.prototype.getNicName=function(){return this.nicName},s.prototype.bG=function(t){this.privateIp=t},s.prototype.getPrivateIp=function(){return this.privateIp},s.prototype.yG=function(t){this.netmask=t},s.prototype.getNetmask=function(){return this.netmask},s.prototype.TG=function(t){this.cidr=t},s.prototype.getCidr=function(){return null},s);function s(){}i.OG=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var s=n(4),r=n(3),e=n(0),h=n(90),o=n(144),u=n(13),c=n(14),a=n(49),f=(l.prototype.aG=function(){var t=new h.OG();this.cG.BF(t)},l.prototype.mG=function(){var t=this;e.Framework.setInterval(function(){t.privateIps=[],t._G=[],t.RG=new r(),t.publicIp=null,t.SG=null,t.getConnectivityInfo()},12e4)},l.prototype.getConnectivityInfo=function(){return this.SG||(this.SG=this.AG()),this.SG},l.prototype.jS=function(){return this.cG},l.prototype.AG=function(){var n=this,r=s.defer();if(this.IG=e.Framework.setTimeout(function(){r.reject({NG:!0,message:"expired"})},4e3),u.HiveConfig.ConnInfo.detectPrivateIP&&this.CG())try{this.kG=new RTCPeerConnection(null),this.DG=this.kG.createDataChannel("sendChannel",{reliable:!1}),this.jG=new RTCPeerConnection(null),this.jG.ondatachannel=function(t){n.MG=t.channel,n.MG.onopen=function(t){if("open"===n.MG.readyState){if(n.jG.close(),n.kG.close(),n.jG=null,n.kG=null,n.logger.debug("Collected ips ["+n.RG.map(function(t,i){return i+":"+t.PG}).join(", ")+"]"),c.Rc.mc&&!n.LG&&(setTimeout(function(){a.Lk.Dk(null,null,"local_ice",null,n.HG)},5e3),n.LG=!0),0<n.RG.length&&c.Rc.Oc){var i=n.RG.entries().sort(function(t,i){return i[1].PG-t[1].PG});i=i.splice(0,1)[0],n.RG.clear(),n.RG.set(i[0],i[1])}n.FG.UG().then(function(t){n._G=t,0<n._G.length&&(n.logger.debug("Already known matching ips ["+n._G.join(",")+"]"),n._G.forEach(function(t){0<n.RG.keys().indexOf(t)&&(n.privateIps.push(t),n.RG["delete"](t))})),n.privateIps=n.privateIps.concat(n.RG.keys())}).fail(function(t){n.logger.warn("Get Previous working ips failed with error "+t.message),n.privateIps=n.privateIps.concat(n.RG.keys())})["finally"](function(){n.logger.debug("Final private ip list ["+n.privateIps.join(",")+"]"),r.resolve(n.GG())})}}},this.kG.onicecandidate=function(t){t.candidate&&(n.xG(t.candidate.candidate),n.jG&&n.jG.addIceCandidate(t.candidate)["catch"](function(t){r.reject({NG:!0,message:t.message}),e.Framework.clearTimeout(n.IG),!1}))},this.jG.onicecandidate=function(t){t.candidate&&(n.xG(t.candidate.candidate),n.kG&&n.kG.addIceCandidate(t.candidate)["catch"](function(t){r.reject({NG:!0,message:t.message}),e.Framework.clearTimeout(n.IG),!1}))},this.kG.createOffer().then(function(t){return n.kG.setLocalDescription(t)}).then(function(){return n.jG.setRemoteDescription(n.kG.localDescription)}).then(function(){return n.jG.createAnswer()}).then(function(t){return n.jG.setLocalDescription(t)}).then(function(){return n.kG.setRemoteDescription(n.jG.localDescription)})["catch"](function(t){r.reject({NG:!0,message:t.message}),e.Framework.clearTimeout(n.IG),!1})}catch(t){r.reject({NG:!0,message:t.message})}else{e.Framework.clearTimeout(this.IG);var t=u.HiveConfig.ConnInfo.detectPrivateIP?"webrtc datachannel not supported":"private IP detection disabled";r.reject({NG:!1,message:t})}return r.promise},l.prototype.CG=function(){try{return"function"==typeof RTCPeerConnection.prototype.createDataChannel}catch(t){return!1}},l.prototype.xG=function(t){var i="candidate:",n=t.indexOf(i)+i.length,r=t.substr(n).split(" "),s=r[0],e=r[1],h=r[2],o=r[3],u=r[4],a=r[5],f={BG:e,type:r[7],VG:s,protocol:h,address:u,port:a,PG:o};c.Rc.mc&&!this.LG&&this.HG.push(f),this.qG(f)},l.prototype.qG=function(t){var i=/([0-9]{1,3}(\.[0-9]{1,3}){3})/.exec(t.address);if(i){var n=i[0],r=this.RG.get(n);(isNaN(r)||t.PG>r)&&this.RG.set(n,t)}},l.prototype.GG=function(){var t=new h.OG();return 0<this.privateIps.length&&t.bG(this.privateIps[0]),this.publicIp&&t.EG(this.publicIp),this.cG.BF(t),this.cG},l.prototype.lG=function(t,i,n){if(this.publicIp=t,this.QG(),0===n&&1<this.privateIps.length)this.privateIps.shift();else if(c.Rc.lf&&0!==n&&-1==this._G.indexOf(this.privateIps[0]))this._G.unshift(this.privateIps[0]),this.FG.YG(this._G.slice(0,2));else if(c.Rc.lf&&0!==n&&0<this._G.indexOf(this.privateIps[0])){var r=this._G.indexOf(this.privateIps[0]);this._G=this._G.splice(r,1),this._G.unshift(this.privateIps[0]),this.FG.YG(this._G.slice(0,2))}this.GG()},l.prototype.QG=function(){var t=this.privateIps.indexOf(this.publicIp);-1<t&&this.privateIps.splice(t,1)},l.prototype.vG=function(t){},l);function l(){this.kG=null,this.jG=null,this.DG=null,this.MG=null,this.RG=new r(),this.publicIp=null,this.privateIps=[],this.failed=!1,this.IG=null,this.HG=[],this.LG=!1,this.logger=e.Framework.resolve(e.Framework.v.p).log(),this.cG=e.Framework.resolve(e.Framework.v.tk),this.FG=new o.KG(),this._G=[],this.aG(),this.mG()}i.WG=f},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(61),s=n(4),e=n(47),h=n(46),o=n(15),u=n(148),a=n(19),f=n(26),c=n(1),l=n(30),v=n(0),d=n(93),E=n(94),w=n(149),p=n(7),g=n(63),b=n(150),y=(T.prototype.getName=function(){return T.dR},T.prototype.id=function(){return"["+T.dR+"] "},T.prototype.getVersion=function(){return this.plugin.getPluginVersion()},T.prototype.needsReportingInstance=function(){return!0},T.prototype.isReady=function(){return s.resolve(!0)},T.prototype.initSession=function(t,i){var n=this.$G(t,i.ticket,i.ticket.VL(),i);return f.aR.getInstance().register(this.plugin,n),h.HiveRequestFactory.register(this),window&&window.activateXHRInterceptor&&window.activateXHRInterceptor(this.plugin.loggerLevel()>l.JS.info,this.plugin.getPluginId()),s.resolve(n)},T.prototype.getInitSessionTimeout=function(){return this.options().initTimeout},T.prototype.isActive=function(t,i,n){var r=i.manifest.toLowerCase().indexOf("/manifest");if(-1<r&&(!n||t===i.manifest)){var s=i.manifest.substring(0,r);if(-1<t.indexOf(s))return!0}else if(t==i.manifest)return!0;return!1},T.prototype.closeSession=function(t,i,n){void 0===n&&(n=!0),t.reportingInstance&&r["default"].getInstance().Dl(t.id)&&(this.plugin.logger().debug("[StatsJS] stopping session ["+t.id+"] complete close: "+i),t.reportingInstance.Wl.qS(n),t.reportingInstance.Ql.gF(),t.reportingInstance.Ql.reset(i)),i?r["default"].getInstance().close(t.id):this.onStateChange(t,!0)},T.prototype.onStateChange=function(t,i){var n=i?a.Il.IDLE:a.Il.Nl;this.plugin.logger().notice("[HiveComm] client state: "+a.Il[n]),t.reportingInstance&&t.reportingInstance.onStateChange(n)},T.prototype.handleStats=function(t,i){var n=0;return this.XG<i.totalBuffering&&(n=i.totalBuffering-this.XG,this.XG=i.totalBuffering),t.getReportingInstance().then(function(){t.reportingInstance.Vl.rF(n,i.bufferLength),t.reportingInstance.Vl.sF(i.zG),t.reportingInstance.ql.ES(i.playingPoint,i.bufferLength,i.totalBuffering)}).done(),s.resolve(!0)},T.prototype.handleEvent=function(t,i,n){return t.getReportingInstance().then(function(){t.reportingInstance.ql.pS(t.ticket.sessionId,i,n)}).done(),s.resolve(!0)},T.prototype.handleTechEvent=function(t,i){return t.getReportingInstance().then(function(){t.reportingInstance.ql.yS([i])}).done(),s.resolve(!0)},T.prototype.onError=function(t){var i=!0;if(null!=this.options().onError)try{!1===this.options_.onError(t)&&(i=!1)}catch(t){c.ErrorMonitor.getInstance().logError("exception in user-defined onError callback",this.id(),t)}return i},T.prototype.onActiveSession=function(r){var s=this;this.JG(),r.getReportingInstance().then(function(t){s.ZG=t;var i={getStreamProtocol:function(){return s.plugin.getStreamProtocol()},UH:function(){}};s.tx.init(s.ZG,r.id),s.tx.fM(s.ZG.ticket,s.options_&&s.options_.contextMatcher),r.authenticationToken&&s.tx.j.qH(r.authenticationToken),s.ZG.Vl._U.init(r.ticket,i),s.plugin.updatePlayerInfo(s.ZG),s.ZG.Ql.init(s.ZG.Vl,r.id),s.plugin.options().testId&&s.ZG.Vl.RU(s.plugin.options().testId),s.ZG.ql.manifestRequested(r.ticket.sessionId,s.plugin.getPlayerSource(),200),s.ix.init(s.ZG);var n=s.plugin.flushTechEvents();if(n&&0<n.length&&s.ZG.ql.yS(n),null!=s.options_.onActiveSession)try{s.options_.onActiveSession(r.toHiveSession())}catch(t){c.ErrorMonitor.getInstance().logError("exception in user-defined onActiveSession callback",s.id(),t)}}).done()},T.prototype.onTechTimeout=function(){},T.prototype.resetTech=function(){},T.prototype.setPlugin=function(t){this.plugin=t},T.prototype.options=function(){return this.options_},T.prototype.JG=function(){this.XG=0},T.prototype.$G=function(t,i,n,r){var s=new e.HiveSessionInternal(t,i,n,r,this.plugin.options().onSessionStateChange);return s.SDN=!1,s.id=i.sessionId,s},T.prototype.getPluginId=function(){return this.plugin.getPluginId()},T.prototype.createManifestRequest=function(t){var r=this,i=v.Framework.resolve(v.Framework.v.FC),s=new w.nx(i,t);return s.sx=function(t,i){if(t===g.$L.JL){r.plugin.logger().debug("Intercepted Manifest Request "+i);var n=r.tx.j;n.ex(s),r.ZG.Vl._U.hG(n),r.ZG.Vl._U.$F(n.yM())}else c.ErrorMonitor.getInstance().logError("Error intercepting manifest request",i)},i},T.prototype.createRequest=function(t){var i=this,n=this.tx.j,r=v.Framework.resolve(v.Framework.v.FC),s=new E.VA(r,n.getMetadata());return s.sx=function(t){n.hH(s).then(function(){if(i.ix.hx(s),t===g.$L.JL)switch(s.S_()){case p.xa.Ba:n.jH(s);break;case p.xa.Va:n.ox(s),n.ux(s),n.jH(s)}})},r},T.prototype.supportsXhrInterception=function(){return Boolean(this.options_.enableXhrInterception)},T.dR="StatsJS",T);function T(t,i){this.plugin=t,this.options_=new u.StatsJSOptions(),this.tx=new b.ax(),this.ix=new d.lx(),void 0!==i[T.dR]&&o.updateOptions(i[T.dR],this.options_),o.parseParameterOptions(window.location.href,new u.StatsJSUrlConfigurableOptions(),this.options_)}i.StatsJS=y},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(63),s=n(7),e=(h.prototype.init=function(t){this.tv=t.tv,this.Vl=t.Vl},h.prototype.vx=function(t){},h.prototype.uH=function(t){t?this.Vl.MU.metrics.bitrateUpN++:this.Vl.MU.metrics.bitrateDwnN++},h.prototype.hx=function(i){var t=this.tv.tG().ga();switch(isNaN(t)||(this.Vl.MU.metrics.srcThroughput=t),this.Ex(i).forEach(function(t){t.srcReqN++,t.srcRespQt+=i.x_()}),i.B_()){case r.$L.JL:this.wx(i,NaN);break;case r.$L.ZL:case r.$L.tH:this.px(i,NaN)}},h.prototype.wx=function(t,i){this.Ex(t).forEach(function(t){t.srcRespN++,t.respFallbackN++})},h.prototype.px=function(t,i){this.Ex(t).forEach(function(t){t.srcRespErrN++,t.respFallbackErrN++})},h.prototype.Ex=function(t){var i=[this.Vl.eF()];if(t.S_()===s.xa.Va){var n=t.V_().getQualityLevel(),r=this.Vl.uF(n);i.push(r)}return i},h);function h(){}i.lx=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(63),r=n(7),s=n(31),e=n(0),o=n(6),u=n(6),a=(f.prototype.loadstart=function(t){this.status=h.$L.zL,this.gx=e.Framework.time()},f.prototype.onload=function(t){this.status=h.$L.JL},f.prototype.onerror=function(t){this.status=h.$L.tH},f.prototype.onloadend=function(t){this.bx(),this.size=t.total,this.yx=e.Framework.time(),this.A_=this.Tx(),this.sx&&this.sx(this.status,this.url)},f.prototype.Tx=function(){if(!this.Ox)return null;var t=this.Ox.S_(this.url);if(t!==r.xa.Va&&t!==r.xa.Ba)return null;var i=this.Ox.MH(this.url);return s.dA.sA(i)},f.prototype.mx=function(){this.xhr.addEventListener("loadstart",this.loadstart.bind(this)),this.xhr.addEventListener("load",this.onload.bind(this)),this.xhr.addEventListener("error",this.onerror.bind(this)),this.xhr.addEventListener("loadend",this.onloadend.bind(this))},f.prototype.bx=function(){this.xhr.removeEventListener("loadstart",this.loadstart),this.xhr.removeEventListener("load",this.onload),this.xhr.removeEventListener("error",this.onerror),this.xhr.removeEventListener("loadend",this.onloadend)},f.prototype.k_=function(){return this.url},f.prototype.B_=function(){return this.status},f.prototype.x_=function(){return this.size},f.prototype.U_=function(){return new o.ma(this.yx-this.gx,this.size)},f.prototype.getResponse=function(){return this.xhr.response},f.prototype.G_=function(){return"arraybuffer"===this.xhr.responseType?u.Ia(this.xhr.response):this.xhr.response},f.prototype.S_=function(){return this.A_?this.A_.S_():r.xa.Qa},f.prototype.V_=function(){return this.A_},f);function f(r,t){var s=this;this.xhr=r,this.Ox=t,this.status=h.$L.XL;var e=r.open;r.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];t[0];var n=t[1];s.url=n,e.apply(r,t)},this.mx()}i.VA=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(32),o=n(1),r=(s.getInstance=function(){return this.instance||(this.instance=new s()),this.instance},s.prototype.AR=function(t,i,n){var r=h.aR.getInstance().pA(t),s=h.aR.getInstance().gA(t);if(!r)return o.ErrorMonitor.getInstance().logError("Tech or Plugin are not defined",this.loggerId),!1;var e={plugin:r,url:i,onActivateSession:n};return this._x(s,!0,e)||this._x(s,!1,e)},s.prototype._x=function(t,i,n){for(var r=n.plugin,s=n.url,e=n.onActivateSession,h=!1,o=0,u=t;o<u.length;o++){var a=u[o],f=void 0;(i?(f=a.ticket.VL())===s:(f=a.ticket.xL(),-1!==s.indexOf(a.ticket.xL())))?(r.logger().debug(this.loggerId+"Intercepted Manifest Request "+s),e&&e(a),r.onActivateSession(s,i),h=!0):r.logger().warn(this.loggerId+"Manifest url mismatches manifest url in ticket. Expected: "+f+", Actual: "+s)}return h},s);function s(){this.loggerId="[SessionActivator] "}i.Rx=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(93),s=n(7),e=(h.prototype.hH=function(i){var n=this;return this.metadata.hH(i).then(function(t){return n.metadata.S_(i.k_())===s.xa.qa&&n.ex(i),t})},h.prototype.ex=function(t){this.metadata.parse(t.k_(),t.G_(),!1)},h.prototype.DH=function(t){},h.prototype.jH=function(t){var i=this.metadata.MH(t.k_());i&&this.PH.add(i,t.x_())},h.prototype.ox=function(t){this.reportingInstance.tv.tG().wa(t.U_())},h.prototype.ux=function(t){var i=t.V_(),n=this.reportingInstance.tv.ZF(),r=i.getQualityLevel();n?0<r.Ob(n)?this.ix.uH(!0):r.Ob(n)<0&&this.ix.uH(!1):this.ix.uH(!0),this.reportingInstance.tv.JF(r)},h.prototype.getMetadata=function(){return this.metadata},h.prototype.getStreamProtocol=function(){return this.metadata.getStreamProtocol()},h.prototype.UH=function(){return this.FH},h.prototype.qH=function(t){this.metadata.qH(t)},h.prototype.yM=function(){return this.metadata.yM()},h);function h(t){this.reportingInstance=t,this.ix=new r.lx(),this.PH=t.Vl.PH,this.UL=t.ticket.VL(),this.ix.init(t)}i.XH=e},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(34),o=n(154),u=n(164),a=n(99),p=n(0),f=n(165),c=n(7),w=n(64),l=n(166),v=n(167),g=n(33),d=n(13),b=n(1),y=n(2),E=n(168),T=n(6),O=n(169),m=n(101),_=(e=m.Sx,s(R,e),R.prototype.getStreamProtocol=function(){return StreamProtocol.DASH},R.prototype.Ax=function(t){var i="";return-1!==t.indexOf("/")&&(-1!==t.indexOf("?")&&(t=t.substring(0,t.indexOf("?"))),i=t.substring(0,t.lastIndexOf("/")+1)),i},R.prototype.HH=function(i){return this.Ix.filter(function(t){return!i||t.type===i}).map(function(t){return t.qualityLevel})},R.prototype.reset=function(){this.Ix=[]},R.prototype.parse=function(t,i,n){var o=this;try{this.reset(),this.UL=t,this.manifest=this.Nx.parse(i);var u=this.manifest.hasOwnProperty("Location")?this.Ax(this.manifest.Location):this.Ax(t);this.manifest.hasOwnProperty("BaseURL")&&(u+=this.manifest.BaseURL),this.live="static"!==this.manifest.type;var a=this.manifest.Period_asArray[0];return a.AdaptationSet_asArray,a.AdaptationSet.forEach(function(t){var e=-1!=(t.mimeType?t.mimeType:t.Representation_asArray[0].mimeType).indexOf("audio")?c.xa.Ba:c.xa.Va;e===c.xa.Va&&t.ContentProtection&&o.Cx(t.ContentProtection);var h=t.SegmentTemplate;t.Representation_asArray&&t.Representation_asArray.forEach(function(t){var i=new f.Representation(),n=o.XF.add(e,{id:t.id,bitrate:parseInt(t.bandwidth),width:t.width,height:t.height,label:t.label}),r=t.SegmentTemplate?t.SegmentTemplate:h;if(i.type=e,i.qualityLevel=n,i.timescale=parseInt(r.timescale)||1e3,i.kx=t.id,i.initialization=u+""+r.initialization,i.initialization=i.initialization.replace(R.Dx,""+i.qualityLevel.bitrate),i.initialization=i.initialization.replace(R.jx,""+i.kx),i.initialization=T.Ha(i.initialization),i.Mx=u+""+r.media,i.Mx=i.Mx.replace(R.Dx,""+i.qualityLevel.bitrate),i.Mx=i.Mx.replace(R.jx,""+i.kx),i.Mx=T.Ha(i.Mx),i.Px=o.Lx(T.La(i.Mx)),i.Mx.match(R.Hx)){if(i.Ux=parseInt(r.duration),!i.Ux)throw new Error("Expected duration on SegmentTemplate for Number-based template");i.startNumber=parseInt(r.startNumber)||0,i.Fx=parseInt(a.start)||0,o.Gx=!0}else{var s=o.xx(r.SegmentTimeline_asArray[0].S_asArray,i.Mx,i.qualityLevel,e);i.Bx=s.Vx,i.qx=s.Qx}o.Ix.push(i)})}),this.Kx.Yx?this.Wx(i,n):i}catch(t){throw b.ErrorMonitor.getInstance().logError("Error parsing the metadata",this.loggerId,y.Un.Fn,t),new Error(t)}},R.prototype.Lx=function(t){var i=t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&"),n=i.match(/\\\$Number%(\d+)d\\\$/);return n&&(i=i.replace("\\$Number%"+n[1]+"d\\$","(\\d{"+parseInt(n[1])+"})")),i=(i=i.replace("\\$Time\\$","([0-9]*)")).replace("\\$Number\\$","([0-9]*)"),new RegExp(i,"i")},R.prototype.xx=function(t,u,a,f){try{var c,l=new h(),v=new h(),d=0,E=0;return t.forEach(function(t){if(t.d){t.t?d=parseInt(t.t):d+=E;var i=parseInt(t.d),n=u.replace(R.$x,d+""),r=new w.iH(d,a,i,n,n,f);c&&(c.next=r),l.set(T.La(n),r),v.set(d,r),c=r;var s=0;t.r&&(s=parseInt(t.r));for(var e=0;e<s;e++){d+=i;var h=u.replace(R.$x,d+""),o=new w.iH(d,a,i,h,h,f);c&&(c.next=o),l.set(T.La(h),o),v.set(d,o),c=o}E=i}}),{Vx:l,Qx:v}}catch(t){throw b.ErrorMonitor.getInstance().logError("Error extracting segment maps",this.loggerId,y.Un.Gn,t),new Error(t)}},R.prototype.Cx=function(t){try{if(t){if(t.CryptoPeriod){var i=t.CryptoPeriod;this.Xx&&!this.Xx.zx()&&this.Xx instanceof l.Jx||(this.Xx=new l.Jx(i.keyUriTemplate,i.IV,this.authenticationToken))}else this.Xx&&this.Xx instanceof v.Zx||(this.Xx=new v.Zx());this.Xx&&g.Dash.MA&&this.Xx.init()}}catch(t){throw b.ErrorMonitor.getInstance().logError("Error initializing the protection",this.loggerId,y.Un.xn,t),new Error(t)}},R.prototype.tB=function(i){return i=T.La(i),this.Ix.find(function(t){return t.Px.test(i)})},R.prototype.MH=function(t){t=T.La(t);try{var i=this.tB(t);if(i){var n=void 0;if(i.Bx&&(n=i.Bx.get(t)))return n;var r=t.match(i.Px);if(r){var s=parseInt(r[1]);return this.BH(s,i.qualityLevel)}}throw new Error("No representation for "+t)}catch(t){return b.ErrorMonitor.getInstance().logError("Error getting the segment info",this.loggerId,y.Un.Bn,t),null}},R.prototype.S_=function(i){try{if(g.Dash.yA(i,void 0,this.iB))return c.xa.qa;if(this.nB(i))return c.xa.Qa;var t=this.MH(i);return null!=t?t.hA:-1!=i.indexOf("audio")?c.xa.Ba:c.xa.Qa}catch(t){return b.ErrorMonitor.getInstance().logError("Error getting the entity type based on a url",this.loggerId,y.In.Nn,{detailedError:t,url:i}),c.xa.Qa}},R.prototype.rB=function(t){t=T.La(t);try{return this.tB(t).timescale}catch(t){return b.ErrorMonitor.getInstance().logError("Error getting the representation for timescale",this.loggerId,y.Un.Vn,t),1e4}},R.prototype.nB=function(i){return i=T.La(i),this.Ix.some(function(t){return T.La(t.initialization)===i})},R.prototype.VH=function(t){t=T.La(t);var i=this.MH(t);return null!=i?i.next:null},R.prototype.sB=function(t,i){var n=this.Ix.find(function(t){return t.qualityLevel.id===i.id});if(n){if(n.qx)return 1;var r=p.Framework.time(),s=this.manifest.availabilityStartTime.getTime()+(this.manifest.Period.start||0)+(t-n.startNumber+1)*n.Ux*n.timescale;return Math.max(1,s-r)}return 1},R.prototype.iP=function(t,i,n,r){try{var s=this.Ix.find(function(t){return t.qualityLevel.id===r.id});if(s){if(s.qx&&s.qx.has(t)&&s.qx.has(n)){for(var e=s.qx.get(t),h=s.qx.get(n),o=0,u=e;u&&u!=h;)o+=u.duration,u=u.next;return Math.round(o/(s.timescale/1e3))}if(s.Ux)return(n-t)*s.Ux*s.timescale}return 0}catch(t){return b.ErrorMonitor.getInstance().logError("Error extracting the segment distance",this.loggerId,y.Un.Vn,t),0}},R.prototype.eB=function(t){try{t instanceof Uint8Array&&(t=t.buffer);var i=u.hB(t),n=i.fetch("tfhd"),r=i.fetch("trun"),s=n?n.default_sample_duration:0;if(r){var e=0;return r.oB.forEach(function(t){e+=t.sample_duration}),isNaN(e)&&0<s&&(e=s*r.oB.length),e}}catch(t){return b.ErrorMonitor.getInstance().logError("Error extracting duration from the buffer",this.loggerId,y.Un.qn,t),0}},R.prototype.Wx=function(t,i){var n=this.uB();if(!i&&(this.live||n||d.HiveConfig.Dash.DashRemoveBitrateSize))try{var r=t.match(/^<\?xml\s[^?]+\?>/),s=new a["default"]({escapeMode:!0,useDoubleQuotes:!0,arrayAccessForm:"property"}),e=s.aB(t);this.live&&this.fB(e),(n||d.HiveConfig.Dash.DashRemoveBitrateSize)&&this.cB(e,n,d.HiveConfig.Dash.DashRemoveBitrateSize);var h=s.lB(e);return r&&(h=r[0]+h),h}catch(t){this.logger.error(t)}return t},R.prototype.fB=function(c){var l=this,v=Math.max(1,g.Dash.DASH_METADATA_MIN_FRAGMENTS),d=Math.max(1,g.Dash.FA),E=[],w=!1;return c.MPD&&c.MPD.Period&&c.MPD.Period.AdaptationSet&&c.MPD.Period.AdaptationSet.forEach(function(t){if(!w)if(t.SegmentTemplate&&t.SegmentTemplate._media&&t.SegmentTemplate._media.match(R.Hx)){w=!0;var i=p.Framework.time();c.MPD.Period._start=c.MPD.Period._start||"PT0S";var n=c.MPD.Period._start,r=O["default"](n),s=parseInt(t.SegmentTemplate._timescale)||1e3,e=parseInt(t.SegmentTemplate._duration)*s,h=Math.max(0,Math.floor((i-(new Date(c.MPD._availabilityStartTime).getTime()+1e3*r))/e)-g.Dash.UA),o=Math.ceil(1e3*g.Dash.HA/e),u=Math.max(0,Math.min(h,o)),a=0<u?u*e/1e3:0;try{c.MPD.Period._start="PT"+(r+a)+"S",l.logger.debug("Trimmed "+a+" from period start "+n+" => "+c.MPD.Period._start)}catch(t){l.logger.warn("Could not modify period: "+t)}}else if(l.vB(t)&&t.Representation_asArray){var f=l.dB(t.SegmentTemplate,d,v);t.Representation_asArray.forEach(function(t){f.bandwidth=parseInt(t._bandwidth)||0,E.push(f)})}else t.Representation_asArray&&0<t.Representation_asArray.length&&t.Representation_asArray.forEach(function(t){if(l.EB(t)){var i=l.dB(t.SegmentTemplate,d,v);i.bandwidth=parseInt(t._bandwidth)||0,E.push(i)}})}),c},R.prototype.EB=function(t){return t&&("video/mp4"===t._mimeType||"video"===t._contentType||t.SegmentTemplate&&t.SegmentTemplate._media&&-1<t.SegmentTemplate._media.indexOf("video"))},R.prototype.dB=function(t,i,n){for(var r=0,s=0,e=t.SegmentTimeline.S_asArray,h=i*parseInt(t._timescale),o=0,u=0,a=0;a<e.length&&0<n;a++)n<(l=(c=e[o=a])._r?parseInt(c._r):1)?(u=n,n=0):(n-=l,u=l);for(var f=e.length-1;0<=f&&0<h&&o<=f;f--){var c,l=(c=e[f])._r?parseInt(c._r):1,v=0;if(!c._d)throw new Error("missing segment duration");var d=l*(v=parseInt(c._d));if((o<f||f==o&&0==u)&&d<=h)h-=d,e.splice(f,1),r+=l,s+=d;else{var E=Math.ceil(h/v);f==o&&(E=Math.min(E,l-u));var w=v*E;c._r=l-E+"",h-=w,r+=E,s+=w}}return this.logger.debug("DASH trimmed "+r+" segments for total duration: "+s),{count:r,wB:s}},R.prototype.vB=function(t){return!!t&&!!("video/mp4"===t._mimeType||"video"===t._contentType||t.SegmentTemplate&&t.SegmentTemplate._media&&-1<t.SegmentTemplate._media.indexOf("video"))&&!!t.SegmentTemplate.SegmentTimeline},R.prototype.uB=function(){var t=d.HiveConfig.Dash.DashFilterBitrates;if(t)try{return("string"==typeof t?t.split(","):t).map(function(t){return parseInt(t)}).filter(function(t){return!isNaN(t)})}catch(t){b.ErrorMonitor.getInstance().logError("Error parsing DashFilterBitrates",this.loggerId,y.Un.zn,t)}},R.prototype.cB=function(t,s,e){var h=this;if(t.MPD&&t.MPD.Period){var o=this.XF.KF(c.xa.Va),u=[];t.MPD.Period.AdaptationSet.forEach(function(t){if(t.Representation_asArray&&(h.vB(t)||t.Representation_asArray.every(function(t){return h.EB(t)}))){var i=t.Representation_asArray;i.sort(function(t,i){return o.get(t.pB)-o.get(i.pB)});for(var n=i.length-1;0<=n;n--){e&&(delete i[n]._width,delete i[n]._height);var r=o.get(i[n].pB);s&&!s.includes(r)?i.splice(n,1):u.push(i[n].pB)}h.logger.debug("DASH filtered-in quality levels: "+u.reverse().join(", ")+" - removed size: "+e)}})}},R.prototype.BH=function(n,i){try{var t=this.Ix.find(function(t){return t.qualityLevel.id===i.id});if(t&&t.qx&&t.qx.has(n))return t.qx.get(n);if(t&&t.Ux){var r=t.Mx.replace(R.Hx,function(t,i){return E.gB(i||"%d",n)}),s=new w.iH(n,t.qualityLevel,t.Ux*t.timescale,r,r,t.type),e=t.Mx.replace(R.Hx,function(t,i){return E.gB(i||"%d",n+1)});return s.next=new w.iH(n+1,t.qualityLevel,t.Ux*t.timescale,r,e,t.type),s}return null}catch(t){return b.ErrorMonitor.getInstance().logError("Error getting the segment",this.loggerId,y.Un.tr,t),null}},R.Dx="$Bandwidth$",R.$x="$Time$",R.jx="$RepresentationID$",R.Hx=/\$Number([^$]+)?\$/,R);function R(t,i,n){var r=e.call(this,t,n)||this;return r.loggerId="[DASH METADATA] ",r.Gx=!1,r.logger=p.Framework&&p.Framework.resolve(p.Framework.v.p)?p.Framework.resolve(p.Framework.v.p).log(i):console,r.Nx=o["default"]().create(),r.reset(),r}i.bB=_},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var u,e,r,s,h=(u=void 0,e=[],r={},s={},u={extend:function(t,i,n,r){!r[t]&&i&&(r[t]={instance:i,yB:n})},TB:o,OB:function(t,i,n){for(var r in e){var s=e[r];if(s.context===t&&s.name===i)return void (e[r].instance=n)}e.push({name:i,context:t,instance:n})},mB:function(n){var t=a(n._B,r);return t||(t=function(t){var i=void 0;return void 0===t&&(t={}),{getInstance:function(){return(i=i||o(t,n._B))||(i=c(n,t,arguments),e.push({name:n._B,context:t,instance:i})),i}}},r[n._B]=t),t},RB:function(t){return a(t,r)},SB:function(t,i){f(t,i,r)},AB:function(i){var t=a(i._B,s);return t||(t=function(t){return void 0===t&&(t={}),{create:function(){return c(i,t,arguments)}}},s[i._B]=t),t},IB:function(t){return a(t,s)},NB:function(t,i){f(t,i,s)}});function o(t,i){for(var n in e){var r=e[n];if(r.context===t&&r.name===i)return r.instance}return null}function a(t,i){return i[t]}function f(t,i,n){t in n&&(n[t]=i)}function c(t,i,n){var r=void 0,s=t._B,e=i[s];if(e){var h=e.instance;if(!e.yB)return h.apply({context:i,CB:u},n);for(var o in r=t.apply({context:i},n),h=h.apply({context:i,CB:u,parent:r},n))r.hasOwnProperty(o)&&(r[o]=h[o])}else r=t.apply({context:i},n);return r.kB=function(){return s},r}i["default"]=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0}),i["default"]=function(m){m=m||{},(function(){void 0===m.escapeMode&&(m.escapeMode=!0),void 0===m.DB&&(m.DB="_"),(m.arrayAccessForm=m.arrayAccessForm||"none",m.jB=m.jB||"text",void 0===m.MB&&(m.MB=!0)),(m.PB=m.PB||[],void 0===m.LB&&(m.LB=!0)),void 0===m.HB&&(m.HB=!0),(m.UB=m.UB||[],void 0===m.useDoubleQuotes&&(m.useDoubleQuotes=!1)),(m.FB=m.FB||[],m.GB=m.GB||[],void 0===m.xB&&(m.xB=!1)),void 0===m.BB&&(m.BB=!1)})();var _={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function R(t){var i=t.localName;return null==i&&(i=t.VB),null!=i&&""!=i||(i=t.nodeName),i}function u(t){return"string"==typeof t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):t}function S(t,i,n,r){for(var s=0;s<t.length;s++){var e=t[s];if("string"==typeof e){if(e==r)break}else if(e instanceof RegExp){if(e.test(r))break}else if("function"==typeof e&&e(i,n,r))break}return s!=t.length}function A(t,i,n){switch(m.arrayAccessForm){case"property":t[i]instanceof Array?t[i+"_asArray"]=t[i]:t[i+"_asArray"]=[t[i]]}!(t[i]instanceof Array)&&0<m.PB.length&&S(m.PB,t,i,n)&&(t[i]=[t[i]])}function I(t){var i=t.split(/[-T:+Z]/g),n=new Date(i[0],i[1]-1,i[2]),r=i[5].split(".");if(n.setHours(i[3],i[4],r[0]),1<r.length&&n.setMilliseconds(r[1]),i[6]&&i[7]){var s=60*i[6]+Number(i[7]);s=0+("-"==(/\d\d-\d\d:\d\d$/.test(t)?"-":"+")?-1*s:s),n.setMinutes(n.getMinutes()-s-n.getTimezoneOffset())}else-1!==t.indexOf("Z",t.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function N(t,i){if(t.nodeType==_.DOCUMENT_NODE){for(var n=new Object(),r=t.childNodes,s=0;s<r.length;s++)(h=r[s]).nodeType==_.ELEMENT_NODE&&(m.BB?n=N(h):(n={})[o=R(h)]=N(h));return n}if(t.nodeType==_.ELEMENT_NODE){(n=new Object()).__cnt=0;var e=[];for(r=t.childNodes,s=0;s<r.length;s++){var h,o=R(h=r[s]);if(h.nodeType!=_.COMMENT_NODE){var u=i+"."+o;if(b=n,y=h.nodeType,T=o,O=u,!(y==_.ELEMENT_NODE&&0<m.FB.length)||S(m.FB,b,T,O))if(n.__cnt++,null==n[o]){var a=N(h,u);("#text"!=o||/[^\s]/.test(a))&&((f={})[o]=a,e.push(f));n[o]=a,A(n,o,u)}else{null!=n[o]&&(n[o]instanceof Array||(n[o]=[n[o]],A(n,o,u)));var f;a=N(h,u);("#text"!=o||/[^\s]/.test(a))&&((f={})[o]=a,e.push(f));n[o][n[o].length]=a}}}n.__children=e;for(var c=R(t),l=0;l<t.attributes.length;l++){var v=t.attributes[l];n.__cnt++;var d=v.value;if(Array.isArray(m.qB))for(var E=0,w=m.qB.length;E<w;E++){var p=m.qB[E];p.test(v,c)&&(d=p.converter(v.value))}n[m.DB+v.name]=d}var g=function(t){return t.prefix}(t);return null!=g&&""!=g&&(n.__cnt++,n.__prefix=g),null!=n["#text"]&&(n.__text=n["#text"],n.__text instanceof Array&&(n.__text=n.__text.join("\n")),m.HB&&(n.__text=n.__text.trim()),delete n["#text"],"property"==m.arrayAccessForm&&delete n["#text_asArray"],n.__text=function(t,i,n){if(0<m.UB.length){var r=n.split(".#")[0];return S(m.UB,t,i,r)?I(t):t}return t}(n.__text,o,i+"."+o)),null!=n["#cdata-section"]&&(n.__cdata=n["#cdata-section"],delete n["#cdata-section"],"property"==m.arrayAccessForm&&delete n["#cdata-section_asArray"]),0==n.__cnt&&"text"==m.jB?n="":1==n.__cnt&&null!=n.__text?n=n.__text:1!=n.__cnt||null==n.__cdata||m.xB?1<n.__cnt&&null!=n.__text&&m.LB&&(m.HB&&""==n.__text||""==n.__text.trim())&&delete n.__text:n=n.__cdata,delete n.__cnt,!m.MB||null==n.__text&&null==n.__cdata||(n.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),n}if(t.nodeType==_.TEXT_NODE||t.nodeType==_.CDATA_SECTION_NODE)return t.nodeValue;var b,y,T,O}function a(t,i,n,r){var s="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+i;if(null!=n)for(var e=0;e<n.length;e++){var h=n[e],o=t[h];m.escapeMode&&(o=u(o)),s+=" "+h.substr(m.DB.length)+"=",m.useDoubleQuotes?s+='"'+o+'"':s+="'"+o+"'"}return s+=r?"/>":">"}function f(t,i){return"</"+(null!=t.__prefix?t.__prefix+":":"")+i+">"}function c(t,i){return!!("property"==m.arrayAccessForm&&function(t,i){return-1!==t.indexOf(i,t.length-i.length)}(i.toString(),"_asArray")||0==i.toString().indexOf(m.DB)||0==i.toString().indexOf("__")||t[i]instanceof Function)}function l(t){var i=0;if(t instanceof Object)for(var n in t)c(t,n)||i++;return i}function v(t){var i=[];if(t instanceof Object)for(var n in t)-1==n.toString().indexOf("__")&&0==n.toString().indexOf(m.DB)&&i.push(n);return i}function d(t){var i="";return t instanceof Object?i+=function(t){var i="";return null!=t.__cdata&&(i+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(m.escapeMode?i+=u(t.__text):i+=t.__text),i}(t):null!=t&&(m.escapeMode?i+=u(t):i+=t),i}function E(t,i){return""===t?i:t+"."+i}function w(t,i,n,r){var s="";if(0==t.length)s+=a(t,i,n,!0);else for(var e=0;e<t.length;e++)s+=a(t[e],i,v(t[e]),!1),s+=p(t[e],E(r,i)),s+=f(t[e],i);return s}function p(t,i){var n,r,s,e="";if(0<l(t))for(var h in t)if(!c(t,h)&&(""==i||(n=t,s=E(i,r=h),0==m.GB.length||""==s||S(m.GB,n,r,s)))){var o=t[h],u=v(o);null==o||null==o?e+=a(o,h,u,!0):o instanceof Object?o instanceof Array?e+=w(o,h,u,i):o instanceof Date?(e+=a(o,h,u,!1),e+=o.toISOString(),e+=f(o,h)):0<l(o)||null!=o.__text||null!=o.__cdata?(e+=a(o,h,u,!1),e+=p(o,E(i,h)),e+=f(o,h)):e+=a(o,h,u,!0):(e+=a(o,h,u,!1),e+=d(o),e+=f(o,h))}return e+=d(t)}this.QB=function(t){var i;window.ActiveXObject||window;if(void 0===t)return null;if(window.DOMParser){var n=new window.DOMParser();try{0<(i=n.parseFromString(t,"text/xml")).getElementsByTagNameNS("*","parsererror").length&&(i=null)}catch(t){i=null}}else 0==t.indexOf("<?")&&(t=t.substr(t.indexOf("?>")+2)),(i=new ActiveXObject("Microsoft.XMLDOM")).async="false",i.YB(t);return i},this.KB=function(t){return void 0===t||null==t?[]:t instanceof Array?t:[t]},this.WB=function(t){return t instanceof Date?t.toISOString():"number"==typeof t?new Date(t).toISOString():null},this.$B=function(t){return"string"==typeof t?I(t):t},this.XB=function(t){return N(t)},this.aB=function(t){var i=this.QB(t);return null!=i?this.XB(i):null},this.lB=function(t){return p(t,"")},this.zB=function(t){var i=this.lB(t);return this.QB(i)},this.getVersion=function(){return"1.2.0"}}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=function(t,i,n){return i&&s(t.prototype,i),n&&s(t,n),t};function s(t,i){for(var n=0;n<i.length;n++){var r=i[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var e,h=n(162),o=(e=h)&&e.s?e:{"default":e},u=(r(a,[{key:"name",get:function(){return this.JB}},{key:"children",get:function(){return this.ZB}},{key:"properties",get:function(){return this.tV}}]),a);function a(t,i,n){var r=this;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,a),this.JB=t||"",this.tV=[],this.ZB=n||[],Array.isArray(i)&&i.forEach(function(t){r.tV.push(new o["default"](t))})}i["default"]=u},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=(e.prototype.xL=function(){return this.UL},e.prototype.iV=function(){return this.iB},e.prototype.isLive=function(){return this.live},e.prototype.qH=function(t){this.authenticationToken=t},e.prototype.yM=function(){return this.XF},e);function e(t,i){this.live=!1,this.XF=r.Framework.resolve(r.Framework.v.gk),this.Kx=t,this.iB=i}i.Sx=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var s=n(33),e=n(52),r=(h.prototype.fM=function(t,i){var n=null,r=t.VL();return e.Mj.bA(r,this.logger,i?i.hls:void 0)?this.j=n=this.nV(t,i):s.Dash.bA(r,this.logger,i?i.dash:void 0)?this.j=n=this.rV(t,i):this.logger.warn("COULD NOT FIND A CONTEXT FOR "+r),null!=n&&this.sV(this.j),n},h.prototype.sV=function(t){},h);function h(){}i.eV=r},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(78),o=n(0),u=(e=h["default"],s(a,e),a);function a(){return e.call(this,"JS",o.Framework.v.Kc)||this}i["default"]=new u()},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(6),f=n(24),s=n(7),c=n(0),l=n(5),v=n(2),d=n(1),e=n(49),h=n(3),o=(E.prototype.hV=function(t,i){try{var n=void 0,r=t.A_.getDuration(),s=t.size,e=-1,h=0,o=-1;if(this.oV.isValid()&&(e=Math.max(10,this.oV.pa(s))),h=-1<e?Math.max(0,r-e*l.xu.Su.Zh):.5*r,E.uV){var u=t.partner.dP();0<u&&(o=i/u*l.xu.Su.io),n=t.type===f.h_.l_?r*l.xu.Su.to:-1<o&&o<=h?h:-1<o&&o<=r*l.xu.Su.no?r*l.xu.Su.no:0}else t.type==f.h_.l_&&(h*=2),n=Math.max(this.aV(),h);if(l.xu.Fu.wu){var a=this.fV.has(t.I_())?this.fV.get(t.I_()):this.cV(t);a.push([c.Framework.time(),i,e,h,o,t.type,n]),this.fV.set(t.I_(),a)}return this.logger.debug("TIMER DETAILS duration: "+r+" left/total: "+i+"/"+s+" cdn: "+e+" remaining: "+h+" p2p: "+o+" timeout: "+n),n}catch(t){return d.ErrorMonitor.getInstance().logError("Error calculating the p2p timeout",this.loggerId,v.cr.lr,t),0}},E.prototype.lV=function(t,i){return 5e3},E.prototype.vV=function(t){try{return this.oV.isValid()?Math.min(this.oV.pa(t),this.dV()):this.EV()}catch(t){return d.ErrorMonitor.getInstance().logError("Error calculating the delivery delay",this.loggerId,v.cr.vr,t),this.EV()}},E.prototype.wV=function(t){if(t.S_()===s.xa.Va)switch(t.R_()){case f.h_.u_:case f.h_.o_:case f.h_.a_:case f.h_.f_:this.oV.wa(t.U_());break;case f.h_.c_:case f.h_.l_:this.pV.wa(t.U_())}if(l.xu.Fu.wu){var i=this.fV.has(t.I_())?this.fV.get(t.I_()):this.cV(t);i.push([c.Framework.time(),t.R_()]),e.Lk.Mk(null,null,"p2p_timer",this.tv.getReportingGuid(),i,10)}},E.prototype.aV=function(){return E.gV},E.prototype.EV=function(){return E.bV},E.prototype.dV=function(){return E.yV},E.prototype.cV=function(t){return[[t.I_(),t.A_.getDuration(),t.size]]},E.uV=!0,E.gV=500,E.yV=1500,E.bV=500,E);function E(t){this.loggerId="[TIMER HANDLER] ",this.oV=new r.ma(),this.pV=new r.ma(),this.fV=new h(),this.logger=c.Framework.resolve(c.Framework.v.p).log(),this.tv=t}i.TV=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var v,r,d=n(2),E=n(2),s=n(0),w=n(15),p=n(1),g=E.de,b=n(7);(r=v=v||{})[r.OV=0]="INFO",r[r.mV=1]="WARN",r[r.ERROR=2]="ERROR";var e=(y.prototype._V=function(){var t=this.metadata.HH(b.xa.Va),i=t.length,n=this.metadata.isLive();if(0===i||void 0!==n)for(var r=0;r<y.RV.length;r++){var s=y.RV[r],e=s[0],h=s[1],o=s[2];if(i<=e){if(-1===this.SV.indexOf(h)){var u=t.map(function(t){return w.Ta(t.bitrate)+"/s"}).join(", "),a=y.AV+w.Ic(d.me[h],n?"Live":"VOD",i,u);switch(o){case v.OV:this.logger.info(a);break;case v.mV:this.logger.warn(a);break;default:this.logger.error(a);var f=0===i?g.ye:g.Te;p.ErrorMonitor.getInstance().logError(d.me[f],y.AV,f,{isLive:n,qualityLevels:t})}this.SV.push(h)}break}}if(-1===this.SV.indexOf(g.Ee)){var c=!1;for(r=0;r<t.length;r++){var l=t[r];if(l.bitrate>y.NV){c=!0,a=y.AV+w.Ic(d.me[E.de.Ee],w.Ta(l.bitrate),w.Ta(y.NV)),this.logger.warn(a);break}}c&&this.SV.push(g.Ee)}},y.prototype.reset=function(){this.SV.length=0},y.AV="[StreamHealthChecker] ",y.NV=35e5,y.RV=[[0,g.we,v.ERROR],[4,g.pe,v.OV],[7,g.ge,v.mV],[1/0,g.be,v.ERROR]],y);function y(t){this.SV=[],this.metadata=t,this.logger=s.Framework.resolve(s.Framework.v.p).log()}i.CV=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(1),e=(s.prototype.size=function(){var t=this.end-this.start+1;return Number.isInteger(t)||(r.ErrorMonitor.getInstance().logError("Segment Size is a Float",{size:t}),t=Math.round(t)),0==this.end&&0==this.start?0:t},s.prototype.kV=function(){return 0==this.start&&(this.end==this.total-1||this.end==this.total&&0==this.total)},s.prototype.DV=function(){return this.end==this.total-1||this.end==this.total&&0==this.total},s.prototype.jV=function(t){return t.start<=this.start&&this.start<=t.end},s.prototype.toString=function(){return"R[S="+this.start+",E="+this.end+",T="+this.total+"]"},s);function s(t,i,n){this.start=t,this.end=i,this.total=n}i.MV=e;var h=(o.PV=function(t){return t.split("-")},o.LV=function(t){var i=t.split("=",4),n=i[1].substr(0,i[1].indexOf(",")),r=i[2].substr(0,i[2].indexOf(",")),s=i[3].substr(0,i[3].indexOf("]"));return new e(+n,+r,+s)},o);function o(){}i.HV=h},function(t,i,n){"use strict";var r;Object.defineProperty(i,"s",{value:!0}),(r=i.UV||(i.UV={}))[r.FV=0]="ALL",r[r.AS=1]="AS",r[r.tM=2]="SITE"},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e,r,h=n(0),o=n(17),u=n(5),a=n(9),f=n(4),s=n(3),c=n(66),l=n(212),v=n(1),d=(E.prototype.init=function(t){this.GV=t,this.logger=h.Framework.resolve(h.Framework.v.p).log(t.sessionId),this.tv=t.tv,this.xV=t.xV,this.uM=t.uM},E.prototype.BV=function(t,i){var n=this,r=f.defer();try{if(this.VV){var s=null;t.privateIpString&&(s=t.privateIpString);var e=new l.qV(t.guid,t.rankValue,s,t.isLeader);if(this.QV.has(e.uuid)){var h=this.QV.get(e.uuid);h.udpScore==e.udpScore&&h.YV==e.YV?r.resolve():(this.QV.set(e.uuid,e),this.KV(),this.WV(e).then(function(){r.resolve()}).fail(function(t){n.QV["delete"](e.uuid),n.KV(),r.reject(t)}))}else i?(e.$V=i,this.logger.info(this.loggerId+" NEW MEMBER GUID "+e.uuid+" RANKING "+e.udpScore+" LEADER "+e.YV),this.QV.set(e.uuid,e),this.KV(),this.WV(e).then(function(){n.XV(n.QV.get(e.uuid)),r.resolve()}).fail(function(t){n.QV["delete"](e.uuid),n.KV(),r.reject(t)})):this.zV(e).then(function(t){e.$V=t,n.logger.info(n.loggerId+" NEW MEMBER GUID "+e.uuid+" RANKING "+e.udpScore+" LEADER "+e.YV),n.QV.set(e.uuid,e),n.KV(),n.WV(e).then(function(){r.resolve()}).fail(function(t){n.QV["delete"](e.uuid),n.KV(),r.reject(t)})}).fail(function(t){r.reject(t)})}else r.reject("LEADER ELECTION NOT STARTED YET")}catch(t){r.reject("TRIGGER LEADER ELECTION ERROR "+t)}return r.promise},E.prototype.XV=function(t){var i=new a.yf(a.pf.bf,null);i.guid=t.uuid,i.isLeader=t.YV,i.rankValue=t.udpScore;var n=[i];this.xV.JV(n,!1)},E.prototype.zV=function(n){var r=this,s=f.defer();return this.ZV.has(n.uuid)||this.tq.has(n.uuid)?s.reject(e.iq):(this.ZV.set(n.uuid,Date.now()),this.Jc.connect(n.uuid).then(function(t){var i=t.il.get(r.GV.swarmId);null==i?(i=t.il.create(r.GV.swarmId),r.nq(i).then(function(){s.resolve(t)}).fail(function(t){s.reject(t)}).done()):r.rq.get(n.uuid)?s.resolve(t):(r.ZV["delete"](n.uuid),r.nq(i).then(function(){s.resolve(t)}).fail(function(t){s.reject(t)}).done())}).fail(function(t){r.ZV["delete"](n.uuid),s.reject(t)}).done()),s.promise},E.prototype.nq=function(t){var i=this,n=f.defer(),r=new o.Al.ml.UDPHandshakeMessage();r.uuid=this.sq.uuid,r.udpScore=this.sq.udpScore,r.isLeader=this.sq.YV,r.streamId=this.sq.streamId,this.logger.debug(this.loggerId+"MSG uuid "+r.uuid+" rankValue "+r.udpScore+" isLeader "+r.isLeader+" stream id "+r.streamId);var s=h.Framework.setTimeout(function(){i.eq(t.otherGuid)},u.xu.UDPBroadcast.iu);return this.tq.set(t.otherGuid,{hq:s,defer:n}),t.rl(o.Fc.Bc,r),n.promise},E.prototype.eq=function(t){if(this.tq.has(t)){this.logger.debug(this.loggerId+" HANDSHAKE REQ EXPIRED TO "+t);var i=this.tq.get(t);this.tq["delete"](t),i.defer.reject("EXPIRED")}},E.prototype.oq=function(t,i){try{this.logger.debug(this.loggerId+"HANDSHAKE RESP RECEIVED FROM "+i.otherGuid);var n=i.otherGuid,r=this.tq.get(n);h.Framework.clearTimeout(r.hq),this.tq["delete"](n),r.defer.resolve(i)}catch(t){v.ErrorMonitor.getInstance().logError("HANDSHAKE RESPONSE RECEIVED FAILED",this.loggerId,t)}},E.prototype.uq=function(t,i){var n=this;try{var r=new a.yf(a.pf.bf,null,t.isLeader);if(r.guid=t.uuid,r.rankValue=t.udpScore,t.streamId===this.tv.getContextId()){var s=i.il.get(this.GV.swarmId);this.rq.set(t.uuid,t.uuid),this.aq(s,"OK"),this.BV(r,i).then(function(){}).fail(function(t){v.ErrorMonitor.getInstance().logError("LEADER ELECTION FAILED",n.loggerId,t)})}}catch(t){v.ErrorMonitor.getInstance().logError("HANDSHAKE REQUEST FAILED",this.loggerId,t)}},E.prototype.aq=function(t,i){var n=new o.Al.ml.UDPHandshakeResponse();n.accept=i,t.rl(o.Fc.UDPHandshakeResponse,n),this.logger.debug(this.loggerId+"SEND HANDSHAKE RESPONSE TO "+t.otherGuid)},E.prototype.WV=function(t){var i=this,n=f.defer();if(this.fq()){var r=!1;this.logger.info(this.loggerId+"I HAVE THE HIGHEST SCORE"),t.YV&&!this.cq.has(t.uuid)&&(r=!0,this.logger.info(this.loggerId+"SEND SWITCH REQUEST TO "+t.uuid),this.lq(t).then(function(){n.resolve()}).fail(function(t){3==t.vq?(i.logger.debug(i.loggerId+" SWITCH REQUEST WAS CANCELED."),n.resolve()):(t.vq=2)&&n.reject(t)})),this.sq.YV||null==this.dq||this.dq.uuid==t.uuid||this.cq.has(this.dq.uuid)||(this.logger.info("SEND SWITCH REQUEST TO THE ALREADY KNOWN LEADER"),r=!0,this.lq(this.dq).then(function(){n.resolve()}).fail(function(t){3==t.vq?(i.logger.debug(i.loggerId+" SWITCH REQUEST WAS CANCELED."),n.resolve()):(t.vq=2)&&n.reject(t)})),null!=this.dq||t.YV||this.sq.YV||0!=this.cq.length||(this.logger.info(this.loggerId+"BECOME LEADER"),this.Eq()),r||n.resolve()}else this.wq(t)&&(this.logger.info(this.loggerId+"PEER "+t.uuid+" HAS THE HIGHEST SCORE"),this.pq(),this.sq.YV&&t.YV&&this.stepDown(),this.gq(t)),n.resolve();return n.promise},E.prototype.gq=function(t){try{this.logger.info(this.loggerId+"UPDATE THE LEADERSHIP"),null!=this.dq&&this.QV.has(this.dq.uuid)&&(this.QV.get(this.dq.uuid).YV=!1),this.QV.has(t.uuid)?(this.QV.get(t.uuid).udpScore=t.udpScore,this.dq=t,this.QV.get(t.uuid).YV=!0):(this.logger.warn(this.loggerId+"SET A LEADER THAT IS NOT A LAN MEMBER LIST. SHOULD NEVER HAPPEN"),this.QV.set(t.uuid,t),this.dq=t),this.tv.bq(t),this.logger.info(this.loggerId+"NEW KNOWN LEADER "+this.tv.pP().uuid)}catch(t){v.ErrorMonitor.getInstance().logError(t,this.loggerId)}},E.prototype.stepDown=function(){this.logger.info(this.loggerId+"STEP DOWN"),this.sq.YV=!1,this.tv.yq(!1),u.xu.Nu.Eo&&(this.uM.Tq(),this.uM.Oq(!1))},E.prototype.pq=function(){for(var t=0,i=this.cq.keys();t<i.length;t++){var n=i[t],r=this.cq.get(n);this.cq["delete"](n),h.Framework.clearTimeout(r.hq),r.defer.reject({vq:3,message:"CANCELED PENDING RESPONSES"})}},E.prototype.wq=function(t){return t.uuid==this.mq[0].uuid},E.prototype.fq=function(){return l.qV.Ob(this.sq,this.mq[0])<0},E.prototype.KV=function(){var t=new c(this.QV.values()),i=t.Nf(l.qV.Ob);t.push(this.sq),this.tv._q(i);var n=new c(this.QV.values());this.mq=n.Nf(l.qV.Ob)},E.prototype.Rq=function(t){this.Sq(t)},E.prototype.Sq=function(t){this.logger.info(this.loggerId+"EVALUATE THE SWITCH REQUEST FROM "+t.uuid);var i=void 0;this.QV.has(t.uuid)?i=this.QV.get(t.uuid):this.logger.warn("I RECEIVED A SWITCH REQUEST FROM AN UNKNOWN MEMBER. THIS SHOULD NEVER HAPPEN"),i&&(this.sq.YV?this.fq()?this.Aq(i,!1):(this.stepDown(),this.pq(),this.gq(i),this.Aq(i,!0)):this.wq(i)?(this.gq(i),this.Aq(i,!0)):this.Aq(i,!1))},E.prototype.Aq=function(t,i){var n=this;this.Iq(t.$V,i).then(function(){}).fail(function(t){v.ErrorMonitor.getInstance().logError("SEND SWITCH RESPONSE ERROR",n.loggerId,t)}).done()},E.prototype.Iq=function(t,i){var n=f.defer(),r=new o.Al.ml.UDPSwitchLeadershipAck();return r.ok=i,t.il.get(this.GV.swarmId).rl(o.Fc.Vc,r),n.promise},E.prototype.lq=function(i){var n=this,r=f.defer();return this.Nq(i.$V).then(function(t){n.Cq(t,i),r.resolve()}).fail(function(t){r.reject(t)}).done(),r.promise},E.prototype.Cq=function(t,i){try{t?(this.QV.get(i.uuid).YV=!1,this.dq=this.sq,this.Eq()):(this.pq(),this.QV.get(i.uuid).YV=!0,this.stepDown(),this.gq(i))}catch(t){v.ErrorMonitor.getInstance().logError("HANDLE LEADERSHIP SWITCH RESPONSE ERROR",this.loggerId,t)}},E.prototype.kq=function(t,i){if(this.cq.has(i)){var n=this.cq.get(i);h.Framework.clearTimeout(n.hq),this.cq["delete"](i),n.defer.resolve(t.ok)}else this.logger.warn(this.loggerId+" SWITCH LEADERSHIP RESPONSE RECEIVED FROM UNKNOWN PEER "+i)},E.prototype.Nq=function(t){var i=this,n=f.defer(),r=new o.Al.ml.UDPSwitchLeadershipRequest();r.uuid=this.sq.uuid,r.udpScore=this.sq.udpScore,this.logger.debug(this.loggerId+"SWITCH LEADERSHIP REQUEST TO "+t.otherGuid);var s=h.Framework.setTimeout(function(){i.Dq(t.otherGuid)},u.xu.UDPBroadcast.tu);this.cq.set(t.otherGuid,{hq:s,defer:n});var e=t.il.get(this.GV.swarmId);return h.Framework.setTimeout(function(){e.rl(o.Fc.UDPSwitchLeadershipRequest,r)},1),n.promise},E.prototype.Dq=function(t){if(this.cq.has(t)){this.logger.info(this.loggerId+" SWITCH LEADERSHIP EXPIRED TO "+t);var i=this.cq.get(t);this.cq["delete"](t),i.defer.reject({vq:2,message:"EXPIRED"})}},E.prototype.Eq=function(){this.logger.info(this.loggerId+"BECOMING LAN LEADER"),null!=this.dq&&this.QV.has(this.dq.uuid)&&(this.QV.get(this.dq.uuid).YV=!1),this.sq.YV=!0,this.dq=this.sq,this.tv.yq(!0),this.tv.bq(this.sq),u.xu.Nu.Eo&&(this.uM.Tq(),this.uM.Oq(!0))},E.prototype.PS=function(t){this.sq=new l.qV(this.tv.getId(),this.tv.jq(),"",!1,this.tv.getContextId()),this.VV=!0,this.logger.info(this.loggerId+" UDP LEADER ELECTION STARTED")},E.prototype.Mq=function(t){this.QV["delete"](t),this.KV(),0==this.QV.length?(this.sq.YV=!1,this.dq=null,this.tv.yq(!1),this.tv.Pq(!1),this.uM.Tq(),this.uM.Oq(!1)):this.fq()?this.Eq():0<this.mq.length&&this.gq(this.mq[0])},E);function E(){this.VV=!1,this.loggerId="[UDPLeaderElection] ",this.Jc=h.Framework.resolve(h.Framework.v.Zc),this.QV=new s(),this.cq=new s(),this.tq=new s(),this.ZV=new s(),this.rq=new s(),this.mq=[]}i.Lq=d,(r=e=i.Hq||(i.Hq={}))[r.Uq=0]="FAILURE",r[r.iq=1]="ALREADY_PENDING"},function(t,i){},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0}),n(25);var v,e,d,h,o=n(4),u=n(3),E=n(0),w=n(205),p=n(5),a=n(17),f=n(9),c=n(206),l=n(8),g=n(1),b=n(2),y=n(48),T=hive.services.protocol.tracker.TrackerPeerInfo,O=hive.services.protocol.tracker.TrackerPeerStreamInfo,m=l.Y.sf;(e=v=i.Fq||(i.Fq={}))[e.Gq=1]="ACCEPT",e[e.xq=2]="REJECT",(h=d=i.Bq||(i.Bq={}))[h.FV=0]="ALL",h[h.Vq=1]="IN",h[h.qq=2]="OUT";var _,R=(_=c.Qq,s(S,_),S.prototype.init=function(t){_.prototype.init.call(this,t),this.GV=t,this.xV=t.xV,this.uM=t.uM,this.Yq=t.Yq,this.Kq.init(t),this.Wq.init(t)},S.prototype.start=function(t){try{this.logger.info(this.loggerId+"PARTNERSHIP STARTED "+t.getContextId()),this.context=t,this.contextId=t.getContextId(),this.$q(p.xu.mu.Uh),this.Xq(p.xu.Nu.yo),this.zq(p.xu._u.Bh),this.active=!0}catch(t){g.ErrorMonitor.getInstance().logError("Error in partnership initialization",this.loggerId,b.Ni.Ci,t)}},S.prototype.stop=function(){return E.Framework.clearInterval(this.Jq),E.Framework.clearInterval(this.Zq),E.Framework.clearInterval(this.tQ),this.context=null,this.contextId=null,this.active=!1,this.iQ()},S.prototype.PS=function(t){this.logger.info("PARTNERSHIP SERVER CONNECTED"),this.uS=t,this.connected=!0,null==this.tv.getId()&&this.tv.setId(this.uS)},S.prototype.nQ=function(){this.connected=!1},S.prototype.rQ=function(i){try{this.sQ(i)||this.eQ.has(i.peerInfo.guid)||this.ZV.has(i.peerInfo.guid)||i.peerInfo.guid==this.uS?this.hQ(i):this.oQ(i),this.uQ(i)&&this.aQ(i)}catch(t){g.ErrorMonitor.getInstance().logError("Error in discoering new lan peer",this.loggerId,b.Ni.ki,{detailedError:t,otherGuid:i.peerInfo.guid})}},S.prototype.hQ=function(t){if(this.fQ.has(t.peerInfo.guid)){var i=this.fQ.get(t.peerInfo.guid);this.fQ["delete"](t.peerInfo.guid),this.QU.set(t.peerInfo.guid,i),this.tv.Pq(!0)}},S.prototype.aQ=function(t){if(this.VU.has(t.peerInfo.guid)){var i=this.VU.get(t.peerInfo.guid);this.VU["delete"](t.peerInfo.guid),this.qU.set(t.peerInfo.guid,i)}},S.prototype.$q=function(t){var i=this;-1!=this.Jq&&E.Framework.clearInterval(this.Jq),this.Jq=E.Framework.setInterval(function(){i.cQ(!1)},t)},S.prototype.cQ=function(t){var i=this;t&&this.Jq&&(E.Framework.clearInterval(this.Jq),this.$q(p.xu.mu.Uh));try{if(this.connected){this.logger.debug(this.loggerId+"ADDING NEW PEERS IF POSSIBLE, NOW "+this.fQ.length+"/"+p.xu.mu.Hh+","+this.QU.length+"/infinity OUT RND "+this.VU.length+" OUT LAN "+this.qU.length);var n=[].concat(this.eQ.keys()).concat(this.ZV.keys()),r=this.xV.lQ(!0),s=void 0;s=this.tv.zM()||this.tv.lP()?this.Wq.vQ(p.xu.mu.Hh,this.fQ.values(),n,r):this.Kq.vQ(p.xu.mu.Hh,this.fQ.values(),n,r),this.dQ=s.EQ(),s.wQ().forEach(function(t){i.oQ(t)})}else this.logger.warn(this.loggerId+"NOT RUNNING IN PARTNER CHOICE, SRV DISCONNECTED")}catch(t){g.ErrorMonitor.getInstance().logError("Error in choosing in partners",this.loggerId,b.Ni.Di,t)}},S.prototype.oQ=function(s){var e=this,h=s.peerInfo.guid,t=s.peerInfo.privateIpString,i=s.peerInfo.publicIpString;this.logger.debug(this.loggerId+"IN PARTNER ADD PROCESS "+h),this.sQ(s)||this.eQ.has(h)||this.ZV.has(h)||this.Yq.pQ(h,t,i)||(this.ZV.set(h,Date.now()),this.Jc.connect(h).then(function(t){var n=t.il.get(e.GV.swarmId);if(null==n&&(n=t.il.create(e.GV.swarmId)),n){var r=e.ZV.get(h);e.ZV["delete"](h),e.active&&e.gQ(n).then(function(t){if(e.bQ(n,s,t.msg,r),e.TQ.yQ(!1,!1),e.Yq.OQ(h,s.peerInfo.privateIpString,s.peerInfo.publicIpString),e.mQ(n),0<e.dQ.length&&!s._Q()){var i=e.dQ[0];e.RQ(i.guid),i.AQ.SQ(d.qq),e.dQ.splice(0,1)}}).fail(function(t){t&&"NOT ACCEPTED"!=t&&g.ErrorMonitor.getInstance().logError("Error in requesting partnership",e.loggerId,b.Ni.Pi,{otherGuid:h}),e.TQ.yQ(!1,!0),e.IQ(h)})}}).fail(function(t){g.ErrorMonitor.getInstance().logError("Error in creating new p2p connection",e.loggerId,b.Ni.Mi,{otherGuid:h}),e.TQ.yQ(!0,!0),e.ZV["delete"](h),e.xV.Mq(h)}).done())},S.prototype.NQ=function(i,t){var n=this;try{var r=i.guid,s=null,e=null;if(i.privateIpString&&(e=i.privateIpString),i.publicIpString&&(s=i.publicIpString),this.CQ(r))this.logger.info(this.loggerId+"ALREADY OUT PARTNER "+r);else{var h=i.contextId,o=t.il.get(this.GV.swarmId);if(this.contextId!==h||p.xu._u.xh!==i.p2pProtocolVersion||this.Yq.pQ(r,e,s))this.logger.info(this.loggerId+"PARTNERSHIP CANNOT BE ESTABLISHED WITH "+r+" CONTEXT ID "+h+" protocol version "+i.p2pProtocolVersion),this.kQ(o,v.xq);else{var u=this.DQ(i),a=void 0,f=void 0;if(u){if(this.xV.JV([u],!1),!(a=(f=this.xV.jQ(r))._Q()||this.VU.length<p.xu.mu.Gh)){this.logger.debug(this.loggerId+" got out part req from "+r+" - reached max "+this.VU.length+"/"+p.xu.mu.Gh);var c=void 0;(c=this.tv.zM()||this.tv.lP()?this.PQ.MQ(this.tv,u,this.VU.values()):this.LQ.MQ(this.VU.values()))&&(this.logger.debug(this.loggerId+" chocking "+c.guid),this.VU["delete"](c.guid),c.AQ.SQ(d.Vq),a=!0)}}else a=!1;if(a){var l=new w.Partner(r,this.TQ,o,this.logger,!1,f);i.reportingGuid&&l.HQ(i.reportingGuid),this.xV.UQ.has(r)?this.qU.set(r,l):this.VU.set(r,l),this.logger.info(this.loggerId+"ADDED OUT PART "+r),this.kQ(o,v.Gq),this.Yq.OQ(r,e,s),E.Framework.setTimeout(function(){n.FQ(r)},500),this.TQ.GQ()}else this.logger.info(this.loggerId+" cannot establish partnership to "+r+" - reached max "+this.VU.length+"/"+p.xu.mu.Gh),this.kQ(o,v.xq)}}}catch(t){g.ErrorMonitor.getInstance().logError("Error receiving out partnership request",this.loggerId,b.Ni.Li,{detailedError:t,otherGuid:i.guid})}},S.prototype.DQ=function(i){try{var t=new T();t.guid=i.guid,i.internalAs&&(t.internalAs=i.internalAs),i.externalAs&&(t.externalAs=i.externalAs),i.publicIpString&&(t.publicIpString=i.publicIpString),i.privateIpString&&(t.privateIpString=i.privateIpString);var n=!1,r=this.xV.jQ(i.guid);if(r&&(n=r.peerInfo.isLeader),i.streamCharacteristics){var s=[];i.streamCharacteristics.forEach(function(t){var i=new O();i.state=t.streamState,i.bitrate=t.qualityLevel.bitrate,i.qualityLevel=t.qualityLevel.id,i.delta=t.delta,s.push(i)}),t.streams=s}return new f.yf(f.pf.gf,t,n)}catch(t){return g.ErrorMonitor.getInstance().logError("Error constructing discovered peer info",this.loggerId,b.Ni.Hi,{detailedError:t,otherGuid:i.guid}),null}},S.prototype.kQ=function(i,t){var r=this;this.logger.debug(this.loggerId+"SEND PART RESPONSE TO "+i.otherGuid);try{var n=new a.Al.ml.OutPartnershipResponse();if(n.accept=t,n.accept===v.Gq){this.tv.sP()&&(n.internalAs=this.tv.sP()),this.tv.eP()&&(n.externalAs=this.tv.eP()),this.tv.getPublicIp()&&(n.publicIpString=this.tv.getPublicIp()),this.tv.getPrivateIp()&&(n.privateIpString=this.tv.getPrivateIp()),n.reportingGuid=this.tv.getReportingGuid();var s=this.tv.xQ(),e=[];s.forEach(function(t,i){var n=new a.Al.ml.StreamCharacteristics();n.qualityLevel=new a.Al.ml.QualityLevel(),n.qualityLevel.id=t.qualityLevel.id,n.qualityLevel.bitrate=t.qualityLevel.bitrate,n.streamState=t.type,n.delta=null!=r.tv.getDelta()?r.tv.getDelta():-1,e.push(n)}),0<e.length&&n.setStreamCharacteristics(e)}i.rl(a.Fc.xc,n)}catch(t){g.ErrorMonitor.getInstance().logError("Error constructing partnership response message",this.loggerId,b.Ni.Ui,{detailedError:t,otherGuid:i.otherGuid})}},S.prototype.bQ=function(t,i,n,r){var s=t.otherGuid;if(n.externalAs&&(i.peerInfo.externalAs=n.externalAs),n.internalAs&&(i.peerInfo.internalAs=n.internalAs),n.publicIpString&&(i.peerInfo.publicIpString=n.publicIpString),n.privateIpString&&(i.peerInfo.privateIpString=n.privateIpString),n.streamCharacteristics){var e=[];n.streamCharacteristics.forEach(function(t){var i=new O();i.state=t.streamState,i.bitrate=t.qualityLevel.bitrate,i.qualityLevel=t.qualityLevel.id,i.delta=t.delta,e.push(i)}),i.peerInfo.streams=e}try{var h=new w.Partner(s,this.TQ,t,this.logger,!0,i,r);return n.reportingGuid&&(h.reportingGuid=n.reportingGuid,t.receiver.setReportingGuid(n.reportingGuid),t.sender.setReportingGuid(n.reportingGuid)),i.peerInfo.type==f.pf.bf?(this.QU.set(s,h),this.tv.BQ(!0),this.tv.VQ(!0),this.tv.Pq(!0)):(0!=this.tv.eP()&&this.tv.eP()===i.peerInfo.externalAs&&this.tv.BQ(!0),0!=this.tv.sP()&&this.tv.sP()===i.peerInfo.internalAs&&this.tv.VQ(!0),this.fQ.set(s,h)),this.logger.debug(this.loggerId+s+" IS NOW IN PARTNER"),h}catch(t){g.ErrorMonitor.getInstance().logError("Error adding a new partner object in the list",this.loggerId,b.Ni.Fi,{detailedError:t,otherGuid:s})}},S.prototype.Mq=function(i){try{this.logger.info(this.loggerId+"GOT PEER DISC "+i),this.qQ(i)&&(this.logger.info(this.loggerId+"IN PRT DISC "+i),this.RQ(i)),this.CQ(i)&&(this.logger.info(this.loggerId+"OUT PRT DISC "+i),this.VU["delete"](i),this.qU["delete"](i))}catch(t){g.ErrorMonitor.getInstance().logError("Error removing disconected partner from the list",this.loggerId,b.Ni.Gi,{detailedError:t,otherGuid:i})}},S.prototype.RQ=function(i){try{this.logger.debug(this.loggerId+"IN PARTNER REMOVE "+i);var t=this.QQ(i);if(this.eM.YQ(t),this.fQ["delete"](i),this.QU["delete"](i),0<this.QU.length)this.tv.BQ(!0),this.tv.VQ(!0);else{var n=this.tv.sP(),r=this.tv.eP(),s=!1,e=!1;0!=n||0!=r?(this.fQ.forEach(function(t){0<n&&n===t.hP.peerInfo.internalAs&&(s=!0),0<r&&r===t.hP.peerInfo.externalAs&&(e=!0)}),this.tv.VQ(s),this.tv.BQ(e)):(this.tv.VQ(!1),this.tv.BQ(!1))}}catch(t){g.ErrorMonitor.getInstance().logError("Error removing the in partner",this.loggerId,b.Ni.xi,{detailedError:t,otherGuid:i})}},S.prototype.KQ=function(i,t){try{this.logger.debug(this.loggerId+"CLOSE RECEIVED FROM "+i+" TYPE "+d[t.getType()]),t.getType()!=d.FV&&t.getType()!=d.qq||(this.VU.has(i)&&this.VU["delete"](i),this.qU.has(i)&&this.qU["delete"](i)),t.getType()!=d.FV&&t.getType()!=d.Vq||this.RQ(i)}catch(t){g.ErrorMonitor.getInstance().logError("Error when close received",this.loggerId,b.Ni.Bi,{detailedError:t,otherGuid:i})}},S.prototype.gQ=function(i){var r=this,n=o.defer();try{var t=new a.Al.ml.OutPartnershipRequest();t.guid=this.uS,t.contextId=this.contextId,t.p2pProtocolVersion=p.xu._u.xh,t.reportingGuid=this.tv.getReportingGuid(),this.tv.sP()&&(t.internalAs=this.tv.sP()),this.tv.eP()&&(t.externalAs=this.tv.eP()),this.tv.getPrivateIp()&&(t.privateIpString=this.tv.getPrivateIp()),this.tv.getPublicIp()&&(t.publicIpString=this.tv.getPublicIp());var s=this.tv.xQ(),e=[];s.forEach(function(t,i){var n=new a.Al.ml.StreamCharacteristics();n.qualityLevel=new a.Al.ml.QualityLevel(),n.qualityLevel.id=t.qualityLevel.id,n.qualityLevel.bitrate=t.qualityLevel.bitrate,n.streamState=t.type,n.delta=null!=r.tv.getDelta()?r.tv.getDelta():-1,e.push(n)}),0<e.length&&t.setStreamCharacteristics(e),this.logger.debug(this.loggerId+"SEND PART REQ TO "+i.otherGuid+" WITH ID "+t.contextId+" internalAS "+t.internalAs+" externalAs "+t.externalAs+" private ip "+t.privateIpString+" public ip "+t.publicIpString+" rGuid "+this.tv.getReportingGuid());var h=E.Framework.setTimeout(function(){r.WQ(n,i.otherGuid)},p.xu.mu.Lh);this.eQ.set(i.otherGuid,{hq:h,defer:n}),i.rl(a.Fc.Gc,t)}catch(t){g.ErrorMonitor.getInstance().logError("Error sending partnership request",this.loggerId,b.Ni.Vi,{detailedError:t,otherGuid:i.otherGuid}),n.reject(t)}return n.promise},S.prototype.$Q=function(t,i){var n=i.otherGuid,r=this.eQ.get(n);r?(E.Framework.clearTimeout(r.hq),this.eQ["delete"](n),t.accept===v.Gq?r.defer.resolve({transport:i,msg:t}):r.defer.reject("NOT ACCEPTED")):g.ErrorMonitor.getInstance().logError("Error receiving out partnership response from an unknown peer",this.loggerId,b.Ni.Yi,{otherGuid:n})},S.prototype.WQ=function(t,i){if(this.eQ.has(i)){g.ErrorMonitor.getInstance().logError("Error partnership request expired",this.loggerId,b.Ni.qi,{otherGuid:i});var n=this.eQ.get(i);this.eQ["delete"](i),n.defer.reject("EXPIRED")}else g.ErrorMonitor.getInstance().logError("Error partnership request expired for unknown peer",this.loggerId,b.Ni.Qi,{otherGuid:i})},S.prototype.iQ=function(){var i=this,n=o.defer(),r=this.fQ.values();this.QU.forEach(function(t,i){r.push(t)});var t=r.slice().map(function(t){return t.AQ.close()});return o.all(t).then(function(t){n.resolve("resolved")}).fail(function(t){g.ErrorMonitor.getInstance().logError("Error closing partnership",i.loggerId,b.Ni.Ki),n.reject("could not close")}),n.promise},S.prototype.IQ=function(t){this.Jc.disconnect(t)},S.prototype.Xq=function(t){var i=this;-1!=this.Zq&&E.Framework.clearInterval(this.Zq),this.Zq=E.Framework.setInterval(function(){i.XQ()},t)},S.prototype.XQ=function(){try{if(this.tv.aP()&&!this.tv.zM()&&m){var t=this.tv.pP(),i=this.context.wM().getQualityLevel();if(i&&this.qQ(t.uuid)){var n=this.QQ(t.uuid);this.zQ(n.AQ,i)}}}catch(t){g.ErrorMonitor.getInstance().logError("Error announcing quality level",this.loggerId,b.Ni.Wi,t)}},S.prototype.zQ=function(i,t){try{var n=new a.Al.ml.QualityLevelMessage();n.guid=this.uS,n.qualityLevel=new a.Al.ml.QualityLevel(),n.qualityLevel.id=t.id,n.qualityLevel.bitrate=t.bitrate,this.logger.debug(this.loggerId+"ANNOUNCE QUALITY LEVEL "+n.qualityLevel.id+" TO PEER GUID "+i.otherGuid),i.rl(a.Fc.QualityLevelMessage,n)}catch(t){g.ErrorMonitor.getInstance().logError("Error constructing quality level announcement",this.loggerId,b.Ni.$i,{detailedError:t,otherGuid:i.otherGuid})}},S.prototype.JQ=function(i){try{if(this.logger.debug(this.loggerId+"RECEIVED QUALITY LEVEL "+i.qualityLevel.id+" FROM PEER GUID "+i.guid),this.xV.UQ.has(i.getGuid())){var t=y.QualityLevel.from(i.qualityLevel);this.xV.UQ.get(i.guid).ZQ(t),this.uM.tY()}}catch(t){g.ErrorMonitor.getInstance().logError("Error receiving quality level info",this.loggerId,b.Ni.Xi,{detailedError:t,otherGuid:i.guid})}},S.prototype.iY=function(i){try{var t=i.guid,n=this.QQ(t);n&&this.nY(n,i),(n=this.rY(t))&&this.nY(n,i),this.Yq.OQ(t,i.privateIpString,i.publicIpString)}catch(t){g.ErrorMonitor.getInstance().logError("Error receiving peer info",this.loggerId,b.Ni.zi,{detailedError:t,otherGuid:i.guid})}},S.prototype.nY=function(t,i){var n=t.hP.peerInfo;if(i.privateIpString&&(n.privateIpString=i.privateIpString),i.publicIpString&&(n.publicIpString=i.publicIpString),i.externalAs&&(n.externalAs=i.externalAs),i.internalAs&&(n.internalAs=i.internalAs),i.streamCharacteristics){var r=[];i.streamCharacteristics.forEach(function(t){var i=new O();i.bitrate=t.qualityLevel.bitrate,i.qualityLevel=t.qualityLevel.id,i.delta=t.delta,i.state=t.streamState,r.push(i)}),n.streams=r}},S.prototype.zq=function(t){var i=this;this.tQ&&E.Framework.clearInterval(this.tQ),this.tQ=E.Framework.setInterval(function(){i.sY()},t)},S.prototype.sY=function(){var r=this;try{if(this.tv.getPrivateIp()||this.tv.getPublicIp()||this.tv.sP()||this.tv.eP()){var t=this.eY(),n=new a.Al.ml.PeerInfoMessage();n.guid=this.tv.getId(),this.tv.getPrivateIp()&&(n.privateIpString=this.tv.getPrivateIp()),this.tv.getPublicIp()&&(n.publicIpString=this.tv.getPublicIp()),this.tv.eP()&&(n.externalAs=this.tv.eP()),this.tv.sP()&&(n.internalAs=this.tv.sP());var i=this.tv.xQ(),s=[];i.forEach(function(t,i){var n=new a.Al.ml.StreamCharacteristics();n.qualityLevel=new a.Al.ml.QualityLevel(),n.qualityLevel.id=t.qualityLevel.id,n.qualityLevel.bitrate=t.qualityLevel.bitrate,n.streamState=t.type,n.delta=null!=r.tv.getDelta()?r.tv.getDelta():-1,s.push(n)}),0<s.length&&n.setStreamCharacteristics(s),t.forEach(function(t,i){t.AQ.rl(a.Fc.qc,n)})}}catch(t){g.ErrorMonitor.getInstance().logError("Error announcing peer info to all partners",this.loggerId,b.Ni.Ji,t)}},S.prototype.eY=function(){try{var n=new u();return this.VU.forEach(function(t,i){n.has(i)||n.set(i,t)}),this.qU.forEach(function(t,i){n.has(i)||n.set(i,t)}),this.QU.forEach(function(t,i){n.has(i)||n.set(i,t)}),this.fQ.forEach(function(t,i){n.has(i)||n.set(i,t)}),n}catch(t){return g.ErrorMonitor.getInstance().logError("Error collecting all partners",this.loggerId,b.Ni.Zi,t),new u()}},S);function S(){var t=_.call(this)||this;return t.loggerId="[Partnership] ",t.eQ=new u(),t.ZV=new u(),t.Jq=-1,t.Zq=-1,t.tQ=-1,t.connected=!1,t.Jc=E.Framework.resolve(E.Framework.v.Zc),t.Kq=E.Framework.resolve(E.Framework.v.GC),t.LQ=E.Framework.resolve(E.Framework.v.$C),t.Wq=E.Framework.resolve(E.Framework.v.xC),t.PQ=E.Framework.resolve(E.Framework.v.XC),t}i.hY=R},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.oY=!0,s.uY=3e4,s.aY=6e4,s.fY=3e4,s);function s(){}i.cY=r;var e=(h.uu="site",h.au="externalAs",h.fu="availableSendRate",h.cu="remoteAddress",h.lu="localAddress",h);function h(){}i.lY=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var E=n(113),w=n(5),p=n(0),g=n(1),b=n(2),r=(s.prototype.init=function(t){this.tv=t.tv},s.prototype.vQ=function(t,i,n,r){try{var s=[],e=[],h=Math.round(t*(1-w.xu.mu.Fh)),o=Math.max(i.length-h,0),u=t-i.length+o;if(0<o){var a=i.filter(function(t){return!t.AQ.transport.tl()}),f=p.Framework.time(),c=a.filter(function(t){return f-t.vY>w.xu._u.Kh}),l=Math.min(c.length,o);e=this.dY(l,c);var v=[],d=[];e.forEach(function(t){v.push(t.guid),d.push(t.tU.ZH(!1))})}return 0<u&&(s=this.EY(u,i,n,r)),this.logger.debug("[PART] A/R: "+u+"/"+o+" ["+s.map(function(t){return t.peerInfo.guid.substring(0,8)})+"/"+e.map(function(t){return t.guid.substring(0,8)})+"] P:["+i.map(function(t){return t.guid.substring(0,8)})+"] M:["+r.map(function(t){return t.peerInfo.guid.substring(0,8)})+"]"),new E.wY(s,e)}catch(t){return g.ErrorMonitor.getInstance().logError("Error updating in partners",this.eH,b.tn["in"],t),new E.wY([],[])}},s);function s(){this.eH="[BaseInPartnerSelection] ",this.logger=p.Framework.resolve(p.Framework.v.p).log()}i.pY=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.EQ=function(){return this.gY},s.prototype.wQ=function(){return this.bY},s);function s(t,i){this.bY=t,this.gY=i}i.wY=r},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(26),o=n(245),u=n(246),a=(e=h.Plugin,s(f,e),f.prototype.initSession=function(t,i,n){var r=this;return this.yY||this.logger().warn(this.TY+" The HiveOzRequestImplementation was not set on the player. Unable to use the full techs Stats and WebRTC functionalities."),this.closeHiveSession("Starting a new session"),this.OY(i,n),this.resolveTicketPromise(t).timeout(this.options().pluginTimeout,"The plugin timedout after "+this.options().pluginTimeout+" ms.").then(function(t){return r.mY(),t.toHiveSession()},function(t){throw h.logError("Error resolving ticket promise",r.loggerId,h.PR.re,t),r.closeHiveSession(),t})},f.prototype.closeHiveSession=function(t,i){void 0===i&&(i=!0),e.prototype.closeHiveSession.call(this,t,i),this.player=void 0,this.video=void 0,this.yY=!1},f.prototype.getRequestImplementation=function(){return this.yY=!0,u["default"].bind(this)},f.prototype.mY=function(){var t={enter_buffering:this._Y,leave_buffering:this.RY,switchVideoRepresentation:this.SY,error:this.AY,destroyed:{IY:this.NY,CY:!0}},i={loadedmetadata:this.kY,canplay:this.DY,playing:this.jY,pause:this.MY,seek:this.PY,ended:this.LY};this.eventBinder=new o["default"](this,this.player,"addListener"),this.eventBinder.HY(this.video,"addEventListener","removeEventListener"),this.eventBinder.mY(this.player,t),this.eventBinder.mY(this.video,i)},f.prototype._Y=function(){this.logger().debug(this.TY+" buffering start event"),this.onStartBuffering()},f.prototype.RY=function(){this.logger().debug(this.TY+" buffering end event"),this.onEndBuffering()},f.prototype.SY=function(){var t=this.player.getSelectedVideoQuality();this.logger().debug(this.TY+" switchVideoRepresentation event - new quality: "+t)},f.prototype.NY=function(){this.logger().debug(this.TY+" player destroyed event"),this.destroyHivePlugin()},f.prototype.AY=function(t){var i=t.type,n=t.description,r=t.UY;this.logger().debug(this.TY+" player error event - Type: "+i+", description: "+n+(r?", extra: "+JSON.stringify(r):"")),this.onError(i,n)},f.prototype.kY=function(){this.logger().debug(this.TY+" loadedmetadata event"),this.onActivateSession(),this.startPeriodicFeedback(),this.onStartBuffering(!1)},f.prototype.DY=function(){this.logger().debug(this.TY+" canplay event"),this.onEndBuffering()},f.prototype.jY=function(){this.logger().debug(this.TY+" playing event"),this.onEventFeedback(h.PlayerEvents.PLAYING,{currentTime:this.getCurrentTime()})},f.prototype.MY=function(){this.logger().debug(this.TY+" pause event"),this.onEventFeedback(h.PlayerEvents.PAUSED)},f.prototype.PY=function(){this.logger().debug(this.TY+" seek event"),this.onEventFeedback(h.PlayerEvents.SKIP)},f.prototype.LY=function(){this.logger().debug(this.TY+" ended event"),this.onEventFeedback(h.PlayerEvents.STOPPED)},f.prototype.createXMLHttpRequest=function(){try{var t=this.getPotentialSession();return t&&t.supportsXhrInterception()?new h.HiveRequestFactory(this.getPluginId()).createXMLHttpRequest():new XMLHttpRequest()}catch(t){return new XMLHttpRequest()}},f.prototype.getPlayerSource=function(){if(this.FY("player"))return this.player.getMpdUrl()},f.prototype.getCurrentTime=function(){if(this.FY("video"))return Math.round(1e3*this.video.currentTime)},f.prototype.getBufferLen=function(){if(this.FY("video"))return Math.round(1e3*h.BasicUtils.Mc(this.video.currentTime,this.video.buffered))},f.prototype.getWindowSize=function(){return this.FY("video")?{width:this.video.clientWidth,height:this.video.clientHeight}:{width:0,height:0}},f.prototype.isFullscreen=function(){return!!this.FY("video")&&null!=document.fullscreenElement&&document.fullscreenElement==this.video},f.prototype.isLive=function(){return!0},f.prototype.isActive=function(){return Boolean(this.player)},f.prototype.getStreamProtocol=function(){return StreamProtocol.DASH},f.prototype.getPlayerTech=function(){return h.cR.HTML5},f.prototype.getPlayerVersion=function(){return"vFacebookOz"},f.prototype.OY=function(t,i){if(this.player=t,this.video=i,!this.FY("player")||!this.FY("video"))throw new Error(this.TY+" The plugin has to be instantiated with valid player and video elements.")},f.prototype.FY=function(t){return!!this[t]||(h.logError("The plugin is missing a required dependency: '"+t+"' is "+this[t],this.TY,h.PR.ce),!1)},f);function f(){var t=null!==e&&e.apply(this,arguments)||this;return t.TY="[HiveOz]",t.yY=!1,t}window.HiveOz=i.HiveOz=a},function(t,i,n){var d,E,w=n(68),p=n(69),g=0,b=0;t.exports=function(t,i,n){var r=i&&n||0,s=i||[],e=(t=t||{}).GY||d,h=void 0!==t.xY?t.xY:E;if(null==e||null==h){var o=w();null==e&&(e=d=[1|o[0],o[1],o[2],o[3],o[4],o[5]]),null==h&&(h=E=16383&(o[6]<<8|o[7]))}var u=void 0!==t.BY?t.BY:new Date().getTime(),a=void 0!==t.VY?t.VY:b+1,f=u-g+(a-b)/1e4;if(f<0&&void 0===t.xY&&(h=h+1&16383),(f<0||g<u)&&void 0===t.VY&&(a=0),1e4<=a)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");g=u,E=h;var c=(1e4*(268435455&(u+=122192928e5))+(b=a))%4294967296;s[r++]=c>>>24&255,s[r++]=c>>>16&255,s[r++]=c>>>8&255,s[r++]=255&c;var l=u/4294967296*1e4&268435455;s[r++]=l>>>8&255,s[r++]=255&l,s[r++]=l>>>24&15|16,s[r++]=l>>>16&255,s[r++]=h>>>8|128,s[r++]=255&h;for(var v=0;v<6;++v)s[r+v]=e[v];return i||p(s)}},function(t,i,n){var h=n(68),o=n(69);t.exports=function(t,i,n){var r=i&&n||0;"string"==typeof t&&(i="binary"===t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.qY||h)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,i)for(var e=0;e<16;++e)i[r+e]=s[e];return i||o(s)}},function(t,s,e){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function r(t,i){this.pB=t,this.QY=i}s.setTimeout=function(){return new r(n.call(setTimeout,i,arguments),clearTimeout)},s.setInterval=function(){return new r(n.call(setInterval,i,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(t){t&&t.close()},r.prototype.YY=r.prototype.KY=function(){},r.prototype.close=function(){this.QY.call(i,this.pB)},s.WY=function(t,i){clearTimeout(t.$Y),t.XY=i},s.zY=function(t){clearTimeout(t.$Y),t.XY=-1},s.JY=s.active=function(t){clearTimeout(t.$Y);var i=t.XY;0<=i&&(t.$Y=setTimeout(function(){t.ZY&&t.ZY()},i))},e(118),s.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,s.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,e(56))},function(t,i,n){(function(t,d){!function(n,r){"use strict";if(!n.setImmediate){var s,e,i,h,o=1,u={},a=!1,f=n.document,t=Object.getPrototypeOf&&Object.getPrototypeOf(n);t=t&&t.setTimeout?t:n,s="[object process]"==={}.toString.call(n.process)?function(t){d.Me(function(){l(t)})}:function(){if(n.postMessage&&!n.tK){var t=!0,i=n.onmessage;return n.onmessage=function(){t=!1},n.postMessage("","*"),n.onmessage=i,t}}()?(h="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",v,!1):n.attachEvent("onmessage",v),function(t){n.postMessage(h+t,"*")}):n.MessageChannel?((i=new MessageChannel()).port1.onmessage=function(t){l(t.data)},function(t){i.port2.postMessage(t)}):f&&"onreadystatechange"in f.createElement("script")?(e=f.documentElement,function(t){var i=f.createElement("script");i.onreadystatechange=function(){l(t),i.onreadystatechange=null,e.removeChild(i),i=null},e.appendChild(i)}):function(t){setTimeout(l,0,t)},t.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var i=new Array(arguments.length-1),n=0;n<i.length;n++)i[n]=arguments[n+1];var r={iK:t,nK:i};return u[o]=r,s(o),o++},t.clearImmediate=c}function c(t){delete u[t]}function l(t){if(a)setTimeout(l,0,t);else{var i=u[t];if(i){a=!0;try{!function(t){var i=t.iK,n=t.nK;switch(n.length){case 0:i();break;case 1:i(n[0]);break;case 2:i(n[0],n[1]);break;case 3:i(n[0],n[1],n[2]);break;default:i.apply(r,n)}}(i)}finally{c(t),a=!1}}}}function v(t){t.source===n&&"string"==typeof t.data&&0===t.data.indexOf(h)&&l(+t.data.slice(h.length))}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(56),n(37))},function(t,i){if(!RegExp.escape){var n=/[-[\]{}()*+?.\\^$|,#\s]/g;RegExp.escape=function(t){return t.replace(n,"\\$&")}}},function(t,i,n){"use strict";var r=n(39),s=n(57);function e(){throw new Error("Can't construct. MapChanges is a mixin.")}t.exports=e;Object.prototype.hasOwnProperty;var h=new r(),o=null;e.prototype.rK=function(){return h.has(this)||(o=o||n(58),h.set(this,o())),h.get(this)},e.prototype.sK=function(t){var i=this.rK();return t=t||"",i.has(t)||i.set(t,{Gf:new s(),xf:new s()}),i.get(t)},e.prototype.eK=function(t,i,n){!this.Qf&&this.qf&&this.qf();var r=this.sK(i);(n?r.Gf:r.xf).push(t),Object.defineProperty(this,"BP",{value:!0,writable:!0,configurable:!0,enumerable:!1});var s=this;return function(){s&&(s.hK(t,i,n),s=null)}},e.prototype.hK=function(t,i,n){var r=this.sK(i),s=(n?r.Gf:r.xf).findLast(t);if(!s)throw new Error("Can't remove map change listener: does not exist: token "+JSON.stringify(i));s["delete"]()},e.prototype.qP=function(s,e,h){var t=this.rK(),o="Map"+(h?"WillChange":"Change");t.forEach(function(t,i){if(!t.isActive){var n;t.isActive=!0,n=h?t.Gf:t.xf;var r="handle"+(i.slice(0,1).toUpperCase()+i.slice(1))+o;try{n.forEach(function(t){if(t[r])t[r](e,s,this);else{if(!t.call)throw new Error("Handler "+t+" has no method "+r+" and is not callable");t.call(t,e,s,this)}},this)}finally{t.isActive=!1}}},this)},e.prototype.oK=function(t,i){return this.eK(t,i,!0)},e.prototype.uK=function(t,i){return this.hK(t,i,!0)},e.prototype.VP=function(t,i){return this.qP(t,i,!0)}},function(t,i,n){"use strict";n(10);var r=n(58),s=n(57),e=n(11),h=n(41),c=n(74),o=n(12);Object.prototype.hasOwnProperty;function u(t,i,n,r){if(!(this instanceof u))return new u(t,i,n,r);i=i||Object.equals,n=n||Object.hash,r=r||Function._e,this.Re=i,this.Se=n,this.Ae=r;var s=this;this.aK=new this.fK(null,function(){return new s.cK()}),this.length=0,this.hiveAddEach(t)}(t.exports=u).lK=u,Object.hiveAddEach(u.prototype,e.prototype),Object.hiveAddEach(u.prototype,h.prototype),Object.hiveAddEach(u.prototype,o.prototype),u.prototype.fK=r,u.prototype.cK=s,u.prototype.Ne=function(t){return new this.constructor(t,this.Re,this.Se,this.Ae)},u.prototype.has=function(t){var i=this.Se(t);return this.aK.get(i).has(t)},u.prototype.get=function(t,i){if(i)throw new Error("FastSet#get does not support second argument: equals");var n=this.Se(t),r=this.aK;return r.has(n)?r.get(n).get(t):this.Ae(t)},u.prototype["delete"]=function(t,i){if(i)throw new Error("FastSet#delete does not support second argument: equals");var n=this.Se(t),r=this.aK;if(r.has(n)){var s=r.get(n);if(s["delete"](t))return this.length--,0===s.length&&r["delete"](n),!0}return!1},u.prototype.clear=function(){this.aK.clear(),this.length=0},u.prototype.hiveAdd=function(t){var i=this.Se(t),n=this.aK;return n.has(i)||n.set(i,new this.cK(null,this.Re)),!n.get(i).has(t)&&(n.get(i).hiveAdd(t),this.length++,!0)},u.prototype.reduce=function(n,t){var r=arguments[2],i=this.aK,s=0;return i.reduce(function(t,i){return i.reduce(function(t,i){return n.call(r,t,i,s++,this)},t,this)},t,this)},u.prototype.kf=function(){if(0<this.length)return this.aK.kf().kf()},u.prototype.Df=function(){return this.aK.values().Sf().Df()},u.prototype.log=function(o,u,a,f){o=o||c.EU,u=u||this.Ce,a||(a=emptyFunction,f=console),a=a.bind(f);var r=this.aK,s=r.keys();s.forEach(function(t,i){var n,e;e=i===s.length-1?(n=o.cU," "):(n=0===i?o.aU:o.lU,o.vU);var h=r.get(t);a.call(f,n+o.oU+o.aU+" "+t),h.forEach(function(t,i){var n,r,s;r=i===h.head.RP?(n=o.cU," "):(n=o.lU,o.vU),u(i,function(t){s?a.call(f,e+" "+r+"  "+t):(a.call(f,e+" "+n+o.oU+o.oU+t),s=!0)},function(t){a.call(f,e+" "+o.vU+"  "+t)})})})},u.prototype.Ce=function(t,i){var n=t.value;Object(n)===n?JSON.stringify(n,null,4).split("\n").forEach(function(t){i(" "+t)}):i(" "+n)}},function(t,i,n){"use strict";t.exports=u;var o=n(38),r=n(11);function u(t){if(!(this instanceof u))return new u(t);if(Array.isArray(t)||"string"==typeof t)return u.Df(t);if((t=o(t))instanceof u)return t;if(t.next)this.next=function(){return t.next()};else if(t.Df){var i=t.Df();this.next=function(){return i.next()}}else{if("[object Function]"!==o.prototype.toString.call(t))throw new TypeError("Can't iterate "+t);this.next=t}}u.prototype.forEach=r.prototype.forEach,u.prototype.map=r.prototype.map,u.prototype.filter=r.prototype.filter,u.prototype.every=r.prototype.every,u.prototype.some=r.prototype.some,u.prototype.Th=r.prototype.Th,u.prototype.all=r.prototype.all,u.prototype.min=r.prototype.min,u.prototype.max=r.prototype.max,u.prototype.Ju=r.prototype.Ju,u.prototype.Rf=r.prototype.Rf,u.prototype.Sf=r.prototype.Sf,u.prototype.Af=r.prototype.Af,u.prototype.enumerate=r.prototype.enumerate,u.prototype.Nf=r.prototype.Nf,u.prototype.group=r.prototype.group,u.prototype.reversed=r.prototype.reversed,u.prototype.toArray=r.prototype.toArray,u.prototype.mf=r.prototype.mf,u.prototype.iterator=r.prototype.iterator,u.prototype.PP=null,o.defineProperty(u.prototype,"_iterationObject",{get:function(){return this.PP||(this.PP={done:!1,value:void 0})}}),u.prototype.Ne=function(t){var i=[];return i.hiveAddEach(t),i},u.prototype.vK=function(i){var n=u(this),r=arguments[1],s=0;if("[object Function]"!=o.prototype.toString.call(i))throw new TypeError();return new n.constructor(function(){if(!0!==n.LP.done){var t=i.call(r,n.next().value,s++,n);n.LP.value=t}return n.LP})},u.prototype.dK=function(i){var n=u(this),r=arguments[1],s=0;if("[object Function]"!=o.prototype.toString.call(i))throw new TypeError();return new n.constructor(function(){for(var t;;){if(!0===(t=n.next()).done)return t;if(i.call(r,t.value,s++,n))return t}})},u.prototype.reduce=function(t){var i,n=u(this),r=arguments[1],s=arguments[2],e=0;if("[object Function]"!=o.prototype.toString.call(t))throw new TypeError();if(!0===(i=n.next()).done){if(1<arguments.length)return arguments[1];throw TypeError("cannot reduce a value from an empty iterator with no initial value")}for(r=1<arguments.length?t.call(s,r,i.value,e,n):i.value,e++;;){if(!0===(i=n.next()).done)return r;r=t.call(s,r,i.value,e,n),e++}},u.prototype.concat=function(){return u.concat(Array.prototype.concat.apply(this,arguments))},u.prototype.EK=function(t){var i,n,r=u(this),s=arguments[1],e=!1,h=0;if("[object Function]"!=o.prototype.toString.call(t))throw new TypeError();for(;!0!==(n=r.next()).done;){if(!t.call(s,n.value,h,r)){e=!0,i=n.value;break}h++}return e?r.constructor([i]).concat(r):r.constructor([])},u.prototype.wK=function(i){var n=u(this),r=arguments[1],s=0;if("[object Function]"!=o.prototype.toString.call(i))throw new TypeError();return new n.constructor(function(){if(!0!==n.LP.done){var t=n.next().value;i.call(r,t,s++,n)?n.LP.value=t:(n.LP.done=!0,n.LP.value=void 0)}return n.LP})},u.prototype.pK=function(){return u.If(Array.prototype.concat.apply(this,arguments))},u.prototype.gK=function(t){return u.count(t).pK(this)},u.Df=function(t){var i;return i=0,new u(function(){if("object"==typeof t)for(;!(i in t);){if(i>=t.length){this.LP.done=!0,this.LP.value=void 0;break}i+=1}else i>=t.length&&(this.LP.done=!0,this.LP.value=void 0);return this.LP.done||(this.LP.value=t[i],i+=1),this.LP})},u.bK=function(n,r){var s;return arguments.length<2&&(r=1/0),new u(function(){var t,i;return s&&(i=s()),s&&!0!==i.done||(i=0<r?(r--,t=u.Df(n),(s=t.next.bind(t))()):(this.LP.done=!0,this.LP)),i})},u.concat=function(n){var r;return n=u(n),new u(function(){var t,i;return r&&(i=r()),i&&!0!==i.done?i:!1===(i=n.next()).done?(t=u(i.value),(r=t.next.bind(t))()):i})},u.If=function(r){return 0===(r=u(r).map(u)).length?new u([]):new u(function(){var i,n,t=r.map(function(t){return!0===(n=t.next()).done&&(i=!0),n.value});return i?(this.LP.done=!0,this.LP.value=void 0):this.LP.value=t,this.LP})},u.Af=function(){return u.If(Array.prototype.slice.call(arguments))},u.chain=function(){return u.concat(Array.prototype.slice.call(arguments))},u.range=function(i,n,r){return arguments.length<3&&(r=1),arguments.length<2&&(n=i,i=0),i=i||0,r=r||1,new u(function(){n<=i&&(this.LP.done=!0,this.LP.value=void 0);var t=i;return i+=r,this.LP.value=t,this.LP})},u.count=function(t,i){return u.range(t,1/0,i)},u.repeat=function(t,i){return new u.range(i).vK(function(){return t})}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=(e.prototype.destroy=function(){this.abort(),this.loader=null,this.xhr=null},e.prototype.abort=function(){var t=this.loader||this.xhr;t&&4!==t.readyState&&(this.stats.aborted=!0,t.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},e.prototype.load=function(t,i,n){this.context=t,this.config=i,this.callbacks=n,this.stats={trequest:performance.now(),retry:0},this.retryDelay=i.retryDelay,this.yK()},e.prototype.yK=function(){this.xhr=this.loader=new XMLHttpRequest();var t=this.context,i=this.stats;i.tfirst=0,i.loaded=0,this.xhrSetup?this.xhr=this.xhrSetup(this.xhr,t)||this.xhr:(!1,r.Framework.h()&&(this.xhr=r.Framework.resolve(r.Framework.v.FC)),this.xhr||(this.xhr=new XMLHttpRequest()),this.xhr.open("GET",t.url,!0),t.rangeEnd&&this.xhr.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),this.xhr.responseType=t.responseType),this.xhr.readyState||this.xhr.open("GET",t.url,!0),t.rangeEnd&&this.xhr.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),this.xhr.onreadystatechange=this.readystatechange.bind(this),this.xhr.onprogress=this.loadprogress.bind(this),this.xhr.responseType=t.responseType,this.config.timeout&&(this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout)),this.xhr.send()},e.prototype.readystatechange=function(t){var i=t.currentTarget,n=i.readyState,r=this.stats,s=this.context,e=this.config;if(!r.aborted&&2<=n)if(window.clearTimeout(this.requestTimeout),0===r.tfirst&&(r.tfirst=Math.max(performance.now(),r.trequest)),4===n){var h=i.status,o=i.getAllResponseHeaders()||"";o=o.replace(/[\r\n]{2,}Access-Control-Allow-Origin:\*/,"\naccess-control-allow-origin: *");var u=i.responseURL||i.url,a=i.statusText||(200===h?"OK":""),f=o.trim().split(/[\r\n]+/),c={};if(o&&f.forEach(function(t){var i=t.split(": "),n=i.shift(),r=i.join(": ");c[n]=r}),200<=h&&h<300){r.tload=Math.max(r.tfirst,performance.now());var l=void 0,v=void 0;v="arraybuffer"===s.responseType?(l=i.response).byteLength:(l=i.responseText).length,r.loaded=r.total=v;var d={url:u,code:h,text:a,responseHeaders:o,TK:c,data:l};this.callbacks.onSuccess(d,r,s)}else void 0===e.retryDelay||void 0===e.mK||r.retry>=e._K||400<=h&&h<499?(!1,d={url:u,code:h,text:a,responseHeaders:o,TK:c,data:"arraybuffer"===s.responseType?i.response:i.responseText},this.callbacks.onError(d,s)):(!1,this.destroy(),this.retryTimeout=window.setTimeout(this.yK.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,e.mK),r.retry++)}else e.timeout&&(this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),e.timeout))},e.prototype.loadtimeout=function(){!1,this.callbacks.onTimeout(this.stats,this.context)},e.prototype.loadprogress=function(t){var i=this.stats;i.loaded=t.loaded,t.lengthComputable&&(i.total=t.total);var n=this.callbacks.onProgress;n&&n(i,this.context,null)},e);function e(t){this.loggerId="[HiveXhrLoader] ",(this.RK=t)&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}i.uR=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(27),s=(e.prototype.apply=function(t){t.apply(this.context)},e);function e(t){this.id=t,this.context=new r.F()}i.D=s},function(t,i,n){"use strict";var r;Object.defineProperty(i,"s",{value:!0}),(r=i.IR||(i.IR={}))[r.HiveJS=0]="HiveJS",r[r.HiveJava=1]="HiveJava",r[r.StatsJS=2]="StatsJS";var s=(e.StatsJS="StatsJS",e.HiveJava="HiveJava",e.HiveJS="HiveJS",e);function e(){}i.TechName=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.getInstance=function(){return void 0===this.instance&&(this.instance=new s()),this.instance},s.prototype.J=function(t,i){this.SK.push(t),this.callbacks.push(i)},s.prototype.AK=function(n){for(var t=function(t){var i=!0;r.SK[t].forEach(function(t){null!=n[t]&&n[t]||(i=!1)}),i&&r.callbacks[t]()},r=this,i=0;i<this.SK.length;i++)t(i)},s);function s(){var i=this;if(this.SK=[],this.callbacks=[],s.instance)throw new Error("Error: Instantiation failed: Use KeyHandlerHiveComm.getInstance() instead of new.");var n={};document.addEventListener("keydown",function(t){n[t.keyCode]=!0,i.AK(n)},!0),document.addEventListener("keyup",function(t){n={}},!0)}i.Z=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(Object.defineProperty(s.prototype,"fullscreen",{get:function(){return this._fullscreen},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"totalBuffering",{get:function(){return this._totalBuffering},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bufferLength",{get:function(){return this._bufferLength},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"playingPoint",{get:function(){return this._playingPoint},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"zG",{get:function(){return this._playingTime},enumerable:!0,configurable:!0}),s.prototype.replaceNaNs=function(){isNaN(this.playingPoint)&&(this._playingPoint=0),isNaN(this.bufferLength)&&(this._bufferLength=0),isNaN(this.totalBuffering)&&(this._totalBuffering=0),isNaN(this.zG)&&(this._playingTime=0)},s);function s(t,i,n,r,s,e,h){this._playingPoint=t,this._bufferLength=i,this._totalBuffering=n,this._width=r,this._height=s,this._fullscreen=e,this._playingTime=h,this.replaceNaNs()}i.HivePlayerStats=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.check=function(t){var i=Date.now();return this.isEqual(this.previousStats,t)||(this.lastStatsChange=i),this.previousStats=t,i-this.lastStatsChange>=this.maxPeriod},s.prototype.isEqual=function(t,i){return!(!t||!i)&&[i.playingPoint-t.playingPoint,i.bufferLength-t.bufferLength,i.totalBuffering-t.totalBuffering].reduce(function(t,i){return t&&Math.abs(i)<10},!0)},s);function s(t){this.maxPeriod=t}i.StatsChecker=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.getInstance=function(t){return t&&(this.logger=t),void 0===this.instance&&(this.instance=new s()),this.instance},s.prototype.callListeners=function(){var i=this,n=!document[this.hidden];this.listeners.forEach(function(t){t.call(i,n)})},s.prototype.setVisibilityChangeListener=function(t){this.listeners.push(t)},s.prototype.cleanListeners=function(){document.removeEventListener(this.visibilityChange,this.callListeners,!1),this.listeners.length=0},s);function s(){if(s.instance)throw new Error("Error: Instantiation failed: Use VisibilityChangeListener.getInstance() instead of new.");void 0!==document.hidden?(this.hidden="hidden",this.visibilityChange="visibilitychange"):void 0!==document.msHidden?(this.hidden="msHidden",this.visibilityChange="msvisibilitychange"):void 0!==document.webkitHidden&&(this.hidden="webkitHidden",this.visibilityChange="webkitvisibilitychange"),void 0!==document.addEventListener&&void 0!==document[this.hidden]?document.addEventListener(this.visibilityChange,this.callListeners.bind(this),!1):s.logger&&s.logger.debug("warn - visibilityChange listener not supported"),this.listeners=[]}i.VisibilityChangeListener=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(45),s=n(44),e=n(15),h=n(1),o=(u.prototype.IK=function(){var t=this;this.plugin.options().silent&&(HiveConfig&&(HiveConfig.ConnInfo.detectPrivateIP=!0),void 0===this.NK&&(this.url="//"+r.gv.Ok+":"+this.CK+"/feedback",this.plugin.logger().info("starting periodic alive ping to hive tester ["+this.url+"]"),this.NK=setInterval(function(){t.kK()},s.Rc.yk)))},u.prototype.kK=function(){var i=this,t=this.plugin.getActiveSession(),n=void 0;t&&(n="S["+t.id+"]");var r=this.plugin.getCurrentTime();r>this.DK?(this.plugin.logger().info("sending hive tester ping ["+r+" > "+this.DK+"]"),e.Cc(this.url).then(function(t){},function(t){h.ErrorMonitor.getInstance().logError("error sending hive tester ping",n,{error:t}),clearInterval(i.NK)})):this.plugin.logger().warn("not sending hive tester ping ["+r+" <= "+this.DK+"]"),this.DK=r},u);function u(t){this.CK=s.Rc.wv?9989:9988,this.DK=-1,this.plugin=t,this.IK()}i.MR=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.sS=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.qc=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.hS=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(27),s=n(30),e=n(42),h=n(135),o=(u.prototype.apply=function(t){t.bind(new r.LR(e.v.l,h.jK,r.HR.VR)),t.bind(new r.LR(e.v.p,s.rA))},u);function u(){}i.kR=o},function(t,e,h){"use strict";(function(t){Object.defineProperty(e,"s",{value:!0});var i=h(73),n=h(3),r=(s.prototype.init=function(){this.MK=void 0},s.prototype.T=function(){return!1},s.prototype.PK=function(t,i,n){},s.prototype.M=function(){return null},s.prototype.time=function(){return+new Date()},s.prototype.setTimeout=function(t,i,n){var r=this;void 0===n&&(n=!1);var s=this.LK.setTimeout(function(){r.HK["delete"](s),t(),0===r.HK.length&&r.MK&&(r.MK(),r.MK=void 0)},i);return this.HK.set(s,n),s},s.prototype.clearTimeout=function(t){return this.HK["delete"](t),this.LK.clearTimeout(t),!0},s.prototype.setInterval=function(t,i){var n=this.LK.setInterval(function(){t()},i);return this.UK.hiveAdd(n),n},s.prototype.clearInterval=function(t){return this.UK["delete"](t),this.LK.clearInterval(t),!0},s.prototype.H=function(n,t){var r=this;void 0===n&&(n=!1),void 0===t&&(t=void 0),this.HK.forEach(function(t,i){!n&&t||r.clearTimeout(i)}),this.UK.forEach(function(t){return r.clearInterval(t)}),0===this.HK.length&&t?t():this.MK=t},s);function s(){this.HK=new n(),this.UK=new i(),this.LK=void 0!==t?t:window}e.jK=r}).call(this,h(56))},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,s,e=n(27),h=n(30),o=n(42),u=n(19),a=n(29),f=n(79),c=n(80),l=n(81),v=n(82),d=n(83),E=n(8),w=n(84),p=n(85),g=n(86),b=n(87),y=n(88),T=E.Y.hf,O=E.Y.vf;T?r=n(89).dG:s=n(91).WG;var m=(_.prototype.apply=function(t){O?(t.bind(new e.LR(o.v.rk,u.Ev,e.HR.VR)),t.bind(new e.LR(o.v.jl,c._F,e.HR.VR))):(t.bind(new e.LR(o.v.rk,u.dv,e.HR.VR)),t.bind(new e.LR(o.v.jl,c.mF,e.HR.VR))),t.bind(new e.LR(o.v.vv,l.CF,e.HR.VR)),t.bind(new e.LR(o.v.Pl,v.GF,e.HR.VR)),t.bind(new e.LR(o.v.p,h.rA,e.HR.VR)),T?t.bind(new e.LR(o.v.jR,r,e.HR.VR)):t.bind(new e.LR(o.v.jR,s,e.HR.VR)),t.bind(new e.LR(o.v.tk,d.VF,e.HR.VR)),"undefined"!=typeof HiveOriginalXMLHttpRequest?t.bind(new e.LR(o.v.FC,HiveOriginalXMLHttpRequest)):t.bind(new e.LR(o.v.FC,XMLHttpRequest)),t.bind(new e.LR(o.v.Xl,f.eU,e.HR.XR)),t.bind(new e.LR(o.v.zl,f.Zl,e.HR.XR)),t.bind(new e.LR(o.v.Jl,a.LS,e.HR.XR)),t.bind(new e.LR(o.v.vk,a.Zl,e.HR.XR)),t.bind(new e.LR(o.v.gk,w.WF,e.HR.XR)),t.bind(new e.LR(o.v.bk,p.zF,e.HR.XR)),t.bind(new e.LR(o.v.nv,g.nG,e.HR.XR)),t.bind(new e.LR(o.v.fk,y.uG,e.HR.XR)),t.bind(new e.LR(o.v.HC,b.rG,e.HR.XR))},_);function _(){}i.DR=m},function(t,i,n){var g=n(22),b=window.hive;void 0===b&&(b=window.hive={}),void 0===b.snapshots&&(b.snapshots={}),b.snapshots.Traffic=function(t){this.reqN=null,this.respFallbackN=null,this.respFallbackErrN=null,this.respP2pN=null,this.reqOtherN=null,this.respFallbackOtherN=null,this.respFallbackOthertErrN=null,this.srcReqN=null,this.srcRespN=null,this.srcRespErrN=null,this.srcReqQt=null,this.srcRespQt=null,this.srcOverQt=null,this.srcOtherReqN=null,this.srcOtherRespN=null,this.srcOtherRespErrN=null,this.srcOtherReqQt=null,this.srcOtherRespQt=null,this.srcOtherOverQt=null,this.p2pSubReqN=null,this.p2pSubRespN=null,this.p2pSubRespPartN=null,this.p2pSubRespErrN=null,this.p2pSubRespExpN=null,this.p2pSubReqQt=null,this.p2pSubRespQt=null,this.p2pDirectQt=null,this.p2pRelayQt=null,this.p2pNatQt=null,this.p2pUdpbQt=null,this.fallAgentRespN=null,this.fallAgentPredHitN=null,this.fallAgentFailedRespN=null,this.fallAgentPredMissN=null,this.fallAgentPredPartialHitN=null,this.fallAgenTrafficSuccessQt=null,this.fallAgenTrafficFailureQt=null,this.p2pAgentPredHitN=null,this.p2pAgentPredMissN=null,this.p2pAgentPredPartialHitN=null,this.p2pAgenTrafficSuccessQt=null,this.p2pAgenTrafficFailureQt=null,this.respP2pOtherN=null,this.lCacheRespN=null,this.lCacheRespQt=null,this.p2pOutSiteLowPrio=null,t&&(void 0!==t.reqN&&null!==t.reqN&&(this.reqN=t.reqN),void 0!==t.respFallbackN&&null!==t.respFallbackN&&(this.respFallbackN=t.respFallbackN),void 0!==t.respFallbackErrN&&null!==t.respFallbackErrN&&(this.respFallbackErrN=t.respFallbackErrN),void 0!==t.respP2pN&&null!==t.respP2pN&&(this.respP2pN=t.respP2pN),void 0!==t.reqOtherN&&null!==t.reqOtherN&&(this.reqOtherN=t.reqOtherN),void 0!==t.respFallbackOtherN&&null!==t.respFallbackOtherN&&(this.respFallbackOtherN=t.respFallbackOtherN),void 0!==t.respFallbackOthertErrN&&null!==t.respFallbackOthertErrN&&(this.respFallbackOthertErrN=t.respFallbackOthertErrN),void 0!==t.srcReqN&&null!==t.srcReqN&&(this.srcReqN=t.srcReqN),void 0!==t.srcRespN&&null!==t.srcRespN&&(this.srcRespN=t.srcRespN),void 0!==t.srcRespErrN&&null!==t.srcRespErrN&&(this.srcRespErrN=t.srcRespErrN),void 0!==t.srcReqQt&&null!==t.srcReqQt&&(this.srcReqQt=t.srcReqQt),void 0!==t.srcRespQt&&null!==t.srcRespQt&&(this.srcRespQt=t.srcRespQt),void 0!==t.srcOverQt&&null!==t.srcOverQt&&(this.srcOverQt=t.srcOverQt),void 0!==t.srcOtherReqN&&null!==t.srcOtherReqN&&(this.srcOtherReqN=t.srcOtherReqN),void 0!==t.srcOtherRespN&&null!==t.srcOtherRespN&&(this.srcOtherRespN=t.srcOtherRespN),void 0!==t.srcOtherRespErrN&&null!==t.srcOtherRespErrN&&(this.srcOtherRespErrN=t.srcOtherRespErrN),void 0!==t.srcOtherReqQt&&null!==t.srcOtherReqQt&&(this.srcOtherReqQt=t.srcOtherReqQt),void 0!==t.srcOtherRespQt&&null!==t.srcOtherRespQt&&(this.srcOtherRespQt=t.srcOtherRespQt),void 0!==t.srcOtherOverQt&&null!==t.srcOtherOverQt&&(this.srcOtherOverQt=t.srcOtherOverQt),void 0!==t.p2pSubReqN&&null!==t.p2pSubReqN&&(this.p2pSubReqN=t.p2pSubReqN),void 0!==t.p2pSubRespN&&null!==t.p2pSubRespN&&(this.p2pSubRespN=t.p2pSubRespN),void 0!==t.p2pSubRespPartN&&null!==t.p2pSubRespPartN&&(this.p2pSubRespPartN=t.p2pSubRespPartN),void 0!==t.p2pSubRespErrN&&null!==t.p2pSubRespErrN&&(this.p2pSubRespErrN=t.p2pSubRespErrN),void 0!==t.p2pSubRespExpN&&null!==t.p2pSubRespExpN&&(this.p2pSubRespExpN=t.p2pSubRespExpN),void 0!==t.p2pSubReqQt&&null!==t.p2pSubReqQt&&(this.p2pSubReqQt=t.p2pSubReqQt),void 0!==t.p2pSubRespQt&&null!==t.p2pSubRespQt&&(this.p2pSubRespQt=t.p2pSubRespQt),void 0!==t.p2pDirectQt&&null!==t.p2pDirectQt&&(this.p2pDirectQt=t.p2pDirectQt),void 0!==t.p2pRelayQt&&null!==t.p2pRelayQt&&(this.p2pRelayQt=t.p2pRelayQt),void 0!==t.p2pNatQt&&null!==t.p2pNatQt&&(this.p2pNatQt=t.p2pNatQt),void 0!==t.p2pUdpbQt&&null!==t.p2pUdpbQt&&(this.p2pUdpbQt=t.p2pUdpbQt),void 0!==t.fallAgentRespN&&null!==t.fallAgentRespN&&(this.fallAgentRespN=t.fallAgentRespN),void 0!==t.fallAgentPredHitN&&null!==t.fallAgentPredHitN&&(this.fallAgentPredHitN=t.fallAgentPredHitN),void 0!==t.fallAgentFailedRespN&&null!==t.fallAgentFailedRespN&&(this.fallAgentFailedRespN=t.fallAgentFailedRespN),void 0!==t.fallAgentPredMissN&&null!==t.fallAgentPredMissN&&(this.fallAgentPredMissN=t.fallAgentPredMissN),void 0!==t.fallAgentPredPartialHitN&&null!==t.fallAgentPredPartialHitN&&(this.fallAgentPredPartialHitN=t.fallAgentPredPartialHitN),void 0!==t.fallAgenTrafficSuccessQt&&null!==t.fallAgenTrafficSuccessQt&&(this.fallAgenTrafficSuccessQt=t.fallAgenTrafficSuccessQt),void 0!==t.fallAgenTrafficFailureQt&&null!==t.fallAgenTrafficFailureQt&&(this.fallAgenTrafficFailureQt=t.fallAgenTrafficFailureQt),void 0!==t.p2pAgentPredHitN&&null!==t.p2pAgentPredHitN&&(this.p2pAgentPredHitN=t.p2pAgentPredHitN),void 0!==t.p2pAgentPredMissN&&null!==t.p2pAgentPredMissN&&(this.p2pAgentPredMissN=t.p2pAgentPredMissN),void 0!==t.p2pAgentPredPartialHitN&&null!==t.p2pAgentPredPartialHitN&&(this.p2pAgentPredPartialHitN=t.p2pAgentPredPartialHitN),void 0!==t.p2pAgenTrafficSuccessQt&&null!==t.p2pAgenTrafficSuccessQt&&(this.p2pAgenTrafficSuccessQt=t.p2pAgenTrafficSuccessQt),void 0!==t.p2pAgenTrafficFailureQt&&null!==t.p2pAgenTrafficFailureQt&&(this.p2pAgenTrafficFailureQt=t.p2pAgenTrafficFailureQt),void 0!==t.respP2pOtherN&&null!==t.respP2pOtherN&&(this.respP2pOtherN=t.respP2pOtherN),void 0!==t.lCacheRespN&&null!==t.lCacheRespN&&(this.lCacheRespN=t.lCacheRespN),void 0!==t.lCacheRespQt&&null!==t.lCacheRespQt&&(this.lCacheRespQt=t.lCacheRespQt),void 0!==t.p2pOutSiteLowPrio&&null!==t.p2pOutSiteLowPrio&&(this.p2pOutSiteLowPrio=t.p2pOutSiteLowPrio))},b.snapshots.Traffic.prototype={},b.snapshots.Traffic.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.reqN=t.zE().value:t.XE(n);break;case 2:n==g.Type.DOUBLE?this.respFallbackN=t.Rp().value:t.XE(n);break;case 3:n==g.Type.I32?this.respFallbackErrN=t.zE().value:t.XE(n);break;case 4:n==g.Type.DOUBLE?this.respP2pN=t.Rp().value:t.XE(n);break;case 5:n==g.Type.I32?this.reqOtherN=t.zE().value:t.XE(n);break;case 6:n==g.Type.I32?this.respFallbackOtherN=t.zE().value:t.XE(n);break;case 7:n==g.Type.I32?this.respFallbackOthertErrN=t.zE().value:t.XE(n);break;case 8:n==g.Type.I32?this.srcReqN=t.zE().value:t.XE(n);break;case 9:n==g.Type.I32?this.srcRespN=t.zE().value:t.XE(n);break;case 10:n==g.Type.I32?this.srcRespErrN=t.zE().value:t.XE(n);break;case 11:n==g.Type.I64?this.srcReqQt=t._p().value:t.XE(n);break;case 12:n==g.Type.I64?this.srcRespQt=t._p().value:t.XE(n);break;case 13:n==g.Type.I64?this.srcOverQt=t._p().value:t.XE(n);break;case 14:n==g.Type.I32?this.srcOtherReqN=t.zE().value:t.XE(n);break;case 15:n==g.Type.I32?this.srcOtherRespN=t.zE().value:t.XE(n);break;case 16:n==g.Type.I32?this.srcOtherRespErrN=t.zE().value:t.XE(n);break;case 17:n==g.Type.I64?this.srcOtherReqQt=t._p().value:t.XE(n);break;case 18:n==g.Type.I64?this.srcOtherRespQt=t._p().value:t.XE(n);break;case 19:n==g.Type.I64?this.srcOtherOverQt=t._p().value:t.XE(n);break;case 20:n==g.Type.I32?this.p2pSubReqN=t.zE().value:t.XE(n);break;case 21:n==g.Type.I32?this.p2pSubRespN=t.zE().value:t.XE(n);break;case 22:n==g.Type.DOUBLE?this.p2pSubRespPartN=t.Rp().value:t.XE(n);break;case 23:n==g.Type.DOUBLE?this.p2pSubRespErrN=t.Rp().value:t.XE(n);break;case 24:n==g.Type.I32?this.p2pSubRespExpN=t.zE().value:t.XE(n);break;case 25:n==g.Type.I64?this.p2pSubReqQt=t._p().value:t.XE(n);break;case 26:n==g.Type.I64?this.p2pSubRespQt=t._p().value:t.XE(n);break;case 27:n==g.Type.I64?this.p2pDirectQt=t._p().value:t.XE(n);break;case 28:n==g.Type.I64?this.p2pRelayQt=t._p().value:t.XE(n);break;case 29:n==g.Type.I64?this.p2pNatQt=t._p().value:t.XE(n);break;case 30:n==g.Type.I64?this.p2pUdpbQt=t._p().value:t.XE(n);break;case 31:n==g.Type.I32?this.fallAgentRespN=t.zE().value:t.XE(n);break;case 32:n==g.Type.I32?this.fallAgentPredHitN=t.zE().value:t.XE(n);break;case 33:n==g.Type.I32?this.fallAgentFailedRespN=t.zE().value:t.XE(n);break;case 34:n==g.Type.I32?this.fallAgentPredMissN=t.zE().value:t.XE(n);break;case 35:n==g.Type.I32?this.fallAgentPredPartialHitN=t.zE().value:t.XE(n);break;case 36:n==g.Type.I64?this.fallAgenTrafficSuccessQt=t._p().value:t.XE(n);break;case 37:n==g.Type.I64?this.fallAgenTrafficFailureQt=t._p().value:t.XE(n);break;case 38:n==g.Type.I32?this.p2pAgentPredHitN=t.zE().value:t.XE(n);break;case 39:n==g.Type.I32?this.p2pAgentPredMissN=t.zE().value:t.XE(n);break;case 40:n==g.Type.I32?this.p2pAgentPredPartialHitN=t.zE().value:t.XE(n);break;case 41:n==g.Type.I64?this.p2pAgenTrafficSuccessQt=t._p().value:t.XE(n);break;case 42:n==g.Type.I64?this.p2pAgenTrafficFailureQt=t._p().value:t.XE(n);break;case 43:n==g.Type.I32?this.respP2pOtherN=t.zE().value:t.XE(n);break;case 44:n==g.Type.I32?this.lCacheRespN=t.zE().value:t.XE(n);break;case 45:n==g.Type.I64?this.lCacheRespQt=t._p().value:t.XE(n);break;case 46:n==g.Type.I64?this.p2pOutSiteLowPrio=t._p().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.Traffic.prototype.write=function(t){t.tw("Traffic"),null!==this.reqN&&void 0!==this.reqN&&(t.iw("reqN",g.Type.I32,1),t.sw(this.reqN),t.rw()),null!==this.respFallbackN&&void 0!==this.respFallbackN&&(t.iw("respFallbackN",g.Type.DOUBLE,2),t.sp(this.respFallbackN),t.rw()),null!==this.respFallbackErrN&&void 0!==this.respFallbackErrN&&(t.iw("respFallbackErrN",g.Type.I32,3),t.sw(this.respFallbackErrN),t.rw()),null!==this.respP2pN&&void 0!==this.respP2pN&&(t.iw("respP2pN",g.Type.DOUBLE,4),t.sp(this.respP2pN),t.rw()),null!==this.reqOtherN&&void 0!==this.reqOtherN&&(t.iw("reqOtherN",g.Type.I32,5),t.sw(this.reqOtherN),t.rw()),null!==this.respFallbackOtherN&&void 0!==this.respFallbackOtherN&&(t.iw("respFallbackOtherN",g.Type.I32,6),t.sw(this.respFallbackOtherN),t.rw()),null!==this.respFallbackOthertErrN&&void 0!==this.respFallbackOthertErrN&&(t.iw("respFallbackOthertErrN",g.Type.I32,7),t.sw(this.respFallbackOthertErrN),t.rw()),null!==this.srcReqN&&void 0!==this.srcReqN&&(t.iw("srcReqN",g.Type.I32,8),t.sw(this.srcReqN),t.rw()),null!==this.srcRespN&&void 0!==this.srcRespN&&(t.iw("srcRespN",g.Type.I32,9),t.sw(this.srcRespN),t.rw()),null!==this.srcRespErrN&&void 0!==this.srcRespErrN&&(t.iw("srcRespErrN",g.Type.I32,10),t.sw(this.srcRespErrN),t.rw()),null!==this.srcReqQt&&void 0!==this.srcReqQt&&(t.iw("srcReqQt",g.Type.I64,11),t.rp(this.srcReqQt),t.rw()),null!==this.srcRespQt&&void 0!==this.srcRespQt&&(t.iw("srcRespQt",g.Type.I64,12),t.rp(this.srcRespQt),t.rw()),null!==this.srcOverQt&&void 0!==this.srcOverQt&&(t.iw("srcOverQt",g.Type.I64,13),t.rp(this.srcOverQt),t.rw()),null!==this.srcOtherReqN&&void 0!==this.srcOtherReqN&&(t.iw("srcOtherReqN",g.Type.I32,14),t.sw(this.srcOtherReqN),t.rw()),null!==this.srcOtherRespN&&void 0!==this.srcOtherRespN&&(t.iw("srcOtherRespN",g.Type.I32,15),t.sw(this.srcOtherRespN),t.rw()),null!==this.srcOtherRespErrN&&void 0!==this.srcOtherRespErrN&&(t.iw("srcOtherRespErrN",g.Type.I32,16),t.sw(this.srcOtherRespErrN),t.rw()),null!==this.srcOtherReqQt&&void 0!==this.srcOtherReqQt&&(t.iw("srcOtherReqQt",g.Type.I64,17),t.rp(this.srcOtherReqQt),t.rw()),null!==this.srcOtherRespQt&&void 0!==this.srcOtherRespQt&&(t.iw("srcOtherRespQt",g.Type.I64,18),t.rp(this.srcOtherRespQt),t.rw()),null!==this.srcOtherOverQt&&void 0!==this.srcOtherOverQt&&(t.iw("srcOtherOverQt",g.Type.I64,19),t.rp(this.srcOtherOverQt),t.rw()),null!==this.p2pSubReqN&&void 0!==this.p2pSubReqN&&(t.iw("p2pSubReqN",g.Type.I32,20),t.sw(this.p2pSubReqN),t.rw()),null!==this.p2pSubRespN&&void 0!==this.p2pSubRespN&&(t.iw("p2pSubRespN",g.Type.I32,21),t.sw(this.p2pSubRespN),t.rw()),null!==this.p2pSubRespPartN&&void 0!==this.p2pSubRespPartN&&(t.iw("p2pSubRespPartN",g.Type.DOUBLE,22),t.sp(this.p2pSubRespPartN),t.rw()),null!==this.p2pSubRespErrN&&void 0!==this.p2pSubRespErrN&&(t.iw("p2pSubRespErrN",g.Type.DOUBLE,23),t.sp(this.p2pSubRespErrN),t.rw()),null!==this.p2pSubRespExpN&&void 0!==this.p2pSubRespExpN&&(t.iw("p2pSubRespExpN",g.Type.I32,24),t.sw(this.p2pSubRespExpN),t.rw()),null!==this.p2pSubReqQt&&void 0!==this.p2pSubReqQt&&(t.iw("p2pSubReqQt",g.Type.I64,25),t.rp(this.p2pSubReqQt),t.rw()),null!==this.p2pSubRespQt&&void 0!==this.p2pSubRespQt&&(t.iw("p2pSubRespQt",g.Type.I64,26),t.rp(this.p2pSubRespQt),t.rw()),null!==this.p2pDirectQt&&void 0!==this.p2pDirectQt&&(t.iw("p2pDirectQt",g.Type.I64,27),t.rp(this.p2pDirectQt),t.rw()),null!==this.p2pRelayQt&&void 0!==this.p2pRelayQt&&(t.iw("p2pRelayQt",g.Type.I64,28),t.rp(this.p2pRelayQt),t.rw()),null!==this.p2pNatQt&&void 0!==this.p2pNatQt&&(t.iw("p2pNatQt",g.Type.I64,29),t.rp(this.p2pNatQt),t.rw()),null!==this.p2pUdpbQt&&void 0!==this.p2pUdpbQt&&(t.iw("p2pUdpbQt",g.Type.I64,30),t.rp(this.p2pUdpbQt),t.rw()),null!==this.fallAgentRespN&&void 0!==this.fallAgentRespN&&(t.iw("fallAgentRespN",g.Type.I32,31),t.sw(this.fallAgentRespN),t.rw()),null!==this.fallAgentPredHitN&&void 0!==this.fallAgentPredHitN&&(t.iw("fallAgentPredHitN",g.Type.I32,32),t.sw(this.fallAgentPredHitN),t.rw()),null!==this.fallAgentFailedRespN&&void 0!==this.fallAgentFailedRespN&&(t.iw("fallAgentFailedRespN",g.Type.I32,33),t.sw(this.fallAgentFailedRespN),t.rw()),null!==this.fallAgentPredMissN&&void 0!==this.fallAgentPredMissN&&(t.iw("fallAgentPredMissN",g.Type.I32,34),t.sw(this.fallAgentPredMissN),t.rw()),null!==this.fallAgentPredPartialHitN&&void 0!==this.fallAgentPredPartialHitN&&(t.iw("fallAgentPredPartialHitN",g.Type.I32,35),t.sw(this.fallAgentPredPartialHitN),t.rw()),null!==this.fallAgenTrafficSuccessQt&&void 0!==this.fallAgenTrafficSuccessQt&&(t.iw("fallAgenTrafficSuccessQt",g.Type.I64,36),t.rp(this.fallAgenTrafficSuccessQt),t.rw()),null!==this.fallAgenTrafficFailureQt&&void 0!==this.fallAgenTrafficFailureQt&&(t.iw("fallAgenTrafficFailureQt",g.Type.I64,37),t.rp(this.fallAgenTrafficFailureQt),t.rw()),null!==this.p2pAgentPredHitN&&void 0!==this.p2pAgentPredHitN&&(t.iw("p2pAgentPredHitN",g.Type.I32,38),t.sw(this.p2pAgentPredHitN),t.rw()),null!==this.p2pAgentPredMissN&&void 0!==this.p2pAgentPredMissN&&(t.iw("p2pAgentPredMissN",g.Type.I32,39),t.sw(this.p2pAgentPredMissN),t.rw()),null!==this.p2pAgentPredPartialHitN&&void 0!==this.p2pAgentPredPartialHitN&&(t.iw("p2pAgentPredPartialHitN",g.Type.I32,40),t.sw(this.p2pAgentPredPartialHitN),t.rw()),null!==this.p2pAgenTrafficSuccessQt&&void 0!==this.p2pAgenTrafficSuccessQt&&(t.iw("p2pAgenTrafficSuccessQt",g.Type.I64,41),t.rp(this.p2pAgenTrafficSuccessQt),t.rw()),null!==this.p2pAgenTrafficFailureQt&&void 0!==this.p2pAgenTrafficFailureQt&&(t.iw("p2pAgenTrafficFailureQt",g.Type.I64,42),t.rp(this.p2pAgenTrafficFailureQt),t.rw()),null!==this.respP2pOtherN&&void 0!==this.respP2pOtherN&&(t.iw("respP2pOtherN",g.Type.I32,43),t.sw(this.respP2pOtherN),t.rw()),null!==this.lCacheRespN&&void 0!==this.lCacheRespN&&(t.iw("lCacheRespN",g.Type.I32,44),t.sw(this.lCacheRespN),t.rw()),null!==this.lCacheRespQt&&void 0!==this.lCacheRespQt&&(t.iw("lCacheRespQt",g.Type.I64,45),t.rp(this.lCacheRespQt),t.rw()),null!==this.p2pOutSiteLowPrio&&void 0!==this.p2pOutSiteLowPrio&&(t.iw("p2pOutSiteLowPrio",g.Type.I64,46),t.rp(this.p2pOutSiteLowPrio),t.rw()),t.ew(),t.hw()},b.snapshots.FragmentMetadata=function(t){this.url=null,this.size=null,this.duration=null,this.qualityLevelId=null,this.contentType=null,t&&(void 0!==t.url&&null!==t.url&&(this.url=t.url),void 0!==t.size&&null!==t.size&&(this.size=t.size),void 0!==t.duration&&null!==t.duration&&(this.duration=t.duration),void 0!==t.qualityLevelId&&null!==t.qualityLevelId&&(this.qualityLevelId=t.qualityLevelId),void 0!==t.contentType&&null!==t.contentType&&(this.contentType=t.contentType))},b.snapshots.FragmentMetadata.prototype={},b.snapshots.FragmentMetadata.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.STRING?this.url=t.$E().value:t.XE(n);break;case 2:n==g.Type.I32?this.size=t.zE().value:t.XE(n);break;case 3:n==g.Type.I32?this.duration=t.zE().value:t.XE(n);break;case 4:n==g.Type.STRING?this.qualityLevelId=t.$E().value:t.XE(n);break;case 5:n==g.Type.I32?this.contentType=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.FragmentMetadata.prototype.write=function(t){t.tw("FragmentMetadata"),null!==this.url&&void 0!==this.url&&(t.iw("url",g.Type.STRING,1),t.nw(this.url),t.rw()),null!==this.size&&void 0!==this.size&&(t.iw("size",g.Type.I32,2),t.sw(this.size),t.rw()),null!==this.duration&&void 0!==this.duration&&(t.iw("duration",g.Type.I32,3),t.sw(this.duration),t.rw()),null!==this.qualityLevelId&&void 0!==this.qualityLevelId&&(t.iw("qualityLevelId",g.Type.STRING,4),t.nw(this.qualityLevelId),t.rw()),null!==this.contentType&&void 0!==this.contentType&&(t.iw("contentType",g.Type.I32,5),t.sw(this.contentType),t.rw()),t.ew(),t.hw()},b.snapshots.QualityLevel=function(t){this.id=null,this.bitrates=null,this.width=null,this.height=null,this.label=null,t&&(void 0!==t.id&&null!==t.id&&(this.id=t.id),void 0!==t.bitrates&&null!==t.bitrates&&(this.bitrates=t.bitrates),void 0!==t.width&&null!==t.width&&(this.width=t.width),void 0!==t.height&&null!==t.height&&(this.height=t.height),void 0!==t.label&&null!==t.label&&(this.label=t.label))},b.snapshots.QualityLevel.prototype={},b.snapshots.QualityLevel.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.STRING?this.id=t.$E().value:t.XE(n);break;case 2:if(n==g.Type.LIST){var s,e;this.bitrates=[];(e=t.wp()).pp,s=e.size;for(var h=0;h<s;++h){var o;o=t.zE().value,this.bitrates.push(o)}t.gp()}else t.XE(n);break;case 3:n==g.Type.I32?this.width=t.zE().value:t.XE(n);break;case 4:n==g.Type.I32?this.height=t.zE().value:t.XE(n);break;case 5:n==g.Type.STRING?this.label=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.QualityLevel.prototype.write=function(t){if(t.tw("QualityLevel"),null!==this.id&&void 0!==this.id&&(t.iw("id",g.Type.STRING,1),t.nw(this.id),t.rw()),null!==this.bitrates&&void 0!==this.bitrates){for(var i in t.iw("bitrates",g.Type.LIST,2),t.$w(g.Type.I32,this.bitrates.length),this.bitrates)this.bitrates.hasOwnProperty(i)&&(i=this.bitrates[i],t.sw(i));t.Xw(),t.rw()}null!==this.width&&void 0!==this.width&&(t.iw("width",g.Type.I32,3),t.sw(this.width),t.rw()),null!==this.height&&void 0!==this.height&&(t.iw("height",g.Type.I32,4),t.sw(this.height),t.rw()),null!==this.label&&void 0!==this.label&&(t.iw("label",g.Type.STRING,5),t.nw(this.label),t.rw()),t.ew(),t.hw()},b.snapshots.Metrics=function(t){this.upBW=null,this.downBW=null,this.memN=null,this.prtInN=null,this.prtOutN=null,this.initVideoBufQt=null,this.videoAvgBufQt=null,this.videoBufQt=null,this.videoBufN=null,this.initAudioBufQt=null,this.audioAvgBufQt=null,this.audioBufQt=null,this.audioBufN=null,this.bitrateUpN=null,this.bitrateDwnN=null,this.delay=null,this.delayEnforcement=null,this.lookupReqEstablished=null,this.lookupReqAccept=null,this.fallbackAvgTp=null,this.srcThroughput=null,this.diskReadTimeout=null,this.diskReadRate=null,this.diskStoreRate=null,this.diskRemoveRate=null,this.diskCacheSize=null,this.clientBufferMs=null,this.lookupTotal=null,this.lookupNotFound=null,this.lookupFailed=null,this.lookupLatency=null,this.trackerFailed=null,this.trackerLatency=null,this.snapshotFailed=null,this.snapshotLatency=null,this.sourceLatency=null,t&&(void 0!==t.upBW&&null!==t.upBW&&(this.upBW=t.upBW),void 0!==t.downBW&&null!==t.downBW&&(this.downBW=t.downBW),void 0!==t.memN&&null!==t.memN&&(this.memN=t.memN),void 0!==t.prtInN&&null!==t.prtInN&&(this.prtInN=t.prtInN),void 0!==t.prtOutN&&null!==t.prtOutN&&(this.prtOutN=t.prtOutN),void 0!==t.initVideoBufQt&&null!==t.initVideoBufQt&&(this.initVideoBufQt=t.initVideoBufQt),void 0!==t.videoAvgBufQt&&null!==t.videoAvgBufQt&&(this.videoAvgBufQt=t.videoAvgBufQt),void 0!==t.videoBufQt&&null!==t.videoBufQt&&(this.videoBufQt=t.videoBufQt),void 0!==t.videoBufN&&null!==t.videoBufN&&(this.videoBufN=t.videoBufN),void 0!==t.initAudioBufQt&&null!==t.initAudioBufQt&&(this.initAudioBufQt=t.initAudioBufQt),void 0!==t.audioAvgBufQt&&null!==t.audioAvgBufQt&&(this.audioAvgBufQt=t.audioAvgBufQt),void 0!==t.audioBufQt&&null!==t.audioBufQt&&(this.audioBufQt=t.audioBufQt),void 0!==t.audioBufN&&null!==t.audioBufN&&(this.audioBufN=t.audioBufN),void 0!==t.bitrateUpN&&null!==t.bitrateUpN&&(this.bitrateUpN=t.bitrateUpN),void 0!==t.bitrateDwnN&&null!==t.bitrateDwnN&&(this.bitrateDwnN=t.bitrateDwnN),void 0!==t.delay&&null!==t.delay&&(this.delay=t.delay),void 0!==t.delayEnforcement&&null!==t.delayEnforcement&&(this.delayEnforcement=t.delayEnforcement),void 0!==t.lookupReqEstablished&&null!==t.lookupReqEstablished&&(this.lookupReqEstablished=t.lookupReqEstablished),void 0!==t.lookupReqAccept&&null!==t.lookupReqAccept&&(this.lookupReqAccept=t.lookupReqAccept),void 0!==t.fallbackAvgTp&&null!==t.fallbackAvgTp&&(this.fallbackAvgTp=t.fallbackAvgTp),void 0!==t.srcThroughput&&null!==t.srcThroughput&&(this.srcThroughput=t.srcThroughput),void 0!==t.diskReadTimeout&&null!==t.diskReadTimeout&&(this.diskReadTimeout=t.diskReadTimeout),void 0!==t.diskReadRate&&null!==t.diskReadRate&&(this.diskReadRate=t.diskReadRate),void 0!==t.diskStoreRate&&null!==t.diskStoreRate&&(this.diskStoreRate=t.diskStoreRate),void 0!==t.diskRemoveRate&&null!==t.diskRemoveRate&&(this.diskRemoveRate=t.diskRemoveRate),void 0!==t.diskCacheSize&&null!==t.diskCacheSize&&(this.diskCacheSize=t.diskCacheSize),void 0!==t.clientBufferMs&&null!==t.clientBufferMs&&(this.clientBufferMs=t.clientBufferMs),void 0!==t.lookupTotal&&null!==t.lookupTotal&&(this.lookupTotal=t.lookupTotal),void 0!==t.lookupNotFound&&null!==t.lookupNotFound&&(this.lookupNotFound=t.lookupNotFound),void 0!==t.lookupFailed&&null!==t.lookupFailed&&(this.lookupFailed=t.lookupFailed),void 0!==t.lookupLatency&&null!==t.lookupLatency&&(this.lookupLatency=t.lookupLatency),void 0!==t.trackerFailed&&null!==t.trackerFailed&&(this.trackerFailed=t.trackerFailed),void 0!==t.trackerLatency&&null!==t.trackerLatency&&(this.trackerLatency=t.trackerLatency),void 0!==t.snapshotFailed&&null!==t.snapshotFailed&&(this.snapshotFailed=t.snapshotFailed),void 0!==t.snapshotLatency&&null!==t.snapshotLatency&&(this.snapshotLatency=t.snapshotLatency),void 0!==t.sourceLatency&&null!==t.sourceLatency&&(this.sourceLatency=t.sourceLatency))},b.snapshots.Metrics.prototype={},b.snapshots.Metrics.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.upBW=t.zE().value:t.XE(n);break;case 2:n==g.Type.I32?this.downBW=t.zE().value:t.XE(n);break;case 3:n==g.Type.I32?this.memN=t.zE().value:t.XE(n);break;case 4:n==g.Type.I32?this.prtInN=t.zE().value:t.XE(n);break;case 5:n==g.Type.I32?this.prtOutN=t.zE().value:t.XE(n);break;case 6:n==g.Type.I64?this.initVideoBufQt=t._p().value:t.XE(n);break;case 7:n==g.Type.DOUBLE?this.videoAvgBufQt=t.Rp().value:t.XE(n);break;case 8:n==g.Type.I64?this.videoBufQt=t._p().value:t.XE(n);break;case 9:n==g.Type.I32?this.videoBufN=t.zE().value:t.XE(n);break;case 10:n==g.Type.I32?this.initAudioBufQt=t.zE().value:t.XE(n);break;case 11:n==g.Type.DOUBLE?this.audioAvgBufQt=t.Rp().value:t.XE(n);break;case 12:n==g.Type.I64?this.audioBufQt=t._p().value:t.XE(n);break;case 13:n==g.Type.I32?this.audioBufN=t.zE().value:t.XE(n);break;case 14:n==g.Type.I32?this.bitrateUpN=t.zE().value:t.XE(n);break;case 15:n==g.Type.I32?this.bitrateDwnN=t.zE().value:t.XE(n);break;case 16:n==g.Type.I32?this.delay=t.zE().value:t.XE(n);break;case 17:n==g.Type.I32?this.delayEnforcement=t.zE().value:t.XE(n);break;case 18:n==g.Type.I32?this.lookupReqEstablished=t.zE().value:t.XE(n);break;case 19:n==g.Type.I32?this.lookupReqAccept=t.zE().value:t.XE(n);break;case 20:n==g.Type.DOUBLE?this.fallbackAvgTp=t.Rp().value:t.XE(n);break;case 21:n==g.Type.DOUBLE?this.srcThroughput=t.Rp().value:t.XE(n);break;case 22:n==g.Type.I32?this.diskReadTimeout=t.zE().value:t.XE(n);break;case 23:n==g.Type.DOUBLE?this.diskReadRate=t.Rp().value:t.XE(n);break;case 24:n==g.Type.DOUBLE?this.diskStoreRate=t.Rp().value:t.XE(n);break;case 25:n==g.Type.DOUBLE?this.diskRemoveRate=t.Rp().value:t.XE(n);break;case 26:n==g.Type.I64?this.diskCacheSize=t._p().value:t.XE(n);break;case 27:n==g.Type.I32?this.clientBufferMs=t.zE().value:t.XE(n);break;case 28:n==g.Type.I32?this.lookupTotal=t.zE().value:t.XE(n);break;case 29:n==g.Type.I32?this.lookupNotFound=t.zE().value:t.XE(n);break;case 30:n==g.Type.I32?this.lookupFailed=t.zE().value:t.XE(n);break;case 31:n==g.Type.I32?this.lookupLatency=t.zE().value:t.XE(n);break;case 32:n==g.Type.I32?this.trackerFailed=t.zE().value:t.XE(n);break;case 33:n==g.Type.I32?this.trackerLatency=t.zE().value:t.XE(n);break;case 34:n==g.Type.I32?this.snapshotFailed=t.zE().value:t.XE(n);break;case 35:n==g.Type.I32?this.snapshotLatency=t.zE().value:t.XE(n);break;case 36:n==g.Type.I32?this.sourceLatency=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.Metrics.prototype.write=function(t){t.tw("Metrics"),null!==this.upBW&&void 0!==this.upBW&&(t.iw("upBW",g.Type.I32,1),t.sw(this.upBW),t.rw()),null!==this.downBW&&void 0!==this.downBW&&(t.iw("downBW",g.Type.I32,2),t.sw(this.downBW),t.rw()),null!==this.memN&&void 0!==this.memN&&(t.iw("memN",g.Type.I32,3),t.sw(this.memN),t.rw()),null!==this.prtInN&&void 0!==this.prtInN&&(t.iw("prtInN",g.Type.I32,4),t.sw(this.prtInN),t.rw()),null!==this.prtOutN&&void 0!==this.prtOutN&&(t.iw("prtOutN",g.Type.I32,5),t.sw(this.prtOutN),t.rw()),null!==this.initVideoBufQt&&void 0!==this.initVideoBufQt&&(t.iw("initVideoBufQt",g.Type.I64,6),t.rp(this.initVideoBufQt),t.rw()),null!==this.videoAvgBufQt&&void 0!==this.videoAvgBufQt&&(t.iw("videoAvgBufQt",g.Type.DOUBLE,7),t.sp(this.videoAvgBufQt),t.rw()),null!==this.videoBufQt&&void 0!==this.videoBufQt&&(t.iw("videoBufQt",g.Type.I64,8),t.rp(this.videoBufQt),t.rw()),null!==this.videoBufN&&void 0!==this.videoBufN&&(t.iw("videoBufN",g.Type.I32,9),t.sw(this.videoBufN),t.rw()),null!==this.initAudioBufQt&&void 0!==this.initAudioBufQt&&(t.iw("initAudioBufQt",g.Type.I32,10),t.sw(this.initAudioBufQt),t.rw()),null!==this.audioAvgBufQt&&void 0!==this.audioAvgBufQt&&(t.iw("audioAvgBufQt",g.Type.DOUBLE,11),t.sp(this.audioAvgBufQt),t.rw()),null!==this.audioBufQt&&void 0!==this.audioBufQt&&(t.iw("audioBufQt",g.Type.I64,12),t.rp(this.audioBufQt),t.rw()),null!==this.audioBufN&&void 0!==this.audioBufN&&(t.iw("audioBufN",g.Type.I32,13),t.sw(this.audioBufN),t.rw()),null!==this.bitrateUpN&&void 0!==this.bitrateUpN&&(t.iw("bitrateUpN",g.Type.I32,14),t.sw(this.bitrateUpN),t.rw()),null!==this.bitrateDwnN&&void 0!==this.bitrateDwnN&&(t.iw("bitrateDwnN",g.Type.I32,15),t.sw(this.bitrateDwnN),t.rw()),null!==this.delay&&void 0!==this.delay&&(t.iw("delay",g.Type.I32,16),t.sw(this.delay),t.rw()),null!==this.delayEnforcement&&void 0!==this.delayEnforcement&&(t.iw("delayEnforcement",g.Type.I32,17),t.sw(this.delayEnforcement),t.rw()),null!==this.lookupReqEstablished&&void 0!==this.lookupReqEstablished&&(t.iw("lookupReqEstablished",g.Type.I32,18),t.sw(this.lookupReqEstablished),t.rw()),null!==this.lookupReqAccept&&void 0!==this.lookupReqAccept&&(t.iw("lookupReqAccept",g.Type.I32,19),t.sw(this.lookupReqAccept),t.rw()),null!==this.fallbackAvgTp&&void 0!==this.fallbackAvgTp&&(t.iw("fallbackAvgTp",g.Type.DOUBLE,20),t.sp(this.fallbackAvgTp),t.rw()),null!==this.srcThroughput&&void 0!==this.srcThroughput&&(t.iw("srcThroughput",g.Type.DOUBLE,21),t.sp(this.srcThroughput),t.rw()),null!==this.diskReadTimeout&&void 0!==this.diskReadTimeout&&(t.iw("diskReadTimeout",g.Type.I32,22),t.sw(this.diskReadTimeout),t.rw()),null!==this.diskReadRate&&void 0!==this.diskReadRate&&(t.iw("diskReadRate",g.Type.DOUBLE,23),t.sp(this.diskReadRate),t.rw()),null!==this.diskStoreRate&&void 0!==this.diskStoreRate&&(t.iw("diskStoreRate",g.Type.DOUBLE,24),t.sp(this.diskStoreRate),t.rw()),null!==this.diskRemoveRate&&void 0!==this.diskRemoveRate&&(t.iw("diskRemoveRate",g.Type.DOUBLE,25),t.sp(this.diskRemoveRate),t.rw()),null!==this.diskCacheSize&&void 0!==this.diskCacheSize&&(t.iw("diskCacheSize",g.Type.I64,26),t.rp(this.diskCacheSize),t.rw()),null!==this.clientBufferMs&&void 0!==this.clientBufferMs&&(t.iw("clientBufferMs",g.Type.I32,27),t.sw(this.clientBufferMs),t.rw()),null!==this.lookupTotal&&void 0!==this.lookupTotal&&(t.iw("lookupTotal",g.Type.I32,28),t.sw(this.lookupTotal),t.rw()),null!==this.lookupNotFound&&void 0!==this.lookupNotFound&&(t.iw("lookupNotFound",g.Type.I32,29),t.sw(this.lookupNotFound),t.rw()),null!==this.lookupFailed&&void 0!==this.lookupFailed&&(t.iw("lookupFailed",g.Type.I32,30),t.sw(this.lookupFailed),t.rw()),null!==this.lookupLatency&&void 0!==this.lookupLatency&&(t.iw("lookupLatency",g.Type.I32,31),t.sw(this.lookupLatency),t.rw()),null!==this.trackerFailed&&void 0!==this.trackerFailed&&(t.iw("trackerFailed",g.Type.I32,32),t.sw(this.trackerFailed),t.rw()),null!==this.trackerLatency&&void 0!==this.trackerLatency&&(t.iw("trackerLatency",g.Type.I32,33),t.sw(this.trackerLatency),t.rw()),null!==this.snapshotFailed&&void 0!==this.snapshotFailed&&(t.iw("snapshotFailed",g.Type.I32,34),t.sw(this.snapshotFailed),t.rw()),null!==this.snapshotLatency&&void 0!==this.snapshotLatency&&(t.iw("snapshotLatency",g.Type.I32,35),t.sw(this.snapshotLatency),t.rw()),null!==this.sourceLatency&&void 0!==this.sourceLatency&&(t.iw("sourceLatency",g.Type.I32,36),t.sw(this.sourceLatency),t.rw()),t.ew(),t.hw()},b.snapshots.PartnerTraffic=function(t){this.p2pSuccReq=null,this.p2pFailReq=null,this.p2pPartReq=null,this.p2pSuccReceived=null,this.p2pSuccReceivedLow=null,this.p2pFailReceived=null,this.p2pSuccResp=null,this.p2pFailResp=null,this.p2pPartResp=null,this.p2pSuccSent=null,this.p2pSuccSentLow=null,this.p2pFailSent=null,t&&(void 0!==t.p2pSuccReq&&null!==t.p2pSuccReq&&(this.p2pSuccReq=t.p2pSuccReq),void 0!==t.p2pFailReq&&null!==t.p2pFailReq&&(this.p2pFailReq=t.p2pFailReq),void 0!==t.p2pPartReq&&null!==t.p2pPartReq&&(this.p2pPartReq=t.p2pPartReq),void 0!==t.p2pSuccReceived&&null!==t.p2pSuccReceived&&(this.p2pSuccReceived=t.p2pSuccReceived),void 0!==t.p2pSuccReceivedLow&&null!==t.p2pSuccReceivedLow&&(this.p2pSuccReceivedLow=t.p2pSuccReceivedLow),void 0!==t.p2pFailReceived&&null!==t.p2pFailReceived&&(this.p2pFailReceived=t.p2pFailReceived),void 0!==t.p2pSuccResp&&null!==t.p2pSuccResp&&(this.p2pSuccResp=t.p2pSuccResp),void 0!==t.p2pFailResp&&null!==t.p2pFailResp&&(this.p2pFailResp=t.p2pFailResp),void 0!==t.p2pPartResp&&null!==t.p2pPartResp&&(this.p2pPartResp=t.p2pPartResp),void 0!==t.p2pSuccSent&&null!==t.p2pSuccSent&&(this.p2pSuccSent=t.p2pSuccSent),void 0!==t.p2pSuccSentLow&&null!==t.p2pSuccSentLow&&(this.p2pSuccSentLow=t.p2pSuccSentLow),void 0!==t.p2pFailSent&&null!==t.p2pFailSent&&(this.p2pFailSent=t.p2pFailSent))},b.snapshots.PartnerTraffic.prototype={},b.snapshots.PartnerTraffic.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I64?this.p2pSuccReq=t._p().value:t.XE(n);break;case 2:n==g.Type.I64?this.p2pFailReq=t._p().value:t.XE(n);break;case 3:n==g.Type.I64?this.p2pPartReq=t._p().value:t.XE(n);break;case 4:n==g.Type.I64?this.p2pSuccReceived=t._p().value:t.XE(n);break;case 5:n==g.Type.I64?this.p2pSuccReceivedLow=t._p().value:t.XE(n);break;case 10:n==g.Type.I64?this.p2pFailReceived=t._p().value:t.XE(n);break;case 6:n==g.Type.I64?this.p2pSuccResp=t._p().value:t.XE(n);break;case 11:n==g.Type.I64?this.p2pFailResp=t._p().value:t.XE(n);break;case 7:n==g.Type.I64?this.p2pPartResp=t._p().value:t.XE(n);break;case 8:n==g.Type.I64?this.p2pSuccSent=t._p().value:t.XE(n);break;case 9:n==g.Type.I64?this.p2pSuccSentLow=t._p().value:t.XE(n);break;case 12:n==g.Type.I64?this.p2pFailSent=t._p().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.PartnerTraffic.prototype.write=function(t){t.tw("PartnerTraffic"),null!==this.p2pSuccReq&&void 0!==this.p2pSuccReq&&(t.iw("p2pSuccReq",g.Type.I64,1),t.rp(this.p2pSuccReq),t.rw()),null!==this.p2pFailReq&&void 0!==this.p2pFailReq&&(t.iw("p2pFailReq",g.Type.I64,2),t.rp(this.p2pFailReq),t.rw()),null!==this.p2pPartReq&&void 0!==this.p2pPartReq&&(t.iw("p2pPartReq",g.Type.I64,3),t.rp(this.p2pPartReq),t.rw()),null!==this.p2pSuccReceived&&void 0!==this.p2pSuccReceived&&(t.iw("p2pSuccReceived",g.Type.I64,4),t.rp(this.p2pSuccReceived),t.rw()),null!==this.p2pSuccReceivedLow&&void 0!==this.p2pSuccReceivedLow&&(t.iw("p2pSuccReceivedLow",g.Type.I64,5),t.rp(this.p2pSuccReceivedLow),t.rw()),null!==this.p2pFailReceived&&void 0!==this.p2pFailReceived&&(t.iw("p2pFailReceived",g.Type.I64,10),t.rp(this.p2pFailReceived),t.rw()),null!==this.p2pSuccResp&&void 0!==this.p2pSuccResp&&(t.iw("p2pSuccResp",g.Type.I64,6),t.rp(this.p2pSuccResp),t.rw()),null!==this.p2pFailResp&&void 0!==this.p2pFailResp&&(t.iw("p2pFailResp",g.Type.I64,11),t.rp(this.p2pFailResp),t.rw()),null!==this.p2pPartResp&&void 0!==this.p2pPartResp&&(t.iw("p2pPartResp",g.Type.I64,7),t.rp(this.p2pPartResp),t.rw()),null!==this.p2pSuccSent&&void 0!==this.p2pSuccSent&&(t.iw("p2pSuccSent",g.Type.I64,8),t.rp(this.p2pSuccSent),t.rw()),null!==this.p2pSuccSentLow&&void 0!==this.p2pSuccSentLow&&(t.iw("p2pSuccSentLow",g.Type.I64,9),t.rp(this.p2pSuccSentLow),t.rw()),null!==this.p2pFailSent&&void 0!==this.p2pFailSent&&(t.iw("p2pFailSent",g.Type.I64,12),t.rp(this.p2pFailSent),t.rw()),t.ew(),t.hw()},b.snapshots.PartnerMetrics=function(t){this.rateReceived=null,this.rateSent=null,this.handshakeDelay=null,t&&(void 0!==t.rateReceived&&null!==t.rateReceived&&(this.rateReceived=t.rateReceived),void 0!==t.rateSent&&null!==t.rateSent&&(this.rateSent=t.rateSent),void 0!==t.handshakeDelay&&null!==t.handshakeDelay&&(this.handshakeDelay=t.handshakeDelay))},b.snapshots.PartnerMetrics.prototype={},b.snapshots.PartnerMetrics.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.DOUBLE?this.rateReceived=t.Rp().value:t.XE(n);break;case 2:n==g.Type.DOUBLE?this.rateSent=t.Rp().value:t.XE(n);break;case 3:n==g.Type.I64?this.handshakeDelay=t._p().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.PartnerMetrics.prototype.write=function(t){t.tw("PartnerMetrics"),null!==this.rateReceived&&void 0!==this.rateReceived&&(t.iw("rateReceived",g.Type.DOUBLE,1),t.sp(this.rateReceived),t.rw()),null!==this.rateSent&&void 0!==this.rateSent&&(t.iw("rateSent",g.Type.DOUBLE,2),t.sp(this.rateSent),t.rw()),null!==this.handshakeDelay&&void 0!==this.handshakeDelay&&(t.iw("handshakeDelay",g.Type.I64,3),t.rp(this.handshakeDelay),t.rw()),t.ew(),t.hw()},b.snapshots.ConnectivityInfo=function(t){this.upBW=null,this.downBW=null,this.externalAs=null,this.internalAs=null,this.publicIp=null,this.privateIp=null,t&&(void 0!==t.upBW&&null!==t.upBW&&(this.upBW=t.upBW),void 0!==t.downBW&&null!==t.downBW&&(this.downBW=t.downBW),void 0!==t.externalAs&&null!==t.externalAs&&(this.externalAs=t.externalAs),void 0!==t.internalAs&&null!==t.internalAs&&(this.internalAs=t.internalAs),void 0!==t.publicIp&&null!==t.publicIp&&(this.publicIp=t.publicIp),void 0!==t.privateIp&&null!==t.privateIp&&(this.privateIp=t.privateIp))},b.snapshots.ConnectivityInfo.prototype={},b.snapshots.ConnectivityInfo.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.upBW=t.zE().value:t.XE(n);break;case 2:n==g.Type.I32?this.downBW=t.zE().value:t.XE(n);break;case 3:n==g.Type.I32?this.externalAs=t.zE().value:t.XE(n);break;case 4:n==g.Type.I32?this.internalAs=t.zE().value:t.XE(n);break;case 5:n==g.Type.STRING?this.publicIp=t.$E().value:t.XE(n);break;case 6:n==g.Type.STRING?this.privateIp=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.ConnectivityInfo.prototype.write=function(t){t.tw("ConnectivityInfo"),null!==this.upBW&&void 0!==this.upBW&&(t.iw("upBW",g.Type.I32,1),t.sw(this.upBW),t.rw()),null!==this.downBW&&void 0!==this.downBW&&(t.iw("downBW",g.Type.I32,2),t.sw(this.downBW),t.rw()),null!==this.externalAs&&void 0!==this.externalAs&&(t.iw("externalAs",g.Type.I32,3),t.sw(this.externalAs),t.rw()),null!==this.internalAs&&void 0!==this.internalAs&&(t.iw("internalAs",g.Type.I32,4),t.sw(this.internalAs),t.rw()),null!==this.publicIp&&void 0!==this.publicIp&&(t.iw("publicIp",g.Type.STRING,5),t.nw(this.publicIp),t.rw()),null!==this.privateIp&&void 0!==this.privateIp&&(t.iw("privateIp",g.Type.STRING,6),t.nw(this.privateIp),t.rw()),t.ew(),t.hw()},b.snapshots.Partner=function(t){this.connInfo=null,this.traffic=null,this.metrics=null,this.inPart=null,this.outPart=null,this.udp=null,t&&(void 0!==t.connInfo&&null!==t.connInfo&&(this.connInfo=t.connInfo),void 0!==t.traffic&&null!==t.traffic&&(this.traffic=t.traffic),void 0!==t.metrics&&null!==t.metrics&&(this.metrics=t.metrics),void 0!==t.inPart&&null!==t.inPart&&(this.inPart=t.inPart),void 0!==t.outPart&&null!==t.outPart&&(this.outPart=t.outPart),void 0!==t.udp&&null!==t.udp&&(this.udp=t.udp))},b.snapshots.Partner.prototype={},b.snapshots.Partner.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.STRUCT?(this.connInfo=new b.snapshots.ConnectivityInfo(),this.connInfo.read(t)):t.XE(n);break;case 2:n==g.Type.STRUCT?(this.traffic=new b.snapshots.PartnerTraffic(),this.traffic.read(t)):t.XE(n);break;case 3:n==g.Type.STRUCT?(this.metrics=new b.snapshots.PartnerMetrics(),this.metrics.read(t)):t.XE(n);break;case 4:n==g.Type.BOOL?this.inPart=t.Tp().value:t.XE(n);break;case 5:n==g.Type.BOOL?this.outPart=t.Tp().value:t.XE(n);break;case 6:n==g.Type.BOOL?this.udp=t.Tp().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.Partner.prototype.write=function(t){t.tw("Partner"),null!==this.connInfo&&void 0!==this.connInfo&&(t.iw("connInfo",g.Type.STRUCT,1),this.connInfo.write(t),t.rw()),null!==this.traffic&&void 0!==this.traffic&&(t.iw("traffic",g.Type.STRUCT,2),this.traffic.write(t),t.rw()),null!==this.metrics&&void 0!==this.metrics&&(t.iw("metrics",g.Type.STRUCT,3),this.metrics.write(t),t.rw()),null!==this.inPart&&void 0!==this.inPart&&(t.iw("inPart",g.Type.BOOL,4),t.Zw(this.inPart),t.rw()),null!==this.outPart&&void 0!==this.outPart&&(t.iw("outPart",g.Type.BOOL,5),t.Zw(this.outPart),t.rw()),null!==this.udp&&void 0!==this.udp&&(t.iw("udp",g.Type.BOOL,6),t.Zw(this.udp),t.rw()),t.ew(),t.hw()},b.snapshots.StreamInfo=function(t){this.url=null,this.streamType=null,this.streamProtocol=null,this.duration=null,this.qualityLevels=null,t&&(void 0!==t.url&&null!==t.url&&(this.url=t.url),void 0!==t.streamType&&null!==t.streamType&&(this.streamType=t.streamType),void 0!==t.streamProtocol&&null!==t.streamProtocol&&(this.streamProtocol=t.streamProtocol),void 0!==t.duration&&null!==t.duration&&(this.duration=t.duration),void 0!==t.qualityLevels&&null!==t.qualityLevels&&(this.qualityLevels=t.qualityLevels))},b.snapshots.StreamInfo.prototype={},b.snapshots.StreamInfo.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.STRING?this.url=t.$E().value:t.XE(n);break;case 2:n==g.Type.I32?this.streamType=t.zE().value:t.XE(n);break;case 3:n==g.Type.I32?this.streamProtocol=t.zE().value:t.XE(n);break;case 4:n==g.Type.I32?this.duration=t.zE().value:t.XE(n);break;case 5:if(n==g.Type.LIST){var s,e;this.qualityLevels=[];(e=t.wp()).pp,s=e.size;for(var h=0;h<s;++h){var o=null;(o=new b.snapshots.QualityLevel()).read(t),this.qualityLevels.push(o)}t.gp()}else t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.StreamInfo.prototype.write=function(t){if(t.tw("StreamInfo"),null!==this.url&&void 0!==this.url&&(t.iw("url",g.Type.STRING,1),t.nw(this.url),t.rw()),null!==this.streamType&&void 0!==this.streamType&&(t.iw("streamType",g.Type.I32,2),t.sw(this.streamType),t.rw()),null!==this.streamProtocol&&void 0!==this.streamProtocol&&(t.iw("streamProtocol",g.Type.I32,3),t.sw(this.streamProtocol),t.rw()),null!==this.duration&&void 0!==this.duration&&(t.iw("duration",g.Type.I32,4),t.sw(this.duration),t.rw()),null!==this.qualityLevels&&void 0!==this.qualityLevels){for(var i in t.iw("qualityLevels",g.Type.LIST,5),t.$w(g.Type.STRUCT,this.qualityLevels.length),this.qualityLevels)this.qualityLevels.hasOwnProperty(i)&&(i=this.qualityLevels[i]).write(t);t.Xw(),t.rw()}t.ew(),t.hw()},b.snapshots.ClientInfo=function(t){this.clientType=null,this.majorVersion=null,this.minorVersion=null,this.patchVersion=null,t&&(void 0!==t.clientType&&null!==t.clientType&&(this.clientType=t.clientType),void 0!==t.majorVersion&&null!==t.majorVersion&&(this.majorVersion=t.majorVersion),void 0!==t.minorVersion&&null!==t.minorVersion&&(this.minorVersion=t.minorVersion),void 0!==t.patchVersion&&null!==t.patchVersion&&(this.patchVersion=t.patchVersion))},b.snapshots.ClientInfo.prototype={},b.snapshots.ClientInfo.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.clientType=t.zE().value:t.XE(n);break;case 2:n==g.Type.BYTE?this.majorVersion=t.Op().value:t.XE(n);break;case 3:n==g.Type.BYTE?this.minorVersion=t.Op().value:t.XE(n);break;case 4:n==g.Type.I16?this.patchVersion=t.mp().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.ClientInfo.prototype.write=function(t){t.tw("ClientInfo"),null!==this.clientType&&void 0!==this.clientType&&(t.iw("clientType",g.Type.I32,1),t.sw(this.clientType),t.rw()),null!==this.majorVersion&&void 0!==this.majorVersion&&(t.iw("majorVersion",g.Type.BYTE,2),t.tp(this.majorVersion),t.rw()),null!==this.minorVersion&&void 0!==this.minorVersion&&(t.iw("minorVersion",g.Type.BYTE,3),t.tp(this.minorVersion),t.rw()),null!==this.patchVersion&&void 0!==this.patchVersion&&(t.iw("patchVersion",g.Type.I16,4),t.np(this.patchVersion),t.rw()),t.ew(),t.hw()},b.snapshots.AgentInfo=function(t){this.firstTierBitrates=null,this.secondTierBitrates=null,t&&(void 0!==t.firstTierBitrates&&null!==t.firstTierBitrates&&(this.firstTierBitrates=t.firstTierBitrates),void 0!==t.secondTierBitrates&&null!==t.secondTierBitrates&&(this.secondTierBitrates=t.secondTierBitrates))},b.snapshots.AgentInfo.prototype={},b.snapshots.AgentInfo.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:if(n==g.Type.SET){var s,e;this.firstTierBitrates=[];(e=t.bp()).pp,s=e.size;for(var h=0;h<s;++h){var o;o=t.zE().value,this.firstTierBitrates.push(o)}t.yp()}else t.XE(n);break;case 2:if(n==g.Type.SET){var u,a;this.secondTierBitrates=[];(a=t.bp()).pp,u=a.size;for(var f=0;f<u;++f){var c;c=t.zE().value,this.secondTierBitrates.push(c)}t.yp()}else t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.AgentInfo.prototype.write=function(t){if(t.tw("AgentInfo"),null!==this.firstTierBitrates&&void 0!==this.firstTierBitrates){for(var i in t.iw("firstTierBitrates",g.Type.SET,1),t.zw(g.Type.I32,this.firstTierBitrates.length),this.firstTierBitrates)this.firstTierBitrates.hasOwnProperty(i)&&(i=this.firstTierBitrates[i],t.sw(i));t.Jw(),t.rw()}if(null!==this.secondTierBitrates&&void 0!==this.secondTierBitrates){for(var n in t.iw("secondTierBitrates",g.Type.SET,2),t.zw(g.Type.I32,this.secondTierBitrates.length),this.secondTierBitrates)this.secondTierBitrates.hasOwnProperty(n)&&(n=this.secondTierBitrates[n],t.sw(n));t.Jw(),t.rw()}t.ew(),t.hw()},b.snapshots.TrafficKey=function(t){this.bitrate=null,this.AS=null,this.partnerGuid=null,this.qualityLevelId=null,t&&(void 0!==t.bitrate&&null!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.AS&&null!==t.AS&&(this.AS=t.AS),void 0!==t.partnerGuid&&null!==t.partnerGuid&&(this.partnerGuid=t.partnerGuid),void 0!==t.qualityLevelId&&null!==t.qualityLevelId&&(this.qualityLevelId=t.qualityLevelId))},b.snapshots.TrafficKey.prototype={},b.snapshots.TrafficKey.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.bitrate=t.zE().value:t.XE(n);break;case 2:n==g.Type.I32?this.AS=t.zE().value:t.XE(n);break;case 3:n==g.Type.STRING?this.partnerGuid=t.$E().value:t.XE(n);break;case 4:n==g.Type.STRING?this.qualityLevelId=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.TrafficKey.prototype.write=function(t){t.tw("TrafficKey"),null!==this.bitrate&&void 0!==this.bitrate&&(t.iw("bitrate",g.Type.I32,1),t.sw(this.bitrate),t.rw()),null!==this.AS&&void 0!==this.AS&&(t.iw("AS",g.Type.I32,2),t.sw(this.AS),t.rw()),null!==this.partnerGuid&&void 0!==this.partnerGuid&&(t.iw("partnerGuid",g.Type.STRING,3),t.nw(this.partnerGuid),t.rw()),null!==this.qualityLevelId&&void 0!==this.qualityLevelId&&(t.iw("qualityLevelId",g.Type.STRING,4),t.nw(this.qualityLevelId),t.rw()),t.ew(),t.hw()},b.snapshots.PartnerKey=function(t){this.bitrate=null,this.AS=null,this.partnerGuid=null,this.qualityLevelId=null,t&&(void 0!==t.bitrate&&null!==t.bitrate&&(this.bitrate=t.bitrate),void 0!==t.AS&&null!==t.AS&&(this.AS=t.AS),void 0!==t.partnerGuid&&null!==t.partnerGuid&&(this.partnerGuid=t.partnerGuid),void 0!==t.qualityLevelId&&null!==t.qualityLevelId&&(this.qualityLevelId=t.qualityLevelId))},b.snapshots.PartnerKey.prototype={},b.snapshots.PartnerKey.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I32?this.bitrate=t.zE().value:t.XE(n);break;case 2:n==g.Type.I32?this.AS=t.zE().value:t.XE(n);break;case 3:n==g.Type.STRING?this.partnerGuid=t.$E().value:t.XE(n);break;case 4:n==g.Type.STRING?this.qualityLevelId=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.PartnerKey.prototype.write=function(t){t.tw("PartnerKey"),null!==this.bitrate&&void 0!==this.bitrate&&(t.iw("bitrate",g.Type.I32,1),t.sw(this.bitrate),t.rw()),null!==this.AS&&void 0!==this.AS&&(t.iw("AS",g.Type.I32,2),t.sw(this.AS),t.rw()),null!==this.partnerGuid&&void 0!==this.partnerGuid&&(t.iw("partnerGuid",g.Type.STRING,3),t.nw(this.partnerGuid),t.rw()),null!==this.qualityLevelId&&void 0!==this.qualityLevelId&&(t.iw("qualityLevelId",g.Type.STRING,4),t.nw(this.qualityLevelId),t.rw()),t.ew(),t.hw()},b.snapshots.Player=function(t){this.bufferingN=null,this.bufferingMs=null,this.initBufferingN=null,this.initBufferingMs=null,this.seekBufferingN=null,this.seekBufferingMs=null,this.playerBufferMs=null,this.playingTimeMs=null,t&&(void 0!==t.bufferingN&&null!==t.bufferingN&&(this.bufferingN=t.bufferingN),void 0!==t.bufferingMs&&null!==t.bufferingMs&&(this.bufferingMs=t.bufferingMs),void 0!==t.initBufferingN&&null!==t.initBufferingN&&(this.initBufferingN=t.initBufferingN),void 0!==t.initBufferingMs&&null!==t.initBufferingMs&&(this.initBufferingMs=t.initBufferingMs),void 0!==t.seekBufferingN&&null!==t.seekBufferingN&&(this.seekBufferingN=t.seekBufferingN),void 0!==t.seekBufferingMs&&null!==t.seekBufferingMs&&(this.seekBufferingMs=t.seekBufferingMs),void 0!==t.playerBufferMs&&null!==t.playerBufferMs&&(this.playerBufferMs=t.playerBufferMs),void 0!==t.playingTimeMs&&null!==t.playingTimeMs&&(this.playingTimeMs=t.playingTimeMs))},b.snapshots.Player.prototype={},b.snapshots.Player.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I16?this.bufferingN=t.mp().value:t.XE(n);break;case 2:n==g.Type.I32?this.bufferingMs=t.zE().value:t.XE(n);break;case 3:n==g.Type.I16?this.initBufferingN=t.mp().value:t.XE(n);break;case 4:n==g.Type.I32?this.initBufferingMs=t.zE().value:t.XE(n);break;case 5:n==g.Type.I16?this.seekBufferingN=t.mp().value:t.XE(n);break;case 6:n==g.Type.I32?this.seekBufferingMs=t.zE().value:t.XE(n);break;case 36:n==g.Type.I32?this.playerBufferMs=t.zE().value:t.XE(n);break;case 37:n==g.Type.I32?this.playingTimeMs=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.Player.prototype.write=function(t){t.tw("Player"),null!==this.bufferingN&&void 0!==this.bufferingN&&(t.iw("bufferingN",g.Type.I16,1),t.np(this.bufferingN),t.rw()),null!==this.bufferingMs&&void 0!==this.bufferingMs&&(t.iw("bufferingMs",g.Type.I32,2),t.sw(this.bufferingMs),t.rw()),null!==this.initBufferingN&&void 0!==this.initBufferingN&&(t.iw("initBufferingN",g.Type.I16,3),t.np(this.initBufferingN),t.rw()),null!==this.initBufferingMs&&void 0!==this.initBufferingMs&&(t.iw("initBufferingMs",g.Type.I32,4),t.sw(this.initBufferingMs),t.rw()),null!==this.seekBufferingN&&void 0!==this.seekBufferingN&&(t.iw("seekBufferingN",g.Type.I16,5),t.np(this.seekBufferingN),t.rw()),null!==this.seekBufferingMs&&void 0!==this.seekBufferingMs&&(t.iw("seekBufferingMs",g.Type.I32,6),t.sw(this.seekBufferingMs),t.rw()),null!==this.playerBufferMs&&void 0!==this.playerBufferMs&&(t.iw("playerBufferMs",g.Type.I32,36),t.sw(this.playerBufferMs),t.rw()),null!==this.playingTimeMs&&void 0!==this.playingTimeMs&&(t.iw("playingTimeMs",g.Type.I32,37),t.sw(this.playingTimeMs),t.rw()),t.ew(),t.hw()},b.snapshots.ResponseInfo=function(t){this.statusCode=null,this.count=null,t&&(void 0!==t.statusCode&&null!==t.statusCode&&(this.statusCode=t.statusCode),void 0!==t.count&&null!==t.count&&(this.count=t.count))},b.snapshots.ResponseInfo.prototype={},b.snapshots.ResponseInfo.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I16?this.statusCode=t.mp().value:t.XE(n);break;case 2:n==g.Type.I32?this.count=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.ResponseInfo.prototype.write=function(t){t.tw("ResponseInfo"),null!==this.statusCode&&void 0!==this.statusCode&&(t.iw("statusCode",g.Type.I16,1),t.np(this.statusCode),t.rw()),null!==this.count&&void 0!==this.count&&(t.iw("count",g.Type.I32,2),t.sw(this.count),t.rw()),t.ew(),t.hw()},b.snapshots.ServiceResponseInfo=function(t){this.source=null,t&&void 0!==t.source&&null!==t.source&&(this.source=g.Mp(t.source,[b.snapshots.ResponseInfo]))},b.snapshots.ServiceResponseInfo.prototype={},b.snapshots.ServiceResponseInfo.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:if(n==g.Type.LIST){var s,e;this.source=[];(e=t.wp()).pp,s=e.size;for(var h=0;h<s;++h){var o=null;(o=new b.snapshots.ResponseInfo()).read(t),this.source.push(o)}t.gp()}else t.XE(n);break;case 0:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.ServiceResponseInfo.prototype.write=function(t){if(t.tw("ServiceResponseInfo"),null!==this.source&&void 0!==this.source){for(var i in t.iw("source",g.Type.LIST,1),t.$w(g.Type.STRUCT,this.source.length),this.source)this.source.hasOwnProperty(i)&&(i=this.source[i]).write(t);t.Xw(),t.rw()}t.ew(),t.hw()},b.snapshots.MetricSnapshot=function(t){this.timestamp=null,this.guid=null,this.eventId=null,this.streamInfo=null,this.metrics=null,this.traffic=null,this.snapshotInfo=null,this.agentInfo=null,this.connInfo=null,this.partners=null,this.player=null,this.client=null,this.sessionId=null,this.responseInfo=null,this.testInfo=null,this.clientId=null,this.fragments=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.eventId&&null!==t.eventId&&(this.eventId=t.eventId),void 0!==t.streamInfo&&null!==t.streamInfo&&(this.streamInfo=t.streamInfo),void 0!==t.metrics&&null!==t.metrics&&(this.metrics=t.metrics),void 0!==t.traffic&&null!==t.traffic&&(this.traffic=t.traffic),void 0!==t.snapshotInfo&&null!==t.snapshotInfo&&(this.snapshotInfo=t.snapshotInfo),void 0!==t.agentInfo&&null!==t.agentInfo&&(this.agentInfo=t.agentInfo),void 0!==t.connInfo&&null!==t.connInfo&&(this.connInfo=t.connInfo),void 0!==t.partners&&null!==t.partners&&(this.partners=t.partners),void 0!==t.player&&null!==t.player&&(this.player=t.player),void 0!==t.client&&null!==t.client&&(this.client=t.client),void 0!==t.sessionId&&null!==t.sessionId&&(this.sessionId=t.sessionId),void 0!==t.responseInfo&&null!==t.responseInfo&&(this.responseInfo=t.responseInfo),void 0!==t.testInfo&&null!==t.testInfo&&(this.testInfo=t.testInfo),void 0!==t.clientId&&null!==t.clientId&&(this.clientId=t.clientId),void 0!==t.fragments&&null!==t.fragments&&(this.fragments=t.fragments))},b.snapshots.MetricSnapshot.prototype={},b.snapshots.MetricSnapshot.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I64?this.timestamp=t._p().value:t.XE(n);break;case 2:n==g.Type.STRING?this.guid=t.$E().value:t.XE(n);break;case 3:n==g.Type.STRUCT?(this.eventId=new EventId(),this.eventId.read(t)):t.XE(n);break;case 4:n==g.Type.STRUCT?(this.streamInfo=new b.snapshots.StreamInfo(),this.streamInfo.read(t)):t.XE(n);break;case 5:n==g.Type.STRUCT?(this.metrics=new b.snapshots.Metrics(),this.metrics.read(t)):t.XE(n);break;case 6:if(n==g.Type.MAP){var s,e;this.traffic={};(e=t.lp()).vp,e.dp,s=e.size;for(var h=0;h<s;++h){0<h&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var o=null,u=null;(o=new b.snapshots.TrafficKey()).read(t),(u=new b.snapshots.Traffic()).read(t),this.traffic[o]=u}t.Ep()}else t.XE(n);break;case 7:n==g.Type.STRUCT?(this.snapshotInfo=new SnapshotInfo(),this.snapshotInfo.read(t)):t.XE(n);break;case 8:n==g.Type.STRUCT?(this.agentInfo=new b.snapshots.AgentInfo(),this.agentInfo.read(t)):t.XE(n);break;case 9:n==g.Type.STRUCT?(this.connInfo=new b.snapshots.ConnectivityInfo(),this.connInfo.read(t)):t.XE(n);break;case 10:if(n==g.Type.MAP){var a,f;this.partners={};(f=t.lp()).vp,f.dp,a=f.size;for(var c=0;c<a;++c){0<c&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var l=null,v=null;(l=new b.snapshots.PartnerKey()).read(t),(v=new b.snapshots.Partner()).read(t),this.partners[l]=v}t.Ep()}else t.XE(n);break;case 11:n==g.Type.STRUCT?(this.player=new b.snapshots.Player(),this.player.read(t)):t.XE(n);break;case 12:n==g.Type.STRUCT?(this.client=new b.snapshots.ClientInfo(),this.client.read(t)):t.XE(n);break;case 13:n==g.Type.STRING?this.sessionId=t.$E().value:t.XE(n);break;case 14:n==g.Type.STRUCT?(this.responseInfo=new b.snapshots.ServiceResponseInfo(),this.responseInfo.read(t)):t.XE(n);break;case 15:n==g.Type.STRUCT?(this.testInfo=new TestInfo(),this.testInfo.read(t)):t.XE(n);break;case 16:n==g.Type.I64?this.clientId=t._p().value:t.XE(n);break;case 17:if(n==g.Type.LIST){var d,E;this.fragments=[];(E=t.wp()).pp,d=E.size;for(var w=0;w<d;++w){var p=null;(p=new b.snapshots.FragmentMetadata()).read(t),this.fragments.push(p)}t.gp()}else t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.MetricSnapshot.prototype.write=function(t){if(t.tw("MetricSnapshot"),null!==this.timestamp&&void 0!==this.timestamp&&(t.iw("timestamp",g.Type.I64,1),t.rp(this.timestamp),t.rw()),null!==this.guid&&void 0!==this.guid&&(t.iw("guid",g.Type.STRING,2),t.nw(this.guid),t.rw()),null!==this.eventId&&void 0!==this.eventId&&(t.iw("eventId",g.Type.STRUCT,3),this.eventId.write(t),t.rw()),null!==this.streamInfo&&void 0!==this.streamInfo&&(t.iw("streamInfo",g.Type.STRUCT,4),this.streamInfo.write(t),t.rw()),null!==this.metrics&&void 0!==this.metrics&&(t.iw("metrics",g.Type.STRUCT,5),this.metrics.write(t),t.rw()),null!==this.traffic&&void 0!==this.traffic){for(var i in t.iw("traffic",g.Type.MAP,6),t.Kw(g.Type.STRUCT,g.Type.STRUCT,g.kE(this.traffic)),this.traffic)if(this.traffic.hasOwnProperty(i)){var n=this.traffic[i];n.key.write(t),n.value.write(t)}t.Ww(),t.rw()}if(null!==this.snapshotInfo&&void 0!==this.snapshotInfo&&(t.iw("snapshotInfo",g.Type.STRUCT,7),this.snapshotInfo.write(t),t.rw()),null!==this.agentInfo&&void 0!==this.agentInfo&&(t.iw("agentInfo",g.Type.STRUCT,8),this.agentInfo.write(t),t.rw()),null!==this.connInfo&&void 0!==this.connInfo&&(t.iw("connInfo",g.Type.STRUCT,9),this.connInfo.write(t),t.rw()),null!==this.partners&&void 0!==this.partners){for(var r in t.iw("partners",g.Type.MAP,10),t.Kw(g.Type.STRUCT,g.Type.STRUCT,g.kE(this.partners)),this.partners)if(this.partners.hasOwnProperty(r)){var s=this.partners[r];s.key.write(t),s.value.write(t)}t.Ww(),t.rw()}if(null!==this.player&&void 0!==this.player&&(t.iw("player",g.Type.STRUCT,11),this.player.write(t),t.rw()),null!==this.client&&void 0!==this.client&&(t.iw("client",g.Type.STRUCT,12),this.client.write(t),t.rw()),null!==this.sessionId&&void 0!==this.sessionId&&(t.iw("sessionId",g.Type.STRING,13),t.nw(this.sessionId),t.rw()),null!==this.responseInfo&&void 0!==this.responseInfo&&(t.iw("responseInfo",g.Type.STRUCT,14),this.responseInfo.write(t),t.rw()),null!==this.testInfo&&void 0!==this.testInfo&&(t.iw("testInfo",g.Type.STRUCT,15),this.testInfo.write(t),t.rw()),null!==this.clientId&&void 0!==this.clientId&&(t.iw("clientId",g.Type.I64,16),t.rp(this.clientId),t.rw()),null!==this.fragments&&void 0!==this.fragments){for(var e in t.iw("fragments",g.Type.LIST,17),t.$w(g.Type.STRUCT,this.fragments.length),this.fragments)this.fragments.hasOwnProperty(e)&&(e=this.fragments[e]).write(t);t.Xw(),t.rw()}t.ew(),t.hw()},b.snapshots.JsonMetricSnapshot=function(t){this.timestamp=null,this.guid=null,this.eventId=null,this.streamInfo=null,this.metrics=null,this.traffic=null,this.snapshotInfo=null,this.agentInfo=null,this.connInfo=null,this.partners=null,this.player=null,this.client=null,this.sessionId=null,this.responseInfo=null,this.testInfo=null,this.clientId=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.guid&&null!==t.guid&&(this.guid=t.guid),void 0!==t.eventId&&null!==t.eventId&&(this.eventId=t.eventId),void 0!==t.streamInfo&&null!==t.streamInfo&&(this.streamInfo=t.streamInfo),void 0!==t.metrics&&null!==t.metrics&&(this.metrics=t.metrics),void 0!==t.traffic&&null!==t.traffic&&(this.traffic=t.traffic),void 0!==t.snapshotInfo&&null!==t.snapshotInfo&&(this.snapshotInfo=t.snapshotInfo),void 0!==t.agentInfo&&null!==t.agentInfo&&(this.agentInfo=t.agentInfo),void 0!==t.connInfo&&null!==t.connInfo&&(this.connInfo=t.connInfo),void 0!==t.partners&&null!==t.partners&&(this.partners=t.partners),void 0!==t.player&&null!==t.player&&(this.player=t.player),void 0!==t.client&&null!==t.client&&(this.client=t.client),void 0!==t.sessionId&&null!==t.sessionId&&(this.sessionId=t.sessionId),void 0!==t.responseInfo&&null!==t.responseInfo&&(this.responseInfo=t.responseInfo),void 0!==t.testInfo&&null!==t.testInfo&&(this.testInfo=t.testInfo),void 0!==t.clientId&&null!==t.clientId&&(this.clientId=t.clientId))},b.snapshots.JsonMetricSnapshot.prototype={},b.snapshots.JsonMetricSnapshot.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==g.Type.STOP)break;switch(r){case 1:n==g.Type.I64?this.timestamp=t._p().value:t.XE(n);break;case 2:n==g.Type.STRING?this.guid=t.$E().value:t.XE(n);break;case 3:n==g.Type.STRUCT?(this.eventId=new EventId(),this.eventId.read(t)):t.XE(n);break;case 4:n==g.Type.STRUCT?(this.streamInfo=new b.snapshots.StreamInfo(),this.streamInfo.read(t)):t.XE(n);break;case 5:n==g.Type.STRUCT?(this.metrics=new b.snapshots.Metrics(),this.metrics.read(t)):t.XE(n);break;case 6:if(n==g.Type.MAP){var s,e;this.traffic={};(e=t.lp()).vp,e.dp,s=e.size;for(var h=0;h<s;++h){0<h&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var o,u=null;o=t.$E().value,(u=new b.snapshots.Traffic()).read(t),this.traffic[o]=u}t.Ep()}else t.XE(n);break;case 7:n==g.Type.STRUCT?(this.snapshotInfo=new SnapshotInfo(),this.snapshotInfo.read(t)):t.XE(n);break;case 8:n==g.Type.STRUCT?(this.agentInfo=new b.snapshots.AgentInfo(),this.agentInfo.read(t)):t.XE(n);break;case 9:n==g.Type.STRUCT?(this.connInfo=new b.snapshots.ConnectivityInfo(),this.connInfo.read(t)):t.XE(n);break;case 10:if(n==g.Type.MAP){var a,f;this.partners={};(f=t.lp()).vp,f.dp,a=f.size;for(var c=0;c<a;++c){0<c&&t.hp.length>t.aw[t.aw.length-1]+1&&t.hp.pop();var l,v=null;l=t.$E().value,(v=new b.snapshots.Partner()).read(t),this.partners[l]=v}t.Ep()}else t.XE(n);break;case 11:n==g.Type.STRUCT?(this.player=new b.snapshots.Player(),this.player.read(t)):t.XE(n);break;case 12:n==g.Type.STRUCT?(this.client=new b.snapshots.ClientInfo(),this.client.read(t)):t.XE(n);break;case 13:n==g.Type.STRING?this.sessionId=t.$E().value:t.XE(n);break;case 14:n==g.Type.STRUCT?(this.responseInfo=new b.snapshots.ServiceResponseInfo(),this.responseInfo.read(t)):t.XE(n);break;case 15:n==g.Type.STRUCT?(this.testInfo=new TestInfo(),this.testInfo.read(t)):t.XE(n);break;case 16:n==g.Type.STRING?this.clientId=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},b.snapshots.JsonMetricSnapshot.prototype.write=function(t){if(t.tw("JsonMetricSnapshot"),null!==this.timestamp&&void 0!==this.timestamp&&(t.iw("timestamp",g.Type.I64,1),t.rp(this.timestamp),t.rw()),null!==this.guid&&void 0!==this.guid&&(t.iw("guid",g.Type.STRING,2),t.nw(this.guid),t.rw()),null!==this.eventId&&void 0!==this.eventId&&(t.iw("eventId",g.Type.STRUCT,3),this.eventId.write(t),t.rw()),null!==this.streamInfo&&void 0!==this.streamInfo&&(t.iw("streamInfo",g.Type.STRUCT,4),this.streamInfo.write(t),t.rw()),null!==this.metrics&&void 0!==this.metrics&&(t.iw("metrics",g.Type.STRUCT,5),this.metrics.write(t),t.rw()),null!==this.traffic&&void 0!==this.traffic){for(var i in t.iw("traffic",g.Type.MAP,6),t.Kw(g.Type.STRING,g.Type.STRUCT,g.kE(this.traffic)),this.traffic)if(this.traffic.hasOwnProperty(i)){var n=this.traffic[i];t.nw(i),n.write(t)}t.Ww(),t.rw()}if(null!==this.snapshotInfo&&void 0!==this.snapshotInfo&&(t.iw("snapshotInfo",g.Type.STRUCT,7),this.snapshotInfo.write(t),t.rw()),null!==this.agentInfo&&void 0!==this.agentInfo&&(t.iw("agentInfo",g.Type.STRUCT,8),this.agentInfo.write(t),t.rw()),null!==this.connInfo&&void 0!==this.connInfo&&(t.iw("connInfo",g.Type.STRUCT,9),this.connInfo.write(t),t.rw()),null!==this.partners&&void 0!==this.partners){for(var r in t.iw("partners",g.Type.MAP,10),t.Kw(g.Type.STRING,g.Type.STRUCT,g.kE(this.partners)),this.partners)if(this.partners.hasOwnProperty(r)){var s=this.partners[r];t.nw(r),s.write(t)}t.Ww(),t.rw()}null!==this.player&&void 0!==this.player&&(t.iw("player",g.Type.STRUCT,11),this.player.write(t),t.rw()),null!==this.client&&void 0!==this.client&&(t.iw("client",g.Type.STRUCT,12),this.client.write(t),t.rw()),null!==this.sessionId&&void 0!==this.sessionId&&(t.iw("sessionId",g.Type.STRING,13),t.nw(this.sessionId),t.rw()),null!==this.responseInfo&&void 0!==this.responseInfo&&(t.iw("responseInfo",g.Type.STRUCT,14),this.responseInfo.write(t),t.rw()),null!==this.testInfo&&void 0!==this.testInfo&&(t.iw("testInfo",g.Type.STRUCT,15),this.testInfo.write(t),t.rw()),null!==this.clientId&&void 0!==this.clientId&&(t.iw("clientId",g.Type.STRING,16),t.nw(this.clientId),t.rw()),t.ew(),t.hw()}},function(t,i,n){var u=n(22),r=(window.StreamType={1:"LIVE",LIVE:1,2:"VOD",VOD:2},window.StreamProtocol={1:"DASH",DASH:1,2:"HDS",HDS:2,3:"HLS",HLS:3,4:"SS",SS:4},window.ClientType={1:"JAVA",FK:1,2:"STATS_ONLY",nF:2,3:"JS_DIRECT",tF:3,4:"JS_PROXY",iF:4},window.ContentType={1:"AUDIO",Ba:1,2:"VIDEO",Va:2},window.EventId=function(t){this.partnerId=null,this.customerId=null,this.contentId=null,this.tags=null,t&&(void 0!==t.partnerId&&null!==t.partnerId&&(this.partnerId=t.partnerId),void 0!==t.customerId&&null!==t.customerId&&(this.customerId=t.customerId),void 0!==t.contentId&&null!==t.contentId&&(this.contentId=t.contentId),void 0!==t.tags&&null!==t.tags&&(this.tags=t.tags))});r.prototype={},r.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==u.Type.STOP)break;switch(r){case 1:n==u.Type.STRING?this.partnerId=t.$E().value:t.XE(n);break;case 2:n==u.Type.STRING?this.customerId=t.$E().value:t.XE(n);break;case 3:n==u.Type.STRING?this.contentId=t.$E().value:t.XE(n);break;case 4:if(n==u.Type.LIST){var s,e;this.tags=[];(e=t.wp()).pp,s=e.size;for(var h=0;h<s;++h){var o;o=t.$E().value,this.tags.push(o)}t.gp()}else t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},r.prototype.write=function(t){if(t.tw("EventId"),null!==this.partnerId&&void 0!==this.partnerId&&(t.iw("partnerId",u.Type.STRING,1),t.nw(this.partnerId),t.rw()),null!==this.customerId&&void 0!==this.customerId&&(t.iw("customerId",u.Type.STRING,2),t.nw(this.customerId),t.rw()),null!==this.contentId&&void 0!==this.contentId&&(t.iw("contentId",u.Type.STRING,3),t.nw(this.contentId),t.rw()),null!==this.tags&&void 0!==this.tags){for(var i in t.iw("tags",u.Type.LIST,4),t.$w(u.Type.STRING,this.tags.length),this.tags)this.tags.hasOwnProperty(i)&&(i=this.tags[i],t.nw(i));t.Xw(),t.rw()}t.ew(),t.hw()};var s=window.SnapshotInfo=function(t){this.timestamp=null,this.apiServer=null,this.clientIp=null,t&&(void 0!==t.timestamp&&null!==t.timestamp&&(this.timestamp=t.timestamp),void 0!==t.apiServer&&null!==t.apiServer&&(this.apiServer=t.apiServer),void 0!==t.clientIp&&null!==t.clientIp&&(this.clientIp=t.clientIp))};s.prototype={},s.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==u.Type.STOP)break;switch(r){case 1:n==u.Type.I64?this.timestamp=t._p().value:t.XE(n);break;case 2:n==u.Type.STRING?this.apiServer=t.$E().value:t.XE(n);break;case 3:n==u.Type.STRING?this.clientIp=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},s.prototype.write=function(t){t.tw("SnapshotInfo"),null!==this.timestamp&&void 0!==this.timestamp&&(t.iw("timestamp",u.Type.I64,1),t.rp(this.timestamp),t.rw()),null!==this.apiServer&&void 0!==this.apiServer&&(t.iw("apiServer",u.Type.STRING,2),t.nw(this.apiServer),t.rw()),null!==this.clientIp&&void 0!==this.clientIp&&(t.iw("clientIp",u.Type.STRING,3),t.nw(this.clientIp),t.rw()),t.ew(),t.hw()};var e=window.TestInfo=function(t){this.testId=null,t&&void 0!==t.testId&&null!==t.testId&&(this.testId=t.testId)};e.prototype={},e.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==u.Type.STOP)break;switch(r){case 1:n==u.Type.STRING?this.testId=t.$E().value:t.XE(n);break;case 0:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},e.prototype.write=function(t){t.tw("TestInfo"),null!==this.testId&&void 0!==this.testId&&(t.iw("testId",u.Type.STRING,1),t.nw(this.testId),t.rw()),t.ew(),t.hw()};var h=window.InetAddress=function(t){this.address=null,this.port=null,t&&(void 0!==t.address&&null!==t.address&&(this.address=t.address),void 0!==t.port&&null!==t.port&&(this.port=t.port))};h.prototype={},h.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=(i.fname,i.ftype),r=i.fid;if(n==u.Type.STOP)break;switch(r){case 1:n==u.Type.STRING?this.address=t.Sp().value:t.XE(n);break;case 2:n==u.Type.I32?this.port=t.zE().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},h.prototype.write=function(t){t.tw("InetAddress"),null!==this.address&&void 0!==this.address&&(t.iw("address",u.Type.STRING,1),t.ep(this.address),t.rw()),null!==this.port&&void 0!==this.port&&(t.iw("port",u.Type.I32,2),t.sw(this.port),t.rw()),t.ew(),t.hw()}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(16),e=n(14),h=(o.prototype.GK=function(){return Date.now()>=this.xK},o);function o(t,i){this.msg=t,this.xK=Date.now()+i,this.BK=r.defer()}var u=(a.prototype.sh=function(t){var i=t.service+"_"+t.msgId,n=this.AQ[i];null!=n?n(t):s.logger().error(s.loggerId+"Could not find a dispatcher for ",t,i,this.AQ)},a.prototype.on=function(t,i,n){this.AQ[t+"_"+i]=n},a.prototype.onerror=function(t){this.VK.push(t)},a.prototype.onconnect=function(t){this.qK.push(t)},a.prototype.QK=function(){var n=this;if(window.WebSocket){var t=new WebSocket(this.YK);return t.binaryType="arraybuffer",t.onopen=function(t){n.KK(),s.logger().debug(s.loggerId+"HiveServicesConnection established to "+n.YK),n.WK=new n.$K().getTime(),n.XK(),n.qK.forEach(function(t){return t(n)}),n.zK(),n.JK()},t.onclose=function(t){n.close(n.ZK),n.connect()},t.onmessage=function(t){n.sh(s.Lc.Pc(t.data))},t.onerror=function(i){n.close(!0),n.VK.forEach(function(t){return t(i.toString())})},t}this.VK.forEach(function(t){return t("WebSocket not defined")})},a.prototype.isOpen=function(){return null!=this.Vv&&this.Vv.readyState==this.Vv.OPEN},a.prototype.connect=function(t){var i=this;t&&(this.ZK=!0),this.ZK&&1!=this.isOpen()&&(0<this.tW||(-1<this.WK&&new this.$K().getTime()-this.WK>this.iW?(this.nW=e.Rc._c,this.WK=-1):this.nW=Math.min(2*this.nW,this.iW),this.tW=window.setTimeout(function(){i.tW=-1,s.logger().debug(s.loggerId+"Connection attempt to "+i.YK+" [t:"+i.nW+" hb:"+i.rW+"]"),i.Vv=i.QK(),i.nW=Math.max(i.nW,e.Rc._c)},this.nW)))},a.prototype.KK=function(){-1<this.tW&&(clearTimeout(this.tW),this.tW=-1)},a.prototype.close=function(t){this.ZK=null!=t&&t,s.logger().debug(s.loggerId+"Closing connection [reconnect:"+this.ZK+"]"),this.KK(),null!=this.Vv&&(this.Vv.close(),this.Vv=null)},a.prototype.XK=function(){for(;0<this.sW.length;){var i=this.sW.pop();try{i.GK()?i.BK.reject(new Error("Message expired")):(this.zK(),this.Vv.send(i.msg.ia()))}catch(t){if(t.code===DOMException.INVALID_STATE_ERR){this.sW.push(i);break}s.logger().error(s.loggerId+"Failed to send the message, dropped: ",t.code,t.name),i.BK.reject(t)}}this.JK()},a.prototype.zK=function(){this.eW&&(clearTimeout(this.eW),this.eW=null)},a.prototype.JK=function(){var t=this;this.rW&&!this.eW&&(this.eW=window.setInterval(function(){t.send(new s.Lc(HiveStreamingServices.hW,0,""))},this.oW))},a.prototype.send=function(t,i){if(void 0===i&&(i=this.uW),this.sW.length>=this.aW)throw new Error("HiveServices connection cannot queue more messages");var n=new h(t,i);return this.sW.push(n),this.Vv?this.XK():s.logger().warn(s.loggerId+" The websocket is closed, messages are being queued"),n.BK.promise},a.prototype.fW=function(t){this.rW=t,this.rW&&this.JK()},a.prototype.isConnected=function(){return null!=this.Vv},a);function a(t,i,n,r,s,e,h){void 0===i&&(i=3e4),void 0===n&&(n=100),void 0===r&&(r=3e4),void 0===s&&(s=15e3),void 0===e&&(e=Date),void 0===h&&(h=!1),this.nW=1,this.tW=-1,this.WK=-1,this.AQ={},this.VK=[],this.qK=[],this.rW=!1,this.ZK=!0,this.YK=t,this.sW=Array(),this.iW=i,this.aW=n,this.uW=r,this.oW=s,this.$K=e,this.rW=h||/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge./i.test(navigator.userAgent)}i.OF=u},function(t,i){window.HiveStreamingServices={1:"REMOTE_EXECUTOR",cW:1,2:"PEER_FORWARDER",lW:2,3:"PEER_INDEX",vW:3,4:"PEER_BROADCAST",dW:4,5:"PEER_FILTER",EW:5,6:"PEER_LOGGING",wW:6,7:"HIVEJS_TRACKER",pW:7,8:"PEER_SYSTEM",gW:8,9:"HIVEJS_SNAPSHOTS",VS:9,10:"HIVEJS_TICKETS",TF:10,11:"HIVEJS_KEEPALIVE",hW:11,12:"HIVEJS_FORWARDING",bW:12,13:"INTERNAL_TICKET",yW:13,14:"LOCALITY_SERVICE",TW:14}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(t){this.bR=new Date().getTime(),this.NF=t}i.AF=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.uv=function(){return this.p2pId},s.prototype.av=function(){return this.reportingId?this.reportingId:this.p2pId},s);function s(t,i){this.p2pId=t,this.reportingId=i}i.PF=r},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(90),o=(e=h.OG,s(u,e),u.prototype.getCidr=function(){return this.cidr?this.cidr:null},u);function u(){return null!==e&&e.apply(this,arguments)||this}i.fG=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(145),o=n(4),r=n(0),u=n(14),s=(e.prototype.kF=function(){var i=o.defer(),n=this.indexedDB.open("PrivateIPDB");return n.onupgradeneeded=function(){n.result.createObjectStore("PrivateIPStore",{keyPath:"id"})},n.onsuccess=function(){var t=n.result;i.resolve(t)},n.onerror=function(t){i.reject(t)},i.promise},e.prototype.UG=function(){var r=this;if(this.OW)return this.OW;var s=setTimeout(function(){r.logger.warn("Private list retrieval timeout"),e.reject({message:"Private list timeout"})},4e3),e=o.defer();return u.Rc.lf&&this.indexedDB?this.kF().then(function(i){var n=i.transaction("PrivateIPStore","readwrite").objectStore("PrivateIPStore").get("iplist");n.onsuccess=function(){clearTimeout(s);var t=[];h.mW(n.result)||h.mW(n.result.value)||(t=n.result.value.split("|")),e.resolve(t),i.close()},n.onerror=function(t){clearTimeout(s),r.logger.warn("I got an error on indexed db "+t.message),e.reject({message:"Error on indexedDB "+t.message})}}).fail(function(t){clearTimeout(s),r.logger.warn("DB is not open with error"+t.message),e.reject({message:"DB is not open with error "+t.message})}):(clearTimeout(s),e.reject({message:"DB is not ready or enabled"})),this.OW=e.promise,this.OW},e.prototype.YG=function(n){var r=this;if(u.Rc.lf&&this.indexedDB){var s=n.join("|");this.kF().then(function(t){var i=t.transaction("PrivateIPStore","readwrite");i.objectStore("PrivateIPStore").put({id:"iplist",value:s}),i.oncomplete=function(){r.logger.debug("Storing site matched ips ["+n.join(",")+"]"),t.close()}}).fail(function(t){r.logger.warn("DB is not open with error "+t.message)})}},e);function e(){this.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,this.logger=r.Framework.resolve(r.Framework.v.p).log()}i.KG=s},function(t,I,N){(function(h){var i=Object.getOwnPropertyDescriptors||function(t){for(var i=Object.keys(t),n={},r=0;r<i.length;r++)n[i[r]]=Object.getOwnPropertyDescriptor(t,i[r]);return n},o=/%[sdj%]/g;I.format=function(t){if(!b(t)){for(var i=[],n=0;n<arguments.length;n++)i.push(u(arguments[n]));return i.join(" ")}n=1;for(var r=arguments,s=r.length,e=String(t).replace(o,function(t){if("%%"===t)return"%";if(s<=n)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),h=r[n];n<s;h=r[++n])p(h)||!a(h)?e+=" "+h:e+=" "+u(h);return e},I._W=function(t,i){if(void 0!==h&&!0===h.RW)return t;if(void 0===h)return function(){return I._W(t,i).apply(this,arguments)};var n=!1;return function(){if(!n){if(h.SW)throw new Error(i);h.AW?console.trace(i):!1,n=!0}return t.apply(this,arguments)}};var t,r={};function u(t,i){var n={IW:[],NW:e};return 3<=arguments.length&&(n.kW=arguments[2]),4<=arguments.length&&(n.DW=arguments[3]),w(i)?n.jW=i:i&&I.MW(n,i),y(n.jW)&&(n.jW=!1),y(n.kW)&&(n.kW=2),y(n.DW)&&(n.DW=!1),y(n.PW)&&(n.PW=!0),n.DW&&(n.NW=s),l(n,t,n.kW)}function s(t,i){var n=u.LW[i];return n?"\x1b["+u.DW[n][0]+"m"+t+"\x1b["+u.DW[n][1]+"m":t}function e(t,i){return t}function l(i,n,r){if(i.PW&&n&&_(n.inspect)&&n.inspect!==I.inspect&&(!n.constructor||n.constructor.prototype!==n)){var t=n.inspect(r,i);return b(t)||(t=l(i,t,r)),t}var s=function(t,i){if(y(i))return t.NW("undefined","undefined");if(b(i)){var n="'"+JSON.stringify(i).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.NW(n,"string")}if(g(i))return t.NW(""+i,"number");if(w(i))return t.NW(""+i,"boolean");if(p(i))return t.NW("null","null")}(i,n);if(s)return s;var e=Object.keys(n),h=function(t){var n={};return t.forEach(function(t,i){n[t]=!0}),n}(e);if(i.jW&&(e=Object.getOwnPropertyNames(n)),m(n)&&(0<=e.indexOf("message")||0<=e.indexOf("description")))return v(n);if(0===e.length){if(_(n)){var o=n.name?": "+n.name:"";return i.NW("[Function"+o+"]","special")}if(T(n))return i.NW(RegExp.prototype.toString.call(n),"regexp");if(O(n))return i.NW(Date.prototype.toString.call(n),"date");if(m(n))return v(n)}var u,a="",f=!1,c=["{","}"];E(n)&&(f=!0,c=["[","]"]),_(n)&&(a=" [Function"+(n.name?": "+n.name:"")+"]");return T(n)&&(a=" "+RegExp.prototype.toString.call(n)),O(n)&&(a=" "+Date.prototype.toUTCString.call(n)),m(n)&&(a=" "+v(n)),0!==e.length||f&&0!=n.length?r<0?T(n)?i.NW(RegExp.prototype.toString.call(n),"regexp"):i.NW("[Object]","special"):(i.IW.push(n),u=f?function(i,n,r,s,t){for(var e=[],h=0,o=n.length;h<o;++h)R(n,String(h))?e.push(d(i,n,r,s,String(h),!0)):e.push("");return t.forEach(function(t){t.match(/^\d+$/)||e.push(d(i,n,r,s,t,!0))}),e}(i,n,r,h,e):e.map(function(t){return d(i,n,r,h,t,f)}),i.IW.pop(),function(t,i,n){return 60<t.reduce(function(t,i){return 0<=i.indexOf("\n")&&0,t+i.replace(/\u001b\[\d\d?m/g,"").length+1},0)?n[0]+(""===i?"":i+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+i+" "+t.join(", ")+" "+n[1]}(u,a,c)):c[0]+a+c[1]}function v(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,i,n,r,s,e){var h,o,u;if((u=Object.getOwnPropertyDescriptor(i,s)||{value:i[s]}).get?o=u.set?t.NW("[Getter/Setter]","special"):t.NW("[Getter]","special"):u.set&&(o=t.NW("[Setter]","special")),R(r,s)||(h="["+s+"]"),o||(t.IW.indexOf(u.value)<0?-1<(o=p(n)?l(t,u.value,null):l(t,u.value,n-1)).indexOf("\n")&&(o=e?o.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+o.split("\n").map(function(t){return"   "+t}).join("\n")):o=t.NW("[Circular]","special")),y(h)){if(e&&s.match(/^\d+$/))return o;h=(h=JSON.stringify(""+s)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(h=h.substr(1,h.length-2),t.NW(h,"name")):(h=h.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.NW(h,"string"))}return h+": "+o}function E(t){return Array.isArray(t)}function w(t){return"boolean"==typeof t}function p(t){return null===t}function g(t){return"number"==typeof t}function b(t){return"string"==typeof t}function y(t){return void 0===t}function T(t){return a(t)&&"[object RegExp]"===n(t)}function a(t){return"object"==typeof t&&null!==t}function O(t){return a(t)&&"[object Date]"===n(t)}function m(t){return a(t)&&("[object Error]"===n(t)||t instanceof Error)}function _(t){return"function"==typeof t}function n(t){return Object.prototype.toString.call(t)}function f(t){return t<10?"0"+t.toString(10):t.toString(10)}I.HW=function(i){if(y(t)&&(t=h.Ge.UW||""),i=i.toUpperCase(),!r[i])if(new RegExp("\\b"+i+"\\b","i").test(t)){var n=h.FW;r[i]=function(){var t=I.format.apply(I,arguments)}}else r[i]=function(){};return r[i]},(I.inspect=u).DW={bold:[1,22],GW:[3,23],xW:[4,24],inverse:[7,27],BW:[37,39],VW:[90,39],qW:[30,39],blue:[34,39],QW:[36,39],green:[32,39],YW:[35,39],red:[31,39],KW:[33,39]},u.LW={WW:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",gT:"magenta",$W:"red"},I.isArray=E,I.cg=w,I.vg=p,I.mW=function(t){return null==t},I.dg=g,I.Eg=b,I.XW=function(t){return"symbol"==typeof t},I.wg=y,I.zW=T,I.tc=a,I.JW=O,I.ZW=m,I.lg=_,I.t$=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},I.isBuffer=N(146);var c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(t,i){return Object.prototype.hasOwnProperty.call(t,i)}I.log=function(){},I.DE=N(147),I.MW=function(t,i){if(!i||!a(i))return t;for(var n=Object.keys(i),r=n.length;r--;)t[n[r]]=i[n[r]];return t};var S="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function A(t,i){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return i(t)}I.i$=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(S&&e[S]){var t;if("function"!=typeof (t=e[S]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,S,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var n,r,t=new Promise(function(t,i){n=t,r=i}),i=[],s=0;s<arguments.length;s++)i.push(arguments[s]);i.push(function(t,i){t?r(t):n(i)});try{e.apply(this,i)}catch(t){r(t)}return t}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),S&&Object.defineProperty(t,S,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,i(e))},I.i$.n$=S,I.r$=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],i=0;i<arguments.length;i++)t.push(arguments[i]);var n=t.pop();if("function"!=typeof n)throw new TypeError("The last argument must be of type Function");function r(){return n.apply(s,arguments)}var s=this;e.apply(this,t).then(function(t){h.Me(r,null,t)},function(t){h.Me(A,t,r)})}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,i(e)),t}}).call(this,N(37))},function(t,i){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.jN&&"function"==typeof t.fill&&"function"==typeof t.wI}},function(t,i){"function"==typeof Object.create?t.exports=function(t,i){t.s$=i,t.prototype=Object.create(i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,i){t.s$=i;function n(){}n.prototype=i.prototype,t.prototype=new n(),t.prototype.constructor=t}},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(20),o=n(26),u=(e=h.HiveTechOptions,s(a,e),a);function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.enableXhrInterception=o.Y.Ef,t}i.StatsJSOptions=u;function f(){this.hiveEnableXhrInterception="enableXhrInterception"}i.StatsJSUrlConfigurableOptions=f},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(94),o=n(1),u=n(32),a=n(95),f=(e=h.VA,s(c,e),c);function c(n,t){var r=e.call(this,n,null)||this;r.pluginId=t,r.pluginId||(r.pluginId=u.aR.getInstance().wA());var s=n.send;return n.send=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];a.Rx.getInstance().AR(r.pluginId,r.url)||o.ErrorMonitor.getInstance().logError("Failed to initialize session on player request"),s.apply(n,t)},r}i.nx=f},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(0),o=n(151),u=n(171),a=n(102),f=(e=a.eV,s(c,e),c.prototype.init=function(t,i){this.reportingInstance=t,this.logger=h.Framework.resolve(h.Framework.v.p).log(i)},c.prototype.nV=function(t,i){return new u.e$(this.reportingInstance,i?i.hls:void 0)},c.prototype.rV=function(t,i){return new o.h$(this.reportingInstance,i?i.dash:void 0)},c);function c(){return null!==e&&e.apply(this,arguments)||this}i.ax=f},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(96),o=n(33),u=(e=h.XH,s(a,e),a.prototype.ex=function(t){e.prototype.ex.call(this,t),void 0===this.FH&&(this.FH=this.metadata.isLive())},a);function a(t,i){var n=e.call(this,t)||this;return n.metadata=o.Dash.SA(n.UL,{Yx:!1},null,i),n}i.h$=u},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,u=n(97),a=n(64),h=n(33),f=n(4),c=n(7),o=(e=u.bB,s(l,e),l.prototype.hH=function(i){var n=this,t=this.S_(i.k_());if(t!==c.xa.Va&&t!==c.xa.Ba)return f.resolve(!1);var o=this.MH(i.k_());if(!o||o.next)return f.resolve(!1);var r=f.defer(),s=f.defer();if(this.Xx)h.Dash.MA?this.Xx.o$().then(function(t){t?n.Xx.decrypt(i.getResponse()).then(function(t){s.resolve(n.eB(t))}).fail(function(t){return s.reject(!0)}):s.reject(!1)}):s.reject(!1);else try{var e=this.eB(i.getResponse());s.resolve(e)}catch(t){this.logger.warn("error extracting duration",t),s.reject(!0)}return s.promise.then(function(e){if(!isNaN(e)){var h=o.id+e;n.logger.debug("found next fragment: "+o.id+" -> "+h+" duration: "+e),n.Ix.forEach(function(t){if(t.type===o.hA){var i=t.Mx.replace(u.bB.$x,o.id+""),n=t.Mx.replace(u.bB.$x,h+""),r=t.Bx.get(i);if(!t.Bx.has(n)&&r){r.duration=e;var s=new a.iH(h,t.qualityLevel,e,n,n,r.hA);r.next=s,t.Bx.set(n,s),t.qx.set(h,s)}}})}r.resolve(!1)}).fail(function(t){n.logger.debug("could not extract duration from "+i.k_()+" [reevaluate: "+t+"]"),r.resolve(t)}),r.promise},l);function l(){return null!==e&&e.apply(this,arguments)||this}i.IA=o},function(t,i,n){"use strict";t.exports=u;n(10);var r=n(11),s=n(41),e=n(12),h=n(40),o=n(74);function u(t,i,n,r){if(!(this instanceof u))return new u(t,i,n,r);this.Re=i||Object.equals,this._f=n||Object.compare,this.Ae=r||Function._e,this.root=null,this.length=0,this.hiveAddEach(t)}function a(t){this.value=t,this.left=null,this.right=null,this.length=1}function f(t,i,n){if(this.set=t,this.RP=null,this.end=n,i){var r=this.set.u$(i);r&&(this.set.a$(r.value),this.RP=r.f$())}}u.c$=u,Object.hiveAddEach(u.prototype,r.prototype),Object.hiveAddEach(u.prototype,s.prototype),Object.hiveAddEach(u.prototype,e.prototype),Object.hiveAddEach(u.prototype,h.prototype),u.prototype.zH=!0,u.prototype.Ne=function(t){return new this.constructor(t,this.Re,this._f,this.Ae)},u.prototype.has=function(t,i){if(i)throw new Error("SortedSet#has does not support second argument: equals");return!!this.root&&(this.a$(t),this.Re(t,this.root.value))},u.prototype.get=function(t,i){if(i)throw new Error("SortedSet#get does not support second argument: equals");return this.root&&(this.a$(t),this.Re(t,this.root.value))?this.root.value:this.Ae(t)},u.prototype.hiveAdd=function(t){var i=new this.Node(t);if(!this.root)return this.yC&&this.RC([t],[],0),this.root=i,this.length++,this.yC&&this.OC([t],[],0),!0;if(this.a$(t),this.Re(t,this.root.value))return!1;var n=this._f(t,this.root.value);if(0===n)throw new Error("SortedSet cannot contain incomparable but inequal values: "+t+" and "+this.root.value);return this.yC&&this.RC([t],[],this.root.index),n<0?(i.right=this.root,i.left=this.root.left,this.root.left=null):(i.left=this.root,i.right=this.root.right,this.root.right=null),this.root.l$(),i.l$(),this.root=i,this.length++,this.yC&&this.OC([t],[],this.root.index),!0},u.prototype["delete"]=function(t,i){if(i)throw new Error("SortedSet#delete does not support second argument: equals");if(this.root&&(this.a$(t),this.Re(t,this.root.value))){var n=this.root.index;if(this.yC&&this.RC([],[t],n),this.root.left){var r=this.root.right;this.root=this.root.left,this.a$(t),this.root.right=r}else this.root=this.root.right;return this.length--,this.root&&this.root.l$(),this.yC&&this.OC([],[t],n),!0}return!1},u.prototype.indexOf=function(t,i){if(i)throw new Error("SortedSet#indexOf does not support second argument: startIndex");return this.root&&(this.a$(t),this.Re(t,this.root.value))?this.root.index:-1},u.prototype.find=function(t,i,n){if(i)throw new Error("SortedSet#find does not support second argument: equals");if(n)throw new Error("SortedSet#find does not support third argument: index");if(this.root&&(this.a$(t),this.Re(t,this.root.value)))return this.root},u.prototype.v$=function(t){if(this.root){for(t=t||this.root;t.right;)t=t.right;return t}},u.prototype.d$=function(t){if(this.root){for(t=t||this.root;t.left;)t=t.left;return t}},u.prototype.E$=function(t){if(this.root)return this.a$(t),0<this._f(this.root.value,t)?this.root.f$():this.root},u.prototype.w$=function(t){if(this.root)return this.a$(t),0<=this._f(this.root.value,t)?this.root.f$():this.root},u.prototype.u$=function(t){if(this.root)return this.a$(t),0<=this._f(this.root.value,t)?this.root:this.root.p$()},u.prototype.g$=function(t){if(this.root)return this.a$(t),this._f(this.root.value,t)<=0?this.root.p$():this.root},u.prototype.pop=function(){if(this.root){var t=this.v$();return this["delete"](t.value),t.value}},u.prototype.shift=function(){if(this.root){var t=this.d$();return this["delete"](t.value),t.value}},u.prototype.push=function(){this.hiveAddEach(arguments)},u.prototype.unshift=function(){this.hiveAddEach(arguments)},u.prototype.slice=function(t,i){t=t||0,i=i||this.length,t<0&&(t+=this.length),i<0&&(i+=this.length);var n=[];if(this.root)for(this.b$(t);this.root.index<i&&(n.push(this.root.value),this.root.right);)this.a$(this.root.p$().value);return n},u.prototype.splice=function(t,i){return this.MP(t,i,Array.prototype.slice.call(arguments,2))},u.prototype.MP=function(t,i,n){if(void 0===t&&void 0===i)return[];(t=t||0)<0&&(t+=this.length),void 0===i&&(i=1/0);var r=[];if(this.root){this.b$(t);for(var s=0;s<i;s++){r.push(this.root.value);var e=this.root.p$();if(this["delete"](this.root.value),!e)break;this.a$(e.value)}}return this.hiveAddEach(n),r},u.prototype.a$=function(t){var i,n,r,s,e,h;if(this.root){for(i=n=r=new this.Node(),h=new this.Node(),e=this.root;;){var o=this._f(t,e.value);if(o<0){if(!e.left)break;if(this._f(t,e.left.value)<0&&(s=e.left,e.left=s.right,e.l$(),s.right=e,s.l$(),!(e=s).left))break;(s=new a()).right=e,s.left=h.left,h.left=s,r.left=e,r.l$(),e=(r=e).left}else{if(!(0<o))break;if(!e.right)break;if(0<this._f(t,e.right.value)&&(s=e.right,e.right=s.left,e.l$(),s.left=e,s.l$(),!(e=s).right))break;(s=new a()).left=e,s.right=h.right,h.right=s,n.right=e,n.l$(),e=(n=e).right}}for(n.right=e.left,n.l$(),r.left=e.right,r.l$(),e.left=i.right,e.right=i.left;h.left;)h.left.right.l$(),h.left=h.left.left;for(;h.right;)h.right.left.l$(),h.right=h.right.right;e.l$(),this.root=e}},u.prototype.b$=function(t){if(this.root){for(var i=this.root,n=this.root.index;n!==t;)if(t<n&&i.left)n-=1+((i=i.left).right?i.right.length:0);else{if(!(n<t&&i.right))break;n+=1+((i=i.right).left?i.left.length:0)}return this.a$(i.value),this.root.index===t}return!1},u.prototype.reduce=function(t,i,n){return this.root&&(i=this.root.reduce(t,i,0,n,this)),i},u.prototype.reduceRight=function(t,i,n){return this.root&&(i=this.root.reduceRight(t,i,this.length-1,n,this)),i},u.prototype.min=function(t){var i=this.d$(t);if(i)return i.value},u.prototype.max=function(t){var i=this.v$(t);if(i)return i.value},u.prototype.kf=function(){return this.min()},u.prototype.clear=function(){var t;this.yC&&(t=this.toArray(),this.RC([],t,0)),this.root=null,this.length=0,this.yC&&this.OC([],t,0)},u.prototype.Df=function(t,i){return new this.Iterator(this,t,i)},u.prototype.Iterator=f,u.prototype.summary=function(){return this.root?this.root.summary():"()"},u.prototype.log=function(t,i,n,r){t=t||o.dU,i=i||this.Ce,n||(n=emptyFunction,r=console),n=n.bind(r),this.root&&this.root.log(t,i,n,n)},u.prototype.Ce=function(t,i,n){i(" "+t.value)},u.y$=o,(u.prototype.Node=a).prototype.reduce=function(t,i,n,r,s,e){if(e=e||0,this.left){var h=this.left.length;i=this.left.reduce(t,i,n,r,s,e+1),n+=h}return i=t.call(r,i,this.value,n,s,this,e),n+=1,this.right&&(i=this.right.reduce(t,i,n,r,s,e+1)),i},a.prototype.reduceRight=function(t,i,n,r,s,e){return e=e||0,this.right&&(i=this.right.reduce(t,i,n,r,s,e+1),n-=this.right.length),i=t.call(r,i,this.value,this.value,s,this,e),n-=1,this.left&&(i=this.left.reduce(t,i,n,r,s,e+1)),i},a.prototype.l$=function(){this.length=1+(this.left?this.left.length:0)+(this.right?this.right.length:0),this.index=this.left?this.left.length:0},a.prototype.T$=function(){var t=1;if(t+=this.left?this.left.T$():0,t+=this.right?this.right.T$():0,this.length!==t)throw new Error("Integrity check failed: "+this.summary());return t},a.prototype.p$=function(){var t=this;if(t.right){for(t=t.right;t.left;)t=t.left;return t}},a.prototype.f$=function(){var t=this;if(t.left){for(t=t.left;t.right;)t=t.right;return t}},a.prototype.summary=function(){var t=this.value||"-";return t+=" <"+this.length,this.left||this.right?"("+t+" "+(this.left?this.left.summary():"()")+", "+(this.right?this.right.summary():"()")+")":"("+t+")"},a.prototype.log=function(i,t,n,r){var s,e,h,o,u=this;s=this.left&&this.right?i.IC:this.left?i.uU:this.right?i.aU:i.oU,this.left&&this.left.log(i,t,function(t){e?r(i.vU+" "+t):(e=!0,r(i.fU+i.oU+t))},function(t){r("  "+t)}),t(this,function(t){h?n((u.right?i.vU:" ")+t):(h=!0,n(s+t))},function(t){r((u.left?i.vU:" ")+t)}),this.right&&this.right.log(i,t,function(t){o?n("  "+t):(o=!0,n(i.cU+i.oU+t))},function(t){n(i.vU+" "+t)})},f.prototype.PP=null,Object.defineProperty(f.prototype,"LP",{get:function(){return this.PP||(this.PP={done:!1,value:null})}}),f.prototype.next=function(){var t;return(t=this.RP?this.set.g$(this.RP.value):this.set.d$())?void 0!==this.end&&0<=this.set._f(t.value,this.end)?(this.LP.done=!0,this.LP.value=void 0):(this.RP=t,this.LP.value=t.value):(this.LP.done=!0,this.LP.value=void 0),this.LP}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=s(n(98)),u=s(n(155)),a=s(n(99)),f=s(n(156)),c=s(n(157)),l=s(n(159)),v=s(n(160)),d=s(n(161)),E=s(n(163));function s(t){return t&&t.s?t:{"default":t}}function e(t){t=t||{};var i=this.context,n=t.debug,r=void 0,e=void 0,s=void 0,h=void 0,o=void 0;return r={parse:function(t){var i=void 0,n=window.performance.now();if(!(i=h.aB(t)))throw new Error("parsing the manifest failed");var r=window.performance.now();o.XN(i);var s=window.performance.now();return e&&"function"==typeof e.info&&e.info("Parsing complete: ( xml2json: "+(r-n).toPrecision(3)+"ms, objectiron: "+(s-r).toPrecision(3)+"ms, total: "+((s-n)/1e3).toPrecision(3)+"s)"),i.protocol="DASH",i},O$:function(){return s},m$:function(){return o}},e=n&&n._$(r),s=[new c["default"](),new l["default"](),new v["default"](),new f["default"]()],h=new a["default"]({escapeMode:!1,DB:"",arrayAccessForm:"property",jB:"object",HB:!1,MB:!0,BB:!0,qB:s}),o=u["default"](i).create({R$:new d["default"](),period:new E["default"]()}),r}e._B="DashParser",i["default"]=r["default"].AB(e)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=n(98),e=(r=s)&&r.s?r:{"default":r};function h(f){function u(t,i){for(var n in t)i.hasOwnProperty(n)||(i[n]=t[n])}function a(t,i,n){for(var r=0,s=t.length;r<s;++r){var e=t[r];if(i[e.name])if(n[e.name]){if(e.mg){var h=i[e.name],o=n[e.name];"object"===(void 0===h?"undefined":l(h))&&"object"===(void 0===o?"undefined":l(o))?u(h,o):n[e.name]=h+o}}else n[e.name]=i[e.name]}}function c(t,i){for(var n=0,r=t.children.length;n<r;++n){var s=t.children[n],e=i[s.name+"_asArray"];if(e)for(var h=0,o=e.length;h<o;++h){var u=e[h];a(t.properties,i,u),c(s,u)}}}return{XN:function(t){if(null===t||"object"!==(void 0===t?"undefined":l(t)))return t;if("period"in f)for(var i=f.period,n=t.Period_asArray,r=0,s=n.length;r<s;++r){var e=n[r];if(c(i,e),"adaptationset"in f){var h=e.AdaptationSet_asArray;if(h)for(var o=f.R$,u=0,a=h.length;u<a;++u)c(o,h[u])}}return t}}}h._B="ObjectIron";var o=e["default"].AB(h);i["default"]=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=s(n(50)),e=s(n(51));function s(t){return t&&t.s?t:{"default":t}}function h(t,i,n){return i in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t}var o=(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}(u,r["default"]),u);function u(){return function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,u),function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,function(t,i){var n,r=(h(n={},e["default"].MPD,[e["default"].tD,e["default"].iD]),h(n,e["default"].zo,[e["default"].tD]),h(n,e["default"].Fk,[e["default"].nD,e["default"].hD]),h(n,e["default"].Gk,[e["default"].oD]),h(n,e["default"].Xk,[e["default"].rD]),h(n,e["default"].Wk,[e["default"].rD]),h(n,e["default"].Bk,[e["default"].oD]),h(n,e["default"].lD,[e["default"].rD]),h(n,e["default"].Vk,[e["default"].uD,e["default"].oD]),h(n,e["default"].xk,[e["default"].oD,e["default"].eD,e["default"].sD,e["default"].zk,e["default"].vD]),h(n,e["default"].Jk,[e["default"].aD,e["default"].tD]),h(n,e["default"].Zk,[e["default"].aD]),h(n,e["default"].Yk,[e["default"].iD,e["default"].cD,e["default"].Qk,e["default"].dD,e["default"].fD]),h(n,e["default"].ND,[e["default"].aD,e["default"].tD]),h(n,e["default"].CD,[e["default"].aD,e["default"].tD]),h(n,e["default"].kD,[e["default"].aD,e["default"].tD]),h(n,e["default"].DD,[e["default"].aD,e["default"].tD]),h(n,e["default"].jD,[e["default"].aD,e["default"].tD]),h(n,e["default"].MD,[e["default"].aD,e["default"].tD]),h(n,e["default"].PD,[e["default"].aD,e["default"].tD]),h(n,e["default"].LD,[e["default"].aD,e["default"].tD]),h(n,e["default"].HD,[e["default"].aD,e["default"].tD]),h(n,e["default"].xD,[e["default"].aD,e["default"].tD]),h(n,e["default"].UD,[e["default"].fD]),h(n,e["default"].Kk,[e["default"].tD,e["default"].ED,e["default"].wD]),h(n,e["default"].FD,[e["default"].tD]),h(n,e["default"].pD,[e["default"].gD]),h(n,e["default"].rk,[e["default"].aD,e["default"].tD]),n);if(r.hasOwnProperty(i)){var s=r[i];return void 0!==s&&0<=s.indexOf(t.name)}return!1},function(t){return String(t)}))}i["default"]=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=h(n(50)),s=h(n(158)),e=h(n(51));function h(t){return t&&t.s?t:{"default":t}}var o=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,u=(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}(a,r["default"]),a);function a(){return function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,a),function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,function(t){for(var i=[e["default"].aj,e["default"].$D,e["default"].XD,e["default"].hj,e["default"].oj,e["default"].fj,e["default"].pj,e["default"].cj,s["default"].S$,e["default"].ij],n=i.length,r=0;r<n;r++)if(t.nodeName===i[r])return o.test(t.value);return!1},function(t){var i=o.exec(t),n=31536e3*parseFloat(i[3]||0)+2592e3*parseFloat(i[5]||0)+86400*parseFloat(i[7]||0)+3600*parseFloat(i[9]||0)+60*parseFloat(i[11]||0)+parseFloat(i[13]||0);return void 0!==i[1]&&(n=-n),n}))}i["default"]=u},function(t,i,n){"use strict";function r(t,i){for(var n=0;n<i.length;n++){var r=i[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,s),this.init()}Object.defineProperty(i,"s",{value:!0});var e=new(function(t,i,n){return i&&r(t.prototype,i),n&&r(t,n),t}(s,[{key:"init",value:function(){this.A$="stream",this.Va="video",this.Ba="audio",this.I$="text",this.N$="fragmentedText",this.C$="embeddedText",this.k$="muxed",this.D$="image",this.j$="stpp",this.M$="ttml",this.P$="vtt",this.L$="wvtt",this.H$="abrDynamic",this.U$="abrBola",this.F$="abrThroughput",this.G$="slidingWindow",this.x$="ewma",this.B$="Invalid Arguments",this.V$="Missing config parameter(s)",this.q$="Location",this.Q$="initialize",this.Y$="showing",this.K$="hidden",this.W$="CC1",this.$$="CC3",this.UTF8="utf-8",this.X$="schemeIdUri",this.S$="starttime",this.z$="urn:dvb:dash:lowlatency:scope:2019",this.J$="urn:dvb:dash:lowlatency:critical:2019",this.Z$="XML",this.ARRAY_BUFFER="ArrayBuffer"}}]),s)();i["default"]=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,s=n(50),e=(r=s)&&r.s?r:{"default":r},h=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,o=(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}(u,e["default"]),u);function u(){return function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,u),function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,function(t){return h.test(t.value)},function(t){var i=h.exec(t),n=void 0;if(n=Date.UTC(parseInt(i[1],10),parseInt(i[2],10)-1,parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10),i[6]&&parseInt(i[6],10)||0,i[7]&&1e3*parseFloat(i[7])||0),i[9]&&i[10]){var r=60*parseInt(i[9],10)+parseInt(i[10],10);n+=("+"===i[8]?-1:1)*r*60*1e3}return new Date(n)}))}i["default"]=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r,s=n(50),e=(r=s)&&r.s?r:{"default":r},h=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,o=(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}(u,e["default"]),u);function u(){return function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,u),function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,function(t){return h.test(t.value)},function(t){return parseFloat(t)}))}i["default"]=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=e(n(100)),s=e(n(51));function e(t){return t&&t.s?t:{"default":t}}var h=(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}(o,r["default"]),o);function o(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,o);var t=[s["default"].iD,s["default"].bD,s["default"].yD,s["default"].TD,s["default"].OD,s["default"].mD,s["default"].cD,s["default"].Qk,s["default"].dD,s["default"]._D,s["default"].RD,s["default"].SD,s["default"].AD,s["default"].ID,s["default"].ND,s["default"].CD,s["default"].kD,s["default"].DD,s["default"].jD,s["default"].MD];return function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,s["default"].Yk,t,[new r["default"](s["default"].Kk,t,[new r["default"](s["default"].$k,t)])]))}i["default"]=h},function(t,i,n){"use strict";function r(t,i){for(var n=0;n<i.length;n++){var r=i[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}Object.defineProperty(i,"s",{value:!0});var s=(function(t,i,n){return i&&r(t.prototype,i),n&&r(t,n),t}(e,[{key:"name",get:function(){return this.JB}},{key:"merge",get:function(){return this.tX}}]),e);function e(t){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,e);var i;this.JB=t,this.tX=(i=t)&&i.length&&i.charAt(0)===i.charAt(0).toUpperCase()}i["default"]=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=e(n(100)),s=e(n(51));function e(t){return t&&t.s?t:{"default":t}}var h=(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}(o,r["default"]),o);function o(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,o);var t=[s["default"].Gk,s["default"].xk,s["default"].Bk];return function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,s["default"].zo,t,[new r["default"](s["default"].Yk,t,[new r["default"](s["default"].Kk,t)])]))}i["default"]=h},function(t,i,n){if(void 0===r)var r={};r.hB=function(t){return new s(t).parse()},r.iX={},r.iX.nX=function(t,i){var n=i||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(n).decode(t);var r=[],s=0;if("utf-8"===n)for(;s<t.byteLength;){var e=t.getUint8(s++);e<128||(e<224?e=(31&e)<<6:(e<240?e=(15&e)<<12:(e=(7&e)<<18,e|=(63&t.getUint8(s++))<<12),e|=(63&t.getUint8(s++))<<6),e|=63&t.getUint8(s++)),r.push(String.fromCharCode(e))}else for(;s<t.byteLength;)r.push(String.fromCharCode(t.getUint8(s++)));return r.join("")},i.hB=r.hB,i.iX=r.iX,r.rX=function(t){this.offset=void 0===t?0:t};var s=function(t){this.sX=new DataView(t),this.eX=new r.rX(),this.hX=[]};s.prototype.fetch=function(t){var i=this.oX(t,!0);return i.length?i[0]:null},s.prototype.oX=function(t,i){var n=[];return s.uX.call(this,t,n,i),n},s.prototype.parse=function(){for(this.eX.offset=0,this.hX=[];this.eX.offset<this.sX.byteLength;){var t=e.parse(this);if(void 0===t.type)break;this.hX.push(t)}return this},s.uX=function(t,i,n){for(var r in this.type&&this.type==t&&i.push(this),this.hX){if(i.length&&n)return;s.uX.call(this.hX[r],t,i,n)}};var e=function(){this.eX=new r.rX()};e.parse=function(t){var i=new e();return i.aX=t.eX.offset,i.fX=t.fX?t.fX:t,i.sX=t.sX,i.cX=t,i.lX(),t.eX.offset=i.sX.byteOffset+i.sX.byteLength,i},e.prototype.vX=function(t){var i=null;switch(t){case 8:i=this.sX.getInt8(this.eX.offset-this.sX.byteOffset);break;case 16:i=this.sX.getInt16(this.eX.offset-this.sX.byteOffset);break;case 32:i=this.sX.getInt32(this.eX.offset-this.sX.byteOffset);break;case 64:var n=this.sX.getInt32(this.eX.offset-this.sX.byteOffset),r=this.sX.getInt32(this.eX.offset-this.sX.byteOffset+4);i=n*Math.pow(2,32)+r}return this.eX.offset+=t>>3,i},e.prototype.dX=function(t){var i=null;switch(t){case 8:i=this.sX.getUint8(this.eX.offset-this.sX.byteOffset);break;case 16:i=this.sX.getUint16(this.eX.offset-this.sX.byteOffset);break;case 24:i=((n=this.sX.getUint16(this.eX.offset-this.sX.byteOffset))<<8)+(r=this.sX.getUint8(this.eX.offset-this.sX.byteOffset+2));break;case 32:i=this.sX.getUint32(this.eX.offset-this.sX.byteOffset);break;case 64:var n=this.sX.getUint32(this.eX.offset-this.sX.byteOffset),r=this.sX.getUint32(this.eX.offset-this.sX.byteOffset+4);i=n*Math.pow(2,32)+r}return this.eX.offset+=t>>3,i},e.prototype.EX=function(t){for(var i="",n=0;n<t;n++){var r=this.dX(8);i+=String.fromCharCode(r)}return i},e.prototype.wX=function(){for(var t="";;){var i=this.dX(8);if(0==i)break;t+=String.fromCharCode(i)}return t},e.prototype.pX=function(t){return this.dX(t/2)+this.dX(t/2)/Math.pow(2,t/2)},e.prototype.lX=function(){if(this.eX.offset=this.aX,this.aX+8>this.sX.buffer.byteLength)this.fX.gX=!0;else{switch(this.size=this.dX(32),this.type=this.EX(4),1==this.size&&(this.bX=this.dX(64)),"uuid"==this.type&&(this.yX=this.EX(16)),this.size){case 0:this.sX=new DataView(this.sX.buffer,this.aX,this.sX.byteLength-this.eX.offset);break;case 1:this.aX+this.size>this.sX.buffer.byteLength?(this.gX=!0,this.fX.gX=!0):this.sX=new DataView(this.sX.buffer,this.aX,this.bX);break;default:this.aX+this.size>this.sX.buffer.byteLength?(this.gX=!0,this.fX.gX=!0):this.sX=new DataView(this.sX.buffer,this.aX,this.size)}!this.gX&&this.TX[this.type]&&this.TX[this.type].call(this)}},e.prototype.OX=function(){this.version=this.dX(8),this.flags=this.dX(24)},e.prototype.TX={},["moov","trak","tref","mdia","minf","stbl","edts","dinf","mvex","moof","traf","mfra","udta","meco","strk","vttc"].forEach(function(t){e.prototype.TX[t]=function(){for(this.hX=[];this.eX.offset-this.sX.byteOffset<this.sX.byteLength;)this.hX.push(e.parse(this))}}),e.prototype.TX.mX=function(){this.OX(),this._X=this.dX(32),this.entries=[];for(var t=1;t<=this._X;t++){var i={};1==this.version?(i.RX=this.dX(64),i.SX=this.vX(64)):(i.RX=this.dX(32),i.SX=this.vX(32)),i.AX=this.vX(16),i.IX=this.vX(16),this.entries.push(i)}},e.prototype.TX.NX=function(){this.OX(),this.CX=this.wX(),this.value=this.wX(),this.timescale=this.dX(32),this.kX=this.dX(32),this.DX=this.dX(32),this.id=this.dX(32),this.jX=new DataView(this.sX.buffer,this.eX.offset,this.sX.byteLength-(this.eX.offset-this.aX))},e.prototype.TX.MX=e.prototype.TX.XE=function(){this.data=new DataView(this.sX.buffer,this.eX.offset,this.sX.byteLength-(this.eX.offset-this.aX))},e.prototype.TX.PX=e.prototype.TX.LX=function(){for(this.HX=this.EX(4),this.UX=this.dX(32),this.FX=[];this.eX.offset-this.sX.byteOffset<this.sX.byteLength;)this.FX.push(this.EX(4))},e.prototype.TX.GX=function(){this.OX(),this.xX=this.dX(32),this.BX=this.EX(4),this.ld=[this.dX(32),this.dX(32),this.dX(32)],this.name=this.wX()},e.prototype.TX.VX=function(){this.data=new DataView(this.sX.buffer,this.eX.offset,this.sX.byteLength-(this.eX.offset-this.aX))},e.prototype.TX.qX=function(){this.OX(),1==this.version?(this.QX=this.dX(64),this.YX=this.dX(64),this.timescale=this.dX(32),this.duration=this.dX(64)):(this.QX=this.dX(32),this.YX=this.dX(32),this.timescale=this.dX(32),this.duration=this.dX(32));var t=this.dX(16);this.pad=t>>15,this.language=String.fromCharCode(96+(t>>10&31),96+(t>>5&31),96+(31&t)),this.xX=this.dX(16)},e.prototype.TX.KX=function(){this.OX(),this.WX=this.dX(32)},e.prototype.TX.$X=function(){this.OX(),1==this.version?(this.QX=this.dX(64),this.YX=this.dX(64),this.timescale=this.dX(32),this.duration=this.dX(64)):(this.QX=this.dX(32),this.YX=this.dX(32),this.timescale=this.dX(32),this.duration=this.dX(32)),this.rate=this.pX(32),this.volume=this.pX(16),this.XX=this.dX(16),this.zX=[this.dX(32),this.dX(32)],this.matrix=[];for(var t=0;t<9;t++)this.matrix.push(this.pX(32));this.xX=[];for(t=0;t<6;t++)this.xX.push(this.dX(32));this.JX=this.dX(32)},e.prototype.TX.ZX=function(){var t=new DataView(this.sX.buffer,this.eX.offset,this.sX.byteLength-(this.eX.offset-this.aX));this.tz=r.iX.nX(t)},e.prototype.TX.iz=function(){this.OX(),this.nz=this.dX(32),this.timescale=this.dX(32),0==this.version?(this.rz=this.dX(32),this.sz=this.dX(32)):(this.rz=this.dX(64),this.sz=this.dX(64)),this.ld=this.dX(16),this.ez=this.dX(16),this.hz=[];for(var t=0;t<this.ez;t++){var i={},n=this.dX(32);i.oz=n>>31&1,i.uz=2147483647&n,i.az=this.dX(32);var r=this.dX(32);i.fz=r>>31&1,i.cz=r>>28&7,i.lz=268435455&r,this.hz.push(i)}},e.prototype.TX.vz=function(){this.OX(),this.dz=this.dX(32),this.Ez=[];for(var t=0;t<this.dz;t++){var i={};i.wz=this.dX(32),i.pz=[];for(var n=0;n<i.wz;n++){var r={};r.level=this.dX(8),r.gz=this.dX(24),i.pz.push(r)}this.Ez.push(i)}},e.prototype.TX.bz=function(){this.OX(),1==this.version?this.yz=this.dX(64):this.yz=this.dX(32)},e.prototype.TX.tfhd=function(){this.OX(),this.Tz=this.dX(32),1&this.flags&&(this.Oz=this.dX(64)),2&this.flags&&(this.mz=this.dX(32)),8&this.flags&&(this.default_sample_duration=this.dX(32)),16&this.flags&&(this._z=this.dX(32)),32&this.flags&&(this.Rz=this.dX(32))},e.prototype.TX.Sz=function(){this.OX(),1==this.version?(this.QX=this.dX(64),this.YX=this.dX(64),this.Tz=this.dX(32),this.XX=this.dX(32),this.duration=this.dX(64)):(this.QX=this.dX(32),this.YX=this.dX(32),this.Tz=this.dX(32),this.XX=this.dX(32),this.duration=this.dX(32)),this.zX=[this.dX(32),this.dX(32)],this.Az=this.dX(16),this.Iz=this.dX(16),this.volume=this.pX(16),this.Nz=this.dX(16),this.matrix=[];for(var t=0;t<9;t++)this.matrix.push(this.pX(32));this.width=this.dX(32),this.height=this.dX(32)},e.prototype.TX.trun=function(){this.OX(),this.Cz=this.dX(32),1&this.flags&&(this.kz=this.vX(32)),4&this.flags&&(this.Dz=this.dX(32)),this.oB=[];for(var t=0;t<this.Cz;t++){var i={};256&this.flags&&(i.sample_duration=this.dX(32)),512&this.flags&&(i.jz=this.dX(32)),1024&this.flags&&(i.Mz=this.dX(32)),2048&this.flags&&(0==this.version?i.Pz=this.dX(32):i.Pz=this.vX(32)),this.oB.push(i)}},e.prototype.TX.Lz=function(){var t=new DataView(this.sX.buffer,this.eX.offset,this.sX.byteLength-(this.eX.offset-this.aX));this.Hz=r.iX.nX(t)},e.prototype.TX.Uz=function(){var t=new DataView(this.sX.buffer,this.eX.offset,this.sX.byteLength-(this.eX.offset-this.aX));this.config=r.iX.nX(t)},e.prototype.TX.Fz=function(){}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.Representation=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(4),r=n(0),h=n(1),o=n(2),u=function(t,i){this.name=t,this.iv=i},s=(a.prototype.init=function(){var i=this;try{this.Gz();var n=e.defer();this.xz().then(function(){return n.resolve(!0)}).fail(function(t){h.ErrorMonitor.getInstance().logError("Error initializing key",i.loggerId,o.Tn.mn,t),n.resolve(!1)}),this.Bz=n.promise}catch(t){h.ErrorMonitor.getInstance().logError("Error initializing AES Manager",this.loggerId,o.Tn.On,t)}},a.prototype.o$=function(){return this.Bz?this.Bz:e.resolve(!1)},a.prototype.xz=function(){var i=this;if(this.Vz)return this.Vz;var n=e.defer();return this.qz().then(function(t){window.crypto.subtle.importKey("raw",t,i.Qz,!1,["decrypt"]).then(function(t){n.resolve(t)},function(t){n.reject("error importing key: "+t.toString())})}).fail(function(t){return n.reject(t)}),this.Vz=n.promise,this.Vz},a.prototype.Gz=function(){for(var t=2,i=this.Yz.length,n=[];t<i;t+=2)n.push(parseInt(this.Yz.substr(t,2),16));this.iv=new Uint8Array(n)},a.prototype.decrypt=function(i){var n=this,r=e.defer(),s=new u(this.Qz,this.iv);return this.Vz.then(function(t){window.crypto.subtle.decrypt(s,t,i).then(function(t){r.resolve(t)})})["catch"](function(t){h.ErrorMonitor.getInstance().logError("Error decrypting arraybuffer",n.loggerId,o.Tn.Rn,t),n.failed=!0,n.Bz=e.resolve(!1),r.reject(t)}),r.promise},a.prototype.qz=function(){var i=this,n=e.defer(),r=new XMLHttpRequest();return r.responseType="arraybuffer",r.open("GET",this.Kz),this.Wz&&r.setRequestHeader("Authorization",this.Wz),r.onload=function(){if(200===r.status){var t=new Uint8Array(r.response);n.resolve(t)}else h.ErrorMonitor.getInstance().logError("Error downloading key",i.loggerId,o.Tn.Sn,r.status),n.reject("error downloading key - status: "+r.status)},r.onerror=function(){h.ErrorMonitor.getInstance().logError("Error downloading key",i.logger,o.Tn.An),n.reject("error downloading key")},r.send(),n.promise},a.prototype.zx=function(){return this.failed},a);function a(t,i,n){this.loggerId="[DASH AES Manager] ",this.Qz="AES-CBC",this.failed=!1,this.logger=r.Framework&&r.Framework.resolve(r.Framework.v.p)?r.Framework.resolve(r.Framework.v.p).log():console,this.Kz=t,this.Yz=i,this.logger.debug(this.loggerId+"Starting Dash AES Manager"),n&&(this.Wz=n)}i.Jx=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=(e.prototype.init=function(){},e.prototype.o$=function(){return r.resolve(!1)},e.prototype.decrypt=function(t){return r.reject("unsupported")},e.prototype.zx=function(){return!1},e);function e(){}i.Zx=s},function(i,n,r){var s;!function(){"use strict";var d={$z:/[^s]/,Xz:/[^t]/,zz:/[^T]/,Jz:/[^v]/,number:/[diefg]/,Zz:/[bcdiefguxX]/,json:/[j]/,tJ:/[^j]/,text:/^[^\x25]+/,iJ:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,nJ:/^\.([a-z_][a-z_\d]*)/i,rJ:/^\[(\d+)\]/,sign:/^[+-]/};function E(t){return function(t,i){var n,r,s,e,h,o,u,a,f,c=1,l=t.length,v="";for(r=0;r<l;r++)if("string"==typeof t[r])v+=t[r];else if("object"==typeof t[r]){if((e=t[r]).keys)for(n=i[c],s=0;s<e.keys.length;s++){if(null==n)throw new Error(E('[sprintf] Cannot access property "%s" of undefined value "%s"',e.keys[s],e.keys[s-1]));n=n[e.keys[s]]}else n=e.sJ?i[e.sJ]:i[c++];if(d.zz.test(e.type)&&d.Jz.test(e.type)&&n instanceof Function&&(n=n()),d.Zz.test(e.type)&&"number"!=typeof n&&isNaN(n))throw new TypeError(E("[sprintf] expecting number but found %T",n));switch(d.number.test(e.type)&&(a=0<=n),e.type){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=JSON.stringify(n,null,e.width?parseInt(e.width):0);break;case"e":n=e.precision?parseFloat(n).toExponential(e.precision):parseFloat(n).toExponential();break;case"f":n=e.precision?parseFloat(n).toFixed(e.precision):parseFloat(n);break;case"g":n=e.precision?String(Number(n.toPrecision(e.precision))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=e.precision?n.substring(0,e.precision):n;break;case"t":n=String(!!n),n=e.precision?n.substring(0,e.precision):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=e.precision?n.substring(0,e.precision):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=e.precision?n.substring(0,e.precision):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}d.json.test(e.type)?v+=n:(!d.number.test(e.type)||a&&!e.sign?f="":(f=a?"+":"-",n=n.toString().replace(d.sign,"")),o=e.eJ?"0"===e.eJ?"0":e.eJ.charAt(1):" ",u=e.width-(f+n).length,h=e.width&&0<u?o.repeat(u):"",v+=e.align?f+n+h:"0"===o?f+h+n:h+f+n)}return v}(function(t){if(u[t])return u[t];var i,n=t,r=[],s=0;for(;n;){if(null!==(i=d.text.exec(n)))r.push(i[0]);else if(null!==(i=d.iJ.exec(n)))r.push("%");else{if(null===(i=d.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(i[2]){s|=1;var e=[],h=i[2],o=[];if(null===(o=d.key.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(e.push(o[1]);""!==(h=h.substring(o[0].length));)if(null!==(o=d.nJ.exec(h)))e.push(o[1]);else{if(null===(o=d.rJ.exec(h)))throw new SyntaxError("[sprintf] failed to parse named argument key");e.push(o[1])}i[2]=e}else s|=2;if(3===s)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");r.push({placeholder:i[0],sJ:i[1],keys:i[2],sign:i[3],eJ:i[4],align:i[5],width:i[6],precision:i[7],type:i[8]})}n=n.substring(i[0].length)}return u[t]=r}(t),arguments)}function t(t,i){return E.apply(null,[t].concat(i||[]))}var u=Object.create(null);n.gB=E,n.hJ=t,"undefined"!=typeof window&&(window.gB=E,window.hJ=t,void 0===(s=function(){return{gB:E,hJ:t}}.call(n,r,n,i))||(i.exports=s))}()},function(t,i,n){var r,s,e;s=[i],void 0===(e="function"==typeof (r=function(t){"use strict";var i,n;Object.defineProperty(t,"s",{value:!0});var r={YEAR:31536e3,MONTH:2628e3,DAY:86400,HOUR:3600,MINUTE:60,SECOND:1},u="years",a="months",f="days",c="hours",l="minutes",v="seconds",d=((i={}).oJ=0,i.uJ=0,i.aJ=0,i),E=((n={}).fJ=0,n.cJ=0,n.lJ=0,n),s=function(t){return/^-?P((([0-9]+Y([0-9]+M)?([0-9]+D)?|([0-9]+M)([0-9]+D)?|([0-9]+D))(T(([0-9]+H)([0-9]+M)?([0-9]+(\.[0-9]+)?S)?|([0-9]+M)([0-9]+(\.[0-9]+)?S)?|([0-9]+(\.[0-9]+)?S)))?)|(T(([0-9]+H)([0-9]+M)?([0-9]+(\.[0-9]+)?S)?|([0-9]+M)([0-9]+(\.[0-9]+)?S)?|([0-9]+(\.[0-9]+)?S))))$/.test(t)},w=function(t){return"string"==typeof t&&0<t.length},p=function(t){return"-"===t[0]},g=function(t){return t.slice(1)},o=function(t,i){var n=b(i);return function(t,i){return r[t.toUpperCase()]*i}(t,n)},b=function(t){var i=parseFloat(t);return isNaN(i)?0:i},e=function(t){var i=p(t),n=i?g(t):t,r=n.split("T"),s=g(r[0]),e=r[1],h=0;return w(s)&&(h+=function(t){var i=/^(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?$/g.exec(t)||[],n=i[1],r=i[2],s=i[3];return o("year",n)+o("month",r)+o("day",s)}(s)),w(e)&&(h+=function(t){var i=/^(?:(\d+)H)?(?:(\d+)M)?(?:(\d+(?:\.\d+)?)S)?$/g.exec(t)||[],n=i[1],r=i[2],s=i[3];return o("hour",n)+o("minute",r)+o("second",s)}(e)),i?-h:h},h=t.vJ=function(t){var i,n=p(t),r=n?g(t):t,s=r.split("T"),e=g(s[0]),h=s[1],o=((i={}).dJ=n,i);return o=w(e)?Object.assign(o,function(t){var i,n=/^(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?$/g.exec(t)||[],r=n[1],s=n[2],e=n[3];return(i={})[u]=b(r),i[a]=b(s),i[f]=b(e),i}(e)):Object.assign(o,d),o=w(h)?Object.assign(o,function(t){var i,n=/^(?:(\d+)H)?(?:(\d+)M)?(?:(\d+(?:\.\d+)?)S)?$/g.exec(t)||[],r=n[1],s=n[2],e=n[3];return(i={})[c]=b(r),i[l]=b(s),i[v]=b(e),i}(h)):Object.assign(o,E)};t["default"]=function(t,i){return function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if("string"==typeof t)return s(t)?i?h(t):e(t):null;throw new TypeError("expected input to be a string")}(t,i)}})?r.apply(i,s):r)||(t.exports=e)},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(97),o=n(4),u=(e=h.bB,s(a,e),a.prototype.hH=function(t){return o.resolve(!1)},a);function a(){return null!==e&&e.apply(this,arguments)||this}i.AA=u},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(96),o=n(52),u=(e=h.XH,s(a,e),a.prototype.ex=function(t){e.prototype.ex.call(this,t),this.metadata.EJ.has(t.k_())&&void 0===this.FH&&(this.FH=this.metadata.isLive())},a);function a(t,i){var n=e.call(this,t)||this;return n.metadata=o.Mj.SA({Yx:!1},i),n}i.e$=u},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(4),l=n(1),u=n(173),o=n(3),a=n(174),v=n(64),f=n(0),d=n(6),c=n(52),E=n(2),w=n(101),p=n(23),g=n(7),b=(e=w.Sx,s(y,e),y.prototype.getStreamProtocol=function(){return StreamProtocol.HLS},y.prototype.parse=function(i,n){try{var t=new u.wJ();if(t.push(n),t.manifest.playlists)this.pJ(i,t.manifest);else if(t.manifest.segments){var r=this.gJ(i,t.manifest);if(r&&r.bJ&&(this.live=!r.bJ.endList),this.live&&this.Kx.Yx){var s=this.yJ(t.manifest,n),e=s.TJ,h=s.OJ,o=s.mJ;return this.logger.debug("HLS manifest trimmed "+h+" segments ("+o+"s) - new segments:["+r._J.map(function(t){return t.id+":"+t.duration})+"]"),e}}else l.ErrorMonitor.getInstance().logError("Error parsing metadata",this.loggerId,E.sr.Fn,{detailedError:"Manifest has no bitrates or playlist has no segments",url:i});return n}catch(t){return l.ErrorMonitor.getInstance().logError("Error parsing metadata",this.loggerId,E.sr.Fn,{detailedError:t,url:i}),n}},y.prototype.BH=function(t,i){return this.RJ.has(i.id)?this.RJ.get(i.id).qx.get(t):null},y.prototype.HH=function(){return this.EJ.values().map(function(t){return t.qualityLevel})},y.prototype.MH=function(t){return null==this.Bx?null:this.Bx.get(t)},y.prototype.VH=function(i){try{var t=this.Bx.get(i);if(t){var n=t.qualityLevel;return this.RJ.get(n.id).qx.get(t.id+1)}return null}catch(t){return l.ErrorMonitor.getInstance().logError("Error getting the next segment info",this.loggerId,E.sr.Bn,{detailedError:t,url:i}),null}},y.prototype.S_=function(i){try{return c.Mj.yA(i,void 0,this.iB)?g.xa.qa:null!=this.MH(i)?g.xa.Va:g.xa.Qa}catch(t){return l.ErrorMonitor.getInstance().logError("Error getting the entityType",this.loggerId,E.ir.Nn,{detailedError:t,url:i}),g.xa.Qa}},y.prototype.SJ=function(t){return this.EJ.has(t)},y.prototype.AJ=function(){this.EJ=new o(),this.Bx=new o(),this.RJ=new o()},y.prototype.pJ=function(a,t){var f=this;this.UL=a,this.manifest=t,this.AJ(),this.IJ=!0,this.manifest.playlists.forEach(function(t){var i=t.uri,n=t.attributes,r=d.Ma(a,i),s=n.BANDWIDTH,e=n.NJ;Number.isInteger(s)||(l.ErrorMonitor.getInstance().logError("Segment Bitrate is a Float",{bitrate:s}),s=Math.round(s));var h=e?e.width:null,o=e?e.height:null,u=n.gL||null;f.CJ(r,s,h,o,u)})},y.prototype.CJ=function(t,i,n,r,s){var e=t.split("?")[0],h=p.ol.ib(e).toString(p.ol.jg.Mg),o=new a.kJ();o.qualityLevel=this.XF.add(g.xa.Va,{id:h,bitrate:i,width:n,height:r,label:s}),o.DJ=t,this.EJ.set(t,o),this.RJ.set(h,o)},y.prototype.gJ=function(e,t){var h=this;try{this.IJ||0!==this.XF.getAll().length||(this.AJ(),this.CJ(e,null,null,null,null));var o=this.EJ.get(e);if(!o)return void l.ErrorMonitor.getInstance().logError("Playlist url does not match any playlist in the master file",this.loggerId,E.sr.er,{url:e});var u=null!=t.mediaSequence?t.mediaSequence:0,a=[],i=u-1,f=o.qx.get(i),c=[];return t.segments.forEach(function(t){var i=d.Ma(e,t.uri),n=Math.round(1e3*t.duration),r=o.qualityLevel,s=new v.iH(u,r,n,t.uri,i,g.xa.Va);h.Bx.has(i)||c.push(s),h.Bx.set(i,s),o.qx.set(u,s),a.push(s),f&&(f.next=s),f=s,u++}),o.update(t.mediaSequence,t.discontinuitySequence,t.endList,t.targetDuration,a),{bJ:o,_J:c}}catch(t){return l.ErrorMonitor.getInstance().logError("Error updating the playlist",this.loggerId,E.sr.ur,t),null}},y.prototype.yJ=function(t,i){try{for(var n=i.split("\n"),r=Math.max(1,c.Mj.jj),s=null,e=0,h=0,o=t.segments.length-1;r-1<o&&(s=t.segments[o],!(e>=c.Mj.Dj));o--)h++,e+=s.duration;var u="";if(s){for(o=0;o<n.length&&(u=u+n[o]+"\n",n[o].trim()!==s.uri);o++);this.logger.debug("HLS trimmed "+h+" segments for total duration: "+e)}else u=n.join("\n")+"\n",this.logger.debug("HLS trimming disabled (minFragments = "+r+", segments.length = "+t.segments.length+")");return{TJ:u,OJ:h,mJ:e}}catch(t){throw l.ErrorMonitor.getInstance().logError("Error trimming the playlist",this.loggerId,E.sr.ar,t),new Error(t)}},y.prototype.hH=function(t){return h.resolve(!1)},y);function y(t,i){var n=e.call(this,t,i)||this;return n.loggerId="[HLS METADATA] ",n.EJ=new o(),n.IJ=!1,n.logger=(f.Framework.resolve(f.Framework.v.p)||console).log(),n}i._j=b},function(t,i,n){var r=function(){var e={Ay:{}};e.Ay.create=Object.create||function(t){function i(){}return i.prototype=t,new i()},e.Ay.jJ=function(t,i,n){for(var r in t)hasOwnProp.call(t,r)&&i.call(n||this,r,t[r])},e.Ay.mg=function(t,i){if(!i)return t;for(var n in i)hasOwnProp.call(i,n)&&(t[n]=i[n]);return t},e.Ay.MJ=function(t,i){var n,r,s;for(n in t=e.Ay.jN(t),i)hasOwnProp.call(i,n)&&(r=t[n],s=i[n],e.Ay.PJ(r)&&e.Ay.PJ(s)?t[n]=e.Ay.MJ(r,s):t[n]=i[n]);return t},e.Ay.jN=function(t){return e.Ay.mg({},t)},e.Ay.PJ=function(t){return!!t&&"object"==typeof t&&"[object Object]"===t.toString()&&t.constructor===Object},e.Ay.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};e.mergeOptions=function(t,i){var n,r,s;for(n in t=e.Ay.jN(t),i)i.hasOwnProperty(n)&&(r=t[n],s=i[n],e.Ay.PJ(r)&&e.Ay.PJ(s)?t[n]=e.util.mergeOptions(r,s):t[n]=i[n]);return t},(t=function(){this.init=function(){var e={};this.on=function(t,i){e[t]||(e[t]=[]),e[t].push(i)},this.off=function(t,i){var n;return!!e[t]&&(n=e[t].indexOf(i),e[t].splice(n,1),-1<n)},this.trigger=function(t){var i,n,r,s;if(i=e[t])for(s=Array.prototype.slice.call(arguments,1),r=i.length,n=0;n<r;++n)i[n].apply(this,s)},this.dispose=function(){e={}}}}).prototype.LJ=function(i){this.on("data",function(t){i.push(t)})},e.HJ=t;function h(t){for(var i,n=t.split(a),r=n.length,s={};r--;)""!==n[r]&&((i=/([^=]*)=(.*)/.exec(n[r]).slice(1))[0]=i[0].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^\s+|\s+$/g,""),i[1]=i[1].replace(/^['"](.*)['"]$/g,"$1"),s[i[0]]=i[1]);return s}var i,o,u,a=new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))'),t=e.HJ;return(i=function(){var n="";i.prototype.init.call(this),this.push=function(t){var i;for(i=(n+=t).indexOf("\n");-1<i;i=n.indexOf("\n"))this.trigger("data",n.substring(0,i)),n=n.substring(i+1)}}).prototype=new t(),(o=function(){o.prototype.init.call(this)}).prototype=new t(),o.prototype.push=function(t){var i,n;if(0!==(t=t.replace(/^\s+|\s+$/g,"")).length)if("#"===t[0])if(0===t.indexOf("#EXT"))if(t=t.replace("\r",""),i=/^#EXTM3U/.exec(t))this.trigger("data",{type:"tag",UJ:"m3u"});else{if(i=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(t))return n={type:"tag",UJ:"inf"},i[1]&&(n.duration=parseFloat(i[1])),i[2]&&(n.title=i[2]),void this.trigger("data",n);if(i=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(t))return n={type:"tag",UJ:"targetduration"},i[1]&&(n.duration=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(t))return n={type:"tag",UJ:"totalduration"},i[1]&&(n.duration=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(t))return n={type:"tag",UJ:"version"},i[1]&&(n.version=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return n={type:"tag",UJ:"media-sequence"},i[1]&&(n.number=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(t))return n={type:"tag",UJ:"discontinuity-sequence"},i[1]&&(n.number=parseInt(i[1],10)),void this.trigger("data",n);if(i=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(t))return n={type:"tag",UJ:"playlist-type"},i[1]&&(n.playlistType=i[1]),void this.trigger("data",n);if(i=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(t))return n={type:"tag",UJ:"byterange"},i[1]&&(n.length=parseInt(i[1],10)),i[2]&&(n.offset=parseInt(i[2],10)),void this.trigger("data",n);if(i=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(t))return n={type:"tag",UJ:"allow-cache"},i[1]&&(n.jk=!/NO/.test(i[1])),void this.trigger("data",n);if(i=/^#EXT-X-STREAM-INF:?(.*)$/.exec(t))return n={type:"tag",UJ:"stream-inf"},i[1]&&(n.attributes=h(i[1]),n.attributes.NJ&&(r=n.attributes.NJ.split("x"),s={},r[0]&&(s.width=parseInt(r[0],10)),r[1]&&(s.height=parseInt(r[1],10)),n.attributes.NJ=s),n.attributes.BANDWIDTH&&(n.attributes.BANDWIDTH=parseInt(n.attributes.BANDWIDTH,10)),n.attributes.FJ&&(n.attributes.FJ=parseInt(n.attributes.FJ,10))),void this.trigger("data",n);var r,s;if(i=/^#EXT-X-ENDLIST/.exec(t))this.trigger("data",{type:"tag",UJ:"endlist"});else if(i=/^#EXT-X-DISCONTINUITY/.exec(t))this.trigger("data",{type:"tag",UJ:"discontinuity"});else{if(i=/^#EXT-X-KEY:?(.*)$/.exec(t))return n={type:"tag",UJ:"key"},i[1]&&(n.attributes=h(i[1]),n.attributes.IV&&("0x"===n.attributes.IV.substring(0,2)&&(n.attributes.IV=n.attributes.IV.substring(2)),n.attributes.IV=n.attributes.IV.match(/.{8}/g),n.attributes.IV[0]=parseInt(n.attributes.IV[0],16),n.attributes.IV[1]=parseInt(n.attributes.IV[1],16),n.attributes.IV[2]=parseInt(n.attributes.IV[2],16),n.attributes.IV[3]=parseInt(n.attributes.IV[3],16),n.attributes.IV=new Uint32Array(n.attributes.IV))),void this.trigger("data",n);this.trigger("data",{type:"tag",data:t.slice(4,t.length)})}}else this.trigger("data",{type:"comment",text:t.slice(1)});else this.trigger("data",{type:"uri",uri:t})},(u=function(){var t,n=this,r=[],s={};u.prototype.init.call(this),this.GJ=new i(),this.xJ=new o(),this.GJ.LJ(this.xJ),this.manifest={allowCache:!0},this.xJ.on("data",function(i){({tag:function(){({"allow-cache":function(){this.manifest.allowCache=i.jk,"allowed"in i||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var t={};"length"in i&&((s.byterange=t).length=i.length,"offset"in i||(this.trigger("info",{message:"defaulting offset to zero"}),i.offset=0)),"offset"in i&&((s.byterange=t).offset=i.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),0<=i.duration&&(s.duration=i.duration),this.manifest.segments=r},key:function(){i.attributes?"NONE"!==i.attributes.BJ?i.attributes.Rv?(i.attributes.BJ||this.trigger("warn",{message:"defaulting key method to AES-128"}),t={method:i.attributes.BJ||"AES-128",uri:i.attributes.Rv},void 0!==i.attributes.IV&&(t.iv=i.attributes.IV)):this.trigger("warn",{message:"ignoring key declaration without URI"}):t=null:this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(i.number)?this.manifest.mediaSequence=i.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+i.number})},"discontinuity-sequence":function(){isFinite(i.number)?this.manifest.discontinuitySequence=i.number:this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+i.number})},"playlist-type":function(){/VOD|EVENT/.test(i.playlistType)?this.manifest.playlistType=i.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+i.bJ})},"stream-inf":function(){this.manifest.playlists=r,i.attributes?(s.attributes||(s.attributes={}),s.attributes=e.mergeOptions(s.attributes,i.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},discontinuity:function(){s.discontinuity=!0},targetduration:function(){!isFinite(i.duration)||i.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+i.duration}):this.manifest.targetDuration=i.duration},totalduration:function(){!isFinite(i.duration)||i.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+i.duration}):this.manifest.totalDuration=i.duration}}[i.UJ]||function(){}).call(n)},uri:function(){s.uri=i.uri,r.push(s),!this.manifest.targetDuration||"duration"in s||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.targetDuration),t&&(s.key=t),s={}},comment:function(){}})[i.type].call(n)})}).prototype=new t(),u.prototype.push=function(t){this.GJ.push(t)},u.prototype.end=function(){this.GJ.push("\n")},e.VJ=i,e.qJ=o,e.wJ=u,e}();t.exports=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=(e.prototype.update=function(t,i,n,r,s){this.mediaSequence=t,this.discontinuitySequence=i,this.endList=n,this.targetDuration=r,this.segments=s,this.updated=!0},e);function e(){this.qx=new r()}i.kJ=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var s=n(3),r=(d.prototype.HY=function(t,i,n){return this.QJ.has(t)||(this.YJ(t,i,n),this.QJ.set(t,{KJ:d.WJ++,$J:i,XJ:n,events:{}})),this},d.prototype.YJ=function(t,i,n){if(!t[i])throw new Error(d.loggerId+"- method "+i+" is undefined in event target.");if(!t[n])throw new Error(d.loggerId+"- method "+n+" is undefined in event target.")},d.prototype.mY=function(t,i){if(!i){var n=this.QJ.keys(),r=n.length;if(1!==r)throw new Error(d.loggerId+"Incorrect use of non-targeted registerEvents; "+r+" registered");i=t,t=n[0]}var s=this.QJ.get(t);if(!s)throw new Error(d.loggerId+"- target not registered");for(var e=s.$J,h=s.KJ,o=[],u=0,a=Object.keys(i);u<a.length;u++){var f=a[u],c=i[f],l=void 0;if(l="function"==typeof c?c=c.bind(this.plugin):c.IY=c.IY.bind(this.plugin),!s.events[f])try{var v=this.registerEvent(t,e,f,l,c);s.events[f]=v,o.push(f)}catch(t){this.plugin.logger().warn(d.loggerId+" error binding event '"+f+"' on target #"+h+": "+t.toString())}}return this.plugin&&this.plugin.logger().debug(d.loggerId+"Registering events ["+o.join(", ")+"] on target #"+h),0<o.length},d.prototype.registerEvent=function(t,i,n,r,s){return t[i](n,r),s},d.prototype.SR=function(l){var v=this;void 0===l&&(l=!1),this.QJ.forEach(function(t,i){for(var n=t.XJ,r=t.events,s=t.KJ,e=[],h=0,o=Object.keys(r);h<o.length;h++){var u=o[h],a=r[u],f=void 0,c=void 0;if("function"==typeof a?f=a:(f=a.IY,c=a.CY),l||!c)try{v.zJ(i,n,u,f),delete r[u],e.push(u)}catch(t){v.plugin.logger().warn(d.loggerId+" error unbinding event '"+u+"' on target #"+s+": "+t.toString())}}l&&v.QJ["delete"](i),v.plugin&&v.plugin.logger().debug(d.loggerId+"Unregistering events ["+e.join(", ")+"] on target #"+s+" [destroy: "+l+"]")})},d.prototype.zJ=function(t,i,n,r){t[i](n,r)},d.prototype.reset=function(){var r=this;this.QJ.forEach(function(t,i){var n=t.KJ;r.QJ["delete"](i),r.plugin&&r.plugin.logger().debug(d.loggerId+"Reset on target #"+n)})},d.loggerId="[HiveEventsBinder] ",d.WJ=0,d);function d(t,i,n,r){this.QJ=new s(),this.plugin=t,i&&this.HY(i,n,r)}i.fR=r},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(4),o=n(60),u=n(0),a=n(177),f=n(103),c=n(19),l=n(92),v=n(239),d=n(28),E=n(47),w=n(46),p=n(15),g=n(240),b=n(1),y=n(30),T=n(35),O=n(32),m=(e=l.StatsJS,s(_,e),_.prototype.getName=function(){return _.dR},_.prototype.getVersion=function(){return this.plugin.getPluginVersion()},_.prototype.needsReportingInstance=function(){return!0},_.prototype.isReady=function(){return f["default"].getInstance?navigator&&navigator.userAgent&&this.JJ(navigator.userAgent)?h.resolve(!0):h.reject(new d.HiveTechError(d.wR.NOT_READY,"WebRTC DataChannels not supported by browser")):h.reject(new d.HiveTechError(d.wR.NOT_READY,"Not included in the page"))},_.prototype.initSession=function(s,e){var h=this;return this.isReady().then(function(){var t=e.ticket;h.JG();var i=t.VL();0===i.indexOf("//")&&(i=location.protocol+i);var n=h.$G(s,t,i,e),r=h.plugin.getPluginId();return O.aR.getInstance().register(h.plugin,n),w.HiveRequestFactory.register(h),window&&window.activateXHRInterceptor&&window.activateXHRInterceptor(h.plugin.loggerLevel()>y.JS.info,r),n})},_.prototype.isActive=function(t,i,n){void 0===n&&(n=!1);var r=i.manifest.toLowerCase(),s=t.toLowerCase(),e=r.indexOf(".ism/manifest");if(-1<e&&(!n||t===i.manifest)){var h=r.substring(0,e);if(-1<s.indexOf(h))return-1<s.indexOf(".ism/manifest(format=mpd-time-csf)")?this.ZJ?(i.ticket.BL(t),!0):this.tZ(i,"The player does not use HiveRequest, downgrading to StatsJS"):this.tZ(i,"Protocol not supported by HiveJS tech, downgrading to StatsJS")}else if(s===r)return!!this.ZJ||this.tZ(i,"The player does not use HiveRequest, downgrading to StatsJS");return!1},_.prototype.closeSession=function(t,i,n){window&&window.deactivateXHRInterceptor&&window.deactivateXHRInterceptor(),e.prototype.closeSession.call(this,t,i,n);var r=f["default"].getInstance();i?(w.HiveRequestFactory.clearPlugin(this.plugin.getPluginId()),O.aR.getInstance().unregister(this.plugin,t),r&&(r.onStateChange(this.plugin.getPluginId(),c.Il.STOP),r.iZ())):r&&r.onStateChange(this.plugin.getPluginId(),c.Il.IDLE)},_.prototype.tZ=function(t,i){return t.tech=this.vR,w.HiveRequestFactory.register(this.vR),this.ZJ&&this.ZJ.resolve(),this.ZJ=void 0,this.plugin.logger().warn("[HiveJS] "+i),this.onError(new d.HiveTechError(d.wR.SESSION_ERROR,i)),window&&window.deactivateXHRInterceptor&&window.deactivateXHRInterceptor(),!0},_.prototype.nZ=function(t){this.ZJ=t},_.prototype.resetTech=function(){},_.prototype.onActiveSession=function(r){var s=this;u.Framework.h().apply(new a.rZ(!0));var e=f["default"].getInstance();if(e.onStateChange(this.plugin.getPluginId(),c.Il.STOP),this.sZ()&&e.eZ(!0),e.start(r.reportingInstance,this.options_).then(function(t){if(s.JG(),s.ZG=r.reportingInstance,s.ZG.renderStatsCallback=s.options_.renderStatsCallback,s.ZG.xl(f["default"].cv()),s.ZG.Ql.init(s.ZG.Vl,r.ticket.sessionId),s.plugin.options().testId&&s.ZG.Vl.RU(s.plugin.options().testId),r.authenticationToken){var i=e.hZ(s.plugin.getPluginId());i&&i.oZ.j.qH(r.authenticationToken)}s.ZJ&&e.request(s.ZJ,s.plugin.getPluginId()),s.ZG.ql.manifestRequested(r.ticket.sessionId,s.plugin.getPlayerSource(),200);var n=s.plugin.flushTechEvents();n&&0<n.length&&s.ZG.ql.yS(n),s.plugin.updatePlayerInfo(s.ZG)}),null!=this.options().onActiveSession)try{this.options().onActiveSession(r.toHiveSession())}catch(t){b.ErrorMonitor.getInstance().logError("exception in user-defined onActiveSession callback","[HiveJS]",t)}},_.prototype.onStateChange=function(t,i){},_.prototype.$G=function(t,i,n,r){var s=new E.HiveSessionInternal(t,i,n,r,this.plugin.options().onSessionStateChange);return s.SDN=!0,s.id=s.ticket.sessionId,s},_.prototype.uZ=function(){},_.prototype.sZ=function(){var t=new o.OS();return t.mS(navigator.userAgent),"Android"==t._S().name},_.prototype.JJ=function(t){try{var i=new o.OS(t).cL();return"Mobile Safari"!==i.name&&("Safari"===i.name?12<=parseInt(i.KP,10):"function"==typeof RTCPeerConnection.prototype.createDataChannel)}catch(t){return!1}},_.prototype.getPluginId=function(){return this.plugin.getPluginId()},_.prototype.createManifestRequest=function(t){return new g.nx(t)},_.prototype.createRequest=function(t){return new T.VA(t)},_.prototype.supportsXhrInterception=function(){return!0},_.dR="HiveJS",_);function _(t,i,n){var r=e.call(this,t,i)||this;return r.options_=new v.HiveJSOptions(),null!=i[_.dR]&&p.updateOptions(i[_.dR],r.options_),r.vR=n,r}i.HiveJS=m},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(27),s=n(42),e=n(30),h=n(19),o=n(80),u=n(81),a=n(82),f=n(79),c=n(29),l=n(178),v=n(179),d=n(181),E=n(191),w=n(194),p=n(195),g=n(196),b=n(197),y=n(198),T=n(110),O=n(213),m=n(214),_=n(215),R=n(54),S=n(17),A=n(216),I=n(220),N=n(221),C=n(222),k=n(223),D=n(225),j=n(226),M=n(227),P=n(83),L=n(228),H=n(229),U=n(230),F=n(8),G=n(231),x=n(232),B=n(233),V=n(234),q=n(236),Q=n(237),Y=n(108),K=n(89),W=n(91),$=n(84),X=n(85),z=n(86),J=n(87),Z=n(88),tt=F.Y.rf,it=F.Y.sf,nt=F.Y.hf,rt=F.Y.vf,st=(et.prototype.apply=function(t){this.aZ?nt&&t.bind(new r.LR(s.v.jR,K.dG,r.HR.VR)):(rt?(t.bind(new r.LR(s.v.rk,h.Ev,r.HR.VR)),t.bind(new r.LR(s.v.jl,o._F,r.HR.VR))):(t.bind(new r.LR(s.v.rk,h.dv,r.HR.VR)),t.bind(new r.LR(s.v.jl,o.mF,r.HR.VR))),t.bind(new r.LR(s.v.vv,u.CF,r.HR.VR)),t.bind(new r.LR(s.v.Pl,a.GF,r.HR.VR)),t.bind(new r.LR(s.v.p,e.rA,r.HR.VR)),t.bind(new r.LR(s.v.zl,f.Zl,r.HR.XR)),t.bind(new r.LR(s.v.Jl,c.LS,r.HR.XR)),t.bind(new r.LR(s.v.vk,c.Zl,r.HR.XR)),t.bind(new r.LR(s.v.gk,$.WF,r.HR.XR)),t.bind(new r.LR(s.v.bk,X.zF,r.HR.XR)),t.bind(new r.LR(s.v.nv,z.nG,r.HR.XR)),t.bind(new r.LR(s.v.fk,Z.uG,r.HR.XR)),t.bind(new r.LR(s.v.HC,J.rG,r.HR.XR)),nt?t.bind(new r.LR(s.v.jR,K.dG,r.HR.VR)):t.bind(new r.LR(s.v.jR,W.WG,r.HR.VR))),t.bind(new r.LR(s.v.qC,V.fZ,r.HR.XR)),t.bind(new r.LR(s.v.ak,G.lx,r.HR.XR)),t.bind(new r.LR(s.v.tk,P.VF,r.HR.VR)),t.bind(new r.LR(s.v.Kc,l.Hu,r.HR.VR)),t.bind(new r.LR(s.v.PC,v.cZ,r.HR.XR)),t.bind(new r.LR(s.v.MC,d.ax,r.HR.XR)),t.bind(new r.LR(s.v.DC,w.Cache,r.HR.XR)),t.bind(new r.LR(s.v.VC,E.lZ,r.HR.XR)),t.bind(new r.LR(s.v.LC,p.vZ,r.HR.XR)),"undefined"!=typeof HiveOriginalXMLHttpRequest?t.bind(new r.LR(s.v.FC,HiveOriginalXMLHttpRequest)):t.bind(new r.LR(s.v.FC,XMLHttpRequest)),t.bind(new r.LR(s.v.lk,j.dZ,r.HR.VR)),t.bind(new r.LR(s.v.ck,g.EZ,r.HR.XR)),t.bind(new r.LR(s.v.Zc,A.wZ,r.HR.VR)),t.bind(new r.LR(s.v.uk,I.pZ,r.HR.VR)),t.bind(new r.LR(s.v.jC,M.gZ,r.HR.XR)),t.bind(new r.LR(s.v.WC,b.bZ,r.HR.XR)),t.bind(new r.LR(s.v.YC,y.Mu,r.HR.XR)),t.bind(new r.LR(s.v.ZC,T.hY,r.HR.XR)),t.bind(new r.LR(s.v.GC,x.yZ,r.HR.XR)),t.bind(new r.LR(s.v.$C,H.TZ,r.HR.XR)),t.bind(new r.LR(s.v.xC,U.OZ,r.HR.XR)),t.bind(new r.LR(s.v.XC,U.mZ,r.HR.XR)),t.bind(new r.LR(s.v.BC,L.Ru,r.HR.XR)),t.bind(new r.LR(s.v.zC,O._Z,r.HR.XR)),t.bind(new r.LR(s.v.ek,m.RZ,r.HR.XR)),t.bind(new r.LR(s.v.hk,_.SZ,r.HR.XR)),t.bind(new r.LR(s.v.ik,k.AZ,r.HR.XR)),t.bind(new r.LR(s.v.JC,R.mP,r.HR.XR)),t.bind(new r.LR(s.v.nk,D.IZ,r.HR.XR)),t.bind(new r.LR(s.v.dk,S.Al,r.HR.XR)),t.bind(new r.LR(s.v.sk,N.Cu,r.HR.XR)),t.bind(new r.LR(s.v.QC,B.NZ,r.HR.XR)),tt&&(t.bind(new r.LR(s.v.wk,Q.CZ,r.HR.XR)),t.bind(new r.LR(s.v.Ek,q.kZ,r.HR.XR))),it&&t.bind(new r.LR(s.v.sf,Y.Lq,r.HR.XR)),t.bind(new r.LR(s.v.KC,C.DZ,r.HR.XR))},et);function et(t){this.aZ=!1,t&&(this.aZ=t)}i.rZ=st},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(4),r=n(23),h=n(0),o=n(5),s=n(19),u=n(3),a=n(53),f=n(49),c=n(8),l=n(1),v=n(2),d=c.Y.rf,E=c.Y.sf,w=c.Y.ef,p=(g.prototype.init=function(t,i,n){try{w?this.jZ(!1):i?this.jZ(!1):this.jZ(!0),this.tv.MZ(t),this.tv.setReportingGuid(this.reportingInstance.identity.av()),this.tv.PZ(i),this.gw.init(o.xu.Cache.jo,o.xu.Cache.Mo);var r=this.oZ.fM(t,n&&n.contextMatcher);this.tv.setContextId(this.oZ.j.getContextId()),this.reportingInstance.Vl._U.init(t,r),this.reportingInstance.Vl._U.$F(r.yM()),this.LZ.start(this.oZ,this.xV),(d||h.Framework.T()&&a.$j.Yj)&&this.UZ.HZ(this.xV);var s=[this.FZ,this.xV,this.partnership,this.LZ,this.reportingInstance.Vl,this.reportingInstance.ql,this.Yq];(d||h.Framework.T()&&a.$j.Yj)&&s.push(this.UZ),(E||h.Framework.T()&&a.$j.Kj)&&s.push(this.GZ),this.Jc.start(this.swarmId,s),this.reportingInstance.Vl.dF(this.partnership),this.reportingInstance.Vl.DU(this.tv)}catch(t){throw l.ErrorMonitor.getInstance().logError("Error initializing swarm object",this.loggerId,v.Ws.Xs,t),new Error(t)}},g.prototype.jZ=function(t){t&&"undefined"!=typeof navigator&&navigator.hardwareConcurrency?(this.tv.xZ(navigator.hardwareConcurrency),this.tv.BZ(navigator.hardwareConcurrency)):(this.tv.xZ(1),this.tv.BZ(1)),this.logger.debug(this.loggerId+"My score "+this.tv.jq())},g.prototype.VZ=function(t){return r.ol.ib(t).toString(r.ol.jg.Mg)},g.prototype.request=function(t){this.qZ(),this.hM.request(t)},g.prototype.QZ=function(){this.state!==s.Il.STOP?(this.xV.stop(),this.partnership.stop(),this.uM.YZ(),this.uM.KZ(),this.LZ.WZ(),this.UZ&&this.UZ.$Z(),this.reportingInstance.onStateChange(s.Il.IDLE),this.gw.XZ(),this.aM.zZ(),this.hM.JZ(),this.KH.ZZ(),h.Framework.clearTimeout(this.requestTimeout)):this.logger.debug("Ignoring changing state from Stop to Idle")},g.prototype.onStateChange=function(t,i){try{if(this.state!=t){switch(this.logger.info("Switching state "+s.Il[this.state]+" -> "+s.Il[t]),t){case s.Il.STOP:this.QZ(),this.Jc.stop(i);break;case s.Il.IDLE:this.QZ();break;case s.Il.Nl:this.xV.start(),this.partnership.start(this.oZ.j),this.uM.t0(),this.LZ.i0(),this.UZ&&this.UZ.n0(),this.reportingInstance.onStateChange(s.Il.Nl),this.KH.r0()}this.state=t}}catch(t){l.ErrorMonitor.getInstance().logError("Error changing peer status",this.loggerId,v.Ws.zs,t)}},g.prototype.qZ=function(){var t=this;try{h.Framework.clearTimeout(this.requestTimeout),this.onStateChange(s.Il.Nl),this.requestTimeout=h.Framework.setTimeout(function(){t.onStateChange(s.Il.IDLE)},o.xu.Hu.du)}catch(t){l.ErrorMonitor.getInstance().logError("Error requesting timeout",this.loggerId,v.Ws.xs,t)}},g);function g(t){this.state=s.Il.Nl,this.requestTimeout=-1;try{this.logger=h.Framework.resolve(h.Framework.v.p).log(t.ticket.sessionId),this.loggerId="[SWARM] ",this.Jc=h.Framework.resolve(h.Framework.v.Zc),this.sessionId=t.ticket.sessionId,this.reportingInstance=t,this.hM=h.Framework.resolve(h.Framework.v.PC),this.gw=h.Framework.resolve(h.Framework.v.DC),this.xV=h.Framework.resolve(h.Framework.v.YC),this.s0=h.Framework.resolve(h.Framework.v.LC),this.eM=h.Framework.resolve(h.Framework.v.WC),this.partnership=h.Framework.resolve(h.Framework.v.ZC),this.uploadScore=h.Framework.resolve(h.Framework.v.hk),this.e0=h.Framework.resolve(h.Framework.v.ek),this.LZ=h.Framework.resolve(h.Framework.v.ck),this.oM=h.Framework.resolve(h.Framework.v.zC),this.oZ=h.Framework.resolve(h.Framework.v.MC),this.dH=h.Framework.resolve(h.Framework.v.sk),this.tv=h.Framework.resolve(h.Framework.v.KC),this.WH=h.Framework.resolve(h.Framework.v.JC),this.uM=h.Framework.resolve(h.Framework.v.nk),this.aM=h.Framework.resolve(h.Framework.v.jC),this.Yq=h.Framework.resolve(h.Framework.v.BC),this.KH=h.Framework.resolve(h.Framework.v.ak),this.h0=h.Framework.resolve(h.Framework.v.QC),this.FZ=h.Framework.resolve(h.Framework.v.qC),(d||h.Framework.T()&&a.$j.Yj)&&(this.o0=h.Framework.resolve(h.Framework.v.Ek),this.UZ=h.Framework.resolve(h.Framework.v.wk)),(E||h.Framework.T()&&a.$j.Kj)&&(this.GZ=h.Framework.resolve(h.Framework.v.sf)),this.swarmId=this.VZ(t.ticket.CS()),this.KH.init(this),this.s0.init(this),this.aM.init(this),this.Yq.init(this),this.partnership.init(this),this.e0.init(this),this.LZ.init(this),this.oM.init(this),this.oZ.init(this),this.hM.init(this),this.xV.init(this),this.WH.init(this),this.uM.init(this),this.dH.init(this),this.h0.init(this),this.FZ.init(this),(E||h.Framework.T()&&a.$j.Kj)&&this.GZ.init(this),(d||h.Framework.T()&&a.$j.Yj)&&this.UZ.init(this)}catch(t){throw l.ErrorMonitor.getInstance().logError("Error constructing swarm object",this.loggerId,v.Ws.$s,t),new Error(t)}}i.u0=p;var b=(y.prototype.start=function(t,i){this.logger=h.Framework.resolve(h.Framework.v.p).log(t.ticket.sessionId);var n=t.ticket,r=n.pluginId;if(this.a0.has(r))this.logger.warn("SESSION ALREADY ACTIVE "+r);else{f.Lk.oS(t.Wl.client,n.YL(),t.identity.av());var s=new p(t);s.init(n,this.f0,i),this.kS.getConnectivityInfo().then(function(t){var i=t.getNetworkChanged().getPrivateIp();i&&s.tv.bG(i)}).done(),t.Vl.vF(this.kS),this.logger.info("PEER CONTEXT STARTED"),this.a0.set(r,s),this.c0.set(s.swarmId,r)}return 1!=this.a0.length&&!this.l0||h.Framework.T()||(this.v0.init(),this.l0=!1),e.resolve(n.xL())},y.prototype.iZ=function(){this.l0=!0},y.prototype.Yc=function(t){if(this.c0.has(t)){var i=this.c0.get(t);return this.a0.get(i)}return null},y.prototype.hZ=function(t){return this.a0.get(t)},y.prototype.d0=function(t){return this.a0.has(t)?this.a0.get(t).hM:null},y.prototype.request=function(t,i){this.hZ(i).request(t)},y.prototype.onStateChange=function(t,i){var n=this.hZ(t);n&&(n.onStateChange(i,n.swarmId),i===s.Il.STOP&&this.a0["delete"](t))},y.prototype.abort=function(t,i){var n=this.d0(i);n&&n.abort(t)},y.prototype.eZ=function(t){this.f0=t},y.prototype.E0=function(t,i){this.kS.vG(t)},y);function y(){this.a0=new u(),this.c0=new u(),this.l0=!1,this.v0=h.Framework.resolve(h.Framework.v.lk),this.kS=h.Framework.resolve(h.Framework.v.jR),this.f0=!1}i.Hu=b},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(4),a=n(24),f=n(6),e=n(5),h=n(0),c=n(7),o=n(180),u=n(6),l=n(1),v=n(2),d=(E.prototype.init=function(t){this.logger=h.Framework.resolve(h.Framework.v.p).log(t.sessionId),this.eM=t.eM,this.gw=t.gw,this.partnership=t.partnership,this.Vl=t.reportingInstance.Vl,this.sessionId=t.reportingInstance.ticket.sessionId,this.s0=t.s0,this.oM=t.oM,this.w0=t.oZ,this.tv=t.tv,this.aM=t.aM,this.KH=t.KH,this.p0=t.uM,this.renderStats=new o.g0(t.reportingInstance),this.Vl.SU(this.b0)},E.prototype.request=function(t){try{var i=t.url;this.logger.info("HIVE REQ "+i),t.y0=h.Framework.time();var n=this.w0.T0(t),r=n.V_(t.url);this.KH.vx(r),this.BM(t,r,n,a.h_.o_)}catch(t){l.ErrorMonitor.getInstance().logError("Error on player request",this.loggerId,v.Bs.Vs,t)}},E.prototype.BM=function(n,t,i,r){var s=this;if(t.M_()){if(t.S_()!=c.xa.Va)return this.O0(n,t,i,r);var e=i.hH(t,r);if(e.TH)return this.logger.debug("DO NOT CONTINUE WITH THE REQUEST "+t.I_()+". ALREADY REQUESTED  "+e.EH+" PENDING REQUEST "+e.yH),null;if(e.yH&&r==a.h_.o_){var h=this.m0(n,t,i,r);return 0<h.length?(h.forEach(function(t){var i=s._0.get(t);s._0.set(n.id,i),s._0["delete"](t)}),null):(this.logger.info("PREFETCH UPGRADE FAILED. THIS SHOULD NOT HAPPEN. CHECK FOR MULTIPLE PLAYER REQUESTS FOR THE SAME FRAGMENT"),this.O0(n,t,i,r))}return this.O0(n,t,i,r)}var o=f._a.next(),u=new a.J_(n,o,r,t,i);return this._0.set(n.id,u),u.type=a.h_.u_,this.R0(u),u},E.prototype.O0=function(t,i,n,r){var s=this,e=f._a.next(),h=new a.J_(t,e,r,i,n);if(this._0.set(t.id,h),i.S_()==c.xa.Va&&(n.mH(h),r!==a.h_.a_&&r!==a.h_.l_)){var o=i.getQualityLevel(),u=this.tv.ZF();o&&(this.tv.JF(o),this.p0.Oq(this.tv.lP()||this.tv.zM()),u&&o.id===u.id||(this.S0=!0,this.A0=0),this.S0&&this.A0++,this.A0===this.I0&&(this.partnership.XQ(),this.S0=!1,this.A0=0))}return this.N0(i.I_()).then(function(t){s.KH.C0(h,t),s.k0(h,t),n._H(h.I_(),h.N_()),n.IH(i.getQualityLevel())})["catch"](function(){s.D0(i,h),h.S_()==c.xa.Va&&(n.SH(h),h.type==a.h_.o_&&s.b0.add(0))}),h},E.prototype.m0=function(t,i,n,r){return n.OH(t,i,r)},E.prototype.N0=function(t){return this.gw.get(t)},E.prototype.D0=function(t,i){this.eM.contains(t.I_())?(this.logger.debug("OBJ IDX CONTAINS "+i.I_()),i.R_()==a.h_.a_&&(i.type=a.h_.l_),this.v_(i)):i.R_()!=a.h_.l_?this.R0(i):(l.ErrorMonitor.getInstance().logError("P2P PREFETCH FAILED BECAUSE OBJECT INDEX DOES NOT CONTAIN REQUEST ENTITY",this.loggerId,{vA:i.I_()}),i.z_._H(i.I_(),i.N_()))},E.prototype.JZ=function(){var i=this;this._0.forEach(function(t){return i.abort(t.X_)})},E.prototype.abort=function(t){if(this._0.has(t.id)){var i=this._0.get(t.id);try{var n=i.N_();this.logger.debug("REQUEST "+n+" ABORTED "),this.oM.Ze(n)?this.oM.j0(n):this.s0.Ze(n)&&this.s0.j0(n),this._0["delete"](t.id)}catch(t){l.ErrorMonitor.getInstance().logError("Error occurred while aborting the request",this.loggerId,v.Bs.qs,t)}}},E.prototype.v_=function(t){t.type==a.h_.o_&&(t.type=a.h_.c_),t.type==a.h_.l_&&(t.Y_=!0),this.oM.request(t)},E.prototype.M0=function(t){if(0!=t.W_&&(t.L_.E_=t.W_,this.logger.info("ALREADY DOWNLOADED "+t.L_.E_+" BYTES"),t.L_.w_=t.W_),!e.xu.Du.Vo&&t.W_&&(t.L_.E_=0),this.KH.P0(t),t.type!=a.h_.l_)t.type=a.h_.f_,this.R0(t);else if(t.S_()==c.xa.Va){t.z_.RH(t.I_()),t.z_._H(t.I_(),t.N_());var i=t.A_;i.getQualityLevel()&&t.z_.IH(i.getQualityLevel())}},E.prototype.L0=function(t){var i=this;this.logger.info("SUCCESS FROM P2P FOR "+t.k_()+" [REQ "+t.C_+"] ["+a.h_[t.type]+"] AFTER "+t.H_()+" [bw:"+t.U_().Ta()+"]"),this.H0(t),this.U0(t,this.oH(t.type)),this.aM.F0(t);var n=this.s0.G0().ga();this.KH.x0(t,n),this.B0(t).then(function(){t.z_.DH(t),i.V0()})["finally"](function(){i.oH(t.type)&&i.q0(t),i._0["delete"](t.X_.id)})},E.prototype.Q0=function(t){if(t.type!=a.h_.l_)t.type=a.h_.o_,this.R0(t);else if(t.S_()==c.xa.Va){t.z_.RH(t.I_()),t.z_._H(t.I_(),t.N_());var i=t.A_;i.getQualityLevel()&&t.z_.IH(i.getQualityLevel())}},E.prototype.R0=function(t){t.z_.QH().Y0(t.X_),this.KH.hx(t),this.s0.request(t)},E.prototype.K0=function(t){this.V0();var i=this.s0.G0().ga();this.KH.px(t,i),t.S_()==c.xa.Va&&(t.z_.RH(t.I_()),t.z_._H(t.I_(),t.N_())),this.W0(t)},E.prototype.$0=function(t){var i=this;this.H0(t),this.U0(t,this.oH(t.type)),t.type==a.h_.f_&&this.logger.debug("CDN COMPENSATION TIME "+(t.L_.m_-t.X_.y0)+" / "+(t.L_.m_-t.L_.y_)+" P2P TIME "+(t.L_.O_-t.L_.T_)),-1==[c.xa.qa,c.xa.Qa].indexOf(t.S_())&&this.aM.F0(t);var n=this.s0.G0().ga();this.KH.wx(t,n),this.B0(t).then(function(){t.S_()==c.xa.qa&&t.z_.ex(t),-1==[c.xa.qa,c.xa.Qa].indexOf(t.S_())&&t.z_.DH(t),i.V0()})["catch"](function(t){i.logger.error(t)})["finally"](function(){i.oH(t.type)&&i.q0(t),i._0["delete"](t.X_.id)})},E.prototype.H0=function(t){t.type==a.h_.l_&&(t.L_.p2pAgenTrafficSuccessQt=t.L_.E_),t.type==a.h_.a_&&(t.L_.b_=t.L_.g_,t.Q_&&(t.L_.srcOtherRespQt=t.L_.g_)),t.L_.d_=t.L_.g_+t.L_.E_,t.X_.total=t.L_.d_},E.prototype.U0=function(t,i){if(this.X0(t),t.X_.total=t.size,i){var n=f.createEvent(ProgressEvent,"progress",{lengthComputable:!0,total:t.L_.d_,loaded:t.L_.d_,currentTarget:t.X_});t.X_.dispatchEvent(n),t.A_.cA()||(t.X_.response=t.G_(),t.X_.responseText=t.G_())}},E.prototype.q0=function(t){var i=t.X_,n=h.Framework.T()?i.total:t.F_?t.F_.byteLength:0;this.logger.info("RESPOND TO THE PLAYER "+t.I_()+" SIZE "+n),i.status=200,i.statusText="OK",i.readyState=4,"string"==typeof i.response&&"arraybuffer"===i.responseType&&(i.response=f.Ua(i.response)),"text"!=i.responseType&&""!=i.responseType&&delete i.responseText,t.A_.cA()&&(i.response=h.Framework.T()?null:f.Sa(t.F_));var r=f.createEvent(Event,"readystatechange",{currentTarget:i}),s=f.createEvent(ProgressEvent,"load",{bubbles:!1,cancelable:!1,lengthComputable:!1,total:n,currentTarget:i,loaded:n}),e=f.createEvent(ProgressEvent,"loadend",{bubbles:!1,cancelable:!1,lengthComputable:!1,loaded:n,total:0,currentTarget:i});i.dispatchEvent(r),i.dispatchEvent(s),i.dispatchEvent(e)},E.prototype.W0=function(t){this._0["delete"](t.X_.id);var i=t.X_,n={bubbles:!1,cancelable:!1,lengthComputable:!1,loaded:i.total,total:0,currentTarget:i};t.xhr.status&&0<t.xhr.status?(i.status=t.xhr.status,i.K_=t.K_):i.status=404,i.readyState=4,i.dispatchEvent(f.createEvent(Event,"readystatechange",n)),i.dispatchEvent(f.createEvent(ProgressEvent,"load",n)),i.dispatchEvent(f.createEvent(ProgressEvent,"loadend",n))},E.prototype.B0=function(t){var i=this;return t.A_.M_()?this.gw.put(t).then(function(){return i.partnership.z0(t.A_,t.L_.d_,t.partner)})["catch"](function(t){s.resolve(!0)}):s.resolve(!0)},E.prototype.k0=function(t,i){var n=this;t.F_=i.data,t.K_=i.headers,t.J0=i.J0,t.L_=i.L_,t.size=i.length;var r=t.z_.GH().vV(i.length);this.logger.info("SCHEDULE DELIVERY OF "+t.I_()+" IN "+r+" SIZE "+(h.Framework.T()?i.length:t.F_.byteLength)+" BYTES"),h.Framework.setTimeout(function(){n.Z0(t)},r)},E.prototype.Z0=function(t){this.logger.debug("DELIVERY OF "+t.I_()),this.U0(t,!0),this._0["delete"](t.X_.id);var i=t.X_.y0-t.L_.m_;this.logger.info("FRAGMENT PREFETCHED "+i+" MSECS BEFORE PLAYER REQUEST"),0<i&&t.S_()==c.xa.Va&&this.b0.add(i);var n=0;n=0<t.L_.T_?t.X_.y0-t.L_.T_:t.X_.y0-t.L_.O_,this.logger.info("FRAGMENT REQUESTED "+n+" MSECS BEFORE PLAYER REQUEST"),this.q0(t)},E.prototype.oH=function(t){return t!=a.h_.l_&&t!=a.h_.a_},E.prototype.X0=function(t){if(t.type!==a.h_.f_)t.K_=t.X_.K_=t.K_;else{var i="\nContent-Range: bytes=0-"+(t.size-1)+"/"+t.size+"\n";i+="Content-Length: "+t.size+"\n",t.K_=t.X_.K_=i}null==t.K_?t.K_="access-control-allow-origin: *":-1==t.K_.toLowerCase().indexOf("access-control-allow-origin")&&(t.K_=t.K_.trim()+"\naccess-control-allow-origin: *\n")},E.prototype.V0=function(){!h.Framework.T()&&this.renderStats&&this.renderStats.render()},E);function E(){this._0=new r(),this.S0=!1,this.A0=0,this.loggerId="[HiveCache] ",this.I0=5,this.b0=new u.ta()}i.cZ=d},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var u=n(28),r=(s.prototype.t1=function(t){t.uuid=this.reportingInstance.Vl.uS;var i=this.reportingInstance.Vl.Ul.gU,n=this.i1(i.p2pSubRespQt),r=this.i1(i.srcRespQt);t.cdnRequests+=this.i1(i.srcReqN),t.cdnResponses+=this.i1(i.srcRespN),t.cdnResponseErrors+=this.i1(i.srcRespErrN),t.cdnResponseBytes+=this.i1(i.srcRespQt),t.p2pRequests+=this.i1(i.p2pSubReqN),t.p2pResponses+=this.i1(i.p2pSubRespN),t.p2pResponseErrors+=this.i1(i.p2pSubRespErrN),t.p2pResponseBytes+=this.i1(i.p2pSubRespQt),t.savings=this.i1(n/(r+n)*100)},s.prototype.i1=function(t){return t||0},s.prototype.n1=function(e){var h=this;e.uuid=this.reportingInstance.Vl.uS;var t=this.reportingInstance.Vl.Ul.yU,o=this.reportingInstance.Vl.Ul.TU;t.forEach(function(t,i){e.partners[i]||(e.partners[i]=new u.HivePartnerStats());var n=e.partners[i];n.uuid=i;var r=h.i1(t.p2pSuccSent);n.sentBytes+=r,e.p2pPartnerTotalSentBytes+=r;var s=h.i1(t.p2pSuccReceived);n.receivedBytes+=s,n.successTransfers+=h.i1(t.p2pSuccReq),n.failedTransfers+=h.i1(t.p2pFailReq),o.has(i)&&(n.rateReceived=o.get(i).rateReceived),n.lastUpdated=Date.now()})},s.prototype.render=function(){var t=this.reportingInstance.renderStatsCallback;if(t){var i=new u.HiveClientStats();this.t1(i),this.n1(i);try{t(i)}catch(t){}}},s);function s(t){this.reportingInstance=t}i.g0=r},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(182),o=n(189),u=n(0),a=n(102),f=(e=a.eV,s(c,e),c.prototype.init=function(t){this.logger=u.Framework.resolve(u.Framework.v.p).log(t.sessionId),this.GV=t,this.partnership=t.partnership},c.prototype.nV=function(t,i){return new o.e$(t,this.GV,i?i.hls:void 0)},c.prototype.rV=function(t,i){return new h.h$(t,this.GV,i?i.dash:void 0)},c.prototype.sV=function(i){var n=this;null!=this.partnership?this.partnership.stop().then(function(t){n.partnership.start(i)}):this.partnership.start(i)},c.prototype.T0=function(t){if(null==this.j)this.logger.warn("FIRST REQUEST, COULD NOT FIND RIGHT CONTEXT "+t.url);else if(!this.j.s1(t))return this.logger.warn("REQUEST DOES NOT BELONG TO THE CURRENT CONTEXT "+t.url),null;return this.j},c);function c(){var t=null!==e&&e.apply(this,arguments)||this;return t.partnership=null,t}i.ax=f},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(65),o=n(33),u=n(188),c=n(7),l=n(31),a=n(35),f=n(0),v=n(1),d=n(2),E=n(6),w=n(105),p=(e=h.XH,s(g,e),g.prototype.V_=function(i){var t=c.xa.Qa,n=0,r=null,s=0,e=!0,h=!1,o=0;try{if(t=this.S_(i),this.metadata.nB(i))e=!0;else if(t!=c.xa.qa){var u=this.metadata.MH(i);if(null!=u){n=u.duration,r=u.qualityLevel,s=u.id,h=this.M_(i);var a=this.metadata.rB(i)/1e3;o=Math.round(n/a)}else{this.qM(),this.logger.warn("could not extract segment info for "+i);var f=this.metadata.tB(i);f?(this.logger.warn("representation is",f),this.logger.warn("representation holds",f.Bx.map(function(t,i){return i+" => "+t.id}))):this.logger.warn("no representation found for "+i)}}else e=!1;return new l.dA(i,t,e,s,o,r,h,this.getContextId())}catch(t){return v.ErrorMonitor.getInstance().logError("Error getting the entity characteristics based on a url",this.loggerId,d.In.Cn,{detailedError:t,url:i}),new l.dA(i,c.xa.Qa,!1,0,0,null,!1,this.getContextId())}},g.prototype.$M=function(){return e.prototype.nH.call(this,o.Dash.NA,o.Dash.CA)},g.prototype.s1=function(i){try{var t=i.url,n=E.La(t);return E.La(this.metadata.xL()),n===E.La(this.UL)||!(null==this.metadata||!this.metadata.nB(t))||!(o.Dash.yA(t,this.logger,this.metadata.iV())&&this.metadata.xL()!==t&&!o.Dash._A(this.metadata.xL(),t))}catch(t){return v.ErrorMonitor.getInstance().logError("Error identifying if is current context",this.loggerId,d.In.Dn,{detailedError:t,url:i.url}),!1}},g.prototype.ex=function(i){try{this.e1=f.Framework.time();var t=i.G_(),n=i.X_.url,r=this.metadata.parse(n,t,i.X_.internal);this.h1._V(),void 0===this.FH&&(this.FH=this.metadata.isLive()),i.X_.responseText=r,i.X_.response=r,this.o1()}catch(t){v.ErrorMonitor.getInstance().logError("Error parsing received metadata",this.loggerId,d.In.jn,{detailedError:t,url:i.X_.url}),i.G_()&&(i.X_.responseText=i.G_(),i.X_.response=i.G_())}try{this.lH.DM()}catch(t){v.ErrorMonitor.getInstance().logError("Error starting prefetcher after fetching metadata",this.loggerId,d.In.Mn,{detailedError:t,url:i.X_.url})}this.u1()},g.prototype.DH=function(i){var n=this;try{e.prototype.DH.call(this,i),i.S_()!==c.xa.Va&&i.S_()!==c.xa.Ba||(i.S_()===c.xa.Va&&this.xH.wV(i),this.metadata.hH(i).then(function(t){t&&n.u1(),i.S_()==c.xa.Va&&n.lH.SM(i.A_)}).done())}catch(t){v.ErrorMonitor.getInstance().logError("Error when received a fragment",this.loggerId,d.In.Pn,t)}},g.prototype.getContextId=function(){return this.ticket.KL()},g.prototype.hH=function(t,i){var n=t;return n.sH=f.Framework.time(),e.prototype.hH.call(this,n,i)},g.prototype.iP=function(t,i,n,r){return this.metadata.iP(t,i,n,r)},g.prototype.u1=function(){var n=this;try{this.metadata.Xx?this.metadata.Xx.o$().then(function(t){if(t)n.a1=!0,n.logger.debug("Protection evaluation: can decrypt");else{var i="Protection evaluation: cannot decrypt ["+(o.Dash.MA?"error":"disabled")+"]";o.Dash.PA?(n.a1=!0,n.logger.debug(i+", metadata prefetch enabled")):n.logger.warn(i+", metadata prefetch DISABLED")}}).done():this.logger.debug("Protection evaluation: not encrypted")}catch(t){if(v.ErrorMonitor.getInstance().logError("Error evaluating the protection",this.loggerId,d.In.Ln,t),o.Dash.PA){var i="Protection evaluation: cannot decrypt ["+(o.Dash.MA?"error":"disabled")+"]";this.a1=!0,this.logger.debug(i+", metadata prefetch enabled")}}},g.prototype.qM=function(){this.a1&&(null==this.f1&&this.metadata.isLive()?this.c1():this.logger.debug("DASH PRE-FETCHING METADATA ALREADY SCHEDULED OR NOT LIVE"))},g.prototype.o1=function(){this.a1&&null!=this.f1&&(f.Framework.clearTimeout(this.f1),this.f1=null)},g.prototype.c1=function(){var t=this,i=(null!=this.e1?this.e1:0)+o.Dash.kA,n=Math.max(1,i-f.Framework.time()+o.Dash.LA);this.logger.debug("DASH PREFETCHING METADATA "+this.metadata.xL()+" IN "+n),this.f1=f.Framework.setTimeout(function(){t.l1(t.metadata.xL(),f.Framework.time())},n)},g.prototype.l1=function(t,i){var n=this.e1;if(null==n&&(n=0),i<n&&this.c1(),this.metadata&&this.metadata.Gx)this.f1=null,this.e1=f.Framework.time();else{var r=new a.VA(this.ticket.pluginId);r.open("GET",t),r.internal=!0,r.send(),this.f1=null,this.e1=f.Framework.time()}},g.prototype.ZM=function(t,i){try{var n=this.wM(),r=this.CH(),s=n.uA(),e=this.metadata.iP(s,n.getQualityLevel(),t,i),h=f.Framework.time()-r;return Math.max(0,e-h)}catch(t){return v.ErrorMonitor.getInstance().logError("Error calculating the distance duration",this.loggerId,d.In.Hn,t),0}},g.prototype.sB=function(t,i){return this.metadata.sB(t,i)},g.prototype.v1=function(){return o.Dash.jA},g.prototype.tP=function(){return o.Dash.DA},g);function g(t,i,n){var r=e.call(this,t,i)||this;return r.loggerId="[Dash Context] ",r.a1=!0,r.xH=new u.d1(i.tv),r.metadata=o.Dash.SA(r.UL,{Yx:!0},i.sessionId,n),r.h1=new w.CV(r.metadata),r}i.h$=p},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){this.EH=!1,this.yH=!1,this.TH=!1}i.cH=r},function(t,i,n){"use strict";t.exports=h;n(10);var r=n(11),s=n(12),e=n(40);function h(t,i,n,r){if(!(this instanceof h))return new h(t,i,n,r);Array.isArray(t)?t=(this.array=t).splice(0,t.length):this.array=[],this.Re=i||Object.equals,this._f=n||Object.compare,this.Ae=r||Function._e,this.length=0,this.hiveAddEach(t)}function o(t,i,n){for(var r=0,s=t.length-1;r<=s;){var e=r+s>>1,h=n(i,t[e]);if(0<h)r=1+e;else{if(!(h<0))return e;s=e-1}}return-(r+1)}function u(t,i,n,r){var s=o(t,i,n);if(s<0)return-1;for(;0<s&&r(i,t[s-1]);)s--;return r(i,t[s])?s:-1}function a(t,i,n,r){var s=o(t,i,n);if(s<0)return-1;for(;s<t.length-1&&r(i,t[s+1]);)s++;return r(i,t[s])?s:-1}h.E1=h,Object.hiveAddEach(h.prototype,r.prototype),Object.hiveAddEach(h.prototype,s.prototype),Object.hiveAddEach(h.prototype,e.prototype),h.prototype.zH=!0,h.prototype.Ne=function(t){return new this.constructor(t,this.Re,this._f,this.Ae)},h.prototype.has=function(t,i){if(i)throw new Error("SortedSet#has does not support second argument: equals");var n=o(this.array,t,this._f);return 0<=n&&this.Re(this.array[n],t)},h.prototype.get=function(t,i){if(i)throw new Error("SortedArray#get does not support second argument: equals");var n=u(this.array,t,this._f,this.Re);return-1!==n?this.array[n]:this.Ae(t)},h.prototype.hiveAdd=function(t){var i=function(t,i,n){var r=o(t,i,n);if(r<0)return-r-1;for(var s=t.length-1;r<s&&0===n(i,t[r+1]);)r++;return r}(this.array,t,this._f);return this.yC&&this.RC([t],[],i),this.array.splice(i,0,t),this.length++,this.yC&&this.OC([t],[],i),!0},h.prototype["delete"]=function(t,i){if(i)throw new Error("SortedArray#delete does not support second argument: equals");var n=u(this.array,t,this._f,this.Re);return-1!==n&&(this.yC&&this.RC([],[t],n),this.array.splice(n,1),this.length--,this.yC&&this.OC([],[t],n),!0)},h.prototype.kC=function(t,i){if(i){var n=this.array.kC(t,i);return this.length-=n,n}var r=u(this.array,t,this._f,this.Re);if(-1===r)return 0;for(var s=r;this.Re(t,this.array[s]);)s++;var e=this.slice(r,s);return this.yC&&this.RC([],e,r),this.array.splice(r,e.length),this.length-=e.length,this.yC&&this.OC([],e,r),e.length},h.prototype.indexOf=function(t){return u(this.array,t,this._f,this.Re)},h.prototype.lastIndexOf=function(t){return a(this.array,t,this._f,this.Re)},h.prototype.find=function(t,i,n){if(i)throw new Error("SortedArray#find does not support second argument: equals");if(n)throw new Error("SortedArray#find does not support third argument: index");return u(this.array,t,this._f,this.Re)},h.prototype.findLast=function(t,i,n){if(i)throw new Error("SortedArray#findLast does not support second argument: equals");if(n)throw new Error("SortedArray#findLast does not support third argument: index");return a(this.array,t,this._f,this.Re)},h.prototype.push=function(){this.hiveAddEach(arguments)},h.prototype.unshift=function(){this.hiveAddEach(arguments)},h.prototype.pop=function(){var t=this.array.pop();return this.length=this.array.length,t},h.prototype.shift=function(){var t=this.array.shift();return this.length=this.array.length,t},h.prototype.slice=function(){return this.array.slice.apply(this.array,arguments)},h.prototype.splice=function(t,i){return this.MP(t,i,Array.prototype.slice.call(arguments,2))},h.prototype.MP=function(t,i,n){if(void 0===t&&void 0===i)return[];(t=t||0)<0&&(t+=this.length),void 0===i&&(i=1/0);var r=this.slice(t,t+i);return this.yC&&this.RC(n,r,t),this.array.splice(t,i),this.length-=r.length,this.yC&&this.OC([],r,t),this.hiveAddEach(n),r},h.prototype.reduce=function(r,t){var s=arguments[2];return this.array.reduce(function(t,i,n){return r.call(s,t,i,n,this)},t,this)},h.prototype.reduceRight=function(){var r=arguments[2];return this.array.reduceRight(function(t,i,n){return callback.call(r,t,i,n,this)},basis,this)},h.prototype.min=function(){if(this.length)return this.array[0]},h.prototype.max=function(){if(this.length)return this.array[this.length-1]},h.prototype.kf=function(){return this.array.kf()},h.prototype.clear=function(){var t;this.yC&&(t=this.array.slice(),this.RC([],t,0)),this.length=0,this.array.clear(),this.yC&&this.OC([],t,0)},h.prototype.equals=function(t,i){return this.array.equals(t,i)},h.prototype.compare=function(t,i){return this.array.compare(t,i)},h.prototype.Df=function(t,i){return new this.Iterator(this.array,t,i)},h.prototype.toJSON=function(){return this.toArray()},h.prototype.Iterator=Array.prototype.Iterator},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(35),o=(e=h.VA,s(u,e),u);function u(){return null!==e&&e.apply(this,arguments)||this}i.GM=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(6),r=n(1),s=(e.prototype.addEventListener=function(t,i,n){this.events[t]=this.events[t]||[],this.events[t].push(i)},e.prototype.removeEventListener=function(t,i,n){this.events[t]&&(this.events[t]=this.events[t].filter(function(t){return t!==i}))},e.prototype.dispatchEvent=function(i){var n=this;this.events[i.type]&&this.events[i.type].forEach(function(t){try{"function"==typeof t?t.call(n,i):"function"==typeof t.handleEvent&&t.handleEvent(i)}catch(t){r.ErrorMonitor.getInstance().logError(n.loggerId+"Error in callback handler '"+i.type+"'",{error:t})}});var t=this["on"+i.type];if("function"==typeof t)try{t.call(this,i)}catch(t){r.ErrorMonitor.getInstance().logError(this.loggerId+"Error in callback handler '"+i.type+"'",{error:t})}return!1},e.prototype.msCachingEnabled=function(){return void 0!==this.msCaching},e.prototype.overrideMimeType=function(t){this.mimeType=t},e.register=function(t,i){e.BA[t]=i},e.prototype.w1=function(t){this.pluginId||(this.pluginId=e.BA[t])},e.prototype.open=function(t,i,n,r,s){void 0===n&&(n=!0),void 0===r&&(r=null),void 0===s&&(s=null),this.url=i.trim(),this.method=t,this.username=r,this.password=s,this.async=n,this.readyState=this.OPENED;var e=h.createEvent(Event,"readystatechange",{currentTarget:this});this.dispatchEvent(e)},e.prototype.setRequestHeader=function(t,i){if(this.readyState!==this.OPENED)throw new Error("The object's state must be OPENED.");this.g1.push({key:t,value:i})},e.prototype.getResponseHeader=function(t){var i=this.getAllResponseHeaders();if(i){var n={};return i.split(/[\r\n]+/).forEach(function(t){var i=t.match(/^([^:]+): ?(.+)$/);i&&(n[i[1]]=i[2])}),n[t.toLowerCase()]}return null},e.prototype.getAllResponseHeaders=function(){return this.K_},e.prototype.onload=function(t){},e.prototype.onloadend=function(t){},e.prototype.onerror=function(t){},e.prototype.onprogress=function(t){},e.prototype.onreadystatechange=function(t){},e.prototype.onabort=function(t){},e.prototype.onloadstart=function(t){},e.prototype.ontimeout=function(t){},e.BA={},e.Sl=0,e);function e(t){this.loggerId="[HiveXHR] ",this.DONE=4,this.LOADING=3,this.HEADERS_RECEIVED=2,this.OPENED=1,this.UNSENT=0,this.username=null,this.password=null,this.g1=[],this.responseType="",this.readyState=this.UNSENT,this.status=0,this.async=!0,this.timeout=0,this.events={},t&&(this.pluginId=t)}i.xA=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),e=n(21),s=n(8),h=(o.prototype.Y0=function(t){t.url=this.b1(t.url),t.g1=this.T1(t.g1)},o.prototype.O1=function(){this.m1=new r(),this._1=new r()},o.prototype.b1=function(t){var i=this,n=new e(t),r=n.search(!0);this.R1(r);var s=n.search("");return this.m1.keys().forEach(function(t){r[t]=i.m1.get(t)}),Object.keys(r).forEach(function(t){s.qd(t,r[t])}),s.toString()},o.prototype.R1=function(i){var n=this;Object.keys(i).forEach(function(t){(s.Y.Ja.includes(t)||s.Y.Ja.includes("*"))&&n.m1.set(t,i[t])})},o.prototype.T1=function(i){var n=this;this.S1(i);var r=[];return Object.keys(i).forEach(function(t){r[t]=i[t]}),this._1.keys().forEach(function(t){r[t]=n._1.get(t)}),r},o.prototype.S1=function(i){var n=this;Object.keys(i).forEach(function(t){(s.Y.Za.includes(t)||s.Y.Za.includes("*"))&&n._1.set(t,i[t])})},o.prototype.A1=function(){return this.m1},o.prototype.I1=function(){return this._1},o);function o(){this.m1=new r(),this._1=new r()}i.$H=h},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(104),o=(e=h.TV,s(u,e),u);function u(){return null!==e&&e.apply(this,arguments)||this}i.d1=o},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(3),o=n(65),u=n(52),a=n(190),f=n(0),c=n(35),l=n(7),v=n(31),d=n(21),E=n(1),w=n(2),p=n(105),g=(e=o.XH,s(b,e),b.prototype.getContextId=function(){return this.ticket.KL()},b.prototype.s1=function(i){try{var t=i.url=this.N1(i.url);return t===this.UL?(this.C1&&this.logger.debug("SAME MANIFEST "+t+","+this.UL),!0):null!=this.metadata&&this.metadata.SJ(t)?(this.C1&&this.logger.debug("CORRECT PLAYLIST "+t+","+this.UL),!0):null!=this.metadata&&null!=this.metadata.MH(t)?(this.C1&&this.logger.debug("CORRECT SEGMENT "+t+","+this.UL),!0):(u.Mj.yA(t,this.logger,this.metadata.iV())&&this.metadata.xL()!==t&&this.C1&&this.logger.debug("FIRST REQUEST FOR MANIFEST "+t+","+this.UL),!1)}catch(t){return E.ErrorMonitor.getInstance().logError("Error getting the current context of the HiveRequest",this.loggerId,w.ir.Dn,{detailedError:t,url:i.url}),!1}},b.prototype.N1=function(t){return d(t).RE().toString()},b.prototype.V_=function(i){var t=0,n=null,r=0,s=!0,e=!1;try{var h=this.S_(i);if(h!=l.xa.qa){var o=this.metadata.MH(i);null!=o&&(t=o.duration,n=o.qualityLevel,r=o.id,e=this.M_(i))}else s=!1,null!=this.metadata&&this.metadata.EJ.has(i)&&(n=this.metadata.EJ.get(i).qualityLevel,this.e1.set(n.id,f.Framework.time()));return new v.dA(i,h,s,r,t,n,e,this.getContextId())}catch(t){return E.ErrorMonitor.getInstance().logError("Error getting the entityCharacteristics from the url",this.loggerId,w.ir.Cn,{detailedError:t,url:i}),new v.dA(i,l.xa.Qa,!1,0,0,null,!1,this.getContextId())}},b.prototype.ex=function(i){try{var t=i.G_(),n=i.k_(),r=this.metadata.parse(n,t);if(this.metadata.EJ.has(n)){var s=this.metadata.EJ.get(n);this.h1._V(),void 0===this.FH&&(this.FH=!s.endList),this.lH.DM(s.qualityLevel)}i.X_.response=r,i.X_.responseText=r}catch(t){E.ErrorMonitor.getInstance().logError("Error receiving the metadata",this.loggerId,w.ir.nr,{detailedError:t,url:i.k_()}),i.G_()&&(i.X_.responseText=i.G_(),i.X_.response=i.G_())}},b.prototype.DH=function(t){e.prototype.DH.call(this,t),t.S_()!=l.xa.qa&&t.S_()!=l.xa.Qa&&(this.xH.wV(t),t.S_()==l.xa.Va&&this.lH.SM(t.A_))},b.prototype.hH=function(t,i){var n=t;return n.sH=f.Framework.time(),e.prototype.hH.call(this,n,i)},b.prototype.qM=function(t){u.Mj.Cj&&(null==this.f1.get(t.id)&&this.metadata.isLive()?this.c1(t):this.logger.debug("HLS PRE-FETCHING METADATA ALREADY SCHEDULED OR MISSING HLS INFO"))},b.prototype.c1=function(t){var i=this;try{var n=this.metadata.RJ.get(t.id);if(null!=n){var r=this.e1.has(t.id),s=this.e1.get(t.id),e=(r?s:0)+(null!=n.segments?n.segments[n.segments.length-1].duration:u.Mj.Ij),h=Math.max(1,e-f.Framework.time()+u.Mj.Nj);this.logger.info("HLS PREFETCHING METADATA "+n.DJ+" QUALITY LEVEL "+t.id+" IN "+h);var o=f.Framework.setTimeout(function(){i.l1(t,n.DJ,f.Framework.time())},h);this.f1.set(t.id,o)}else this.logger.warn("NO STREAM WITH QL "+t.id)}catch(t){E.ErrorMonitor.getInstance().logError("Error scheduling metadata prefetch",this.loggerId,w.ir.rr,t)}},b.prototype.l1=function(t,i,n){var r=this.e1.get(t.id);if(null==r&&(r=0),n<r)this.c1(t);else{var s=new c.VA(this.ticket.pluginId);s.open("GET",i),s.internal=!0,s.send(),this.f1["delete"](t.id),this.e1.set(t.id,f.Framework.time())}},b.prototype.o1=function(){var n=this;this.f1.keys().forEach(function(t){var i=n.f1.get(t);f.Framework.clearTimeout(i),n.f1["delete"](t)})},b.prototype.$M=function(){return e.prototype.nH.call(this,u.Mj.Rj,u.Mj.Sj)},b.prototype.iP=function(t,i,n,r){return n-t},b.prototype.tP=function(){return u.Mj.Aj},b.prototype.v1=function(){return u.Mj.kj},b.prototype.ZM=function(t,i){try{var n=this.wM(),r=this.CH(),s=n.uA(),e=0;if(s<t)for(var h=this.metadata.BH(s,i);h&&h.id<t;)e+=h.duration,h=h.next;var o=f.Framework.time()-r;return Math.max(0,e-o)}catch(t){return E.ErrorMonitor.getInstance().logError("Error getting the distance duration",this.loggerId,w.ir.Hn,t),0}},b.prototype.sB=function(t,i){return 1},b);function b(t,i,n){var r=e.call(this,t,i)||this;return r.loggerId="[HLS Context] ",r.C1=!1,r.e1=new h(),r.f1=new h(),r.xH=new a.D1(i.tv),r.metadata=u.Mj.SA({Yx:!0},n),r.h1=new p.CV(r.metadata),r}i.e$=g},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(104),o=(e=h.TV,s(u,e),u);function u(){return null!==e&&e.apply(this,arguments)||this}i.D1=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),c=n(4),s=n(0),l=n(192),v=n(106),d=n(193),E=n(1),w=n(2),e=(h.prototype.init=function(t,i){this.j1=t,this.M1=i},h.prototype.put=function(t){var i=c.defer();try{var n=t.I_(),r=t.K_,s=t.F_,e=t.L_.d_-1,h=t.L_.d_;-1==this.P1&&this.L1();var o=null,u=!1;if(this.H1.has(n)){o=this.H1.get(n);var a=new v.MV(0,e,h);u=!0,o.content.forEach(function(t,i){v.HV.LV(i).jV(a)&&(u=!1)})}else{var f=new v.MV(0,e,h).toString();o=new d.U1(t.A_),t.partner&&(o.J0=t.partner.hP.peerInfo),o.content.set(f,new l.F1(h,s,t.L_,t.R_())),this.H1.set(n,o),u=!0,this.G1.unshift(n)}null==o.headers&&null!=r&&(o.headers=r),u?i.resolve(!0):i.reject(!1)}catch(t){E.ErrorMonitor.getInstance().logError("Error adding fragment in LiveCache",this.loggerId,w.ii.Xt,t),i.reject("CACHE PUT ERROR "+t)}return i.promise},h.prototype.get=function(t){var i=c.defer();try{var n=this.H1.get(t);if(null!=n){var r=null;n.content.forEach(function(t,i){if(v.HV.LV(i).kV())return(r=t).headers=n.headers,void (r.J0=n.J0)}),i.resolve(r)}else i.reject(!1)}catch(t){E.ErrorMonitor.getInstance().logError("Error getting fragment from LiveCache",this.loggerId,w.ii.zt,t),i.reject("CACHE GET ERROR "+t)}return i.promise},h.prototype.YM=function(){try{return this.H1.keys()}catch(t){return E.ErrorMonitor.getInstance().logError("Error getting keys from LiveCache",this.loggerId,w.ii.Zt,t),[]}},h.prototype.B1=function(){var i=c.defer();try{i.resolve(this.H1.values())}catch(t){E.ErrorMonitor.getInstance().logError("Error getting elements from LiveCache",this.loggerId,w.ii.ti,t),i.reject("CACHE GET ELEMENTS ERROR "+t)}return i.promise},h.prototype.contains=function(t){var i=c.defer();try{this.H1.has(t)?i.resolve(!0):i.resolve(!1)}catch(t){E.ErrorMonitor.getInstance().logError("Error checking if LiveCache contains the fragment",this.loggerId,w.ii.Jt,t),i.reject("CACHE CONTAINS ERROR "+t)}return i.promise},h.prototype.L1=function(){var t=this;this.V1(),this.logger.debug(this.loggerId+"Starting cache periodic purge"),this.P1=s.Framework.setInterval(function(){t.P()},this.M1)},h.prototype.V1=function(){-1!=this.P1&&(this.logger.debug(this.loggerId+" Stopping cache periodic purge"),s.Framework.clearInterval(this.P1),this.P1=-1)},h.prototype.P=function(){var r=this;try{var s=0,e=0,t=0;this.logger.debug(this.loggerId+" RUNNING GC"),this.G1.every(function(t,i){var n=r.H1.get(t).size();return s+n>r.j1?(e=i,!1):(s+=n,!0)})||(t=this.G1.length-e,this.G1.splice(e,this.G1.length-1).forEach(function(t){r.H1["delete"](t)})),this.logger.debug(this.loggerId+" GC DONE - REMOVED: "+t+" - CURRENT ITEMS: "+this.H1.length+" SIZE: "+s+" "),0===this.H1.length&&(this.logger.debug(this.loggerId+" Cache contains no items, stopping purge timer"),this.V1())}catch(t){E.ErrorMonitor.getInstance().logError("Error purging LiveCache",this.loggerId,w.ii.ni,t)}},h.prototype.XZ=function(){this.H1=new r(),this.G1=[]},h.prototype.q1=function(){var n=this;this.H1.forEach(function(t,i){n.logger.debug("EID="+i),t.content.forEach(function(t,i){n.logger.debug("\tRANGE ",i)})})},h);function h(){this.loggerId="[LIVE CACHE] ",this.H1=new r(),this.P1=-1,this.G1=[],this.logger=s.Framework.resolve(s.Framework.v.p).log()}i.lZ=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(t,i,n,r){this.length=t,this.data=i,this.L_=n,this.Q1=r}i.F1=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(106),s=n(3),e=(h.prototype.size=function(){var n=0;return this.content.forEach(function(t,i){n+=r.HV.LV(i).size()}),n},h);function h(t){this.headers=null,this.J0=null,this.totalSize=0,this.Y1=!1,this.A_=t,this.content=new s()}i.U1=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(4),e=n(2),h=n(1),o=(u.prototype.init=function(t,i){try{this.K1.init(t,i)}catch(t){h.ErrorMonitor.getInstance().logError("Error initializing cache",this.loggerId,e.Wt.$t,t)}},u.prototype.put=function(t){var i=this,n=s.defer();try{this.K1.put(t).then(function(){n.resolve(!0)})["catch"](function(t){t&&h.ErrorMonitor.getInstance().logError("Error adding new fragment in cache",i.loggerId,e.Wt.Xt,t),n.reject(!1)})}catch(t){h.ErrorMonitor.getInstance().logError("Error adding new fragment in cache",this.loggerId,e.Wt.Xt,t),n.reject(!1)}return n.promise},u.prototype.get=function(i){var n=this,r=s.defer();try{this.contains(i).then(function(t){t?n.K1.get(i).then(function(t){r.resolve(t)})["catch"](function(t){t&&h.ErrorMonitor.getInstance().logError("Error getting the fragment from cache",n.loggerId,e.Wt.zt,t),r.reject(!1)}):r.reject(!1)})["catch"](function(t){t&&h.ErrorMonitor.getInstance().logError("Error getting the fragment from cache",n.loggerId,e.Wt.zt,t),r.reject(!1)})}catch(t){h.ErrorMonitor.getInstance().logError("Error getting the fragment from cache",this.loggerId,e.Wt.zt,t),r.reject(!1)}return r.promise},u.prototype.contains=function(t){var i=this,n=s.defer(),r=!1;try{this.K1.contains(t).then(function(t){r=t}).fail(function(t){i.logger.error(t)})["finally"](function(){n.resolve(r)})}catch(t){h.ErrorMonitor.getInstance().logError("Error checking if cache contains the fragment",this.loggerId,e.Wt.Jt,t),n.resolve(!1)}return n.promise},u.prototype.YM=function(){try{return this.K1.YM()}catch(t){return h.ErrorMonitor.getInstance().logError("Error getting the keys from cache",this.loggerId,e.Wt.Zt,t),[]}},u.prototype.B1=function(){var i=this,n=s.defer(),r=[];try{this.K1.B1().then(function(t){r=t}).fail(function(t){i.logger.error(t)})["finally"](function(){n.resolve(r)})}catch(t){h.ErrorMonitor.getInstance().logError("Error getting the elements from cache ",this.loggerId,e.Wt.ti,t),n.resolve(r)}return n.promise},u.prototype.XZ=function(){this.K1.XZ()},u);function u(){this.loggerId="[CACHE] ",this.logger=r.Framework.resolve(r.Framework.v.p).log(),this.K1=r.Framework.resolve(r.Framework.v.VC)}i.Cache=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(24),e=n(6),u=n(6),a=n(5),f=n(0),c=n(7),l=n(1),v=n(2),h=n(6),o=(d.prototype.init=function(t){this.logger=f.Framework.resolve(f.Framework.v.p).log(t.sessionId),this.gw=t.hM,this.tv=t.tv,this.tv&&(this.bandwidth=this.tv.tG()),this.Vl=t.reportingInstance.Vl,this.Vl.CU(this.W1)},d.prototype.request=function(n){var r=this,s=f.Framework.resolve(f.Framework.v.FC),e=!1,h=n.N_(),o=n.X_,t=n.X_.url;n.xhr=s,n.L_.O_=f.Framework.time(),this.logger.debug("FRL ISSUE REQ FOR FRAGMENT "+n.A_.toString()+"-"+n.L_.E_+" ["+c.xa[n.S_()]+"] TO FALLBACK "),n.A_.cA()&&(s.responseType="arraybuffer"),this.X1(n.type)&&o.range&&n.S_()!=c.xa.qa&&s.setRequestHeader("Range","bytes="+o.range),a.xu.Du.Vo&&this.z1(n.type)&&0!=n.L_.E_&&(this.logger.info("SET RANGE bytes="+n.L_.E_+"-"),s.setRequestHeader("Range","bytes="+n.L_.E_+"-")),o.g1.forEach(function(t){"range"!==t.key.toLowerCase()&&s.setRequestHeader(t.key,t.value)}),o.async&&0<o.timeout&&(s.timeout=o.timeout),o.mimeType&&s.overrideMimeType(o.mimeType),o.withCredentials&&(s.withCredentials=o.withCredentials),s.onloadstart=function(t){var i=u.createEvent(Event,"loadstart",t,o);o.dispatchEvent(i)},s.onabort=function(t){if(!e){var i=u.createEvent(Event,"abort",t,o);o.dispatchEvent(i)}},s.ontimeout=function(t){if(!e){r.error(n,h,10);var i=u.createEvent(ProgressEvent,"timeout",t,o);o.dispatchEvent(i),l.ErrorMonitor.getInstance().logError("Error on fallback request because of timeout",r.loggerId,v.Gs.xs)}},s.onreadystatechange=function(t){if(o&&(s.readyState===XMLHttpRequest.HEADERS_RECEIVED&&(o.K_=s.getAllResponseHeaders(),o.status=s.status,o.statusText=s.statusText),s.readyState<XMLHttpRequest.DONE||s.readyState===XMLHttpRequest.DONE&&0===s.status)){0===s.status&&(o.status=s.status,o.statusText=s.statusText),o.readyState=s.readyState;var i=u.createEvent(Event,"readystatechange",t,o);o.dispatchEvent(i)}},s.onprogress=function(t){if(!r.z1(n.type)){var i=u.createEvent(ProgressEvent,"progress",t,o);o.dispatchEvent(i),s.total=t.total}n.L_.g_=t.total,n.size=t.total},s.onload=function(t){if(e=!0,o.status=s.status,t&&0!=t.total&&(n.L_.g_=t.total),n.K_=s.getAllResponseHeaders(),s.status<200||299<s.status)return r.logger.debug("FRL SERVER RETURNED ERROR CODE "+s.status),void r.error(n,h);n.A_.cA()?r.X1(n.type)?n.F_=s.response:r.z1(n.type)&&(a.xu.Du.Vo?n.F_=f.Framework.T()?null:u.appendBuffer(n.F_,s.response):n.F_=s.response):n.responseText=s.responseText,r.J1["delete"](h),n.L_.m_=f.Framework.time(),r.Z1(n),r.t2(n),r.gw.$0(n),s=null},s.onerror=function(){e||r.error(n,h)},this.J1.set(h,n),s.open("GET",t,o.async,o.username,o.password),s.send()},d.prototype.error=function(t,i,n){this.Vl&&-1==a.xu.Iu.oo.indexOf(t.xhr.status)&&(n&&0<n?this.Vl.EF(n):t.xhr.status&&0<t.xhr.status?this.Vl.EF(t.xhr.status):this.Vl.EF(404));var r="COULD NOT DOWNLOAD "+t.k_()+" status: "+t.xhr.status;t.type==s.h_.a_?this.logger.debug(r):this.logger.warn(r),this.i2(t),this.J1["delete"](i),this.gw.K0(t)},d.prototype.Ze=function(t){return this.J1.has(t)},d.prototype.X1=function(t){return t==s.h_.a_||t==s.h_.u_||t==s.h_.o_},d.prototype.z1=function(t){return t==s.h_.f_},d.prototype.j0=function(t){var i=this.J1.get(t);this.J1["delete"](t),i&&i.xhr&&i.xhr.abort()},d.prototype.t2=function(t){t.A_.S_()==c.xa.Va&&this.W1.add(t.P_()),this.logger.info("SUCCESS FROM FALLBACK FOR "+t.k_()+" ["+s.h_[t.type]+"]["+t.L_.g_+"] AFTER "+t.P_()+" [curr:"+t.U_().Ta()+" avg:"+this.bandwidth.Ta()+"]")},d.prototype.i2=function(t){},d.prototype.G0=function(){return this.bandwidth},d.prototype.Z1=function(t){t.S_()===c.xa.Va&&this.bandwidth.wa(t.U_())},d);function d(){this.loggerId="[FallbackRequester] ",this.J1=new r(),this.bandwidth=new e.ma(),this.W1=new h.ta()}i.vZ=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(4);n(25);var u=n(0),e=n(5),a=n(54),f=n(65),o=n(9),r=n(107),c=hive.services.protocol.tracker.CustomerKey,l=n(13),s=n(8),v=n(1),d=n(2),E=n(6),w=s.Y.sf,p=(g.prototype.init=function(t){this.logger=u.Framework.resolve(u.Framework.v.p).log(t.sessionId),this.sessionId=t.sessionId,this.s0=t.s0,this.tv=t.tv,this.WH=t.WH,this.p0=t.uM,this.v0.n2(t.sessionId,this),this.s2=r.UV.FV,this.Vl=t.reportingInstance.Vl,this.Vl.IU(this.e2)},g.prototype.start=function(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];this.context=t,this.streamId=t.j.getContextId(),this.ticket=t.j.wP(),this.listeners=i},g.prototype.i0=function(){var t=this;this.WZ(),this.h2=u.Framework.setInterval(function(){t.o2()},e.xu.Au.eo),this.o2()},g.prototype.WZ=function(){this.h2&&u.Framework.clearInterval(this.h2)},g.prototype.u2=function(){var i=this,n=h.defer(),r=new hive.services.protocol.tracker.TrackerRequest(),s=this.context.j,t=s.UH()?StreamType.LIVE:StreamType.VOD;r.sessionId=this.sessionId;var e=new c();return l.HiveConfig.ClientInfo.rc&&l.HiveConfig.ClientInfo.sc?(e.partnerId=l.HiveConfig.ClientInfo.rc,e.customerId=l.HiveConfig.ClientInfo.sc):(e.partnerId=this.ticket.mR(),e.customerId=this.ticket._R()),r.customerKey=e,r.streamType=t,r.contentId=this.tv.getContextId(),this.kS.getConnectivityInfo().then(function(t){i.a2=t.getNetworkChanged().getPrivateIp(),i.tv.bG(i.a2)}).fail(function(t){v.ErrorMonitor.getInstance().logError("Error getting connectivity info",i.loggerId,d.gr.yr)})["finally"](function(){try{var t=new hive.snapshots.ConnectivityInfo();t.publicIp=i.ZU,t.privateIp=i.a2,r.info=i.f2(t,s),r.query=i.c2(s,r.info),n.resolve(r)}catch(t){v.ErrorMonitor.getInstance().logError("Error collecting the data for the tracker request",i.loggerId,d.gr.Tr,t),n.reject("ERROR")}}).done(),n.promise},g.prototype.l2=function(){var t=new Array();return this.s2==r.UV.FV?t.push(hive.services.protocol.tracker.TrackerRankType.Global):this.s2==r.UV.AS?t.push(hive.services.protocol.tracker.TrackerRankType.sR):this.s2==r.UV.tM?t.push(hive.services.protocol.tracker.TrackerRankType.rR):this.logger.warn("Wrong locality mode"),t},g.prototype.c2=function(t,i){var r=this,s=new hive.services.protocol.tracker.TrackerQuery();try{return s.random=e.xu.Pu.su,i.externalAs&&!this.JU&&(this.JU=i.externalAs),i.internalAs&&!this.v2&&(this.v2=i.internalAs),s.rankings=this.l2(),s.asns=[],0<this.JU&&this.d2(s.asns,hive.services.protocol.tracker.TrackerAsType.External,this.JU,e.xu.Pu.eu),0<this.v2&&(this.d2(s.asns,hive.services.protocol.tracker.TrackerAsType.hR,this.v2,e.xu.Pu.hu),s.watchersForQualityLevel=[],t.HH().forEach(function(t){var i=r.E2(hive.services.protocol.tracker.TrackerAsType.hR,r.v2,t,-1);s.watchersForQualityLevel.push({key:i,value:1})}),s.streamersForQualityLevel=[],this.tv.xQ().forEach(function(t,i){var n=r.E2(hive.services.protocol.tracker.TrackerAsType.hR,r.v2,t.qualityLevel,t.type==a.Jj.tM?hive.services.protocol.tracker.TrackerPeerStreamState.iR:-1);s.streamersForQualityLevel.push({key:n,value:e.xu.Pu.ou})})),s}catch(t){throw v.ErrorMonitor.getInstance().logError("Error preparing tracker query",this.loggerId,d.gr.Or,t),new Error(t)}},g.prototype.E2=function(t,i,n,r){var s=new hive.services.protocol.tracker.TrackerQualityLevelQuery(),e=new hive.services.protocol.tracker.TrackerAsQuery();return e.asType=t,e.asn=i,s.qualityLevel=n.id,s.asn=e,-1!=r&&s.streamState,s},g.prototype.d2=function(t,i,n,r){var s=new hive.services.protocol.tracker.TrackerAsQuery();s.asType=i,s.asn=n,t.push({key:s,value:r})},g.prototype.f2=function(t,i){var r=new hive.services.protocol.tracker.TrackerPeerInfo();try{if(u.Framework.T()?r.guid=this.uS:r.guid=btoa(this.uS),r.timestamp=u.Framework.time(),r.nat=void 0,this.tv.eP()&&(r.externalAs=this.tv.eP()),this.tv.sP()&&(r.internalAs=this.tv.sP()),null!=t){r.publicIpString=t.publicIp;var n=new InetAddress();n.address=t.publicIp,r.publicIp=n,r.privateIpString=t.privateIp;var s=new InetAddress();s.address=t.privateIp,r.privateIp=s}var e=Math.round(this.tv.tG().ga()/8);if(r.bandwidth=isNaN(e)?null:e,!this.tv.zM()&&this.tv.aP()&&w?r.rankValue=1:r.rankValue=this.tv.w2(),this.context.j instanceof f.XH){r.streams=new Array();var h=i.wM();null!=h&&(r.watchingQualityLevel=h.getQualityLevel().id);var o=i.LH();this.tv.xQ().forEach(function(t,i){if(t.oA){var n=new hive.services.protocol.tracker.TrackerPeerStreamInfo();switch(n.qualityLevel=t.qualityLevel.id,t.type){case a.Jj.Z_:n.state=hive.services.protocol.tracker.TrackerPeerStreamState.tR;break;case a.Jj.Zj:n.state=hive.services.protocol.tracker.TrackerPeerStreamState.nR;break;case a.Jj.tM:n.state=hive.services.protocol.tracker.TrackerPeerStreamState.iR}n.delta=o.jM(t.oA.uA(),t.qualityLevel),r.streams.push(n)}})}return r}catch(t){throw v.ErrorMonitor.getInstance().logError("Error preparing tracker info",this.loggerId,d.gr.Rr,t),new Error(t)}},g.prototype.o2=function(){var n=this;this.g2=u.Framework.time(),this.logger.debug(this.loggerId+" PREPARE REQUEST"),this.u2().then(function(t){var i=n.loggerId+"SENDING TRACKER REQUEST [ privateIp:"+t.info.privateIpString+" rank:"+t.info.rankValue+"]";switch(n.b2){case 0:default:n.logger.debug(i);break;case 1:n.logger.debug(i+" "+JSON.stringify(t));break;case 2:n.logger.debug(i,t);break;case 3:n.logger.debug(i+" "+JSON.stringify(t),t)}n.v0.T2(t)},function(t){v.ErrorMonitor.getInstance().logError("Error preparing the tracker request",n.loggerId,d.gr.br)})["catch"](function(t){v.ErrorMonitor.getInstance().logError("Error sending tracker request",n.loggerId,d.gr.Sr,t)})},g.prototype.O2=function(t){this.s2=t},g.prototype.m2=function(){var t=Math.max(0,u.Framework.time()-this.g2);0<t&&t<e.xu.Pu.TIMEOUT&&this.e2.add(t)},g.prototype.U0=function(t){var i=this;try{switch(this.m2(),this.b2){case 1:this.logger.debug(this.loggerId+this.context.j.wP()+" Tracker Response: "+JSON.stringify(t));break;case 2:this.logger.debug(this.loggerId+this.context.j.wP()+" Tracker Response: ",t);break;case 3:this.logger.debug(this.loggerId+this.context.j.wP()+" Tracker Response: "+JSON.stringify(t),t)}this.JU=t.peerInfo.externalAs,this.v2=t.peerInfo.internalAs,this.ZU=t.peerInfo.publicIpString,this.a2=t.peerInfo.privateIpString,this.localityGroupId=t.peerInfo.localityGroupId,this.tv.EG(this.ZU),this.tv._2(this.v2),this.tv.R2(this.JU),this.kS.lG(this.ZU,this.a2,this.v2),this.logger.debug(this.loggerId+"Reporting from tracker public IP:"+this.ZU+" private IP: "+this.a2+" ExtAs:"+this.JU+" inAs:"+this.v2+" localityGroupId:"+this.localityGroupId),!this.tv.zM()&&this.tv.aP()&&w?this.p0.Oq(!1):this.p0.S2(t.rankings,t.infos);var n=this.A2(t);this.listeners.forEach(function(t){return t.JV(n,i.I2)}),this.I2=!1}catch(t){v.ErrorMonitor.getInstance().logError("Error handling the response",this.loggerId,d.gr.Ar,t)}},g.prototype.A2=function(t){for(var i=[],n=0,r=t.infos;n<r.length;n++){var s=r[n],e=new o.yf(o.pf.gf,s);i.push(e)}return i},g.prototype.Mq=function(t){},g.prototype.PS=function(t){this.uS=t,this.logger.info(this.loggerId+"CONNECTED "+this.uS),this.p0.N2(),this.i0()},g.prototype.nQ=function(){},g);function g(){this.b2=isNaN(l.HiveConfig.DebugLogs.TrackerLogs)?0:l.HiveConfig.DebugLogs.TrackerLogs,this.loggerId="[TRACKER] ",this.JU=0,this.v2=0,this.localityGroupId=0,this.C2=/([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{0,4}){5})/,this.I2=!0,this.Jc=u.Framework.resolve(u.Framework.v.Zc),this.kS=u.Framework.resolve(u.Framework.v.jR),this.v0=u.Framework.resolve(u.Framework.v.lk),this.e2=new E.ta()}i.EZ=p},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(0),e=n(6),h=n(1),o=n(2),u=function(t,i){this.id=t,this.size=i};i.Element=u;var a=(f.prototype.put=function(t,i){try{var n=t.fragmentId,r=t.size;this.D2.has(n)||(this.D2.set(n,new u(n,r)),this.j2.set(n,new Array())),this.j2.get(n).push(i)}catch(t){throw h.ErrorMonitor.getInstance().logError("Error adding new have in object index",this.loggerId,o.Qs.Ys,t),new Error(t)}},f.prototype.contains=function(t){return this.j2.has(t)},f.prototype.rP=function(t){return this.j2.get(t)},f.prototype.nP=function(t){return this.D2.get(t)},f.prototype.YQ=function(n){var r=this;try{this.j2.forEach(function(t,i){e.Aa(t,n,!1),0===t.length&&(r.j2["delete"](i),r.D2["delete"](i))})}catch(t){h.ErrorMonitor.getInstance().logError("Error removing haves send from a specific peer",this.loggerId,o.Qs.Ks,t)}},f.prototype.q1=function(){var n=this;this.j2.forEach(function(t,i){n.logger.debug("OBJIDX FR "+i+" PS "+t.map(function(t){return t.AQ.transport.otherGuid}).reduce(function(t,i){return t+","+i}))})},f);function f(){this.loggerId="[ObjectIndex] ",this.D2=new r(),this.j2=new r(),this.logger=s.Framework.resolve(s.Framework.v.p).log()}i.bZ=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(5),e=n(0),h=n(6),o=n(9),u=n(199),a=n(53),f=n(108),c=n(8),l=n(1),v=n(2),d=c.Y.sf,E=(w.prototype.init=function(t){this.logger=e.Framework.resolve(e.Framework.v.p).log(t.sessionId),this.partnership=t.partnership,this.tv=t.tv,this.h0=t.h0,this.M2=t.KH,(d||e.Framework.T()&&a.$j.Kj)&&(this.GZ=t.GZ),this.start()},w.prototype.start=function(){this.P2=!0},w.prototype.stop=function(){this.P2=!1},w.prototype.JV=function(t,i){var n=this;try{if(this.P2){var r=[];t.forEach(function(i){var t=null;i.guid!=n.uS&&(i.type==o.pf.gf?t=n.L2(i):d||e.Framework.T()&&a.$j.Kj?(t=n.H2(i),n.GZ.BV(i).then(function(){n.partnership.rQ(n.UQ.get(i.guid))}).fail(function(t){t&&t!=f.Hq.iq&&(n.UQ["delete"](i.guid),l.ErrorMonitor.getInstance().logError("Error electing lan leader",n.loggerId,v.si.hi))})):t=n.H2(i)),t&&r.push(t.peerInfo.guid)}),this.U2(),this.handleStats(),i&&this.partnership.cQ(i),0<r.length&&this.logger.debug("DISCOVERED NEW "+r.length+"/"+t.length+": ["+r.join(", ")+"]")}}catch(t){l.ErrorMonitor.getInstance().logError("Error discovering peers",this.loggerId,v.si.ei,t)}},w.prototype.handleStats=function(){var t=this.F2.length+this.UQ.length;this.M2.G2(t)},w.prototype.U2=function(){try{this.F2.length>s.xu.Mu.nu&&this.B2(this.F2,s.xu.Mu.nu),this.UQ.length>=s.xu.Mu.ru&&this.V2(this.UQ)}catch(t){l.ErrorMonitor.getInstance().logError("Error clearing membership views",this.loggerId,v.si.oi,t)}},w.prototype.B2=function(t,i){for(var n=t.values().sort(function(t,i){return t.peerInfo.timestamp-i.peerInfo.timestamp});t.length>i;){var r=n.splice(0,1)[0];this.partnership.sQ(r)||t["delete"](r.peerInfo.guid)}},w.prototype.V2=function(t){var i=t.keys()[e.Framework.random()*t.length];t["delete"](i)},w.prototype.H2=function(t){var i=null;try{if(this.F2.has(t.guid)?(i=this.F2.get(t.guid),this.F2["delete"](t.guid),this.UQ.set(t.guid,i)):this.UQ.has(t.guid)&&(i=this.UQ.get(t.guid)),!i)return i=new u.q2(t),this.UQ.set(t.guid,i),i;i.Q2(t)}catch(t){return l.ErrorMonitor.getInstance().logError("Error adding peer to lan view",this.loggerId,v.si.ui,t),null}},w.prototype.L2=function(t){var i=null;try{if(this.UQ.has(t.guid))this.H2(t);else{if(!this.F2.has(t.guid))return i=new u.q2(t),this.F2.set(t.guid,i),this.h0.Y2(i),i;(i=this.F2.get(t.guid)).Q2(t),this.h0.Y2(i)}}catch(t){return l.ErrorMonitor.getInstance().logError("Error adding peer to random view",this.loggerId,v.si.ai,t),null}},w.prototype.lQ=function(t,i){var n=[];try{return this.P2&&(n=d||e.Framework.T()&&a.$j.Kj?h.Ca(this.F2.values()):(n=this.F2.values(),this.UQ.forEach(function(t,i){n.push(t)}),h.Ca(n))),t?n:i?n.slice(0,i):n.slice(0,2*s.xu.mu.Hh)}catch(t){return l.ErrorMonitor.getInstance().logError("Error sampling membership",this.loggerId,v.si.fi,t),[]}},w.prototype.jQ=function(t){return this.F2.has(t)?this.F2.get(t):this.UQ.has(t)?this.UQ.get(t):null},w.prototype.PS=function(t){this.logger.info("MEMBERSHIP SERVER CONNECTED"),this.uS=t,this.tv.setId(this.uS)},w.prototype.nQ=function(){},w.prototype.Mq=function(t){this.logger.debug("Peer "+t+" disconnected"),this.F2["delete"](t),this.UQ["delete"](t),this.handleStats()},w);function w(){this.loggerId="[Membership] ",this.uS=null,this.F2=new r(),this.UQ=new r()}i.Mu=E},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(9),s=n(200),e=(h.prototype._Q=function(){return this.peerInfo.type===r.pf.bf},h.prototype.K2=function(t){this.W2=new s.X2([t])},h.prototype.z2=function(){return this.W2},h.prototype.J2=function(){return this.h0},h.prototype.Z2=function(t){isNaN(t)||(this.h0=t)},h.prototype.Q2=function(t){this.peerInfo.type==r.pf.gf&&t.type==r.pf.bf?this.peerInfo.type=r.pf.bf:this.peerInfo.type==r.pf.gf&&t.type==r.pf.gf||this.peerInfo.type==r.pf.bf&&t.type==r.pf.bf?this.t3(this.peerInfo,t):this.peerInfo.type==r.pf.bf&&t.type==r.pf.gf&&(this.t3(this.peerInfo,t),this.peerInfo.type=r.pf.bf)},h.prototype.ZQ=function(t){this.peerInfo.watchingQualityLevel=t},h.prototype.t3=function(t,i){t.internalAs=this.i3(t.internalAs,i.internalAs),t.externalAs=this.i3(t.externalAs,i.externalAs),t.nat=this.i3(t.nat,i.nat),t.bandwidth=this.i3(t.bandwidth,i.bandwidth),t.watchingQualityLevel=this.i3(t.watchingQualityLevel,i.watchingQualityLevel),t.privateIpString=this.i3(t.privateIpString,i.privateIpString),t.publicIpString=this.i3(t.publicIpString,i.publicIpString),t.rankValue=this.i3(t.rankValue,i.rankValue),t.timestamp=this.i3(t.timestamp,i.timestamp),i.isLeader&&(t.isLeader=this.i3(t.isLeader,i.isLeader)),i.streams&&(t.streams=i.streams)},h.prototype.i3=function(t,i){return t?i&&t!=i&&(t=i):i&&(t=i),t},h);function h(t){this.h0=0,this.peerInfo=t}i.q2=e},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(c.prototype.n3=function(){return this.r3||this.s3(),this.r3},c.prototype.s3=function(){for(var t=[],i=0;i<this.columns;i++){for(var n=[],r=0;r<this.rows;r++)n.push(this.matrix[r][i]);t.push(n)}this.r3=new c(t)},c.prototype.e3=function(t){for(var i=t.h3(),n=[],r=0;r<this.rows;r++){for(var s=[],e=0;e<this.columns;e++){var h=this.matrix[r][e]/i[r][e];s.push(h||0)}n.push(s)}return new c(n)},c.prototype.multiply=function(t){for(var i=t.h3(),n=t.o3(),r=t.u3(),s=[],e=0;e<this.rows;e++){for(var h=this.matrix[e],o=[],u=0;u<r;u++){for(var a=0,f=0;f<n;f++)a+=h[f]*i[f][u];o.push(a)}s.push(o)}return new c(s)},c.prototype.a3=function(t){for(var i=[],n=0;n<this.rows;n++){for(var r=[],s=0;s<this.columns;s++)r.push(this.matrix[n][s]*t);i.push(r)}return new c(i)},c.prototype.f3=function(t){for(var i=[],n=0;n<this.rows;n++){for(var r=[],s=0;s<this.columns;s++)r.push(this.matrix[n][s]+t);i.push(r)}return new c(i)},c.prototype.c3=function(){for(var t=[],i=0;i<this.rows;i++){for(var n=[],r=0;r<this.columns;r++)n.push(Math.exp(this.matrix[i][r]));t.push(n)}return new c(t)},c.prototype.l3=function(t){for(var i=[],n=0;n<this.rows;n++){var r=this.matrix[n];i.push([t]);for(var s=0;s<r.length;s++)i[n].push(r[s])}return new c(i)},c.prototype.h3=function(){return this.matrix},c.prototype.o3=function(){return this.rows},c.prototype.u3=function(){return this.columns},c);function c(t){this.matrix=[],this.rows=0,this.columns=0,this.matrix=t,this.rows=this.matrix.length,this.columns=this.matrix[0].length}i.X2=r},function(s,e,l){(function(i){var t,n,r;n=[l(36)],void 0===(r="function"==typeof (t=function(T,t){"use strict";var s={};return s.v3=T,s.ZA=T.ZA||null,s.VERSION="4.1.3",s.d3={},s.d3.E3=0,s.d3.w3=1,s.d3.g3=2,s.d3.b3=3,s.d3.y3=4,s.d3.T3=5,s.O3=[s.d3.E3,s.d3.w3,s.d3.T3],s.m3={int32:{name:"int32",_3:s.d3.E3,defaultValue:0},uint32:{name:"uint32",_3:s.d3.E3,defaultValue:0},sint32:{name:"sint32",_3:s.d3.E3,defaultValue:0},int64:{name:"int64",_3:s.d3.E3,defaultValue:s.ZA?s.ZA.ZERO:void 0},uint64:{name:"uint64",_3:s.d3.E3,defaultValue:s.ZA?s.ZA.R3:void 0},sint64:{name:"sint64",_3:s.d3.E3,defaultValue:s.ZA?s.ZA.ZERO:void 0},bool:{name:"bool",_3:s.d3.E3,defaultValue:!1},"double":{name:"double",_3:s.d3.w3,defaultValue:0},string:{name:"string",_3:s.d3.g3,defaultValue:""},bytes:{name:"bytes",_3:s.d3.g3,defaultValue:null},fixed32:{name:"fixed32",_3:s.d3.T3,defaultValue:0},sfixed32:{name:"sfixed32",_3:s.d3.T3,defaultValue:0},fixed64:{name:"fixed64",_3:s.d3.w3,defaultValue:s.ZA?s.ZA.R3:void 0},sfixed64:{name:"sfixed64",_3:s.d3.w3,defaultValue:s.ZA?s.ZA.ZERO:void 0},"float":{name:"float",_3:s.d3.T3,defaultValue:0},"enum":{name:"enum",_3:s.d3.E3,defaultValue:0},message:{name:"message",_3:s.d3.g3,defaultValue:null},group:{name:"group",_3:s.d3.b3,defaultValue:null}},s.S3=[s.m3.int32,s.m3.sint32,s.m3.sfixed32,s.m3.uint32,s.m3.fixed32,s.m3.int64,s.m3.sint64,s.m3.sfixed64,s.m3.uint64,s.m3.fixed64,s.m3.bool,s.m3.string,s.m3.bytes],s.A3=1,s.I3=536870911,s.N3=!1,s.C3=!0,s.D3=!0,s.ST=function(){var s={};return s.j3=!("object"!=typeof i||i+""!="[object process]"||i.JN),s.M3=function(){for(var t=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],i=null,n=0;n<t.length;n++){try{i=t[n]()}catch(t){continue}break}if(!i)throw Error("XMLHttpRequest is not supported");return i},s.fetch=function(t,n){if(n&&"function"!=typeof n&&(n=null),s.j3){var i=l(18);if(n)i.P3(t,function(t,i){n(t?null:""+i)});else try{return i.L3(t)}catch(t){return null}}else{var r=s.M3();if(r.open("GET",t,!!n),r.setRequestHeader("Accept","text/plain"),"function"==typeof r.overrideMimeType&&r.overrideMimeType("text/plain"),!n)return r.send(null),200==r.status||0==r.status&&"string"==typeof r.responseText?r.responseText:null;if(r.onreadystatechange=function(){4==r.readyState&&(200==r.status||0==r.status&&"string"==typeof r.responseText?n(r.responseText):n(null))},4==r.readyState)return;r.send(null)}},s.H3=function(t){return t.replace(/_([a-zA-Z])/g,function(t,i){return i.toUpperCase()})},s}(),s.Lang={U3:/[\s\{\}=;:\[\],'"\(\)<>]/g,F3:/^(?:required|optional|repeated|map)$/,_L:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,gL:/^[a-zA-Z_][a-zA-Z_0-9]*$/,G3:/^[a-zA-Z][a-zA-Z_0-9]*$/,x3:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,B3:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,V3:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,q3:/^(?:[1-9][0-9]*|0)$/,Q3:/^0[xX][0-9a-fA-F]+$/,Y3:/^0[0-7]+$/,K3:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,tD:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,W3:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,X3:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,z3:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,J3:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},s.Z3=function(r,h){function i(t){this.source=t+"",this.index=0,this.line=1,this.stack=[],this.t4=null}var t={},n=i.prototype;function s(t){this.i4=new i(t),this.n4=!1}n.EX=function(){var t='"'===this.t4?h.z3:h.J3;t.lastIndex=this.index-1;var i=t.exec(this.source);if(!i)throw Error("unterminated string");return this.index=t.lastIndex,this.stack.push(this.t4),this.t4=null,i[1]},n.next=function(){if(0<this.stack.length)return this.stack.shift();if(this.index>=this.source.length)return null;if(null!==this.t4)return this.EX();var t,i,n;do{for(t=!1;h.X3.test(n=this.source.charAt(this.index));)if("\n"===n&&++this.line,++this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if(++this.index,"/"===this.source.charAt(this.index)){for(;"\n"!==this.source.charAt(++this.index);)if(this.index==this.source.length)return null;++this.index,++this.line,t=!0}else{if("*"!==(n=this.source.charAt(this.index)))return"/";do{if("\n"===n&&++this.line,++this.index===this.source.length)return null;i=n,n=this.source.charAt(this.index)}while("*"!==i||"/"!==n);++this.index,t=!0}}while(t);if(this.index===this.source.length)return null;var r=this.index;if(h.U3.lastIndex=0,!h.U3.test(this.source.charAt(r++)))for(;r<this.source.length&&!h.U3.test(this.source.charAt(r));)++r;var s=this.source.substring(this.index,this.index=r);return'"'!==s&&"'"!==s||(this.t4=s),s},n.DP=function(){if(0===this.stack.length){var t=this.next();if(null===t)return null;this.stack.push(t)}return this.stack[0]},n.XE=function(t){var i=this.next();if(i!==t)throw Error("illegal '"+i+"', '"+t+"' expected")},n.r4=function(t){return this.DP()===t&&(this.next(),!0)},n.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},t.s4=i;var e=s.prototype;function o(t,i){var n=-1,r=1;if("-"==t.charAt(0)&&(r=-1,t=t.substring(1)),h.q3.test(t))n=parseInt(t);else if(h.Q3.test(t))n=parseInt(t.substring(2),16);else{if(!h.Y3.test(t))throw Error("illegal id value: "+(r<0?"-":"")+t);n=parseInt(t.substring(1),8)}if(n=r*n|0,!i&&n<0)throw Error("illegal id value: "+(r<0?"-":"")+t);return n}function u(t){var i=1;if("-"==t.charAt(0)&&(i=-1,t=t.substring(1)),h.q3.test(t))return i*parseInt(t,10);if(h.Q3.test(t))return i*parseInt(t.substring(2),16);if(h.Y3.test(t))return i*parseInt(t.substring(1),8);if("inf"===t)return i*(1/0);if("nan"===t)return NaN;if(h.K3.test(t))return i*parseFloat(t);throw Error("illegal number value: "+(i<0?"-":"")+t)}function a(t,i,n){void 0===t[i]?t[i]=n:(Array.isArray(t[i])||(t[i]=[t[i]]),t[i].push(n))}return e.parse=function(){var t,i={name:"[ROOT]","package":null,messages:[],e4:[],imports:[],options:{},services:[]},n=!0;try{for(;t=this.i4.next();)switch(t){case"package":if(!n||null!==i["package"])throw Error("unexpected 'package'");if(t=this.i4.next(),!h.x3.test(t))throw Error("illegal package name: "+t);this.i4.XE(";"),i["package"]=t;break;case"import":if(!n)throw Error("unexpected 'import'");"public"===(t=this.i4.DP())&&this.i4.next(),t=this.EX(),this.i4.XE(";"),i.imports.push(t);break;case"syntax":if(!n)throw Error("unexpected 'syntax'");this.i4.XE("="),"proto3"===(i.h4=this.EX())&&(this.n4=!0),this.i4.XE(";");break;case"message":this.o4(i,null),n=!1;break;case"enum":this.u4(i),n=!1;break;case"option":this.a4(i);break;case"service":this.f4(i);break;case"extend":this.c4(i);break;default:throw Error("unexpected '"+t+"'")}}catch(t){throw t.message="Parse error at line "+this.i4.line+": "+t.message,t}return delete i.name,i},s.parse=function(t){return new s(t).parse()},e.EX=function(){var t,i,n="";do{if("'"!==(i=this.i4.next())&&'"'!==i)throw Error("illegal string delimiter: "+i);n+=this.i4.next(),this.i4.XE(i),t=this.i4.DP()}while('"'===t||'"'===t);return n},e.l4=function(t){var i=this.i4.DP();if('"'===i||"'"===i)return this.EX();if(this.i4.next(),h.V3.test(i))return u(i);if(h.BOOL.test(i))return"true"===i.toLowerCase();if(t&&h.x3.test(i))return i;throw Error("illegal value: "+i)},e.a4=function(t,i){var n=this.i4.next(),r=!1;if("("===n&&(r=!0,n=this.i4.next()),!h.x3.test(n))throw Error("illegal option name: "+n);var s=n;r&&(this.i4.XE(")"),s="("+s+")",n=this.i4.DP(),h.B3.test(n)&&(s+=n,this.i4.next())),this.i4.XE("="),this.v4(t,s),i||this.i4.XE(";")},e.v4=function(t,i){var n=this.i4.DP();if("{"!==n)a(t.options,i,this.l4(!0));else for(this.i4.XE("{");"}"!==(n=this.i4.next());){if(!h.gL.test(n))throw Error("illegal option name: "+i+"."+n);this.i4.r4(":")?a(t.options,i+"."+n,this.l4(!0)):this.v4(t,i+"."+n)}},e.f4=function(t){var i=this.i4.next();if(!h.gL.test(i))throw Error("illegal service name at line "+this.i4.line+": "+i);var n={name:i,d4:{},options:{}};for(this.i4.XE("{");"}"!==(i=this.i4.next());)if("option"===i)this.a4(n);else{if("rpc"!==i)throw Error("illegal service token: "+i);this.E4(n)}this.i4.r4(";"),t.services.push(n)},e.E4=function(t){var i=this.i4.next();if(!h.gL.test(i))throw Error("illegal rpc service method name: "+i);var n=i,r={request:null,response:null,w4:!1,g4:!1,options:{}};if(this.i4.XE("("),"stream"===(i=this.i4.next()).toLowerCase()&&(r.w4=!0,i=this.i4.next()),!h.x3.test(i))throw Error("illegal rpc service request type: "+i);if(r.request=i,this.i4.XE(")"),"returns"!==(i=this.i4.next()).toLowerCase())throw Error("illegal rpc service request type delimiter: "+i);if(this.i4.XE("("),"stream"===(i=this.i4.next()).toLowerCase()&&(r.g4=!0,i=this.i4.next()),r.response=i,this.i4.XE(")"),"{"===(i=this.i4.DP())){for(this.i4.next();"}"!==(i=this.i4.next());){if("option"!==i)throw Error("illegal rpc service token: "+i);this.a4(r)}this.i4.r4(";")}else this.i4.XE(";");void 0===t.d4&&(t.d4={}),t.d4[n]=r},e.o4=function(t,i){var n=!!i,r=this.i4.next(),s={name:"",fields:[],e4:[],messages:[],options:{},b4:{}};if(!h.gL.test(r))throw Error("illegal "+(n?"group":"message")+" name: "+r);for(s.name=r,n&&(this.i4.XE("="),i.id=o(this.i4.next()),s.y4=!0),"["===(r=this.i4.DP())&&i&&this.T4(i),this.i4.XE("{");"}"!==(r=this.i4.next());)if(h.F3.test(r))this.O4(s,r);else if("oneof"===r)this.m4(s);else if("enum"===r)this.u4(s);else if("message"===r)this.o4(s);else if("option"===r)this.a4(s);else if("extensions"===r)this._4(s);else if("extend"===r)this.c4(s);else{if(!h.x3.test(r))throw Error("illegal message token: "+r);if(!this.n4)throw Error("illegal field rule: "+r);this.O4(s,"optional",r)}return this.i4.r4(";"),t.messages.push(s),s},e.O4=function(t,i,n){if(!h.F3.test(i))throw Error("illegal message field rule: "+i);var r,s={rule:i,type:"",name:"",options:{},id:0};if("map"===i){if(n)throw Error("illegal type: "+n);if(this.i4.XE("<"),r=this.i4.next(),!h._L.test(r)&&!h.x3.test(r))throw Error("illegal message field type: "+r);if(s.keytype=r,this.i4.XE(","),r=this.i4.next(),!h._L.test(r)&&!h.x3.test(r))throw Error("illegal message field: "+r);if(s.type=r,this.i4.XE(">"),r=this.i4.next(),!h.gL.test(r))throw Error("illegal message field name: "+r);s.name=r,this.i4.XE("="),s.id=o(this.i4.next()),"["===(r=this.i4.DP())&&this.T4(s),this.i4.XE(";")}else if("group"===(n=void 0!==n?n:this.i4.next())){var e=this.o4(t,s);if(!/^[A-Z]/.test(e.name))throw Error("illegal group name: "+e.name);s.type=e.name,s.name=e.name.toLowerCase(),this.i4.r4(";")}else{if(!h._L.test(n)&&!h.x3.test(n))throw Error("illegal message field type: "+n);if(s.type=n,r=this.i4.next(),!h.gL.test(r))throw Error("illegal message field name: "+r);s.name=r,this.i4.XE("="),s.id=o(this.i4.next()),"["===(r=this.i4.DP())&&this.T4(s),this.i4.XE(";")}return t.fields.push(s),s},e.m4=function(t){var i=this.i4.next();if(!h.gL.test(i))throw Error("illegal oneof name: "+i);var n,r=i,s=[];for(this.i4.XE("{");"}"!==(i=this.i4.next());)(n=this.O4(t,"optional",i)).R4=r,s.push(n.id);this.i4.r4(";"),t.b4[r]=s},e.T4=function(t){this.i4.XE("[");for(var i=!0;"]"!==this.i4.DP();)i||this.i4.XE(","),this.a4(t,!0),i=!1;this.i4.next()},e.u4=function(t){var i={name:"",values:[],options:{}},n=this.i4.next();if(!h.gL.test(n))throw Error("illegal name: "+n);for(i.name=n,this.i4.XE("{");"}"!==(n=this.i4.next());)if("option"===n)this.a4(i);else{if(!h.gL.test(n))throw Error("illegal name: "+n);this.i4.XE("=");var r={name:n,id:o(this.i4.next(),!0)};"["===(n=this.i4.DP())&&this.T4({options:{}}),this.i4.XE(";"),i.values.push(r)}this.i4.r4(";"),t.e4.push(i)},e._4=function(t){var i=this.i4.next(),n=[];"min"===i?n.push(r.A3):"max"===i?n.push(r.I3):n.push(u(i)),this.i4.XE("to"),"min"===(i=this.i4.next())?n.push(r.A3):"max"===i?n.push(r.I3):n.push(u(i)),this.i4.XE(";"),t.extensions=n},e.c4=function(t){var i=this.i4.next();if(!h.x3.test(i))throw Error("illegal extend reference: "+i);var n={KY:i,fields:[]};for(this.i4.XE("{");"}"!==(i=this.i4.next());)if(h.F3.test(i))this.O4(n,i);else{if(!h.x3.test(i))throw Error("illegal extend token: "+i);if(!this.n4)throw Error("illegal field rule: "+i);this.O4(n,"optional",i)}return this.i4.r4(";"),t.messages.push(n),n},e.toString=function(){return"Parser at line "+this.i4.line},t.wJ=s,t}(s,s.Lang),s.Reflect=function(E){function f(t,i,n){this.S4=t,this.parent=i,this.name=n,this.className}var h={},t=f.prototype;function o(t,i,n,r,s){f.call(this,t,i,n),this.className="Namespace",this.children=[],this.options=r||{},this.h4=s||"proto2"}t.A4=function(){for(var t=this.name,i=this;null!=(i=i.parent);)t=i.name+"."+t;return t},t.toString=function(t){return(t?this.className+" ":"")+this.A4()},t._l=function(){throw Error(this.toString(!0)+" cannot be built directly")},h.I4=f;var i=o.prototype=Object.create(f.prototype);function c(t,i,n,r){if(this.type=t,this.N4=i,this.C4=n,this.h4=r,n&&E.S3.indexOf(t)<0)throw Error("Invalid map key type: "+t.name)}i.D4=function(t){if(null==(t=t||null))return this.children.slice();for(var i=[],n=0,r=this.children.length;n<r;++n)this.children[n]instanceof t&&i.push(this.children[n]);return i},i.j4=function(t){var i;if(i=this.M4(t.name))if(i instanceof l.P4&&i.name!==i.L4&&null===this.M4(i.L4))i.name=i.L4;else{if(!(t instanceof l.P4&&t.name!==t.L4&&null===this.M4(t.L4)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+t.name);t.name=t.L4}this.children.push(t)},i.M4=function(t){for(var i="number"==typeof t?"id":"name",n=0,r=this.children.length;n<r;++n)if(this.children[n][i]===t)return this.children[n];return null},i.resolve=function(t,i){var n,r="string"==typeof t?t.split("."):t,s=this,e=0;if(""===r[e]){for(;null!==s.parent;)s=s.parent;e++}do{do{if(!(s instanceof h.H4)){s=null;break}if(!(n=s.M4(r[e]))||!(n instanceof h.I4)||i&&!(n instanceof h.H4)){s=null;break}s=n,e++}while(e<r.length);if(null!=s)break;if(null!==this.parent)return this.parent.resolve(t,i)}while(null!=s);return s},i.U4=function(t){for(var i=[],n=t;i.unshift(n.name),null!==(n=n.parent););for(var r=1;r<=i.length;r++){var s=i.slice(i.length-r);if(t===this.resolve(s,t instanceof h.H4))return s.join(".")}return t.A4()},i._l=function(){for(var t,i={},n=this.children,r=0,s=n.length;r<s;++r)(t=n[r])instanceof o&&(i[t.name]=t._l());return Object.defineProperty&&Object.defineProperty(i,"F4",{value:this.G4()}),i},i.G4=function(){for(var t={},i=Object.keys(this.options),n=0,r=i.length;n<r;++n){var s=i[n],e=this.options[i[n]];t[s]=e}return t},i.x4=function(t){return void 0===t?this.options:void 0!==this.options[t]?this.options[t]:null},h.H4=o;var n=c.prototype;function e(t,i){if(t&&"number"==typeof t.low&&"number"==typeof t.high&&"boolean"==typeof t.hN&&t.low==t.low&&t.high==t.high)return new E.ZA(t.low,t.high,void 0===i?t.hN:i);if("string"==typeof t)return E.ZA.fromString(t,i||!1,10);if("number"==typeof t)return E.ZA.rb(t,i||!1);throw Error("not convertible to Long")}c.B4=function(t){if("string"==typeof t&&(t=E.m3[t]),void 0===t.defaultValue)throw Error("default value for type "+t.name+" is not supported");return t==E.m3.bytes?new T(0):t.defaultValue},n.V4=function(i){var n=function(t,i){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+t+" ("+i+")")}.bind(this);switch(this.type){case E.m3.int32:case E.m3.sint32:case E.m3.sfixed32:return("number"!=typeof i||i==i&&i%1!=0)&&n(typeof i,"not an integer"),4294967295<i?0|i:i;case E.m3.uint32:case E.m3.fixed32:return("number"!=typeof i||i==i&&i%1!=0)&&n(typeof i,"not an integer"),i<0?i>>>0:i;case E.m3.int64:case E.m3.sint64:case E.m3.sfixed64:if(E.ZA)try{return e(i,!1)}catch(t){n(typeof i,t.message)}else n(typeof i,"requires Long.js");case E.m3.uint64:case E.m3.fixed64:if(E.ZA)try{return e(i,!0)}catch(t){n(typeof i,t.message)}else n(typeof i,"requires Long.js");case E.m3.bool:return"boolean"!=typeof i&&n(typeof i,"not a boolean"),i;case E.m3["float"]:case E.m3["double"]:return"number"!=typeof i&&n(typeof i,"not a number"),i;case E.m3.string:return"string"==typeof i||i&&i instanceof String||n(typeof i,"not a string"),""+i;case E.m3.bytes:return T.rI(i)?i:T.wrap(i,"base64");case E.m3["enum"]:var t=this.N4.D4(E.Reflect.Q4.q4);for(s=0;s<t.length;s++){if(t[s].name==i)return t[s].id;if(t[s].id==i)return t[s].id}if("proto3"===this.h4)return("number"!=typeof i||i==i&&i%1!=0)&&n(typeof i,"not an integer"),(4294967295<i||i<0)&&n(typeof i,"not in range for uint32"),i;n(i,"not a valid enum value");case E.m3.group:case E.m3.message:if(i&&"object"==typeof i||n(typeof i,"object expected"),i instanceof this.N4.Y4)return i;if(i instanceof E.K4.Lc){var r={};for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s]);i=r}return new this.N4.Y4(i)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+i+" (undefined type "+this.type+")")},n.W4=function(t,i){if(null===i)return 0;var n;switch(this.type){case E.m3.int32:return i<0?T.nN(i):T.KI(i);case E.m3.uint32:return T.KI(i);case E.m3.sint32:return T.KI(T.WI(i));case E.m3.fixed32:case E.m3.sfixed32:case E.m3["float"]:return 4;case E.m3.int64:case E.m3.uint64:return T.nN(i);case E.m3.sint64:return T.nN(T.eN(i));case E.m3.fixed64:case E.m3.sfixed64:return 8;case E.m3.bool:return 1;case E.m3["enum"]:return T.KI(i);case E.m3["double"]:return 8;case E.m3.string:return n=T._N(i),T.KI(n)+n;case E.m3.bytes:if(i.GN()<0)throw Error("Illegal value for "+this.toString(!0)+": "+i.GN()+" bytes remaining");return T.KI(i.GN())+i.GN();case E.m3.message:return n=this.N4.X4(i),T.KI(n)+n;case E.m3.group:return(n=this.N4.X4(i))+T.KI(t<<3|E.d3.y3)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+i+" (unknown type)")},n.z4=function(t,i,n){if(null===i)return n;switch(this.type){case E.m3.int32:i<0?n.cN(i):n.XI(i);break;case E.m3.uint32:n.XI(i);break;case E.m3.sint32:n.zI(i);break;case E.m3.fixed32:n.AI(i);break;case E.m3.sfixed32:n.RI(i);break;case E.m3.int64:case E.m3.uint64:n.cN(i);break;case E.m3.sint64:n.lN(i);break;case E.m3.fixed64:n.LI(i);break;case E.m3.sfixed64:n.kI(i);break;case E.m3.bool:"string"==typeof i?n.XI("false"===i.toLowerCase()?0:!!i):n.XI(i?1:0);break;case E.m3["enum"]:n.XI(i);break;case E.m3["float"]:n.GI(i);break;case E.m3["double"]:n.qI(i);break;case E.m3.string:n.NN(i);break;case E.m3.bytes:if(i.GN()<0)throw Error("Illegal value for "+this.toString(!0)+": "+i.GN()+" bytes remaining");var r=i.offset;n.XI(i.GN()),n.append(i),i.offset=r;break;case E.m3.message:var s=new T().PN();this.N4.encode(i,s),n.XI(s.offset),n.append(s.cl());break;case E.m3.group:this.N4.encode(i,n),n.XI(t<<3|E.d3.y3);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+i+" (unknown type)")}return n},n.decode=function(t,i,n){if(i!=this.type._3)throw Error("Unexpected wire type for element");var r,s;switch(this.type){case E.m3.int32:return 0|t.JI();case E.m3.uint32:return t.JI()>>>0;case E.m3.sint32:return 0|t.tN();case E.m3.fixed32:return t.NI()>>>0;case E.m3.sfixed32:return 0|t.SI();case E.m3.int64:return t.vN();case E.m3.uint64:return t.vN().uN();case E.m3.sint64:return t.dN();case E.m3.fixed64:return t.UI();case E.m3.sfixed64:return t.jI();case E.m3.bool:return!!t.JI();case E.m3["enum"]:return t.JI();case E.m3["float"]:return t.VI();case E.m3["double"]:return t.Rp();case E.m3.string:return t.CN();case E.m3.bytes:if(s=t.JI(),t.GN()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+t.GN());return(r=t.clone()).WA=r.offset+s,t.offset+=s,r;case E.m3.message:return s=t.JI(),this.N4.decode(t,s);case E.m3.group:return this.N4.decode(t,-1,n)}throw Error("[INTERNAL] Illegal decode type")},n.J4=function(t){if(!this.C4)throw Error("valueFromString() called on non-map-key element");switch(this.type){case E.m3.int32:case E.m3.sint32:case E.m3.sfixed32:case E.m3.uint32:case E.m3.fixed32:return this.V4(parseInt(t));case E.m3.int64:case E.m3.sint64:case E.m3.sfixed64:case E.m3.uint64:case E.m3.fixed64:return this.V4(t);case E.m3.bool:return"true"===t;case E.m3.string:return this.V4(t);case E.m3.bytes:return T.hI(t)}},n.Z4=function(t){if(!this.C4)throw Error("valueToString() called on non-map-key element");return this.type===E.m3.bytes?t.toString("binary"):t.toString()},h.Element=c;var l=function(t,i,n,r,s,e){o.call(this,t,i,n,r,e),this.className="Message",this.extensions=[E.A3,E.I3],this.Y4=null,this.y4=!!s,this.t5=null,this.i5=null,this.n5=null},r=l.prototype=Object.create(o.prototype);function w(t,i){var n=i.JI(),r=7&n,s=n>>>3;switch(r){case E.d3.E3:for(;128==(128&(n=i.EI())););break;case E.d3.w3:i.offset+=8;break;case E.d3.g3:n=i.JI(),i.offset+=n;break;case E.d3.b3:w(s,i);break;case E.d3.y3:if(s===t)return!1;throw Error("Illegal GROUPEND after unknown group: "+s+" ("+t+" expected)");case E.d3.T3:i.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+t+": "+r)}return!0}function u(t,i,n,r,s,e,h,o,u,a){f.call(this,t,i,e),this.className="Message.Field",this.required="required"===n,this.repeated="repeated"===n,this.map="map"===n,this.r5=r||null,this.type=s,this.N4=null,this.id=h,this.options=o||{},this.defaultValue=null,this.R4=u||null,this.h4=a||"proto2",this.L4=this.name,this.s5=null,this.e5=null,!this.S4.options.N3||this instanceof l.h5||(this.name=E.ST.H3(this.name))}r._l=function(t){if(this.Y4&&!t)return this.Y4;var i=function(c,h){var o=h.D4(c.Reflect.Lc.P4),u=h.D4(c.Reflect.Lc.o5),a=function(t,i){c.K4.Lc.call(this);for(var n=0,r=u.length;n<r;++n)this[u[n].name]=null;for(n=0,r=o.length;n<r;++n){var s=o[n];this[s.name]=s.repeated?[]:s.map?new c.Map(s):null,!s.required&&"proto3"!==h.h4||null===s.defaultValue||(this[s.name]=s.defaultValue)}var e;if(0<arguments.length)if(1!==arguments.length||null===t||"object"!=typeof t||!("function"!=typeof t.encode||t instanceof a)||Array.isArray(t)||t instanceof c.Map||T.rI(t)||t instanceof ArrayBuffer||c.ZA&&t instanceof c.ZA)for(n=0,r=arguments.length;n<r;++n)void 0!==(e=arguments[n])&&this.u5(o[n].name,e);else this.u5(t)},e=a.prototype=Object.create(c.K4.Lc.prototype);e.add=function(t,i,n){var r=h.n5[t];if(!n){if(!r)throw Error(this+"#"+t+" is undefined");if(!(r instanceof c.Reflect.Lc.P4))throw Error(this+"#"+t+" is not a field: "+r.toString(!0));if(!r.repeated)throw Error(this+"#"+t+" is not a repeated field");i=r.V4(i,!0)}return null===this[t]&&(this[t]=[]),this[t].push(i),this},e.a5=e.add,e.set=function(t,i,n){if(t&&"object"==typeof t){for(var r in n=i,t)t.hasOwnProperty(r)&&void 0!==(i=t[r])&&this.u5(r,i,n);return this}var s=h.n5[t];if(n)this[t]=i;else{if(!s)throw Error(this+"#"+t+" is not a field: undefined");if(!(s instanceof c.Reflect.Lc.P4))throw Error(this+"#"+t+" is not a field: "+s.toString(!0));this[s.name]=i=s.V4(i)}if(s&&s.R4){var e=this[s.R4.name];null!==i?(null!==e&&e!==s.name&&(this[e]=null),this[s.R4.name]=s.name):e===t&&(this[s.R4.name]=null)}return this},e.u5=e.set,e.get=function(t,i){if(i)return this[t];var n=h.n5[t];if(!(n&&n instanceof c.Reflect.Lc.P4))throw Error(this+"#"+t+" is not a field: undefined");if(!(n instanceof c.Reflect.Lc.P4))throw Error(this+"#"+t+" is not a field: "+n.toString(!0));return this[n.name]},e.f5=e.get;for(var t=0;t<o.length;t++){var i=o[t];i instanceof c.Reflect.Lc.h5||h.S4.options.C3&&(function(n){var t=n.L4.replace(/(_[a-zA-Z])/g,function(t){return t.toUpperCase().replace("_","")});function i(t,i){return this[n.name]=i?t:n.V4(t),this}function r(){return this[n.name]}t=t.substring(0,1).toUpperCase()+t.substring(1);var s=n.L4.replace(/([A-Z])/g,function(t){return"_"+t});null===h.M4("set"+t)&&(e["set"+t]=i),null===h.M4("set_"+s)&&(e["set_"+s]=i),null===h.M4("get"+t)&&(e["get"+t]=r),null===h.M4("get_"+s)&&(e["get_"+s]=r)})(i)}function l(t,n,r,s){if(null===t||"object"!=typeof t){if(s&&s instanceof c.Reflect.Q4){var i=c.Reflect.Q4.getName(s.object,t);if(null!==i)return i}return t}if(T.rI(t))return n?t.toBase64():t.toBuffer();if(c.ZA.c5(t))return r?t.toString():c.ZA.l5(t);var e;if(Array.isArray(t))return e=[],t.forEach(function(t,i){e[i]=l(t,n,r,s)}),e;if(e={},t instanceof c.Map){for(var h=t.entries(),o=h.next();!o.done;o=h.next())e[t.v5.Z4(o.value[0])]=l(o.value[1],n,r,t.d5.N4);return e}var u=t.E5,a=void 0;for(var f in t)t.hasOwnProperty(f)&&(u&&(a=u.M4(f))?e[f]=l(t[f],n,r,a.N4):e[f]=l(t[f],n,r));return e}return e.encode=function(i,t){"boolean"==typeof i&&(t=i,i=void 0);var n=!1;i||(i=new T(),n=!0);var r=i.$A;try{return h.encode(this,i.PN(),t),(n?i.cl():i).PN(r)}catch(t){throw i.PN(r),t}},a.encode=function(t,i,n){return new a(t).encode(i,n)},e.X4=function(){return h.X4(this)},e.w5=function(t){var i=!1;t||(t=new T(),i=!0);var n=new T().PN();return h.encode(this,n).cl(),t.XI(n.GN()),t.append(n),i?t.cl():t},e.p5=function(){try{return this.encode().toArrayBuffer()}catch(t){throw t.g5&&(t.g5=t.g5.toArrayBuffer()),t}},e.toArrayBuffer=e.p5,e.b5=function(){try{return this.encode().toBuffer()}catch(t){throw t.g5&&(t.g5=t.g5.toBuffer()),t}},e.toBuffer=e.b5,e.y5=function(){try{return this.encode().toBase64()}catch(t){throw t.g5&&(t.g5=t.g5.toBase64()),t}},e.toBase64=e.y5,e.T5=function(){try{return this.encode().BN()}catch(t){throw t.g5&&(t.g5=t.g5.BN()),t}},e.BN=e.T5,e.O5=function(t,i){return l(this,!!t,!!i,this.E5)},e.m5=function(){return JSON.stringify(l(this,!0,!0,this.E5))},a.decode=function(i,t){"string"==typeof i&&(i=T.wrap(i,t||"base64"));var n=(i=T.rI(i)?i:T.wrap(i)).$A;try{var r=h.decode(i.PN());return i.PN(n),r}catch(t){throw i.PN(n),t}},a._5=function(i,t){if("string"==typeof i&&(i=T.wrap(i,t||"base64")),(i=T.rI(i)?i:T.wrap(i)).GN()<1)return null;var n=i.offset,r=i.JI();if(i.GN()<r)return i.offset=n,null;try{var s=h.decode(i.slice(i.offset,i.offset+r).PN());return i.offset+=r,s}catch(t){throw i.offset+=r,t}},a.decode64=function(t){return a.decode(t,"base64")},a.R5=function(t){return a.decode(t,"hex")},a.S5=function(t){return new a(JSON.parse(t))},e.toString=function(){return h.toString()},Object.defineProperty&&(Object.defineProperty(a,"F4",{value:h.G4()}),Object.defineProperty(e,"F4",{value:a.F4}),Object.defineProperty(a,"E5",{value:h}),Object.defineProperty(e,"E5",{value:h})),a}(E,this);this.t5=[],this.i5={},this.n5={};for(var n,r=0,s=this.children.length;r<s;r++)if((n=this.children[r])instanceof v||n instanceof l||n instanceof g){if(i.hasOwnProperty(n.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+n.toString(!0)+" cannot override static property '"+n.name+"'");i[n.name]=n._l()}else if(n instanceof l.P4)n._l(),this.t5.push(n),this.i5[n.id]=n,this.n5[n.name]=n;else if(!(n instanceof l.o5||n instanceof p))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[r].toString(!0));return this.Y4=i},r.encode=function(t,i,n){for(var r,s,e=null,h=0,o=this.t5.length;h<o;++h)s=t[(r=this.t5[h]).name],r.required&&null===s?null===e&&(e=r):r.encode(n?s:r.V4(s),i,t);if(null===e)return i;var u=Error("Missing at least one required field for "+this.toString(!0)+": "+e);throw u.g5=i,u},r.X4=function(t){for(var i,n,r=0,s=0,e=this.t5.length;s<e;++s){if(n=t[(i=this.t5[s]).name],i.required&&null===n)throw Error("Missing at least one required field for "+this.toString(!0)+": "+i);r+=i.X4(n,t)}return r},r.decode=function(t,i,n){i="number"==typeof i?i:-1;for(var r,s,e,h,o=t.offset,u=new this.Y4();t.offset<o+i||-1===i&&0<t.GN();){if(e=(r=t.JI())>>>3,(s=7&r)===E.d3.y3){if(e!==n)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+e+" ("+(n?n+" expected":"not a group")+")");break}if(h=this.i5[e]){if(h.repeated&&!h.options.A5)u[h.name].push(h.decode(s,t));else if(h.map){var a=h.decode(s,t);u[h.name].set(a[0],a[1])}else if(u[h.name]=h.decode(s,t),h.R4){var f=u[h.R4.name];null!==f&&f!==h.name&&(u[f]=null),u[h.R4.name]=h.name}}else switch(s){case E.d3.E3:t.JI();break;case E.d3.T3:t.offset+=4;break;case E.d3.w3:t.offset+=8;break;case E.d3.g3:var c=t.JI();t.offset+=c;break;case E.d3.b3:for(;w(e,t););break;default:throw Error("Illegal wire type for unknown field "+e+" in "+this.toString(!0)+"#decode: "+s)}}for(var l=0,v=this.t5.length;l<v;++l)if(null===u[(h=this.t5[l]).name])if("proto3"===this.h4)u[h.name]=h.defaultValue;else{if(h.required){var d=Error("Missing at least one required field for "+this.toString(!0)+": "+h.name);throw d.I5=u,d}E.D3&&null!==h.defaultValue&&(u[h.name]=h.defaultValue)}return u},h.Lc=l;var s=u.prototype=Object.create(f.prototype);function a(t,i,n,r,s,e,h){u.call(this,t,i,n,null,r,s,e,h),this.N5}s._l=function(){this.s5=new c(this.type,this.N4,!1,this.h4),this.map&&(this.e5=new c(this.r5,void 0,!0,this.h4)),"proto3"!==this.h4||this.repeated||this.map?void 0!==this.options["default"]&&(this.defaultValue=this.V4(this.options["default"])):this.defaultValue=c.B4(this.type)},s.V4=function(t,i){i=i||!1;var n,r=function(t,i){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+t+" ("+i+")")}.bind(this);if(null===t)return this.required&&r(typeof t,"required"),"proto3"===this.h4&&this.type!==E.m3.message&&r(typeof t,"proto3 field without field presence cannot be null"),null;if(!this.repeated||i)return this.map&&!i?t instanceof E.Map?t:(t instanceof Object||r(typeof t,"expected ProtoBuf.Map or raw object for map field"),new E.Map(this,t)):(!this.repeated&&Array.isArray(t)&&r(typeof t,"no array expected"),this.s5.V4(t));Array.isArray(t)||(t=[t]);var s=[];for(n=0;n<t.length;n++)s.push(this.s5.V4(t[n]));return s},s.C5=function(t,i){if("proto3"!==this.h4)return null!==t;if(this.R4&&i[this.R4.name]===this.name)return!0;switch(this.type){case E.m3.int32:case E.m3.sint32:case E.m3.sfixed32:case E.m3.uint32:case E.m3.fixed32:return 0!==t;case E.m3.int64:case E.m3.sint64:case E.m3.sfixed64:case E.m3.uint64:case E.m3.fixed64:return 0!==t.low||0!==t.high;case E.m3.bool:return t;case E.m3["float"]:case E.m3["double"]:return 0!==t;case E.m3.string:return 0<t.length;case E.m3.bytes:return 0<t.GN();case E.m3["enum"]:return 0!==t;case E.m3.message:return null!==t;default:return!0}},s.encode=function(i,s,t){if(null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===i||this.repeated&&0==i.length)return s;try{var n;if(this.repeated)if(this.options.A5&&0<=E.O3.indexOf(this.type._3)){s.XI(this.id<<3|E.d3.g3),s.MN(s.offset+=1);var r=s.offset;for(n=0;n<i.length;n++)this.s5.z4(this.id,i[n],s);var e=s.offset-r,h=T.KI(e);if(1<h){var o=s.slice(r,s.offset);r+=h-1,s.offset=r,s.append(o)}s.XI(e,r-h)}else for(n=0;n<i.length;n++)s.XI(this.id<<3|this.type._3),this.s5.z4(this.id,i[n],s);else this.map?i.forEach(function(t,i,n){var r=T.KI(8|this.r5._3)+this.e5.W4(1,i)+T.KI(16|this.type._3)+this.s5.W4(2,t);s.XI(this.id<<3|E.d3.g3),s.XI(r),s.XI(8|this.r5._3),this.e5.z4(1,i,s),s.XI(16|this.type._3),this.s5.z4(2,t,s)},this):this.C5(i,t)&&(s.XI(this.id<<3|this.type._3),this.s5.z4(this.id,i,s))}catch(t){throw Error("Illegal value for "+this.toString(!0)+": "+i+" ("+t+")")}return s},s.X4=function(i,t){if(i=this.V4(i),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===i||this.repeated&&0==i.length)return 0;var s=0;try{var n,r;if(this.repeated)if(this.options.A5&&0<=E.O3.indexOf(this.type._3)){for(s+=T.KI(this.id<<3|E.d3.g3),n=r=0;n<i.length;n++)r+=this.s5.W4(this.id,i[n]);s+=T.KI(r),s+=r}else for(n=0;n<i.length;n++)s+=T.KI(this.id<<3|this.type._3),s+=this.s5.W4(this.id,i[n]);else this.map?i.forEach(function(t,i,n){var r=T.KI(8|this.r5._3)+this.e5.W4(1,i)+T.KI(16|this.type._3)+this.s5.W4(2,t);s+=T.KI(this.id<<3|E.d3.g3),s+=T.KI(r),s+=r},this):this.C5(i,t)&&(s+=T.KI(this.id<<3|this.type._3),s+=this.s5.W4(this.id,i))}catch(t){throw Error("Illegal value for "+this.toString(!0)+": "+i+" ("+t+")")}return s},s.decode=function(t,i,n){var r,s;if(!(!this.map&&t==this.type._3||!n&&this.repeated&&this.options.A5&&t==E.d3.g3||this.map&&t==E.d3.g3))throw Error("Illegal wire type for field "+this.toString(!0)+": "+t+" ("+this.type._3+" expected)");if(t==E.d3.g3&&this.repeated&&this.options.A5&&0<=E.O3.indexOf(this.type._3)&&!n){s=i.JI(),s=i.offset+s;for(var e=[];i.offset<s;)e.push(this.decode(this.type._3,i,!0));return e}if(this.map){var h=c.B4(this.r5);if(r=c.B4(this.type),s=i.JI(),i.GN()<s)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+s+" required but got only "+i.GN());var o=i.clone();for(o.WA=o.offset+s,i.offset+=s;0<o.GN();){var u=o.JI();t=7&u;var a=u>>>3;if(1==a)h=this.e5.decode(o,t,a);else{if(2!=a)throw Error("Unexpected tag in map field key/value submessage");r=this.s5.decode(o,t,a)}}return[h,r]}return this.s5.decode(i,t,this.id)},h.Lc.P4=u,a.prototype=Object.create(u.prototype),h.Lc.h5=a,h.Lc.o5=function(t,i,n){f.call(this,t,i,n),this.fields=[]};var v=function(t,i,n,r,s){o.call(this,t,i,n,r,s),this.className="Enum",this.object=null};function d(t,i,n,r){f.call(this,t,i,n),this.className="Enum.Value",this.id=r}v.getName=function(t,i){for(var n,r=Object.keys(t),s=0;s<r.length;++s)if(t[n=r[s]]===i)return n;return null},(v.prototype=Object.create(o.prototype))._l=function(t){if(this.object&&!t)return this.object;for(var i=new E.K4.Q4(),n=this.D4(v.q4),r=0,s=n.length;r<s;++r)i[n[r].name]=n[r].id;return Object.defineProperty&&Object.defineProperty(i,"F4",{value:this.G4(),enumerable:!1}),this.object=i},h.Q4=v,d.prototype=Object.create(f.prototype),h.Q4.q4=d;var p=function(t,i,n,r){f.call(this,t,i,n),this.field=r};p.prototype=Object.create(f.prototype),h.k5=p;var g=function(t,i,n,r){o.call(this,t,i,n,r),this.className="Service",this.Y4=null};function b(t,i,n,r){f.call(this,t,i,n),this.className="Service.Method",this.options=r||{}}function y(t,i,n,r,s,e,h,o){b.call(this,t,i,n,o),this.className="Service.RPCMethod",this.D5=r,this.j5=s,this.M5=e,this.P5=h,this.L5=null,this.H5=null}return(g.prototype=Object.create(o.prototype))._l=function(t){return this.Y4&&!t?this.Y4:this.Y4=function(i,s){for(var e=function(t){i.K4.U5.call(this),this.F5=t||function(t,i,n){setTimeout(n.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},t=e.prototype=Object.create(i.K4.U5.prototype),n=s.D4(i.Reflect.U5.G5),r=0;r<n.length;r++)!function(r){t[r.name]=function(t,n){try{try{t=r.L5.Y4.decode(T.wrap(t))}catch(t){if(!(t instanceof TypeError))throw t}if(null===t||"object"!=typeof t)throw Error("Illegal arguments");t instanceof r.L5.Y4||(t=new r.L5.Y4(t)),this.F5(r.A4(),t,function(t,i){if(t)n(t);else{try{i=r.H5.Y4.decode(i)}catch(t){}i&&i instanceof r.H5.Y4?n(null,i):n(Error("Illegal response type received in service method "+s.name+"#"+r.name))}})}catch(t){setTimeout(n.bind(this,t),0)}},e[r.name]=function(t,i,n){new e(t)[r.name](i,n)},Object.defineProperty&&(Object.defineProperty(e[r.name],"F4",{value:r.G4()}),Object.defineProperty(t[r.name],"F4",{value:e[r.name].F4}))}(n[r]);return Object.defineProperty&&(Object.defineProperty(e,"F4",{value:s.G4()}),Object.defineProperty(t,"F4",{value:e.F4}),Object.defineProperty(e,"E5",{value:s}),Object.defineProperty(t,"E5",{value:s})),e}(E,this)},h.U5=g,(b.prototype=Object.create(f.prototype)).G4=i.G4,h.U5.x5=b,y.prototype=Object.create(b.prototype),h.U5.G5=y,h}(s),s.K4=function(c,i,h){function o(t){this.B5=new h.H4(this,null,""),this.V5=this.B5,this.q5=!1,this.result=null,this.files={},this.Q5=null,this.options=t||{}}var t=o.prototype;return o.Y5=function(t){return"string"==typeof t.name&&void 0===t.values&&void 0===t.d4},o.K5=function(t){return"string"==typeof t.rule&&"string"==typeof t.name&&"string"==typeof t.type&&void 0!==t.id},o.W5=function(t){return"string"==typeof t.name&&!(void 0===t.values||!Array.isArray(t.values)||0===t.values.length)},o.X5=function(t){return!("string"!=typeof t.name||"object"!=typeof t.d4||!t.d4)},o.z5=function(t){return"string"==typeof t.KY},t.reset=function(){return this.V5=this.B5,this},t.define=function(t){if("string"!=typeof t||!i.x3.test(t))throw Error("illegal namespace: "+t);return t.split(".").forEach(function(t){var i=this.V5.M4(t);null===i&&this.V5.j4(i=new h.H4(this,this.V5,t)),this.V5=i},this),this},t.create=function(t){if(!t)return this;if(Array.isArray(t)){if(0===t.length)return this;t=t.slice()}else t=[t];for(var i=[t];0<i.length;){if(t=i.pop(),!Array.isArray(t))throw Error("not a valid namespace: "+JSON.stringify(t));for(;0<t.length;){var n=t.shift();if(o.Y5(n)){var s=new h.Lc(this,this.V5,n.name,n.options,n.y4,n.h4),r={};n.b4&&Object.keys(n.b4).forEach(function(t){s.j4(r[t]=new h.Lc.o5(this,s,t))},this),n.fields&&n.fields.forEach(function(t){if(null!==s.M4(0|t.id))throw Error("duplicate or invalid field id in "+s.name+": "+t.id);if(t.options&&"object"!=typeof t.options)throw Error("illegal field options in "+s.name+"#"+t.name);var i=null;if("string"==typeof t.R4&&!(i=r[t.R4]))throw Error("illegal oneof in "+s.name+"#"+t.name+": "+t.R4);t=new h.Lc.P4(this,s,t.rule,t.keytype,t.type,t.name,t.id,t.options,i,n.h4),i&&i.fields.push(t),s.j4(t)},this);var e=[];if(n.e4&&n.e4.forEach(function(t){e.push(t)}),n.messages&&n.messages.forEach(function(t){e.push(t)}),n.services&&n.services.forEach(function(t){e.push(t)}),n.extensions&&(s.extensions=n.extensions,s.extensions[0]<c.A3&&(s.extensions[0]=c.A3),s.extensions[1]>c.I3&&(s.extensions[1]=c.I3)),this.V5.j4(s),0<e.length){i.push(t),t=e,e=null,this.V5=s,s=null;continue}e=null}else if(o.W5(n))s=new h.Q4(this,this.V5,n.name,n.options,n.h4),n.values.forEach(function(t){s.j4(new h.Q4.q4(this,s,t.name,t.id))},this),this.V5.j4(s);else if(o.X5(n))s=new h.U5(this,this.V5,n.name,n.options),Object.keys(n.d4).forEach(function(t){var i=n.d4[t];s.j4(new h.U5.G5(this,s,t,i.request,i.response,!!i.w4,!!i.g4,i.options))},this),this.V5.j4(s);else{if(!o.z5(n))throw Error("not a valid definition: "+JSON.stringify(n));if(s=this.V5.resolve(n.KY,!0))n.fields.forEach(function(t){if(null!==s.M4(0|t.id))throw Error("duplicate extended field id in "+s.name+": "+t.id);if(t.id<s.extensions[0]||t.id>s.extensions[1])throw Error("illegal extended field id in "+s.name+": "+t.id+" ("+s.extensions.join(" to ")+" expected)");var i=t.name;this.options.N3&&(i=c.ST.H3(i));var n=new h.Lc.h5(this,s,t.rule,t.type,this.V5.A4()+"."+i,t.id,t.options),r=new h.k5(this,this.V5,t.name,n);n.N5=r,this.V5.j4(r),s.j4(n)},this);else if(!/\.?google\.protobuf\./.test(n.KY))throw Error("extended message "+n.KY+" is not defined")}s=n=null}t=null,this.V5=this.V5.parent}return this.q5=!1,this.result=null,this},t["import"]=function(i,t){var n="/";if("string"==typeof t){if(c.ST.j3&&(t=l(109).resolve(t)),!0===this.files[t])return this.reset();this.files[t]=!0}else if("object"==typeof t){var r=t.root;c.ST.j3&&(r=l(109).resolve(r)),(0<=r.indexOf("\\")||0<=t.J5.indexOf("\\"))&&(n="\\");var s=r+n+t.J5;if(!0===this.files[s])return this.reset();this.files[s]=!0}if(i.imports&&0<i.imports.length){var e,h=!1;"object"==typeof t?(this.Q5=t.root,h=!0,e=this.Q5,t=t.J5,(0<=e.indexOf("\\")||0<=t.indexOf("\\"))&&(n="\\")):"string"==typeof t?this.Q5?e=this.Q5:0<=t.indexOf("/")?""===(e=t.replace(/\/[^\/]*$/,""))&&(e="/"):0<=t.indexOf("\\")?(e=t.replace(/\\[^\\]*$/,""),n="\\"):e=".":e=null;for(var o=0;o<i.imports.length;o++)if("string"==typeof i.imports[o]){if(!e)throw Error("cannot determine import root");var u=i.imports[o];if("google/protobuf/descriptor.proto"===u)continue;if(u=e+n+u,!0===this.files[u])continue;/\.proto$/i.test(u)&&!c.Z3&&(u=u.replace(/\.proto$/,".json"));var a=c.ST.fetch(u);if(null===a)throw Error("failed to import '"+u+"' in '"+t+"': file not found");/\.json$/i.test(u)?this["import"](JSON.parse(a+""),u):this["import"](c.Z3.wJ.parse(a),u)}else t?/\.(\w+)$/.test(t)?this["import"](i.imports[o],t.replace(/^(.+)\.(\w+)$/,function(t,i,n){return i+"_import"+o+"."+n})):this["import"](i.imports[o],t+"_import"+o):this["import"](i.imports[o]);h&&(this.Q5=null)}i["package"]&&this.define(i["package"]),i.h4&&(function i(n){n.messages&&n.messages.forEach(function(t){t.h4=n.h4,i(t)}),n.e4&&n.e4.forEach(function(t){t.h4=n.h4})})(i);var f=this.V5;return i.options&&Object.keys(i.options).forEach(function(t){f.options[t]=i.options[t]}),i.messages&&(this.create(i.messages),this.V5=f),i.e4&&(this.create(i.e4),this.V5=f),i.services&&(this.create(i.services),this.V5=f),i.Z5&&this.create(i.Z5),this.reset()},t.t6=function(){var t;if(null==this.V5||"object"==typeof this.V5.type)return this;if(this.V5 instanceof h.H4)this.V5.children.forEach(function(t){this.V5=t,this.t6()},this);else if(this.V5 instanceof h.Lc.P4){if(i._L.test(this.V5.type))this.V5.type=c.m3[this.V5.type];else{if(!i.x3.test(this.V5.type))throw Error("illegal type reference in "+this.V5.toString(!0)+": "+this.V5.type);if(!(t=(this.V5 instanceof h.Lc.h5?this.V5.N5.parent:this.V5.parent).resolve(this.V5.type,!0)))throw Error("unresolvable type reference in "+this.V5.toString(!0)+": "+this.V5.type);if((this.V5.N4=t)instanceof h.Q4){if(this.V5.type=c.m3["enum"],"proto3"===this.V5.h4&&"proto3"!==t.h4)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(t instanceof h.Lc))throw Error("illegal type reference in "+this.V5.toString(!0)+": "+this.V5.type);this.V5.type=t.y4?c.m3.group:c.m3.message}}if(this.V5.map){if(!i._L.test(this.V5.r5))throw Error("illegal key type for map field in "+this.V5.toString(!0)+": "+this.V5.r5);this.V5.r5=c.m3[this.V5.r5]}}else if(this.V5 instanceof c.Reflect.U5.x5){if(!(this.V5 instanceof c.Reflect.U5.G5))throw Error("illegal service type in "+this.V5.toString(!0));if(!((t=this.V5.parent.resolve(this.V5.D5,!0))&&t instanceof c.Reflect.Lc))throw Error("Illegal type reference in "+this.V5.toString(!0)+": "+this.V5.D5);if(this.V5.L5=t,!((t=this.V5.parent.resolve(this.V5.j5,!0))&&t instanceof c.Reflect.Lc))throw Error("Illegal type reference in "+this.V5.toString(!0)+": "+this.V5.j5);this.V5.H5=t}else if(!(this.V5 instanceof c.Reflect.Lc.o5||this.V5 instanceof c.Reflect.k5||this.V5 instanceof c.Reflect.Q4.q4))throw Error("illegal object in namespace: "+typeof this.V5+": "+this.V5);return this.reset()},t._l=function(t){if(this.reset(),this.q5||(this.t6(),this.q5=!0,this.result=null),null===this.result&&(this.result=this.B5._l()),!t)return this.result;for(var i="string"==typeof t?t.split("."):t,n=this.result,r=0;r<i.length;r++){if(!n[i[r]]){n=null;break}n=n[i[r]]}return n},t.lookup=function(t,i){return t?this.B5.resolve(t,i):this.B5},t.toString=function(){return"Builder"},o.Lc=function(){},o.Q4=function(){},o.U5=function(){},o}(s,s.Lang,s.Reflect),s.Map=function(t,h){function i(t,i){if(!t.map)throw Error("field is not a map");if(this.field=t,this.v5=new h.Element(t.r5,null,!0,t.h4),this.d5=new h.Element(t.type,t.N4,!1,t.h4),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),i)for(var n=Object.keys(i),r=0;r<n.length;r++){var s=this.v5.J4(n[r]),e=this.d5.V4(i[n[r]]);this.map[this.v5.Z4(s)]={key:s,value:e}}}var n=i.prototype;function s(t){var i=0;return{next:function(){return i<t.length?{done:!1,value:t[i++]}:{done:!0}}}}return n.clear=function(){this.map={}},n["delete"]=function(t){var i=this.v5.Z4(this.v5.V4(t)),n=i in this.map;return delete this.map[i],n},n.entries=function(){for(var t,i=[],n=Object.keys(this.map),r=0;r<n.length;r++)i.push([(t=this.map[n[r]]).key,t.value]);return s(i)},n.keys=function(){for(var t=[],i=Object.keys(this.map),n=0;n<i.length;n++)t.push(this.map[i[n]].key);return s(t)},n.values=function(){for(var t=[],i=Object.keys(this.map),n=0;n<i.length;n++)t.push(this.map[i[n]].value);return s(t)},n.forEach=function(t,i){for(var n,r=Object.keys(this.map),s=0;s<r.length;s++)t.call(i,(n=this.map[r[s]]).value,n.key,this)},n.set=function(t,i){var n=this.v5.V4(t),r=this.d5.V4(i);return this.map[this.v5.Z4(n)]={key:n,value:r},this},n.get=function(t){var i=this.v5.Z4(this.v5.V4(t));if(i in this.map)return this.map[i].value},n.has=function(t){return this.v5.Z4(this.v5.V4(t))in this.map},i}(0,s.Reflect),s.i6=function(t,i,n){return("string"==typeof i||i&&"string"==typeof i.J5&&"string"==typeof i.root)&&(n=i,i=void 0),s.Rl(s.Z3.wJ.parse(t),i,n)},s.n6=s.i6,s.r6=function(i,n,r){if(n&&"object"==typeof n?(r=n,n=null):n&&"function"==typeof n||(n=null),n)return s.ST.fetch("string"==typeof i?i:i.root+"/"+i.J5,function(t){if(null!==t)try{n(null,s.i6(t,r,i))}catch(t){n(t)}else n(Error("Failed to fetch file"))});var t=s.ST.fetch("object"==typeof i?i.root+"/"+i.J5:i);return null===t?null:s.i6(t,r,i)},s.s6=s.r6,s.e6=function(t){return void 0===(t=t||{}).N3&&(t.N3=s.N3),void 0===t.C3&&(t.C3=s.C3),new s.K4(t)},s.Rl=function(t,i,n){return("string"==typeof i||i&&"string"==typeof i.J5&&"string"==typeof i.root)&&(n=i,i=null),i&&"object"==typeof i||(i=s.e6()),"string"==typeof t&&(t=JSON.parse(t)),i["import"](t,n),i.t6(),i},s.h6=function(i,n,r){if(n&&"object"==typeof n?(r=n,n=null):n&&"function"==typeof n||(n=null),n)return s.ST.fetch("string"==typeof i?i:i.root+"/"+i.J5,function(t){if(null!==t)try{n(null,s.Rl(JSON.parse(t),r,i))}catch(t){n(t)}else n(Error("Failed to fetch file"))});var t=s.ST.fetch("object"==typeof i?i.root+"/"+i.J5:i);return null===t?null:s.Rl(JSON.parse(t),r,i)},s})?t.apply(e,n):t)||(s.exports=r)}).call(this,l(37))},function(t,i,n){var r,s,e;s=[],void 0===(e="function"==typeof (r=function(){"use strict";function v(t,i,n){this.low=0|t,this.high=0|i,this.hN=!!n}Object.defineProperty(v.prototype,"o6",{value:!0,enumerable:!1,configurable:!1}),v.c5=function(t){return!0===(t&&t.o6)};var s={},e={};v.cb=function(t,i){var n,r;return i?0<=(t>>>=0)&&t<256&&(r=e[t])?r:(n=new v(t,(0|t)<0?-1:0,!0),0<=t&&t<256&&(e[t]=n),n):-128<=(t|=0)&&t<128&&(r=s[t])?r:(n=new v(t,t<0?-1:0,!1),-128<=t&&t<128&&(s[t]=n),n)},v.rb=function(t,i){return i=!!i,isNaN(t)||!isFinite(t)?v.ZERO:!i&&t<=-h?v.MIN_VALUE:!i&&h<=t+1?v.MAX_VALUE:i&&r<=t?v.u6:t<0?v.rb(-t,i).Ub():new v(t%n|0,t/n|0,i)},v.LO=function(t,i,n){return new v(t,i,n)},v.fromString=function(t,i,n){if(0===t.length)throw Error("number format error: empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return v.ZERO;if("number"==typeof i&&(n=i,i=!1),(n=n||10)<2||36<n)throw Error("radix out of range: "+n);var r;if(0<(r=t.indexOf("-")))throw Error('number format error: interior "-" character: '+t);if(0===r)return v.fromString(t.substring(1),i,n).Ub();for(var s=v.rb(Math.pow(n,8)),e=v.ZERO,h=0;h<t.length;h+=8){var o=Math.min(8,t.length-h),u=parseInt(t.substring(h,h+o),n);if(o<8){var a=v.rb(Math.pow(n,o));e=e.multiply(a).add(v.rb(u))}else e=(e=e.multiply(s)).add(v.rb(u))}return e.hN=i,e},v.l5=function(t){return t instanceof v?t:"number"==typeof t?v.rb(t):"string"==typeof t?v.fromString(t):new v(t.low,t.high,t.hN)};var n=4294967296,r=n*n,h=r/2,d=v.cb(1<<24);return v.ZERO=v.cb(0),v.R3=v.cb(0,!0),v.ONE=v.cb(1),v.a6=v.cb(1,!0),v.f6=v.cb(-1),v.MAX_VALUE=v.LO(-1,2147483647,!1),v.u6=v.LO(-1,-1,!0),v.MIN_VALUE=v.LO(0,-2147483648,!1),v.prototype.rN=function(){return this.hN?this.low>>>0:this.low},v.prototype.c6=function(){return this.hN?(this.high>>>0)*n+(this.low>>>0):this.high*n+(this.low>>>0)},v.prototype.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix out of range: "+t);if(this.l6())return"0";var i;if(this.dJ()){if(this.equals(v.MIN_VALUE)){var n=v.rb(t),r=this.v6(n);return i=r.multiply(n).d6(this),r.toString(t)+i.rN().toString(t)}return"-"+this.Ub().toString(t)}var s=v.rb(Math.pow(t,6),this.hN);i=this;for(var e="";;){var h=i.v6(s),o=(i.d6(h.multiply(s)).rN()>>>0).toString(t);if((i=h).l6())return o+e;for(;o.length<6;)o="0"+o;e=""+o+e}},v.prototype.E6=function(){return this.high},v.prototype.w6=function(){return this.high>>>0},v.prototype.p6=function(){return this.low},v.prototype.g6=function(){return this.low>>>0},v.prototype.b6=function(){if(this.dJ())return this.equals(v.MIN_VALUE)?64:this.Ub().b6();for(var t=0!=this.high?this.high:this.low,i=31;0<i&&0==(t&1<<i);i--);return 0!=this.high?i+33:i+1},v.prototype.l6=function(){return 0===this.high&&0===this.low},v.prototype.dJ=function(){return!this.hN&&this.high<0},v.prototype.y6=function(){return this.hN||0<=this.high},v.prototype.T6=function(){return 1==(1&this.low)},v.prototype.Hb=function(){return 0==(1&this.low)},v.O6=v.prototype.equals=function(t){return v.c5(t)||(t=v.l5(t)),(this.hN===t.hN||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},v.m6=v.prototype._6=function(t){return!this.equals(t)},v.prototype.R6=v.prototype.S6=function(t){return this.compare(t)<0},v.prototype.A6=v.prototype.I6=function(t){return this.compare(t)<=0},v.prototype.N6=v.prototype.C6=function(t){return 0<this.compare(t)},v.prototype.k6=v.prototype.D6=function(t){return 0<=this.compare(t)},v.prototype.compare=function(t){if(v.c5(t)||(t=v.l5(t)),this.equals(t))return 0;var i=this.dJ(),n=t.dJ();return i&&!n?-1:!i&&n?1:this.hN?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.d6(t).dJ()?-1:1},v.prototype.j6=v.prototype.Ub=function(){return!this.hN&&this.equals(v.MIN_VALUE)?v.MIN_VALUE:this.not().add(v.ONE)},v.prototype.add=function(t){v.c5(t)||(t=v.l5(t));var i=this.high>>>16,n=65535&this.high,r=this.low>>>16,s=65535&this.low,e=t.high>>>16,h=65535&t.high,o=t.low>>>16,u=0,a=0,f=0,c=0;return f+=(c+=s+(65535&t.low))>>>16,a+=(f+=r+o)>>>16,u+=(a+=n+h)>>>16,u+=i+e,v.LO((f&=65535)<<16|(c&=65535),(u&=65535)<<16|(a&=65535),this.hN)},v.prototype.sub=v.prototype.d6=function(t){return v.c5(t)||(t=v.l5(t)),this.add(t.Ub())},v.prototype.M6=v.prototype.multiply=function(t){if(this.l6())return v.ZERO;if(v.c5(t)||(t=v.l5(t)),t.l6())return v.ZERO;if(this.equals(v.MIN_VALUE))return t.T6()?v.MIN_VALUE:v.ZERO;if(t.equals(v.MIN_VALUE))return this.T6()?v.MIN_VALUE:v.ZERO;if(this.dJ())return t.dJ()?this.Ub().multiply(t.Ub()):this.Ub().multiply(t).Ub();if(t.dJ())return this.multiply(t.Ub()).Ub();if(this.S6(d)&&t.S6(d))return v.rb(this.c6()*t.c6(),this.hN);var i=this.high>>>16,n=65535&this.high,r=this.low>>>16,s=65535&this.low,e=t.high>>>16,h=65535&t.high,o=t.low>>>16,u=65535&t.low,a=0,f=0,c=0,l=0;return c+=(l+=s*u)>>>16,f+=(c+=r*u)>>>16,c&=65535,f+=(c+=s*o)>>>16,a+=(f+=n*u)>>>16,f&=65535,a+=(f+=r*o)>>>16,f&=65535,a+=(f+=s*h)>>>16,a+=i*u+n*o+r*h+s*e,v.LO((c&=65535)<<16|(l&=65535),(a&=65535)<<16|(f&=65535),this.hN)},v.prototype.P6=v.prototype.v6=function(t){if(v.c5(t)||(t=v.l5(t)),t.l6())throw new Error("division by zero");if(this.l6())return this.hN?v.R3:v.ZERO;var i,n,r;if(this.equals(v.MIN_VALUE))return t.equals(v.ONE)||t.equals(v.f6)?v.MIN_VALUE:t.equals(v.MIN_VALUE)?v.ONE:(i=this.aN(1).v6(t).shiftLeft(1)).equals(v.ZERO)?t.dJ()?v.ONE:v.f6:(n=this.d6(t.multiply(i)),r=i.add(n.v6(t)));if(t.equals(v.MIN_VALUE))return this.hN?v.R3:v.ZERO;if(this.dJ())return t.dJ()?this.Ub().v6(t.Ub()):this.Ub().v6(t).Ub();if(t.dJ())return this.v6(t.Ub()).Ub();for(r=v.ZERO,n=this;n.D6(t);){i=Math.max(1,Math.floor(n.c6()/t.c6()));for(var s=Math.ceil(Math.log(i)/Math.LN2),e=s<=48?1:Math.pow(2,s-48),h=v.rb(i),o=h.multiply(t);o.dJ()||o.C6(n);)o=(h=v.rb(i-=e,this.hN)).multiply(t);h.l6()&&(h=v.ONE),r=r.add(h),n=n.d6(o)}return r},v.prototype.mb=v.prototype.iJ=function(t){return v.c5(t)||(t=v.l5(t)),this.d6(this.v6(t).multiply(t))},v.prototype.not=function(){return v.LO(~this.low,~this.high,this.hN)},v.prototype.and=function(t){return v.c5(t)||(t=v.l5(t)),v.LO(this.low&t.low,this.high&t.high,this.hN)},v.prototype.or=function(t){return v.c5(t)||(t=v.l5(t)),v.LO(this.low|t.low,this.high|t.high,this.hN)},v.prototype.xor=function(t){return v.c5(t)||(t=v.l5(t)),v.LO(this.low^t.low,this.high^t.high,this.hN)},v.prototype.L6=v.prototype.shiftLeft=function(t){return v.c5(t)&&(t=t.rN()),0==(t&=63)?this:t<32?v.LO(this.low<<t,this.high<<t|this.low>>>32-t,this.hN):v.LO(0,this.low<<t-32,this.hN)},v.prototype.H6=v.prototype.aN=function(t){return v.c5(t)&&(t=t.rN()),0==(t&=63)?this:t<32?v.LO(this.low>>>t|this.high<<32-t,this.high>>t,this.hN):v.LO(this.high>>t-32,0<=this.high?0:-1,this.hN)},v.prototype.U6=v.prototype.sN=function(t){if(v.c5(t)&&(t=t.rN()),0==(t&=63))return this;var i=this.high;if(t<32){var n=this.low;return v.LO(n>>>t|i<<32-t,i>>>t,this.hN)}return v.LO(32===t?i:i>>>t-32,0,this.hN)},v.prototype.oN=function(){return this.hN?new v(this.low,this.high,!1):this},v.prototype.uN=function(){return this.hN?this:new v(this.low,this.high,!0)},v})?r.apply(i,s):r)||(t.exports=e)},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(0),y=n(17),e=n(53),h=n(204),o=n(208),u=n(8),T=n(1),O=n(2),m=u.Y.af,a=u.Y.sf,f=(c.prototype.tl=function(){return this.sender.tl()||this.receiver.tl()},c.prototype.close=function(){var i=this,n=r.defer();return this.sender.F6().then(function(t){return i.receiver.close(t).then(function(t){return i.SQ(t).then(function(t){return i.transport.close(t).then(function(t){n.resolve(t)})})})})["catch"](function(t){T.ErrorMonitor.getInstance().logError("Error closing connection to peer",i.loggerId,O.Ft.jt,{detailedError:t,otherGuid:i.otherGuid}),n.reject("Close partnership failed")}),n.promise},c.prototype.SQ=function(t){this.logger.debug("SEND CLOSE TO "+this.otherGuid);var i=new y.Al.ml.Close();return i.setType(t),this.rl(y.Fc.Close,i),r(this.swarmId)},c.prototype.sh=function(t){try{switch(m&&this.logger.debug("DISPATCH "+t.bl),t.bl){case y.Fc.Chunk:var i=y.Al.ml.Chunk.decode(t.receivedData);this.receiver.G6(i);break;case y.Fc.Ack:var n=y.Al.ml.Ack.decode(t.receivedData);this.sender.x6(n.transferId);break;case y.Fc.Cancel:var r=y.Al.ml.Cancel.decode(t.receivedData);this.sender.B6(r.transferId);break;case y.Fc.Gc:m&&this.logger.debug("RECEIVED OUT PART,DECODING ");var s=y.Al.ml.OutPartnershipRequest.decode(t.receivedData);m&&this.logger.debug("RECEIVED OUT PART FROM "+s.guid),this.partnership.NQ(s,this.transport);break;case y.Fc.xc:m&&this.logger.debug("RECEIVED OUT PART RESP ");var e=y.Al.ml.OutPartnershipResponse.decode(t.receivedData);m&&this.logger.debug("RECEIVED OUT PART RESP FROM "+e.accept),this.partnership.$Q(e,this.transport);break;case y.Fc.Have:var h=y.Al.ml.Have.decode(t.receivedData);m&&this.logger.debug("RECEIVED HAVE FOR "+h.fragmentId+" FROM "+this.otherGuid),this.partnership.V6(this.otherGuid,h);break;case y.Fc.Close:var o=y.Al.ml.Close.decode(t.receivedData);m&&this.logger.debug("RECEIVED CLOSE FROM "+this.otherGuid),this.partnership.KQ(this.otherGuid,o);break;case y.Fc.Request:var u=y.Al.ml.Request.decode(t.receivedData);m&&this.logger.debug("RECEIVED REQUEST FOR "+u.fragmentId+" FROM "+this.otherGuid),this.e0.hH(this.otherGuid,u,this);break;case y.Fc.DoNotHave:var a=y.Al.ml.DoNotHave.decode(t.receivedData);m&&this.logger.debug("DoNotHave "+a.transferId),this.Q6.q6(a);break;case y.Fc.Bc:var f=y.Al.ml.UDPHandshakeMessage.decode(t.receivedData);m&&this.logger.debug("UDP HANDSHAKE MESSAGE RECEIVED FROM "+f.uuid),this.GZ.uq(f,this.transport);break;case y.Fc.UDPHandshakeResponse:var c=y.Al.ml.UDPHandshakeResponse.decode(t.receivedData);m&&this.logger.debug("UDP HANDSHAKE MESSAGE RESPONSE RECEIVED FROM "+this.otherGuid),this.GZ.oq(c,this.transport);break;case y.Fc.UDPSwitchLeadershipRequest:var l=y.Al.ml.UDPSwitchLeadershipRequest.decode(t.receivedData);m&&this.logger.debug("SWITCH LEADERSHIP REQUEST RECEIVED FROM "+this.otherGuid),this.GZ.Rq(l);break;case y.Fc.Vc:var v=y.Al.ml.UDPSwitchLeadershipAck.decode(t.receivedData);m&&this.logger.debug("UDP SWITCH ACKNOWLEDGMENT RESPONSE FROM "+this.otherGuid),this.GZ.kq(v,this.otherGuid);break;case y.Fc.QualityLevelMessage:var d=y.Al.ml.QualityLevelMessage.decode(t.receivedData);m&&this.logger.debug("QUALITY LEVEL INFO "+d.qualityLevel.id+" FROM "+d.guid),this.partnership.JQ(d);break;case y.Fc.Haves:var E=y.Al.ml.Haves.decode(t.receivedData);m&&this.logger.debug("RECEIVED BATCH HAVES FOR FROM "+this.otherGuid),this.partnership.Y6(this.otherGuid,E);break;case y.Fc.qc:var w=y.Al.ml.PeerInfoMessage.decode(t.receivedData);m&&this.logger.debug("RECEIVED PEER INFO FROM "+this.otherGuid),this.partnership.iY(w);break;case y.Fc.Ping:var p=y.Al.ml.Ping.decode(t.receivedData);m&&this.logger.debug("RECEIVED PING FROM "+this.otherGuid),this.partnership.K6(p);break;case y.Fc.Pong:var g=y.Al.ml.Pong.decode(t.receivedData);m&&this.logger.debug("RECEIVED PONG FROM "+this.otherGuid),this.partnership.W6(g);break;case y.Fc.Qc:var b=y.Al.ml.NoPartners.decode(t.receivedData);m&&this.logger.debug("RECEIVED NON PARTNER MESSAGE FROM "+this.otherGuid),this.Q6.X6(this.otherGuid,b);break;default:this.logger.warn("UNKNOWN MESSAGE TYPE "+t.bl)}}catch(t){T.ErrorMonitor.getInstance().logError("Error dispatching message",this.loggerId,t,O.Ft.Gt,t)}},c.prototype.rl=function(t,i){return this.transport.rl(t,this.swarmId,i)},c.prototype.dl=function(){this.sender.dl()},c);function c(t,i,n,r){this.loggerId="[P2PDispatcher] ",this.logger=s.Framework.resolve(s.Framework.v.p).log(t.sessionId),this.$c=i,this.otherGuid=n,this.swarmId=t.swarmId,this.transport=r,this.receiver=new h.z6(i,n,t),this.sender=new o.J6(i,n,t,this),this.Q6=t.oM,this.partnership=t.partnership,this.e0=t.e0,(a||s.Framework.T()&&e.$j.Kj)&&(this.GZ=t.GZ)}i.Wc=f},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(34),e=n(17),u=n(0),a=n(6),f=n(5),h=n(110),c=n(1),l=n(2),o=(v.prototype.setReportingGuid=function(t){this.Z6=t},v.prototype.tl=function(){return!(0===this.J1.keys().length&&null===this.t8)},v.prototype.n8=function(t){var i=new e.Al.ml.Request();try{i.fragmentId=t.I_(),i.transferId=t.OP,this.Uc&&this.logger.debug("INITIATING TR-"+t.OP+" TIMEOUT: "+t.r8+" FRAGMENT: "+t.I_()+" FROM: "+this.otherGuid),this.J1.set(t.OP,t),this.s8.set(t.OP,u.Framework.time())}catch(t){c.ErrorMonitor.getInstance().logError("Error constructing fragment request message",this.loggerId,l.Ur.Fr,{detailedError:t,otherGuid:this.otherGuid}),i=null}try{i&&t.partner.AQ.rl(e.Fc.Request,i)}catch(t){c.ErrorMonitor.getInstance().logError("Error sending fragment request",this.loggerId,l.Ur.Gr,{detailedError:t,otherGuid:this.otherGuid})}},v.prototype.G6=function(t){try{var i=t.transferId,n=t.data.toBuffer(),r=t.chunkSize,s=t.totalSize,e=t.headers;if(this.Uc&&this.logger.debug("RCV Chunk "+n.byteLength),!this.J1.has(i))return;null==this.t8?(this.Uc&&this.logger.debug("INITIATED TR-"+i+",SIZE="+s),this.t8=this.J1.get(i),this.t8.OP=i,f.xu.ju.Wo&&this.e8(i,this.t8.partner),null!=e?this.t8.K_=e:this.logger.warn("HEADERS NULL IN FIRST CHUNK"),this.Q6.I2(this.otherGuid,this.t8,r,s),this.t8.W_=r,u.Framework.T()||(this.t8.F_=n)):(f.xu.ju.Wo&&this.e8(i,this.t8.partner),this.t8.W_+=r,u.Framework.T()||(this.t8.F_=a.appendBuffer(this.t8.F_,n)));var h=u.Framework.T()?this.t8.W_:this.t8.F_.byteLength;if(this.Uc&&this.logger.debug("RECEIVED "+h+"/"+s+" TRID "+i),h==s){this.Uc&&this.logger.debug("RCV ALL DATA "+h+" TR-"+this.t8.C_),this.t8.L_.E_=h,u.Framework.clearTimeout(this.t8.hq),this.J1["delete"](i);var o=u.Framework.time()-this.s8.get(i);this.logger.debug("RCV ALL DATA FROM "+this.otherGuid+" AFTER "+o+" mseconds"),this.s8["delete"](i),this.Q6.SM(i,this.t8),this.t8=null}}catch(t){c.ErrorMonitor.getInstance().logError("Error receiving chunk",this.loggerId,l.Ur.xr,{detailedError:t,otherGuid:this.otherGuid})}},v.prototype.e8=function(t,i){try{this.Uc&&this.logger.debug("SEND ACK "+t+" TO "+this.otherGuid);var n=new e.Al.ml.Ack();n.transferId=t,i.AQ.rl(e.Fc.Ack,n)}catch(t){c.ErrorMonitor.getInstance().logError("Error sending ack",this.loggerId,l.Ur.Br,{detailedError:t,otherGuid:this.otherGuid})}},v.prototype.close=function(t){var i=this,n=r.defer();return null!=this.t8&&this.h8(this.t8.OP),this.J1.keys().slice().forEach(function(t){i.h8(t)}),n.resolve(h.Bq.FV),n.promise},v.prototype.h8=function(t){try{if(this.J1.has(t)){var i=this.J1.get(t);i.L_.E_=i.W_,this.logger.debug("SEND CANCEL FOR "+t+" TO "+this.otherGuid),this.s8["delete"](t);var n=new e.Al.ml.Cancel();n.transferId=t,i.partner.AQ.rl(e.Fc.Cancel,n),null!==this.t8&&this.t8.N_()===i.N_()&&(this.t8=null),this.J1["delete"](t)}else c.ErrorMonitor.getInstance().logError("Error cleaning up a not pending transfer",this.loggerId,l.Ur.Vr)}catch(t){c.ErrorMonitor.getInstance().logError("Error sending stop transfer",this.loggerId,l.Ur.qr,{detailedError:t,otherGuid:this.otherGuid})}},v);function v(t,i,n){this.loggerId="[FragmentRequester] ",this.J1=new s(),this.s8=new s(),this.t8=null,this.Uc=e.Uc,this.$c=t,this.otherGuid=i,this.Q6=n.oM,this.tv=n.tv,this.Jc=u.Framework.resolve(u.Framework.v.Zc),this.logger=u.Framework.resolve(u.Framework.v.p).log(n.sessionId)}i.z6=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var o=n(3),u=n(0),a=n(5),f=n(2),c=n(1),r=(s.prototype.HQ=function(t){this.reportingGuid=t,this.AQ&&(this.AQ.receiver.setReportingGuid(this.reportingGuid),this.AQ.sender.setReportingGuid(this.reportingGuid))},s.prototype.o8=function(t,i,n){var r=Math.max(1,i);for(n&&(this.u8+=r,this.a8+=t);this.f8.length>a.xu.ku.Lo;)this.f8.pop();var s=t/r;this.f8.unshift(s)},s.prototype.c8=function(t){this.J1.has(t)?this.logger.warn(this.guid+" DUPLICATE {} PENDING REQUESTS "+t):this.J1.set(t,u.Framework.time())},s.prototype.l8=function(t,i,n,r,s,e){try{if(this.J1.has(t)){var h=this.J1.get(t),o=u.Framework.time()-h;this.J1["delete"](t),r&&s&&this.o8(i,o,!0),this.tU.success(i),this.aH.v8(this.reportingGuid,i,n,s,e)}else c.ErrorMonitor.getInstance().logError("Error completing a non-existing request",this.loggerId,f.Ts.ms,{otherGuid:this.guid,Z6:this.reportingGuid})}catch(t){c.ErrorMonitor.getInstance().logError("Error handling request completed",this.loggerId,f.Ts.Os,{detailedError:t,otherGuid:this.guid,Z6:this.reportingGuid})}},s.prototype.d8=function(t,i,n,r,s,e){try{if(this.J1.has(t)){var h=this.J1.get(t);this.J1["delete"](t),a.xu.ku.Ho?this.o8(i,h,!0):this.o8(0,h,!0),this.tU.E8(i,r),this.aH.w8(this.reportingGuid,i,n,r,s,e)}else c.ErrorMonitor.getInstance().logError("Error partially failed a non-existing request",this.loggerId,f.Ts.Rs,{otherGuid:this.guid,Z6:this.reportingGuid})}catch(t){c.ErrorMonitor.getInstance().logError("Error handling request partially failed ",this.loggerId,f.Ts._s,{detailedError:t,otherGuid:this.guid})}},s.prototype.TP=function(t,i,n){try{if(this.J1.has(t)){var r=this.J1.get(t);this.J1["delete"](t),this.o8(0,r,!0),this.tU.failed(),this.aH.p8(this.reportingGuid,n,i)}else c.ErrorMonitor.getInstance().logError("Error failed a non-existing request",this.loggerId,f.Ts.As,{otherGuid:this.guid,Z6:this.reportingGuid})}catch(t){c.ErrorMonitor.getInstance().logError("Error handling request failed ",this.loggerId,f.Ts.Ss,{detailedError:t,otherGuid:this.guid})}},s.prototype.g8=function(t,i){this.aH.b8(t,i,!0)},s.prototype.y8=function(t,i){this.aH.T8(t,i,!0)},s.prototype.O8=function(t,i,n){this.aH.m8(t,i,n,!0)},s.prototype.dP=function(){var t=this.f8.reduce(function(t,i){return t+i},0);return 0<this.f8.length?t/this.f8.length:0},s.prototype._8=function(t){this.R8=t},s.prototype.S8=function(){return this.R8},s.prototype._Q=function(){return this.hP._Q()},s.prototype.A8=function(){return this.handshakeDelay},s.prototype.I8=function(t){var i=Math.max(0,this.vY-t);0<i&&i<a.xu._u.Wh&&(this.handshakeDelay=i)},s);function s(t,i,n,r,s,e,h){this.loggerId="[Partner] ",this.a8=0,this.u8=0,this.R8=0,this.f8=new Array(),this.N8=new Array(),this.J1=new o(),this.handshakeDelay=-1,this.logger=r,this.AQ=n,this.guid=t,this.hP=e,this.C8=s,this.aH=i,this.tU=u.Framework.resolve(u.Framework.v.hk),this.nU=u.Framework.resolve(u.Framework.v.hk),this.vY=u.Framework.time(),h&&this.I8(h)}i.Partner=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(36),r=n(3),h=n(0),u=n(9),v=n(17),o=n(5),d=n(1),s=n(207),E=n(2),a=(f.prototype.init=function(t){this.logger=h.Framework.resolve(h.Framework.v.p).log(t.sessionId),this.tv=t.tv,this.gw=t.gw,this.uploadScore=t.uploadScore,this.eM=t.eM,this.TQ=t.KH},f.prototype.uQ=function(t){return this.CQ(t.peerInfo.guid)},f.prototype.CQ=function(t){return this.qU.has(t)||this.VU.has(t)},f.prototype.rY=function(t){return this.VU.has(t)?this.VU.get(t):this.qU.get(t)},f.prototype.sQ=function(t){return this.qQ(t.peerInfo.guid)},f.prototype.qQ=function(t){return this.QU.has(t)||this.fQ.has(t)},f.prototype.QQ=function(t){return this.QU.has(t)?this.QU.get(t):this.fQ.get(t)},f.prototype.FQ=function(u){var a=this;try{var t=this.tv.k8();if(this.D8&&!t)if(this.CQ(u)){var f=this.rY(u),c=this.uploadScore.j8(!1),l=[];this.gw.B1().then(function(t){a.logger.debug(a.eH+"SEND ALL HAVES TO "+u+","+t.length);for(var i=0;i<t.length;i++){var n=0;n=a.context.UH()?t[i].size():t[i].totalSize;var r=t[i].A_,s=new v.Al.ml.Have();s.setFragmentId(r.I_()),s.setSize(n),s.setUploadScore(c);var e=r;s.setId(e.uA());var h=new v.Al.ml.QualityLevel();h.id=e.getQualityLevel().id,h.bitrate=e.getQualityLevel().bitrate,s.setQualityLevel(h),s.setDuration(e.getDuration()),s.setType(e.S_()),l.push(s)}if(0<l.length){var o=new v.Al.ml.Haves();o.setHave(l),f.AQ.rl(v.Fc.Haves,o)}})}else d.ErrorMonitor.getInstance().logError("Error sending all haves to peer who is not out partner",this.eH,E.ci.gi,{otherGuid:u})}catch(t){d.ErrorMonitor.getInstance().logError("Error sending all haves",this.eH,E.ci.li,{detailedError:t,otherGuid:u})}},f.prototype.z0=function(i,n,r){var s=this,t=this.tv.k8();if(this.D8&&!t){var e=this.VU.values();this.qU.forEach(function(t,i){e.push(t)});var h=this.uploadScore.j8(!1);e.forEach(function(t){(!r||r&&t.guid!=r.guid)&&s.M8(t.AQ,i,n,h)})}},f.prototype.M8=function(i,t,n,r){this.P8&&this.logger.debug(this.eH+"SEND HAVE TO "+i.otherGuid+" FOR "+t.I_());try{var s=new v.Al.ml.Have();s.setFragmentId(t.I_()),s.setSize(n),s.setUploadScore(r);var e=t;s.setId(e.uA());var h=new v.Al.ml.QualityLevel();h.id=e.getQualityLevel().id,h.bitrate=e.getQualityLevel().bitrate,s.setQualityLevel(h),s.setDuration(e.getDuration()),s.setType(e.S_()),i.rl(v.Fc.Have,s)}catch(t){d.ErrorMonitor.getInstance().logError("Error sending have ",this.eH,E.ci.vi,{detailedError:t,otherGuid:i.otherGuid})}},f.prototype.V6=function(i,t){try{if(this.qQ(i)){this.L8&&this.logger.debug(this.eH+"HAVE RECEIVED FROM "+i+": "+t.fragmentId);var n=this.QQ(i);n._8(t.getUploadScore()),this.eM.put(t,n),this.context.kH(t)}else d.ErrorMonitor.getInstance().logError("Error receiving have from unknown peer",this.eH,E.ci.di,{otherGuid:i})}catch(t){d.ErrorMonitor.getInstance().logError("Error handling received have",this.eH,E.ci.wi,{detailedError:t,otherGuid:i})}},f.prototype.Y6=function(i,t){var n=this;try{if(this.qQ(i)){this.L8&&this.logger.debug(this.eH+"BATCH HAVES RECEIVED FROM "+i);var r=this.QQ(i);t.getHave().forEach(function(t){r._8(t.getUploadScore()),n.eM.put(t,r)}),this.context.kH(t.getHave()[0])}else d.ErrorMonitor.getInstance().logError("Error receiving haves from unknown peer",this.eH,E.ci.Ei,{otherGuid:i})}catch(t){d.ErrorMonitor.getInstance().logError("Error handling received haves",this.eH,E.ci.pi,{detailedError:t,otherGuid:i})}},f.prototype.mQ=function(i){try{var t=new v.Al.ml.Ping();t.id=this.tv.getId(),t.startTs=h.Framework.time(),this.logger.debug(this.eH+"REQUEST PING TO PEER GUID "+i.otherGuid),i.rl(v.Fc.Ping,t)}catch(t){d.ErrorMonitor.getInstance().logError("Error requesting ping",this.eH,E.ci.yi,{detailedError:t,otherGuid:i.otherGuid})}},f.prototype.K6=function(i){try{var t=i.id;if(!this.CQ(t))return void d.ErrorMonitor.getInstance().logError("Error receiving ping from an unknown peer",this.eH,E.ci.Oi,{otherGuid:t});var n=-1;i.startTs&&(n=i.startTs),this.H8(this.rY(t).AQ,n)}catch(t){d.ErrorMonitor.getInstance().logError("Error handling received ping",this.eH,E.ci.Ti,{detailedError:t,otherGuid:i.id})}},f.prototype.U8=function(){try{for(var t="",i=0;i<o.xu.ju.qo;i++)t+=String.fromCharCode(33+93*Math.random());var n=new ArrayBuffer(t.length),r=new Uint8Array(n),s=t.length;for(i=0;i<s;i++)r[i]=t.charCodeAt(i);this.F8=e.wrap(r)}catch(t){d.ErrorMonitor.getInstance().logError("Error creating random buffer for ping pong",this.logger,E.ci.bi,t)}},f.prototype.H8=function(i,t){try{var n=new v.Al.ml.Pong();n.id=this.tv.getId(),n.startTs=t,this.F8||this.U8(),n.data=this.F8,n.dataSize=o.xu.ju.qo,this.logger.debug(this.eH+"SEND PONG TO PEER GUID "+i.otherGuid),i.rl(v.Fc.Pong,n)}catch(t){d.ErrorMonitor.getInstance().logError("Error sending pong",this.eH,E.ci.mi,{detailedError:t,otherGuid:i.otherGuid})}},f.prototype.W6=function(i){try{var t=i.id;if(!this.qQ(t))return void d.ErrorMonitor.getInstance().logError("Error receiving a pong from an unknown peer",this.eH,E.ci._i,{otherGuid:t});var n=h.Framework.time();if(i.startTs&&0<i.startTs){var r=n-i.startTs,s=this.QQ(t);i.dataSize==i.data.toArrayBuffer().byteLength?s.o8(i.dataSize,r,!0):d.ErrorMonitor.getInstance().logError("Error receing pong with wrong data size",this.eH,E.ci.Ri,{otherGuid:t})}else d.ErrorMonitor.getInstance().logError("Error receiving pong with wrong timestamp",this.eH,E.ci.Si,{otherGuid:t})}catch(t){d.ErrorMonitor.getInstance().logError("Error receiving pong",this.eH,E.ci.Ai,{detailedError:t,otherGuid:i.id})}},f.prototype.KU=function(){try{var t=new r();return this.G8(this.QU,t),this.G8(this.fQ,t),t}catch(t){return d.ErrorMonitor.getInstance().logError("Error getting partner snapshots",this.eH,E.ci.Ii,t),new r()}},f.prototype.G8=function(t,h){var o=this;t.forEach(function(t,i){var n=new hive.snapshots.Partner();n.inPart=!0,n.outPart=o.CQ(i),n.connInfo=new hive.snapshots.ConnectivityInfo();var r=void 0;t.hP.peerInfo.publicIpString&&(r=t.hP.peerInfo.publicIpString);var s=void 0;t.hP.peerInfo.privateIpString&&(s=t.hP.peerInfo.privateIpString),n.connInfo.publicIp=r,n.connInfo.privateIp=s,n.connInfo.externalAs=t.hP.peerInfo.externalAs,n.connInfo.internalAs=t.hP.peerInfo.internalAs;var e=o.x8();e.rateReceived=t.dP(),n.metrics=e,-1!=t.A8()&&(n.metrics.handshakeDelay=t.A8()),n.udp=t.hP.peerInfo.type==u.pf.bf,h.set(t.reportingGuid,n)})},f.prototype.BU=function(){return new s.B8(this.QU.length,this.fQ.length,this.qU.length,this.VU.length)},f.prototype.x8=function(){var t=new hive.snapshots.PartnerMetrics();return t.rateReceived=0,t.rateSent=0,t.handshakeDelay=0,t},f);function f(){this.eH="[PARTNERSHIP] ",this.fQ=new r(),this.QU=new r(),this.VU=new r(),this.qU=new r(),this.P8=!1,this.L8=!1,this.D8=!0,this.active=!1,this.U8(),this.dQ=[]}i.Qq=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(t,i,n,r){this.QU=t,this.YU=i,this.qU=n,this.VU=r}i.B8=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(4),s=n(34),e=n(36),h=n(17),o=n(0),u=n(209),a=n(5),f=n(1),c=n(2),l=(v.prototype.setReportingGuid=function(t){this.Z6=t},v.prototype.V8=function(t,i,n,r,s){var e=this;this.Uc&&this.logger.info("SEND FRAGMENT "+t+" TO "+this.otherGuid);try{var h=new u.q8();h.transferId=i,h.fragmentId=t,h.Q8=s,h.headers=r,h.Y8=n,h.K8=Math.ceil(h.Y8/a.xu.ju.qo),h.W8=0,this.X8.push(h),this.Uc&&this.X8.forEach(function(t){e.logger.debug(e.otherGuid+" PENDING OUT "+t)})}catch(t){f.ErrorMonitor.getInstance().logError("Error constructing chunk response",this.loggerId,c.Yr.Kr,{detailedError:t,otherGuid:this.otherGuid})}null===this.response?this.z8():this.Uc&&this.logger.debug(this.otherGuid+" OUT MSG NOT NULL")},v.prototype.x6=function(t){this.Uc&&this.logger.debug("ONGOING "+t+" GOT ACK"),null!==this.response&&this.response.transferId.toString()===t.toString()?this.J8(!1):f.ErrorMonitor.getInstance().logError("Error receiving ack for unknown transfer",this.loggerId,c.Yr.Xr)},v.prototype.dl=function(){null!=this.response&&this.J8(!1)},v.prototype.B6=function(i){null!=this.response&&this.response.transferId===i?(this.logger.debug("GOT CANCEL FOR ONGOING TR-"+i),this.logger.debug("TRANSPORT CANCEL STATS "+this.$c+","+this.otherGuid+","+i),this.Z8["delete"](i),0!=this.response.W8?this.e0.t9(this.otherGuid,this.Z6,this.response.W8,this.response.Y8):this.e0.i9(this.otherGuid,this.Z6,this.response.Y8),this.response=null,this.z8()):this.X8=this.X8.filter(function(t){return t.transferId!==i})},v.prototype.z8=function(){try{if(null===this.response&&0!==this.X8.length){var t=this.X8.shift();this.response=t,this.Uc&&this.logger.debug("DATA TO SEND LENGTH "+this.response.Y8+" IN "+this.response.K8+" CHUNKS WITH TR-"+this.response.transferId),this.J8(!0)}}catch(t){f.ErrorMonitor.getInstance().logError("Error start sending chunks",this.loggerId,c.Yr.Wr,t),this.nl()}},v.prototype.J8=function(t){t&&(this.Z8.set(this.response.transferId,o.Framework.time()),this.n9=this.response.K8);try{if(null!=this.response)if(0===this.response.K8)this.logger.debug("FINISHED SENDING TRANSFER "+this.response.transferId+" WITH "+this.response.W8+" BYTES"),this.Z8["delete"](this.response.transferId),this.e0.r9(this.otherGuid,this.Z6,this.response.Y8),this.response=null,this.s9(),this.z8();else{this.Uc&&this.logger.debug("A CHUNK");var i=Math.min(this.response.W8+a.xu.ju.qo,this.response.Y8),n=i-this.response.W8,r=new h.Al.ml.Chunk();if(r.transferId=this.response.transferId,r.totalSize=this.response.Y8,r.chunkSize=n,t&&null!=this.response.headers&&(r.headers=this.response.headers),o.Framework.T()||null==this.response.Q8)r.data=e.wrap(new ArrayBuffer(0));else if(r.data=this.aM.e9(this.response.fragmentId,this.n9-this.response.K8),null==r.data){var s=this.response.Q8.slice(this.response.W8,i);r.data=e.wrap(s)}this.response.W8=this.response.W8+n,this.AQ.rl(h.Fc.Chunk,r),this.Uc&&this.logger.debug("SND ["+this.response.W8+"-"+(this.response.W8+n)+"/"+this.response.Y8+"] TO "+this.otherGuid+" OF TR-"+this.response.transferId),this.response.K8--}else this.logger.debug("NO MESSAGE TO SEND")}catch(t){f.ErrorMonitor.getInstance().logError("Error sending chunk",this.loggerId,c.Yr.$r,{detailedError:t,otherGuid:this.otherGuid}),this.nl()}},v.prototype.tl=function(){return!(0===this.X8.length&&null===this.response)},v.prototype.F6=function(){var t=r.defer();return this.X8.length=0,this.tl()?this.close=t:t.resolve("CLOSE"),t.promise},v.prototype.s9=function(){this.close&&this.close.resolve("CLOSED")},v.prototype.nl=function(){this.response=null},v);function v(t,i,n,r){this.loggerId="[FragmentSender] ",this.Uc=h.Uc,this.response=null,this.X8=new Array(),this.Z8=new s(),this.n9=0,this.close=null,this.$c=t,this.otherGuid=i,this.e0=n.e0,this.AQ=r,this.aM=n.aM,this.logger=o.Framework.resolve(o.Framework.v.p).log(n.sessionId),this.Jc=o.Framework.resolve(o.Framework.v.Zc)}i.J6=l},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){this.headers=null}i.q8=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});function r(){}i.yl=r},function(t){t.exports=JSON.parse('{"package":"HiveMsgs","messages":[{"name":"Chunk","fields":[{"rule":"required","type":"int32","name":"transferId","id":1},{"rule":"required","type":"int32","name":"totalSize","id":2},{"rule":"required","type":"int32","name":"chunkSize","id":3},{"rule":"required","type":"bytes","name":"data","id":4},{"rule":"optional","type":"string","name":"headers","id":5}]},{"name":"Haves","fields":[{"rule":"repeated","type":"Have","name":"have","id":1}]},{"name":"Have","fields":[{"rule":"required","type":"string","name":"fragmentId","id":1},{"rule":"required","type":"int32","name":"size","id":2},{"rule":"required","type":"int32","name":"type","id":3},{"rule":"required","type":"int32","name":"id","id":4},{"rule":"required","type":"QualityLevel","name":"qualityLevel","id":5},{"rule":"required","type":"int32","name":"duration","id":6},{"rule":"required","type":"float","name":"uploadScore","id":7}]},{"name":"Ping","fields":[{"rule":"required","type":"string","name":"id","id":1},{"rule":"required","type":"uint64","name":"startTs","id":2}]},{"name":"Pong","fields":[{"rule":"required","type":"string","name":"id","id":1},{"rule":"required","type":"bytes","name":"data","id":2},{"rule":"required","type":"int32","name":"dataSize","id":3},{"rule":"required","type":"uint64","name":"startTs","id":4}]},{"name":"Request","fields":[{"rule":"required","type":"string","name":"fragmentId","id":1},{"rule":"required","type":"int32","name":"transferId","id":2}]},{"name":"DoNotHave","fields":[{"rule":"required","type":"int32","name":"transferId","id":1}]},{"name":"NoPartners","fields":[{"rule":"required","type":"int32","name":"transferId","id":1}]},{"name":"Cancel","fields":[{"rule":"required","type":"int32","name":"transferId","id":1}]},{"name":"Ack","fields":[{"rule":"optional","type":"int32","name":"transferId","id":1}]},{"name":"Close","fields":[{"rule":"required","type":"int32","name":"type","id":1}]},{"name":"StreamCharacteristics","fields":[{"rule":"required","type":"int32","name":"streamState","id":1},{"rule":"required","type":"QualityLevel","name":"qualityLevel","id":2},{"rule":"required","type":"int32","name":"delta","id":3}]},{"name":"OutPartnershipRequest","fields":[{"rule":"required","type":"string","name":"guid","id":1},{"rule":"required","type":"string","name":"contextId","id":2},{"rule":"required","type":"string","name":"p2pProtocolVersion","id":3},{"rule":"optional","type":"int32","name":"internalAs","id":4},{"rule":"optional","type":"int32","name":"externalAs","id":5},{"rule":"optional","type":"string","name":"publicIpString","id":6},{"rule":"optional","type":"string","name":"privateIpString","id":7},{"rule":"required","type":"string","name":"reportingGuid","id":8},{"rule":"repeated","type":"StreamCharacteristics","name":"streamCharacteristics","id":9}]},{"name":"OutPartnershipResponse","fields":[{"rule":"required","type":"int32","name":"accept","id":1},{"rule":"optional","type":"int32","name":"internalAs","id":2},{"rule":"optional","type":"int32","name":"externalAs","id":3},{"rule":"optional","type":"string","name":"publicIpString","id":4},{"rule":"optional","type":"string","name":"privateIpString","id":5},{"rule":"optional","type":"string","name":"reportingGuid","id":6},{"rule":"repeated","type":"StreamCharacteristics","name":"streamCharacteristics","id":7}]},{"name":"PeerInfoMessage","fields":[{"rule":"required","type":"string","name":"guid","id":1},{"rule":"optional","type":"string","name":"publicIpString","id":2},{"rule":"optional","type":"string","name":"privateIpString","id":3},{"rule":"optional","type":"int32","name":"internalAs","id":4},{"rule":"optional","type":"int32","name":"externalAs","id":5},{"rule":"repeated","type":"StreamCharacteristics","name":"streamCharacteristics","id":6}]},{"name":"UDPHandshakeMessage","fields":[{"rule":"required","type":"string","name":"uuid","id":1},{"rule":"required","type":"string","name":"streamId","id":2},{"rule":"required","type":"float","name":"udpScore","id":3},{"rule":"required","type":"bool","name":"isLeader","id":4}]},{"name":"UDPHandshakeResponse","fields":[{"rule":"required","type":"string","name":"accept","id":1}]},{"name":"UDPSwitchLeadershipRequest","fields":[{"rule":"required","type":"string","name":"uuid","id":1},{"rule":"required","type":"float","name":"udpScore","id":2}]},{"name":"UDPSwitchLeadershipAck","fields":[{"rule":"required","type":"bool","name":"ok","id":1}]},{"name":"QualityLevelMessage","fields":[{"rule":"required","type":"string","name":"guid","id":1},{"rule":"required","type":"QualityLevel","name":"qualityLevel","id":2}]},{"name":"QualityLevel","fields":[{"rule":"required","type":"string","name":"id","id":1},{"rule":"required","type":"int32","name":"bitrate","id":2}]}]}')},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(5),s=(e.Ob=function(t,i){var n=0;return 0!=(n=t.udpScore>i.udpScore?1:t.udpScore<i.udpScore?-1:0)?-n:r.xu.UDPBroadcast.Zo?i.uuid.localeCompare(t.uuid):t.uuid.localeCompare(i.uuid)},e);function e(t,i,n,r,s){this.udpScore=0,this.YV=!1,this.streamId="",this.uuid=t,this.udpScore=i,n&&(this.address=n),r&&(this.YV=r),s&&(this.streamId=s)}i.qV=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(6),h=n(0),e=n(7),o=n(9),u=n(1),a=n(2),f=(c.prototype.init=function(t){this.logger=h.Framework.resolve(h.Framework.v.p).log(t.sessionId),this.eM=t.eM,this.partnership=t.partnership,this.hM=t.hM,this.tv=t.tv,this.aH=t.KH,this.o9.h9(t.tv)},c.prototype.request=function(t){this.logger.debug("FRL ISSUE REQ FOR FRAGMENT "+t.A_.toString()+"-"+t.L_.E_+" ["+e.xa[t.S_()]+"] TO P2P"),this.J1.set(t.N_(),t);var i=this.Sl.next();t.OP=i,this.u9.set(i,t.N_()),this.u2(t)},c.prototype.u2=function(t){var i=t.I_(),n=t.N_(),r=this.a9(i);t.size=this.eM.nP(i).size;var s=this.o9.f9(r,t.type);null!=s?(this.logger.info("SELECT "+s.AQ.otherGuid+" (LAN LEADER "+s.hP.peerInfo.isLeader+" iAS "+s.hP.peerInfo.internalAs+" eAS "+s.hP.peerInfo.externalAs+" privateIp "+s.hP.peerInfo.privateIpString+" ) out of "+r.length+" type "+o.pf[s.hP.peerInfo.type]+" size:"+t.size+" FOR TRANSFER"+t.OP+" REQUEST ID "+n),t.partner=s,t.J0=s.hP.peerInfo,t.partner.c8(t.OP),t.L_.v_=!0,t.L_.T_=h.Framework.time(),this.yP(t)?(this.aH.c9(t),s.AQ.receiver.n8(t)):this.l9(t)):(u.ErrorMonitor.getInstance().logError("Error sending p2p request because we cannot find a partner",this.loggerId,a.zr.Jr),this.TP(t.OP,"NO PARTNERS FOUND FOR REQUEST"))},c.prototype.a9=function(t){var i=this,n=[];try{this.eM.rP(t).forEach(function(t){i.partnership.qQ(t.guid)?n.push(t):i.logger.warn("I HAVE A HAVE FROM A NON IN-PARTNER "+t.guid)})}catch(t){u.ErrorMonitor.getInstance().logError("Error filtering in partners",this.loggerId,a.zr.Zr,t)}return n},c.prototype.l9=function(t){var i=t.OP;if(this.logger.info("REQUEST "+t.OP+" TO "+t.partner.guid+" ABORTED BECAUSE OF SLOW P2P CONNECTION"),this.u9.has(i)){var n=this.u9.get(i);this.u9["delete"](i);var r=this.J1.get(n);this.J1["delete"](n),this.hM.Q0(r)}},c.prototype.yP=function(t){var i=this,n=!1;try{var r=0;null==t.size?(r=this.eM.nP(t.I_()).size,t.size=r,this.logger.warn("request size not set - this should not happen")):r=t.size;var s=r-t.W_,e=t.z_.GH().hV(t,s);return 0<(t.r8=e)&&(n=!0,null==t.hq&&(t.hq=h.Framework.setTimeout(function(){i.v9(t)},e))),n}catch(t){return u.ErrorMonitor.getInstance().logError("Error setting request timeout",this.loggerId,a.zr.ns,t),!1}},c.prototype.v9=function(t){this.aH.d9(t),this.TP(t.OP,"TIMED-OUT")},c.prototype.TP=function(t,i){this.logger.info(i+" "+t);var n=this.E9(t,!0);this.logger.warn("REQUEST "+t+" FOR "+n.N_()+" FAILED BECAUSE "+i),n&&this.hM.M0(n)},c.prototype.E9=function(t,i){try{if(this.u9.has(t)){var n=this.u9.get(t);this.u9["delete"](t);var r=this.J1.get(n);if(this.J1["delete"](n),h.Framework.clearTimeout(r.hq),i&&this.partnership.qQ(r.partner.AQ.otherGuid)){r.partner.AQ.receiver.h8(t);var s=r.S_()==e.xa.Va;0!=r.W_?r.partner.d8(r.OP,r.W_,r.L_.p2pAgenTrafficSuccessQt,r.size,s,r.type):r.partner.TP(r.OP,s,r.size)}return r}return u.ErrorMonitor.getInstance().logError("Error cancelling request on non existing session",this.loggerId,a.zr.ss),null}catch(t){return u.ErrorMonitor.getInstance().logError("Error removing request",this.loggerId,a.zr.rs,t),null}},c.prototype.j0=function(t){if(this.J1.has(t)){var i=this.J1.get(t).OP;this.E9(i,!0)}},c.prototype.I2=function(t,i,n,r){this.logger.debug("FRL DOWNLOADING "+i.N_()+" FROM "+t+" P2P")},c.prototype.SM=function(t,i){if(this.logger.debug("FRL PROMISED FRAGMENT "+i.N_()+" RETURNED FROM P2P SIZE "+i.L_.E_),i=this.E9(t,!1)){i.L_.m_=h.Framework.time();var n=i.S_()==e.xa.Va;i.partner.l8(i.OP,i.size,i.L_.p2pAgenTrafficSuccessQt,!0,n,i.type),this.hM.L0(i)}else this.logger.warn("TRIED TO REMOVE A NON EXISTING REQUEST "+t+" (THIS SHOULD NOT HAPPEN. AT LEAST NOT TOO OFTEN)")},c.prototype.q6=function(t){var i=t.getTransferId();if(this.u9.has(i)){u.ErrorMonitor.getInstance().logError("Error receiving a do not have for my request",this.loggerId,a.zr.es),this.logger.debug("DO NOT HAVE RECEIVED FOR "+i);var n=this.E9(i,!1);if(n){var r=n.S_()==e.xa.Va;n.partner.TP(n.OP,r,n.size),this.hM.M0(n)}}else this.logger.warn("UNKNOWN DO NOT HAVE "+i)},c.prototype.X6=function(t,i){var n=i.transferId;if(this.u9.has(n)){u.ErrorMonitor.getInstance().logError("Error rejected request by a non partner",this.loggerId,a.zr.hs),this.partnership.RQ(t);var r=this.E9(n,!1);r&&this.hM.M0(r)}},c.prototype.Ze=function(t){return this.J1.has(t)},c);function c(){this.loggerId="[P2PRequester] ",this.Sl=new s.Counter(),this.J1=new r(),this.u9=new r(),this.o9=h.Framework.resolve(h.Framework.v.ik)}i._Z=f},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(17),e=n(1),h=n(2),o=(u.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.v.p).log(t.sessionId),this.GV=t,this.eM=t.eM,this.gw=t.gw,this.partnership=t.partnership,this.uploadScore=t.uploadScore,this.tv=t.tv,this.aH=t.KH},u.prototype.hH=function(t,i,n){try{if(this.partnership.CQ(t)){var r=this.partnership.rY(t);this.w9(t,i,r)}else this.p9(t,i,n)}catch(t){e.ErrorMonitor.getInstance().logError("Error on responding to p2p request",this.loggerId,h.us.fs,t)}},u.prototype.r9=function(t,i,n){try{if(this.uploadScore.success(n),this.partnership.CQ(t)){var r=this.partnership.rY(t);r.nU.success(n),r.g8(n,i)}}catch(t){e.ErrorMonitor.getInstance().logError("Error on request satisfied",this.loggerId,h.us.cs,t)}},u.prototype.t9=function(t,i,n,r){try{if(this.uploadScore.E8(n,r),this.partnership.CQ(t)){var s=this.partnership.rY(t);s.nU.E8(n,r),s.O8(n,r,i)}}catch(t){e.ErrorMonitor.getInstance().logError("Error on request partially satisfied",this.loggerId,h.us.ls,t)}},u.prototype.i9=function(t,i,n){try{if(this.uploadScore.failed(),this.partnership.CQ(t)){var r=this.partnership.rY(t);r.nU.failed(),r.y8(n,i)}}catch(t){e.ErrorMonitor.getInstance().logError("Error on request not satisfied",this.loggerId,h.us.vs,t)}},u.prototype.w9=function(i,n,r){var s=this;this.gw.get(n.fragmentId).then(function(t){t?(s.logger.debug("SENDING TO "+i+","+n.fragmentId+","+n.transferId+","+t.length+" DL "+t.length),r.AQ.sender.V8(n.fragmentId,n.transferId,t.length,t.headers,t.data)):(s.logger.debug("RECEIVED REQUEST FOR "+n.fragmentId+" FROM "+i+" CAN'T BE SERVED"),s.g9(n.transferId,r))})},u.prototype.g9=function(t,i){try{this.logger.info("SEND DO NOT HAVE "+t+" TO "+i.AQ.$c);var n=new s.Al.ml.DoNotHave();n.setTransferId(t),i.AQ.rl(s.Fc.DoNotHave,n)}catch(t){e.ErrorMonitor.getInstance().logError("Error on sending do not have",this.loggerId,h.us.ds,t)}},u.prototype.p9=function(t,i,n){try{this.logger.warn("GOT REQUEST FROM NON-PARTNER "+t+" FOR "+i.fragmentId);var r=new s.Al.ml.NoPartners();r.setTransferId(i.transferId),n.rl(s.Fc.Qc,r)}catch(t){e.ErrorMonitor.getInstance().logError("Error on send no partners",this.loggerId,h.us.Es,t)}},u);function u(){this.loggerId="[P2PResponder] "}i.RZ=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e,r,h=n(34),o=n(0),s=n(5);(r=e=i.b9||(i.b9={}))[r.S=0]="S",r[r.y9=1]="F",r[r.T9=2]="PF";var u=function(t){this.ts=t},a=function(){this.O9=0,this.m9=0,this._9=0,this.R9=0,this.S9=0,this.A9=0};i.I9=a;var f=(c.prototype.success=function(t){this.event(e.S,t,t)},c.prototype.failed=function(){this.event(e.y9,0,0)},c.prototype.E8=function(t,i){this.event(e.T9,t,i)},c.prototype.event=function(t,i,n){var r=new u(o.Framework.time());r.t=t,r.N9=i,r.C9=i/n,r.k9=(n-i)/n,this.D9.set(r.ts,r),this.j9()},c.prototype.j9=function(){var i=this,n=o.Framework.time()-2*s.xu.ku.Uo;if(0<n){var r=[];this.D9.forEach(function(t,i){i<n&&r.push(i)}),r.forEach(function(t){i.D9["delete"](t)})}},c.prototype.ZH=function(t){var i=0,n=this.M9(t,s.xu.ku.Uo);return null!=n&&(i=0==n.m9+n._9+n.R9?0:(n.m9-s.xu.ku.Fo*(n.R9+n._9))/(n.m9+s.xu.ku.Fo*(n.R9+n._9))),i},c.prototype.j8=function(t){var i=0,n=this.M9(t,s.xu.ku.Uo);if(null!=n){var r=n.m9+n._9+n.R9;i=0==r?0:(n._9+n.R9*s.xu.ku.xo)/r}return i},c.prototype.P9=function(t){var i=this.M9(!1,t);return null!=i?i.O9:0},c.prototype.M9=function(t,i){if(0==this.D9.keys().length)return null;var n=new a(),r=o.Framework.time()-i;r<0&&(r=0);var s=new h();return this.D9.forEach(function(t,i){r<=i&&s.set(i,t)}),s.forEach(function(t,i){switch(n.O9+=t.N9,t.t){case e.S:n.m9++;break;case e.y9:n._9++;break;default:n.R9++,n.S9+=t.C9,n.A9+=t.k9}}),n},c.xo=.2,c.Go=.2,c);function c(){this.D9=new h()}i.SZ=f},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(3),o=n(4),u=n(0),a=n(217),f=n(219),c=n(111),l=n(2),v=n(1),d=n(14),E=(e=f.L9,s(w,e),w.prototype.start=function(t,i){void 0===i&&(i=[]);var n=u.Framework.resolve(u.Framework.v.p).log(t),r=null;return 0==this.listeners.keys().length?(n.debug("TRIGGERING CONNECT "),r=this.H9(),this.U9(t,i)):(n.debug("ALREADY CONNECTED "),r=this.Ml.sv(),this.U9(t,i),this.F9.isConnected()&&this.G9(this.uS,t)),r},w.prototype.H9=function(){var n=this,r=d.Rc.hc;return"localhost"===r&&(r="127.0.0.1:"+location.port),this.logger.debug("CONNECTING.."),this.Ml.sv().then(function(t){var i=t.uv();return n.logger.debug("MY IDENTITY ",i),n.uS=i,n.F9.start(r,i),t})},w.prototype.cv=function(){return o.resolve(new h())},w.prototype.connect=function(i){var n=this,r=o.defer();return this.x9.has(i)?(this.logger.debug("Already connected to "+i+", ignoring"),r.resolve(this.x9.get(i))):this.channelManager.B9(this.uS,i).then(function(t){return n.connected(i,t)}).then(function(t){return r.resolve(t)}).fail(function(t){v.ErrorMonitor.getInstance().logError("Error establishing connection",n.loggerId,l.lt.wt,{otherGuid:i}),r.reject("CONN TO "+i+" CANNOT BE ESTABLISHED ")}),r.promise},w.prototype.send=function(t,i,n){var r=this.channelManager.send(t,i);return r||(v.ErrorMonitor.getInstance().logError("Error sending message without channel established",this.loggerId,l.lt.pt,{otherGuid:t}),this.V9(t)),r},w.prototype.q9=function(t,i,n){this.Q9&&this.logger.debug("REC BUF "+n.byteLength+" "+n),this.x9.has(t)?(this.Q9&&this.logger.debug("PROC MSG FROM "+t),this.x9.get(t).El(n)):v.ErrorMonitor.getInstance().logError("Error receiving msg without having a connection established",this.loggerId,l.lt.pt,{otherGuid:t})},w.prototype.connected=function(t,i){if(this.x9.has(t))this.logger.debug("RECONNECTED TO "+t+", RESETTING STATE"),this.x9.get(t).reset();else{this.logger.info("CONNECTED TO "+t);var n=i.$V;n.init(this.uS,t),this.x9.set(t,n)}return o.resolve(this.x9.get(t))},w.prototype.Y9=function(t,i){this.logger.debug("FAILED CONN TO "+i),t.reject("CONN TO "+i+" CANNOT BE ESTABLISHED ")},w.prototype.K9=function(t,i){this.logger.info(t+" connected to me"),this.connected(t,i)},w.prototype.V9=function(t){this.x9.has(t)?(this.logger.info("Connection closed to "+t),this.x9["delete"](t),this.W9(t)):this.logger.warn("TRYING TO REMOVE A PEER THAT IS NOT THERE: "+t)},w.prototype.X9=function(){var s=this;c.cY.oY&&u.Framework.setInterval(function(){var r=u.Framework.time();s.x9.forEach(function(t,i){var n=r-t.Ol();n>c.cY.aY&&(s.logger.debug("closing stale connection to "+i+" [unused for: "+n+"ms]"),s.disconnect(i))})},c.cY.uY)},w.prototype.stop=function(t){u.Framework.resolve(u.Framework.v.p).log(t).debug("STOPPING CONNECTIONS AND REMOVING LISTENERS"),this.bx(t)},w.prototype.z9=function(){},w.prototype.disconnect=function(t){this.x9.has(t)&&this.channelManager.disconnect(t)},w.fu="availableSendRate",w.cu="remoteAddress",w.lu="localAddress",w);function w(){var t=e.call(this)||this;return t.loggerId="[HiveNetworkManager] ",t.Q9=!1,t.x9=new h(),t.Sl=1,t.Ml=u.Framework.resolve(u.Framework.v.Pl),t.F9=u.Framework.resolve(u.Framework.v.uk),t.channelManager=new a.J9(t.logger,t.F9,t),t.F9.init(t,t.logger,t.channelManager),t.X9(),t}i.wZ=E},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(4),r=n(0),s=n(218),h=n(111),o=n(2),u=n(1),a=(f.prototype.B9=function(t,i){var n=null;if(i in this.Z9){var r=e.defer();r.reject("OTHER ALREADY TRYING TO CONNECT"),n=r.promise}else{this.t7.Q9&&this.logger.info("Initiating connection to "+i);var s=this.i7(t,i);n=this.n7(s,i).connect(i)}return n},f.prototype.r7=function(t){t.s7 in this.Z9&&(delete this.channels[t.label],delete this.Z9[t.s7]),t.open&&(this.t7.V9(t.s7),t.open=!1)},f.prototype.send=function(t,i){this.t7.Q9&&this.logger.debug("DATA "+i.byteLength+" "+i);var n=this.Z9[t];return n&&n.channel?(n.send(i),!0):(u.ErrorMonitor.getInstance().logError("Error sending message wihtout channel established",this.loggerId,o.Pt.Lt,{otherGuid:t}),!1)},f.prototype.trigger=function(t,i){var n=i.channel;if(n&&n.label&&this.channels[n.label]){var r=this.channels[n.label];(s=r[t]).call(r,i)}else{var s,e="handle_"+t;(s=this[e])?s.call(this,i):u.ErrorMonitor.getInstance().logError("Error received a message for a non existing function",this.loggerId,o.Pt.Ht,{e7:e})}},f.prototype.handle_offer=function(t){if(this.t7.Q9&&this.logger.info("received an offer from "+t.peer.guid+" on channel "+t.channel.label),this.Z9[t.peer.guid]&&t.peer<this.t7.uS)this.F9.h7(this.t7.uS,t.peer.guid,t.channel.label);else{var i=this.n7(t.channel.label,t.peer.guid),n=this.o7(i);i.offer(t,n)}},f.prototype.o7=function(t){var i=this;return r.Framework.setTimeout(function(){u.ErrorMonitor.getInstance().logError("Error incoming connection timedout",i.loggerId,o.Pt.Ut,{otherGuid:t.s7}),t.close()},h.cY.fY)},f.prototype.n7=function(t,i){var n=new s.u7(this,this.t7,t,this.a7,this.f7,i);return this.channels[t]=n,this.Z9[i]=n},f.prototype.handle_offer_rejected=function(t){this.t7.Q9&&this.logger.debug("remote peer rejected ",t);var i=this.Z9[t.c7];i&&i.close(),delete this.Z9[t.c7],delete this.channels[t.channel]},f.prototype.i7=function(t,i){return t.substring(0,Math.max(8,t.length))+":"+i.substring(0,Math.max(8,i.length))+":"+this.Sl++},f.prototype.disconnect=function(t){var i=this.Z9[t];i&&i.close()},f);function f(t,i,n){this.loggerId="[ChannelManager] ",this.f7={iceServers:[{urls:"stun:stun.hivestreaming.com:3478"}]},this.Sl=1,this.a7=null,this.channels={},this.Z9={},this.logger=t,this.F9=i,this.t7=n}i.J9=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var s=n(5),o=n(2),e=n(4),u=n(0),a=n(1),r=(h.prototype.l7=function(){var t=this;if(this.channel&&"open"!=this.channel.readyState){if(this.Q9&&this.logger.debug(this.loggerId+"Check connection "+this.s7),this.v7<=0)return this.logger.debug(this.loggerId+"Closing channel since it couldnt be established to "+this.s7),void this.close();this.v7-=1,this.d7=u.Framework.setTimeout(function(){return t.l7()},this.timeout)}},h.prototype.close=function(){try{this.Q9&&this.logger.debug(this.loggerId+"Closing connection to "+this.s7),this.E7(!0),this.channelManager.r7(this),this.cG&&"closed"!==this.cG.signalingState&&(this.cG.close(),this.cG=null,this.channel&&(this.channel.close(),this.channel=null))}catch(t){a.ErrorMonitor.getInstance().logError("Error closing the connection",this.loggerId,o.bt.jt,{detailedError:t,otherGuid:this.s7})}},h.prototype.w7=function(){return!!this.channel&&"connecting"===this.channel.readyState},h.prototype.connect=function(t){var i=this;this.Q9&&this.logger.debug(this.loggerId+"Connecting to "+t),this.s7=t,this.channel=this.cG.createDataChannel(this.label);var n=this.p7(!0,-1);return this.d7=u.Framework.setTimeout(function(){return i.l7()},this.timeout),n},h.prototype.g7=function(t){var i=this,n=e.defer();return this.cG.setRemoteDescription(t).then(function(){n.resolve("OK")})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error setting remote description",i.loggerId,o.bt.Ot,{detailedError:t,otherGuid:i.s7}),n.reject(t)}),n.promise},h.prototype.b7=function(t){var i=this,n=e.defer();return"closed"!==this.cG.signalingState?this.cG.setLocalDescription(t).then(function(){n.resolve(i.cG.localDescription)})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error setting local description",i.loggerId,o.bt._t,{detailedError:t,otherGuid:i.s7}),n.reject(t)}):(a.ErrorMonitor.getInstance().logError("Signaling state is closed",this.loggerId,o.bt.Ot),n.reject("Signaling state is closed")),n.promise},h.prototype.createOffer=function(){var i=this,n=e.defer();return this.cG.createOffer().then(function(t){n.resolve(new RTCSessionDescription(t))})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error creating offer",i.loggerId,o.bt.yt,{detailedError:t,otherGuid:i.s7}),i.close()}),n.promise},h.prototype.createAnswer=function(){var i=this,n=e.defer();return this.cG.createAnswer().then(function(t){n.resolve(new RTCSessionDescription(t))})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error creating answer",i.loggerId,o.bt.Tt,{detailedError:t,otherGuid:i.s7}),n.reject(t)}),n.promise},h.prototype.offer=function(t,i){var n=this;this.Q9&&(this.logger.debug(this.loggerId+"Received an offer from "+this.s7),this.logger.debug(this.loggerId+"Offer:",t)),this.cG.ondatachannel=function(t){n.channel=t.channel,n.p7(!1,i)};var r=new RTCSessionDescription(t.channel.offer);this.s7=t.peer.guid,this.g7(r).then(function(){return"closed"!==n.cG.signalingState?(n.update_ice_candidates(t),n.createAnswer()):e.reject("Connection closed while creating answer")}).then(function(t){return n.b7(t)}).then(function(t){n.logger.debug(n.loggerId+"Sending back an answer [candidates: "+n.y7.length+"]");var i=n.y7;n.y7=new Array(),n.channelManager.F9.answer(n,t,i,n.s7),n.T7=!0})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error responding to offer",n.loggerId,o.bt.kt,{detailedError:t,otherGuid:n.s7}),n.close()})},h.prototype.answer=function(t){var i=this;this.Q9&&this.logger.debug(this.loggerId+"Answer: ",t);var n=new RTCSessionDescription(t.answer);this.g7(n).then(function(){"closed"!==i.cG.signalingState&&i.update_ice_candidates(t)})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error setting remote descriptor for the answer received",i.logger,o.bt.Ct,{detailedError:t,otherGuid:i.s7}),i.close()})},h.prototype.update_ice_candidates=function(t){var n=this;t.channel.ice_candidates.forEach(function(t){n.Q9&&n.logger.debug(n.loggerId+"got ICE cand: ",t);var i=new RTCIceCandidate(t);n.cG.addIceCandidate(i).then(function(){})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error updating ice candidates",n.loggerId,o.bt.Nt,{detailedError:t,otherGuid:n.s7})})})},h.prototype.p7=function(i,n){var r=this,s=e.defer();return this.channel.onopen=function(t){return r.O7(s,i,n)},this.channel.onclose=function(t){r.close(),s.reject(r)},this.channel.onmessage=function(t){return r.$V.El(t.data)},this.channel.onerror=function(t){a.ErrorMonitor.getInstance().logError("Error setting up channel",r.loggerId,o.bt.St,{detailedError:t,otherGuid:r.s7}),r.close()},s.promise},h.prototype.O7=function(t,i,n){var r=this;this.open=!0,this.channel.bufferedAmountLowThreshold=Math.min(this.cG.sctp.maxMessageSize,s.xu.ju.qo),this.channel.addEventListener("bufferedamountlow",function(){r.$V.dl()}),t.resolve(this),i||(this.t7.K9(this.s7,this),n&&u.Framework.clearTimeout(n))},h.prototype.m7=function(){var t=this;this.T7&&-1==this._7&&(this._7=u.Framework.setTimeout(function(){t.R7(),t.E7(!1)},s.xu.Uu.Eu))},h.prototype.R7=function(){var i=this,t=this.y7;if(this.y7=new Array(),t&&0<t.length){var n=t.length;this.channelManager.F9.S7(this.t7.uS,this,t,this.s7).then(function(t){i.Q9&&i.logger.debug(i.loggerId+"sent "+n+" more candidates")})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error sending candidates",i.loggerId,o.bt.St,{detailedError:t,otherGuid:i.s7})})}},h.prototype.E7=function(t){t&&-1!=this._7&&u.Framework.clearTimeout(this._7),this._7=-1},h.prototype.send=function(t){var i=this;null!==this.A7&&(u.Framework.clearTimeout(this.A7),this.A7=null);try{this.channel.send(t),this.channel.bufferedAmount<=s.xu.ju.qo&&(this.A7=u.Framework.setTimeout(function(){return i.$V.dl()},0))}catch(t){a.ErrorMonitor.getInstance().logError("Error setting sending ",this.loggerId,o.bt.Mt,{detailedError:t,otherGuid:this.s7}),this.close()}},h);function h(t,i,n,r,s,e){var h=this;this.Q9=!1,this.loggerId="[Channel] ",this._7=-1,this.cG=null,this.channel=null,this.A7=null,this.d7=null,this.v7=5,this.timeout=5e3,this.open=!1,this.T7=!1,this.y7=new Array(),this.channelManager=t,this.t7=i,this.label=n,this.a7=r,this.f7=s,this.s7=e,this.logger=u.Framework.resolve(u.Framework.v.p).log(),this.$V=u.Framework.resolve(u.Framework.v.dk),this.$V.init(this.t7.uS,e),this.cG=new RTCPeerConnection(this.f7),this.cG.onicecandidate=function(t){t&&t.candidate&&(h.y7.push(t.candidate),h.m7())},this.cG.onnegotiationneeded=function(){h.createOffer().then(function(t){return h.b7(t)}).then(function(t){h.Q9&&h.logger.debug(h.loggerId+"Sending offer to "+h.s7+" [candidates: "+h.y7.length+"]");var i=h.y7;h.y7=new Array();var n=h.channelManager.F9.offer(h.t7.uS,h.s7,h,i,t);return h.T7=!0,n})["catch"](function(t){a.ErrorMonitor.getInstance().logError("Error negotiating with peer",h.loggerId,o.bt.Rt,{detailedError:t,otherGuid:h.s7}),h.close()})},this.cG.oniceconnectionstatechange=function(t){h.cG&&"disconnected"===h.cG.iceConnectionState&&h.close(),h.cG&&"failed"===h.cG.iceConnectionState&&(a.ErrorMonitor.getInstance().logError("Error establishing ICE connection",h.loggerId,o.bt.Rt,{otherGuid:h.s7}),h.close())},this.cG.onsignalingstatechange=function(t){"closed"===t.signalingState&&h.close()}}i.u7=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(0),e=n(2),h=n(1),o=(u.prototype.U9=function(t,i){void 0===i&&(i=[]),this.logger.info("SET LISTENERS FOR "+t+","+i.length),this.listeners.set(t,i)},u.prototype.bx=function(t){this.listeners["delete"](t)},u.prototype.I7=function(){0<this.listeners.length&&this.listeners.forEach(function(t,i){t.forEach(function(t){t.nQ&&t.nQ()})})},u.prototype.G9=function(n,t){var r=this;0<this.listeners.length&&(t?this.listeners.get(t).forEach(function(t){try{t.PS&&t.PS(n)}catch(t){h.ErrorMonitor.getInstance().logError("Error firing server connect when we have swarm",r.eH,e.lt.dt,t)}}):this.listeners.forEach(function(t,i){t.forEach(function(t){try{t.PS&&t.PS(n)}catch(t){h.ErrorMonitor.getInstance().logError("Error firing server connect when we do not have swarm",r.eH,e.lt.Et,t)}})}))},u.prototype.W9=function(n){0<this.listeners.length&&this.listeners.forEach(function(t,i){t.forEach(function(t){t.Mq&&t.Mq(n)})})},u);function u(){this.eH="[Base Network Manager] ",this.listeners=new r(),this.logger=s.Framework.resolve(s.Framework.v.p).log()}i.L9=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var h=n(4),o=n(0),u=n(16),r=(s.prototype.init=function(t,i,n){this.t7=t,this.logger=i,this.channelManager=n},s.prototype.isConnected=function(){return this.client.xS().isConnected()},s.prototype.start=function(t,i){var n=this;this.logger.debug("MY ID "+i),this.uS=i,this.client&&this.client.xS()?this.client.xS().on(HiveStreamingServices.bW,1,function(t){n.N7(t.msg)}):this.logger.error("error getting active services connection"),this.t7.G9(this.uS)},s.prototype.N7=function(t){var i=JSON.parse(t);this.t7.Q9&&this.logger.debug("RCV MSG FROM SRV ",i),this.channelManager.trigger(i.msgName,i.msg)},s.prototype.C7=function(t,i,n){var r=this.wrap(i,t,n);if(this.client&&this.client.xS()){var s=JSON.stringify(r);this.t7.Q9&&this.logger.debug(" FORWARDING REQUEST : "+s);var e=new u.Lc(HiveStreamingServices.bW,0,s);return this.client.xS().send(e)}return h.reject()},s.prototype.wrap=function(t,i,n){return{msgId:this.Sl++,destination:n,msg:t,msgName:i}},s.prototype.S7=function(t,i,n,r){var s={channel:{label:i.label,ice_candidates:n}};return this.C7("update_ice_candidates",s,r)},s.prototype.offer=function(t,i,n,r,s){var e={peer:{guid:t,first_seen:o.Framework.time()},channel:{label:n.label,ice_candidates:r,offer:s}};return this.C7("offer",e,n.s7)},s.prototype.h7=function(t,i,n){this.t7.Q9&&this.logger.debug("Discovery service rejects offer from peer "+i+" on channel "+n);var r={c7:t,channel:n};return this.C7("answer",r,i)},s.prototype.answer=function(t,i,n,r){var s={answer:i,k7:this.t7.uS,channel:{label:t.label,ice_candidates:n}};return this.C7("answer",s,r)},s);function s(){this.Sl=1,this.client=o.Framework.resolve(o.Framework.v.jl)}i.pZ=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(5),e=n(0),h=(o.prototype.init=function(t){this.logger=e.Framework.resolve(e.Framework.v.p).log(t.sessionId),this.hM=t.hM,this.D7()},o.prototype.D7=function(){var t=this;e.Framework.setInterval(function(){t.j7()},s.xu.Cu.ko)},o.prototype.j7=function(){var i=this;this.J1.values().filter(function(t){return e.Framework.time()-t.L_.y_>s.xu.Cu.Do}).forEach(function(t){i.hM.abort(t.X_),i._H(t.I_(),t.N_())})},o.prototype.mH=function(t){this.M7(t.I_(),t.N_()),this.J1.set(t.N_(),t)},o.prototype._H=function(t,i){this.J1["delete"](i),this.P7(t,i)},o.prototype.AH=function(t){this.L7(t)},o.prototype.RH=function(t){this.EH["delete"](t)},o.prototype.L7=function(t){if(this.EH.set(t.I_(),t.R_()),this.H7.push(t.I_()),this.EH.length>s.xu.Cu.Co){var i=this.H7[0];this.EH["delete"](i),this.H7.splice(0,1)}},o.prototype.vH=function(t){return this.EH.has(t)},o.prototype.wH=function(t){return this.EH.get(t)},o.prototype.M7=function(t,i){if(this.U7.has(t))this.U7.get(t).push(i);else{var n=[];n.push(i),this.U7.set(t,n)}},o.prototype.P7=function(t,i){if(this.U7.has(t)){var n=this.U7.get(t),r=n.indexOf(i);-1==r?this.logger.warn("I CANNOT FIND THE REQUEST ID "+i):n.splice(r,1),0==n.length&&this.U7["delete"](t)}else this.logger.warn("TRIED TO REMOVE AN OBJECT THAT DOES NOT EXIST")},o.prototype.bH=function(t){var i=[];if(this.F7(t))for(var n=this.U7.get(t),r=0;r<n.length;r++)this.J1.has(n[r])&&i.push(this.J1.get(n[r]));return i},o.prototype.F7=function(t){return this.U7.has(t)},o.prototype.NH=function(){return 0!=this.J1.length},o.prototype.gH=function(t){return this.U7.has(t)},o);function o(){this.EH=new r(),this.H7=[],this.J1=new r(),this.U7=new r()}i.Cu=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),s=n(5),e=n(6),h=n(23),o=(u.prototype.setId=function(t){this.G7=t},u.prototype.getId=function(){return this.G7},u.prototype.xZ=function(t){this.udpScore=t},u.prototype.jq=function(){return this.udpScore},u.prototype.BZ=function(t){this.x7=t},u.prototype.w2=function(){return this.x7},u.prototype.setContextId=function(t){var i=h.ol.ib(t+"_"+s.xu._u.xh).toString(h.ol.jg.Mg);this.contextId=i},u.prototype.getContextId=function(){return this.contextId},u.prototype.yq=function(t){this.B7=t},u.prototype.zM=function(){return this.B7},u.prototype.Pq=function(t){this.V7=t},u.prototype.aP=function(){return this.V7},u.prototype.VQ=function(t){this.q7=t},u.prototype.fP=function(){return this.q7},u.prototype.BQ=function(t){this.Q7=t},u.prototype.cP=function(){return this.Q7},u.prototype._2=function(t){this.siteId=t},u.prototype.sP=function(){return this.siteId},u.prototype.R2=function(t){this.Y7=t},u.prototype.eP=function(){return this.Y7},u.prototype.bq=function(t){this.K7=t},u.prototype.pP=function(){return this.K7},u.prototype.W7=function(t){this.X7=t},u.prototype.lP=function(){return this.X7},u.prototype.JF=function(t){this.watchingQualityLevel=t},u.prototype.ZF=function(){return this.watchingQualityLevel},u.prototype._q=function(t){this.mq=t},u.prototype.EP=function(){return this.mq},u.prototype.bG=function(t){this.privateIp=t},u.prototype.getPrivateIp=function(){return this.privateIp},u.prototype.EG=function(t){this.publicIp=t},u.prototype.getPublicIp=function(){return this.publicIp},u.prototype.setReportingGuid=function(t){this.reportingGuid=t},u.prototype.getReportingGuid=function(){return this.reportingGuid},u.prototype.setDelta=function(t){this.delta=t},u.prototype.getDelta=function(){return this.delta},u.prototype.RM=function(t,i){this.z7.set(t.id,i)},u.prototype.OM=function(t){this.z7["delete"](t.id)},u.prototype.xQ=function(){return this.z7},u.prototype.UU=function(){return this.lP()?this.z7.values().map(function(t){return t.qualityLevel}):[]},u.prototype.FU=function(){return this.lP()?[]:this.z7.values().map(function(t){return t.qualityLevel})},u.prototype.MZ=function(t){this.ticket=t},u.prototype.wP=function(){return this.ticket},u.prototype.PZ=function(t){this.f0=t},u.prototype.k8=function(){return this.f0},u.prototype.tG=function(){return this.srcThroughput},u);function u(){this.udpScore=0,this.x7=0,this.B7=!1,this.X7=!1,this.V7=!1,this.q7=!1,this.Q7=!1,this.z7=new r(),this.srcThroughput=new e.ma()}i.DZ=o},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var a,f=n(9),e=n(224),c=n(2),l=n(1),v=n(5),h=(a=e.J7,s(o,a),o.prototype.f9=function(t,i){var r=[],s=[],e=[],h=[];try{var o=this.tv.sP(),u=this.tv.eP();return t.forEach(function(t){t.hP.peerInfo.type==f.pf.bf&&r.push(t);var i=t.hP.peerInfo.internalAs;if(0!=o&&o===i&&s.push(t),v.xu.ju.$o){var n=t.hP.peerInfo.externalAs;0!=u&&u===n&&e.push(t)}t.hP.peerInfo.type==f.pf.gf&&h.push(t)}),0<r.length?a.prototype.f9.call(this,r,i):0<s.length?a.prototype.f9.call(this,s,i):0<e.length?a.prototype.f9.call(this,e,i):a.prototype.f9.call(this,h,i)}catch(t){return l.ErrorMonitor.getInstance().logError("Error choosing partner for p2p",this.loggerId,c.Lr.Hr,t),null}},o);function o(){return null!==a&&a.apply(this,arguments)||this}i.AZ=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(5),e=n(1),h=n(2),o=(u.prototype.h9=function(t){this.tv=t},u.prototype.f9=function(t,i){var n=this.Z7(t);return n?n[0]:null},u.prototype.ttt=function(t,i){return s.xu.ju.Yo*(t.dP()/i)+s.xu.ju.Ko*(1-t.S8())},u.prototype.Z7=function(t){var n=this;try{var r=.1;r+=t.map(function(t){return t.dP()}).reduce(function(t,i){return t+i});var i=t.sort(function(t,i){return n.ttt(i,r)-n.ttt(t,r)}),s=[];return i.forEach(function(t){s.push(t.guid+":"+n.ttt(t,r))}),this.logger.debug("SC ["+s.join(", ")+"]"),i}catch(t){return e.ErrorMonitor.getInstance().logError("Error sorting the partners",this.loggerId,h.Mr.Pr,t),null}},u);function u(){this.loggerId="[PickerTRSingle] ",this.logger=r.Framework.resolve(r.Framework.v.p).log()}i.J7=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var v=n(54),d=n(3),E=n(66),w=n(6),p=n(5),a=n(0),r=n(53),s=n(107),e=n(8).Y.sf,h=(o.prototype.init=function(t){this.logger=a.Framework.resolve(a.Framework.v.p).log(t.sessionId),this.tv=t.tv,this.LZ=t.LZ,this.xV=t.xV,this.WH=t.WH},o.prototype.fM=function(t){this.cM=t},o.prototype.N2=function(){this.t0()},o.prototype.Tq=function(){if(p.xu.Nu.wo)this.itt();else{var t=!this.tv.aP()||this.tv.zM()||!e;this.logger.debug("REQUEST REMOTE ELECTION "+t),t?this.itt():this.ntt()}},o.prototype.itt=function(){var t=this.tv.sP(),i=t&&0!=t?s.UV.tM:s.UV.AS;this.LZ.O2(i)},o.prototype.ntt=function(){this.LZ.O2(s.UV.FV)},o.prototype.t0=function(){var t=this;this.YZ(),this.stt=a.Framework.setInterval(function(){t.Tq()},p.xu.Nu.bo),this.WH.AR(),this.Tq()},o.prototype.YZ=function(){this.stt&&a.Framework.clearInterval(this.stt)},o.prototype.KZ=function(){this.WH.VM(),this.cM.o1()},o.prototype.Oq=function(t){var i=new d();if(t){this.ett().forEach(function(t){i.set(t,v.Jj.Zj)});var n=!1,r=v.Jj.Zj;this.tv.lP()&&(r=v.Jj.tM,n=!0),this.WH.EM(i,r,n)}else this.WH.EM(i,v.Jj.Z_,!1)},o.prototype.S2=function(t,i){var n=this,r=this.htt(i),s=this.WH.dM().UH();if(t&&0<t.length){var e=new E();e.hiveAddEach(t);var h=p.xu.Nu.fo||e.some(function(t){var i=w.ja(hive.services.protocol.tracker.TrackerRankType,t.key.rankType);return n.logger.info("GOT RANKING "+i+",CRV "+t.cumulatedRankValue+",RV "+t.ranking+",GS "+t.groupSize),n.ott(t)});p.xu.Nu.co&&(h=this.utt(h));var o=null!=r&&0!=r.length;if(this.logger.debug("Tracker reports ["+r.keys().join(", ")+"]  quality levels"),this.logger.debug("ISLive "+s+" DoElect "+h),p.xu.Nu.ao&&s){var u=this.ett();if(o&&h){this.tv.W7(!0),this.logger.info("BECOMING SITE LEADER");var a=new d();u.forEach(function(t){a.set(t,v.Jj.Zj)}),r.forEach(function(t,i){n.xV.UQ.has(t)||a.set(i,v.Jj.tM)}),this.WH.EM(a,v.Jj.tM,!1)}else{this.tv.W7(!1);var f=v.Jj.Z_,c=new d();this.tv.aP()&&this.tv.zM()&&(f=v.Jj.Zj,u.forEach(function(t){c.set(t,v.Jj.Zj)})),this.WH.EM(c,f,!1)}}}else if(s){p.xu.Nu.fo?this.tv.W7(!0):this.tv.W7(!1);var l=new d();f=v.Jj.Z_,this.tv.aP()&&this.tv.zM()&&(this.ett().forEach(function(t){l.set(t,v.Jj.Zj)}),f=v.Jj.Zj),p.xu.Nu.fo&&(f=v.Jj.tM),this.WH.EM(l,f,!1)}},o.prototype.utt=function(t){return t?!(this.att=!1):this.tv.lP()?this.att?this.att=!1:this.att=!0:void 0},o.prototype.tY=function(){var t=this.ett(),i=new d();t.forEach(function(t){i.set(t,v.Jj.Zj)});var n=!1,r=v.Jj.Zj;this.tv.lP()&&(r=v.Jj.tM,n=!0),this.WH.EM(i,r,n)},o.prototype.ett=function(){var n=new E();return this.xV.UQ.forEach(function(t,i){t.peerInfo.watchingQualityLevel&&!n.has(t.peerInfo.watchingQualityLevel.id)&&n.hiveAdd(t.peerInfo.watchingQualityLevel.id)}),n.toArray()},o.prototype.htt=function(t){var i=new d(),n=this.tv.sP();return t.forEach(function(t){null!=t.watchingQualityLevel&&(0<n?n===t.internalAs&&i.set(t.watchingQualityLevel,t.guid):i.set(t.watchingQualityLevel,t.guid))}),i},o.prototype.ott=function(t){if(t.groupSize<2)return!1;var i=Math.max(p.xu.Nu["do"],Math.round(t.groupSize*p.xu.Nu.vo));return e||a.Framework.T()&&r.$j.Kj?t.ranking<i&&(this.tv.zM()||!this.tv.aP()):t.ranking<i},o.prototype.FM=function(t,i,n,r){var s=1,e=this.cM.ZM(n,i),h=p.xu.Nu.To*a.Framework.random();if(t==v.Jj.Zj){var o=this.cM.v1()-h;s=Math.max(1,e-o)}else if(t==v.Jj.tM){var u=p.xu.Nu.Oo-h;s=Math.max(1,e-u)+r}return s=Math.round(s)},o);function o(){this.att=!1}i.IZ=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=n(3),e=n(16),h=n(1),o=n(2);n(25);var u=n(6),a=(f.prototype.n2=function(t,i){try{return this.logger.debug("TRACKER CLIENT REGISTERED "+t),this.ftt.has(t)||this.ftt.set(t,i),this.ftt.get(t)}catch(t){h.ErrorMonitor.getInstance().logError("Error adding new tracker client",this.loggerId,o.Ir.Nr,t)}},f.prototype.ctt=function(t){this.ftt["delete"](t)},f.prototype.ltt=function(t){return this.ftt.get(t)},f.prototype.T2=function(t){var i=this;if(this.client&&this.client.xS()){var n=void 0;try{n=this.vtt.ia(t,"TRACKER_REQ",0)}catch(t){h.ErrorMonitor.getInstance().logError("Error serializing the new request",this.loggerId,o.Ir.Cr,t)}if(n){var r=new e.Lc(HiveStreamingServices.pW,1,n),s=this.client.xS().send(r);s.then(function(){return i.logger.info("TRACKER REQUEST SENT")}),s.fail(function(t){h.ErrorMonitor.getInstance().logError("Error sending tracker request",i.loggerId,o.Ir.Sr)})}}else h.ErrorMonitor.getInstance().logError("Error sending tracker request because of connection",this.loggerId,o.Ir.Dr)},f.prototype.dtt=function(t){t.infos.map(function(t){t.guid=atob(t.guid),t.publicIp=new InetAddress(),t.publicIp.address=t.publicIpString,t.privateIp=new InetAddress(),t.privateIp.address=t.privateIpString}),t.peerInfo.guid=atob(t.peerInfo.guid),t.peerInfo.publicIp=new InetAddress(),t.peerInfo.publicIp.address=t.peerInfo.publicIpString,t.peerInfo.privateIp=new InetAddress(),t.peerInfo.privateIp.address=t.peerInfo.privateIpString},f.prototype.init=function(){var n=this;this.logger.debug("TRACKER MANAGER INIT"),this.client&&this.client.xS()?this.client.xS().on(HiveStreamingServices.pW,10,function(t){try{var i=null;try{i=n.vtt.oa(t.msg,"TRACKER_RESP",1,hive.services.protocol.tracker.TrackerResponse),n.dtt(i)}catch(t){h.ErrorMonitor.getInstance().logError("Error deserializing the tracker response",n.loggerId,o.Ir.kr,t)}n.Ett&&n.logger.debug("RESP "+JSON.stringify(i)),i&&n.ftt.has(i.sessionId)?n.ftt.get(i.sessionId).U0(i):n.logger.warn("SESSION ID NOT VALID OR NULL "+i.sessionId)}catch(t){h.ErrorMonitor.getInstance().logError("Error initializing the tracker manager",n.loggerId,o.Ir.jr,t)}}):r.Framework.T()||this.logger.warn(this.loggerId+" CANNOT GET ACTIVE CONNECTION")},f);function f(){this.Ett=!1,this.loggerId="[TRACKER] ",this.ftt=new s(),this.vtt=new u.va(),this.logger=r.Framework.resolve(r.Framework.v.p).log(),r.Framework.T()||(this.client=r.Framework.resolve(r.Framework.v.jl))}i.dZ=a},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var f=n(36),r=n(3),c=n(0),l=n(5),v=n(1),d=n(2),s=(e.prototype.init=function(t){this.logger=c.Framework.resolve(c.Framework.v.p).log(t.sessionId)},e.prototype.F0=function(t){try{var i=t.I_(),n=t.F_,r=t.L_.d_,s=Math.ceil(r/l.xu.ju.qo),e=t.A_.getQualityLevel(),h=0,o=Math.min(l.xu.ju.qo,r);this.wtt(i,e);for(var u=o-h;0<s;){var a=null;try{c.Framework.T()||(a=f.wrap(n.slice(h,o))),h+=u}catch(t){v.ErrorMonitor.getInstance().logError("Error wrapping chunk",this.loggerId,d.pn.bn,t)}this.ptt.get(i).push(a),s--,u=(o=Math.min(h+l.xu.ju.qo,r))-h}}catch(t){v.ErrorMonitor.getInstance().logError("Error adding fragment to the fragmentMap",this.loggerId,d.pn.gn,t)}},e.prototype.wtt=function(t,i){try{if(this.gtt.has(i.id)&&this.gtt.get(i.id).length>l.xu.Cache.Po){var n=this.gtt.get(i.id)[0];this.ptt["delete"](n),this.gtt.get(i.id).shift()}if(this.gtt.has(i.id))this.gtt.get(i.id).push(t),this.ptt.set(t,[]);else{var r=[t];this.gtt.set(i.id,r),this.ptt.set(t,[])}}catch(t){v.ErrorMonitor.getInstance().logError("Error generating the chunk handler hashmaps",this.loggerId,d.pn.yn,t)}},e.prototype.e9=function(t,i){return this.ptt.has(t)?this.ptt.get(t)[i]:null},e.prototype.zZ=function(){this.ptt=new r(),this.gtt=new r()},e);function e(){this.loggerId="[ChunkHandler] ",this.ptt=new r(),this.gtt=new r()}i.gZ=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(3),h=n(5),s=n(0),o=n(2),u=n(1),e=(a.prototype.init=function(t){this.logger=s.Framework.resolve(s.Framework.v.p).log(t.sessionId),this.partnership=t.partnership,this.btt=new r(),this.ytt=new r(),this.Ttt&&this.Ott()},a.prototype.pQ=function(i,t,n){try{if(!this.Ttt)return!1;if(this.btt.has(i)||!t||!n)return!1;var r=this.mtt(t,n);return!!(r&&this.ytt.has(r)&&this.ytt.get(r).length>=h.xu.Ru.zh)&&(u.ErrorMonitor.getInstance().logError("Error peer violates ip spoofing rules",this.loggerId,o.ws.gs,{privateIp:t,publicIp:n,otherGuid:i}),this.logger.debug(this.loggerId+"Spoofing rule violated for "+i+" with privateIp "+t+" publicIp "+n),!0)}catch(t){return u.ErrorMonitor.getInstance().logError("Error checking if peer violates ip spoofing rules",this.loggerId,o.ws.ps,{detailedError:t,otherGuid:i}),!1}},a.prototype.OQ=function(i,t,n){try{if(this.Ttt&&n&&t){var r=this.mtt(t,n),s=this.btt.get(i);s&&s!=r&&this._tt(i,s),this.Rtt(i,r)}}catch(t){u.ErrorMonitor.getInstance().logError("Error adding or updating ip spoofing maps",this.loggerId,o.ws.bs,{detailedError:t,otherGuid:i})}},a.prototype.Stt=function(t){this.Ttt&&this.YQ(t)},a.prototype.Mq=function(t){this.Ttt&&this.YQ(t)},a.prototype.Rtt=function(t,i){this.btt.set(t,i);var n=[];this.ytt.has(i)&&-1!=(n=this.ytt.get(i)).indexOf(t)||(n.push(t),this.ytt.set(i,n))},a.prototype.YQ=function(t){var i=this.btt.get(t);i?(this._tt(t,i),this.btt["delete"](t)):this.logger.warn(this.loggerId+"no ip pair for guid "+t)},a.prototype._tt=function(t,i){var n=this.ytt.get(i),r=n.indexOf(t);-1!=r?(n.splice(r,1),0==n.length?this.ytt["delete"](i):this.ytt.set(t,n)):this.logger.warn(this.loggerId+"pair list "+i+" does not contain guid "+t)},a.prototype.mtt=function(t,i){return i+":"+t},a.prototype.Ott=function(){var e=this;s.Framework.setInterval(function(){try{var s=[];e.ytt.forEach(function(t,i){if(t.length>h.xu.Ru.zh){for(var n=[],r=h.xu.Ru.zh;r<t.length;r++)n.push(t[r]);e.logger.warn("IpSpoofing violation for "+i+" - closing: "+n),s.concat(n)}}),s.forEach(function(t){e.partnership.IQ(t)})}catch(t){u.ErrorMonitor.getInstance().logError("Error checking periodic ip spoofing tables",e.loggerId,o.ws.ys,t)}},h.xu.Ru.Jh)},a);function a(){this.loggerId="[IPSpoofing] ",this.Ttt=h.xu.Ru.$h}i.Ru=e},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(112),o=n(5),u=n(67),a=n(0),f=n(2),c=n(1),l=(e=h.pY,s(v,e),v.prototype.dY=function(t,i){try{return i.sort(u.iU.JH),i.slice(0,t)}catch(t){return c.ErrorMonitor.getInstance().logError("Error selecting partners to remove",this.Att,f.hn.rn,t),[]}},v.prototype.EY=function(t,n,r,i){try{return i.filter(function(i){return n.every(function(t){return t.guid!=i.peerInfo.guid})&&-1==r.indexOf(i.peerInfo.guid)}).slice(0,t)}catch(t){return c.ErrorMonitor.getInstance().logError("Error selecting partners to add",this.Att,f.hn.sn,t),[]}},v);function v(){var t=e.call(this)||this;return t.Att="[Score Partner Selection] ",t.type="Score",t}i.Itt=l;var d=(E.prototype.MQ=function(t){try{var i=t.filter(function(t){return!t.AQ.transport.tl()}),n=a.Framework.time(),r=i.filter(function(t){return n-t.vY>o.xu._u.Kh});return 0<r.length?(r.sort(u.rU.JH),r.slice(0,1)[0]):null}catch(t){return c.ErrorMonitor.getInstance().logError("Error updating partners out",this.Att,f.hn.en,t),null}},E);function E(){this.Att="[Score Partner Selection] "}i.TZ=d},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0}),n(25);var p=n(3),E=n(113),g=n(5),b=n(0),d=n(6),h=n(67),y=n(2),T=n(1),e="NOT_USEFUL_PARTNER",r=(s.prototype.init=function(t){this.tv=t.tv},s.prototype.vQ=function(t,i,n,r){try{var s=[],e=[],h=Math.round(t*(1-g.xu.mu.Fh)),o=Math.max(i.length-h,0),u=t-i.length+o;if(0<o){var a=i.filter(function(t){return!t.AQ.transport.tl()}),f=b.Framework.time(),c=a.filter(function(t){return f-t.vY>g.xu._u.Kh}),l=Math.min(c.length,o);(e=this.dY(l,c)).length>l&&(u+=e.length-l);var v=[],d=[];e.forEach(function(t){v.push(t.guid),d.push(t.tU.ZH(!1))})}return 0<u&&(s=this.EY(u,i,n,r)),new E.wY(s,e)}catch(t){return T.ErrorMonitor.getInstance().logError("Error updating in partners",this.Ntt,y.un["in"],t),new E.wY([],[])}},s.prototype.dY=function(t,i){var n=this;try{i.sort(h.iU.JH);var r=i.slice(0,t);return i.slice(t,i.length).forEach(function(t){n.Ctt(t.hP)&&r.push(t)}),r}catch(t){return T.ErrorMonitor.getInstance().logError("Error selecting partners to remove",this.Ntt,y.un.rn,t),[]}},s.prototype.EY=function(t,i,n,r){var s=this;try{var e=[],h=[],o=[],u=[],a=[],f=[];i.forEach(function(t){f.push(t.guid)});var c=Math.floor(t*g.xu._u.qh),l=this.tv.xQ();r.forEach(function(t){var i=t.peerInfo.streams;if(i){var n=s.isLeader(t,i,l);n.YV?n.ktt?e.push(t):h.push(t):s.Dtt(t,g.xu._u.Vh)?s.Ctt(t)?a.push(t):u.push(t):o.push(t)}else a.push(t)});var v=this.jtt(e,h,o,u,a,t,t,c);return v.slice(0,Math.min(v.length,t))}catch(t){return T.ErrorMonitor.getInstance().logError("Error selecting partners to add",this.Ntt,y.un.sn,t),[]}},s.prototype.jtt=function(t,i,n,r,s,e,h,o){try{var u=[],a=[];0<t.length&&b.Framework.random()<g.xu._u.Qh&&(a=(t=d.Ca(t)).slice(0,Math.min(t.length,o)),u.push.apply(u,a),h=e-a.length);var f=[];0<i.length&&(f=(i=d.Ca(i)).slice(0,Math.min(i.length,o)),u.push.apply(u,f),h=e-f.length);var c=[];0<n.length&&(c=(n=d.Ca(n)).slice(0,Math.min(n.length,o)),u.push.apply(u,c),h=e-c.length);var l=null;0<r.length&&(l=(r=d.Ca(r)).slice(0,Math.min(r.length,h)),h=e-((0<c.length?c.length:0)-l.length));var v=[];return 0<h&&0<s.length&&(v=(s=d.Ca(s)).slice(0,Math.min(s.length,h)),u.push.apply(u,v)),u}catch(t){return T.ErrorMonitor.getInstance().logError("Error grouping partners",this.Ntt,y.un.an,t),[]}},s.prototype.isLeader=function(e,t,h){try{var o=!1,u=this.tv.sP(),a=this.tv.eP(),i=new p();t.forEach(function(t){i.set(t.qualityLevel,t)});var n=new p();return i.forEach(function(t,i){h.has(i)&&n.set(i,t)}),0<n.keys().length&&n.forEach(function(t,i){var n=h.get(i);if(n&&2<=t.state&&1<=n.type){var r=e.peerInfo.internalAs,s=e.peerInfo.externalAs;o=0<u?u===r:0<a&&a===s}}),{YV:!1,ktt:o}}catch(t){return T.ErrorMonitor.getInstance().logError("Error identifying if member is leader or same site",this.Ntt,y.un.fn,{detailedError:t,otherGuid:e.peerInfo.guid}),{YV:!1,ktt:!1}}},s.prototype.Dtt=function(i,t){try{var n=this.tv.getDelta(),r=this.tv.ZF(),s=this.Mtt(i,r);return(0!=n||0!=s)&&n<s&&s+t<n}catch(t){return T.ErrorMonitor.getInstance().logError("Error identifying if member is ahead or behind delta",this.Ntt,y.un.cn,{detailedError:t,otherGuid:i.peerInfo.guid}),!1}},s.prototype.Ctt=function(i){try{var t=this.tv.getDelta(),n=this.tv.ZF(),r=this.Mtt(i,n);return 0==t&&0==r||r<t}catch(t){return T.ErrorMonitor.getInstance().logError("Error identifying if member is behind or not retrieveing the same quality level",this.Ntt,y.un.vn,{detailedError:t,otherGuid:i.peerInfo.guid}),!1}},s.prototype.Mtt=function(i,n){try{var t=i.peerInfo.streams,r=0;return t&&t.forEach(function(t){t.qualityLevel===n.id&&(r=t.delta)}),r}catch(t){return T.ErrorMonitor.getInstance().logError("Error retrieving delta for member's quality level",this.Ntt,y.un.dn,{detailedError:t,otherGuid:i.peerInfo.guid}),0}},s);function s(){this.Ntt="[Delta Partner Selection] "}i.OZ=r;var o=(u.prototype.MQ=function(t,i,n){var r=this;try{this.tv=t;var s=this.tv.xQ(),e=i.streams;if(e){var h=n.filter(function(t){return!t.AQ.transport.tl()}),o=b.Framework.time(),u=h.filter(function(t){return o-t.vY>g.xu._u.Kh});if(0==e.filter(function(t){return s.has(t.qualityLevel)}).length)return null;var a=this.Ptt(u),f=this.Ltt(s,a);if(f)return f;var c=s.keys().length,l=u.length,v=Math.round(l/c),d=a.keys().filter(function(t){return s.has(t)}),E=new p();d.forEach(function(t){E.set(t,a.get(t))});var w=null;return null!=(w=this.Htt(E,v))?w:(e.forEach(function(t){var i=E.get(t.qualityLevel);if(null!=i){var n=r.Utt(i);0<n.length&&!g.xu._u.Yh&&(w=n[0])}}),null!=w?w:null)}return null}catch(t){return T.ErrorMonitor.getInstance().logError("Error selecting partner to update out",this.loggerId,y.En.wn,t),null}},u.prototype.Ptt=function(t){var s=new p();return t.forEach(function(t){var i=t.hP.peerInfo.watchingQualityLevel,n=i?i.id:null;if(n=n||e,s.has(n)){var r=s.get(n);r.push(t),s.set(n,r)}else s.set(n,[t])}),s},u.prototype.Utt=function(t){return t.filter(function(t){if(0==t.nU.P9(g.xu.ku.Bo))return t})},u.prototype.Htt=function(r,s){var n=[];r.forEach(function(t,i){n.push({qualityLevel:i,count:t.length})}),n.sort(function(t,i){return t.count>i.count?1:t.count<i.count?0:-1});var e=null;return n.forEach(function(t){var i=r.get(t.qualityLevel).length;if(s<i){var n=r.get(t.qualityLevel);0<n.length&&(n.sort(h.rU.JH),e=n[0])}}),e},u.prototype.Ltt=function(n,t){var r=this,s=null;return t.has(e)?s=t.get(e)[0]:t.filter(function(t,i){return!n.has(i)}).forEach(function(t,i){var n=r.Utt(t);0<n.length&&(s=n[0])}),s},u);function u(){this.loggerId="[Throughput Partner Selection] ",this.logger=b.Framework.resolve(b.Framework.v.p).log()}i.mZ=o},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),f=n(7),s=n(31),a=n(24),c=n(9),e=n(13),h=n(5),o=(u.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.v.p).log(t.sessionId),this.loggerId="S["+t.sessionId+"]",this.Vl=t.reportingInstance.Vl,this.tv=t.tv,this.r0()},u.prototype.G2=function(t){this.Vl.MU.metrics.memN=t,this.Vl.Ul.metrics.memN=t},u.prototype.yQ=function(t,i){this.Vl.MU.metrics.lookupTotal++,this.Vl.Ul.metrics.lookupTotal++,t?(this.Vl.MU.metrics.lookupNotFound++,this.Vl.Ul.metrics.lookupNotFound++,this.Vl.MU.metrics.lookupFailed++,this.Vl.Ul.metrics.lookupFailed++):i?(this.Vl.MU.metrics.lookupFailed++,this.Vl.Ul.metrics.lookupFailed++):(this.Vl.MU.metrics.lookupReqEstablished++,this.Vl.Ul.metrics.lookupReqEstablished++)},u.prototype.GQ=function(){this.Vl.MU.metrics.lookupReqAccept++,this.Vl.Ul.metrics.lookupReqAccept++},u.prototype.v8=function(t,i,n,r,s){if(this.Ftt||r){var e=s==a.h_.l_,h=this.Vl.lF(t),o=this.Vl.cF(t);h.p2pSuccReq++,h.p2pSuccReceived+=i,o.p2pSuccReq++,o.p2pSuccReceived+=i,e&&(h.p2pSuccReceivedLow+=i,o.p2pSuccReceivedLow+=i),0<n&&!e&&(h.p2pSuccReceivedLow+=i,o.p2pSuccReceivedLow+=i)}},u.prototype.w8=function(t,i,n,r,s,e){if(this.Ftt||s){var h=e==a.h_.l_,o=this.Vl.lF(t),u=this.Vl.cF(t);o.p2pFailReq++,o.p2pSuccReceived+=i,o.p2pFailReceived+=r-i,u.p2pSuccReq++,u.p2pSuccReceived+=i,u.p2pFailReceived+=r-i,h&&(o.p2pSuccReceivedLow+=i,u.p2pSuccReceivedLow+=i),0<n&&!h&&(o.p2pSuccReceivedLow+=i,u.p2pSuccReceivedLow+=i)}},u.prototype.p8=function(t,i,n){if(this.Ftt||n){var r=this.Vl.lF(t),s=this.Vl.cF(t);r.p2pFailReq++,r.p2pFailReceived+=i,s.p2pFailReq++,s.p2pFailReceived+=i}},u.prototype.b8=function(t,i,n){if(this.Ftt||n){var r=this.Vl.lF(i),s=this.Vl.cF(i);r.p2pSuccResp++,r.p2pSuccSent+=t,s.p2pSuccResp++,s.p2pSuccSent+=t}},u.prototype.m8=function(t,i,n,r){if(this.Ftt||r){var s=this.Vl.lF(n),e=this.Vl.cF(n);s.p2pPartResp++,s.p2pSuccSent+=t,s.p2pFailSent+=i-t,e.p2pPartResp++,e.p2pSuccSent+=t,e.p2pFailSent+=i-t}},u.prototype.T8=function(t,i,n){if(this.Ftt||n){var r=this.Vl.lF(i),s=this.Vl.cF(i);r.p2pFailResp++,r.p2pFailSent+=t,s.p2pFailResp++,s.p2pFailSent+=t}},u.prototype.uH=function(t){t?this.Vl.MU.metrics.bitrateUpN++:this.Vl.MU.metrics.bitrateDwnN++},u.prototype.vx=function(t){if(-1==[f.xa.qa,f.xa.Qa].indexOf(t.S_())){var i=t.S_()!=f.xa.Ba;if((this.Ftt||i)&&(this.Vl.hF().reqN++,this.Vl.eF().reqN++,t.S_()==f.xa.Va)){var n=t;if(n.getQualityLevel()){var r=n.getQualityLevel();this.Vl.oF(r).reqN++,this.Vl.uF(r).reqN++}}}else this.Vl.hF().reqOtherN++,this.Vl.eF().reqOtherN++},u.prototype.hx=function(t){var i=t.S_()!=f.xa.Ba;if(this.Ftt||i){var n,r=this.Vl.hF(),s=this.Vl.eF(),e=null,h=null;-1==[f.xa.qa,f.xa.Qa].indexOf(t.S_())&&(r.srcReqN++,s.srcReqN++,!i||(n=this.Gtt(t))&&(e=this.Vl.oF(n),h=this.Vl.uF(n),e.srcReqN++,h.srcReqN++),t.R_()==a.h_.a_&&(r.srcOtherReqN++,s.srcOtherReqN++,!i||(n=this.Gtt(t))&&(e.srcOtherReqN++,h.srcOtherReqN++)))}},u.prototype.c9=function(t){if(this.Vl.hF().p2pSubReqN++,this.Vl.eF().p2pSubReqN++,t.S_()==f.xa.Va){var i=this.Gtt(t);i&&(this.Vl.oF(i).p2pSubReqN++,this.Vl.uF(i).p2pSubReqN++)}},u.prototype.xtt=function(t,i){this.Btt(t,this.Vl.eF()),this.Btt(t,this.Vl.hF());var n=this.Gtt(t);n&&t.S_()===f.xa.Va&&this.tv.ZF().id===n.id&&(this.Btt(t,this.Vl.oF(n)),this.Btt(t,this.Vl.uF(n))),isNaN(i)||(this.Vl.MU.metrics.srcThroughput=i)},u.prototype.wx=function(t,i){var n=t.S_()!=f.xa.Ba;(this.Ftt||n)&&(-1!=[f.xa.qa,f.xa.Qa].indexOf(t.S_())?(this.Vl.hF().respFallbackOtherN++,this.Vl.eF().respFallbackOtherN++):this.xtt(t,i))},u.prototype.px=function(t,i){if(-1!=[f.xa.qa,f.xa.Qa].indexOf(t.S_()))this.Vl.hF().respFallbackOthertErrN++,this.Vl.eF().respFallbackOthertErrN++;else{var n=t.S_()!=f.xa.Ba;if(this.Ftt||n)if(this.oH(t.type))this.Vl.eF().respFallbackErrN++,this.Vl.hF().respFallbackErrN++,!n||(r=this.Gtt(t))&&(this.Vl.oF(r).respFallbackErrN++,this.Vl.uF(r).respFallbackErrN++),0==t.L_.g_&&(this.Vl.eF().srcRespErrN++,this.Vl.hF().srcRespErrN++,!n||(r=this.Gtt(t))&&t.S_()===f.xa.Va&&(this.Vl.oF(r).srcRespErrN++,this.Vl.uF(r).srcRespErrN++)),this.xtt(t,i);else if(t.type==a.h_.a_&&-1!=h.xu.Iu.oo.indexOf(t.X_.status))this.Vl.hF().fallAgentFailedRespN++,this.Vl.eF().fallAgentFailedRespN++,this.Vl.hF().reqN--,this.Vl.eF().reqN--;else{var r;0==t.L_.g_&&(this.Vl.hF().srcOtherRespErrN++,this.Vl.eF().srcOtherRespErrN++),n||(r=this.Gtt(t))&&t.S_()===f.xa.Va&&(this.Vl.oF(r).srcOtherRespErrN++,this.Vl.uF(r).srcOtherRespErrN++),this.xtt(t,i)}}},u.prototype.C0=function(t,i){if(i.Q1==a.h_.l_)this.Vl.eF().respP2pN++,this.Vl.hF().respP2pN++;else if(i.Q1==a.h_.a_)this.Vl.eF().respFallbackN++,this.Vl.hF().respFallbackN++;else if(i.Q1==a.h_.o_){this.Vl.eF().lCacheRespN++,this.Vl.hF().lCacheRespN++;var n=r.Framework.T()?i.length:t.F_.byteLength;this.Vl.eF().lCacheRespQt+=n,this.Vl.hF().lCacheRespQt+=n}},u.prototype.x0=function(t,i){var n=t.S_()!=f.xa.Ba;(this.Ftt||n)&&this.xtt(t,i);var r=new hive.snapshots.PartnerMetrics();r.rateReceived=t.partner.dP(),this.Vl.Ul.TU.set(t.partner.reportingGuid,r)},u.prototype.P0=function(t){if(0!=t.W_&&(this.Vl.hF().p2pSubRespErrN++,this.Vl.eF().p2pSubRespErrN++,t.S_()==f.xa.Va)){var i=this.Gtt(t);i&&(this.Vl.oF(i).p2pSubRespErrN++,this.Vl.uF(i).p2pSubRespErrN++)}},u.prototype.d9=function(t){if(this.Vl.hF().p2pSubRespExpN++,this.Vl.eF().p2pSubRespExpN++,t.S_()==f.xa.Va){var i=this.Gtt(t);i&&(this.Vl.oF(i).p2pSubRespExpN++,this.Vl.uF(i).p2pSubRespExpN++)}},u.prototype.Btt=function(t,i){var n=t.L_.d_,r=t.L_.g_,s=t.L_.E_,e=t.L_.w_,h=t.L_.p_;if(t.S_()!=f.xa.qa){if(t.L_.v_&&e&&e<n){var o=e/n;i.p2pSubRespPartN+=o,this.oH(t.type)||(i.p2pAgenTrafficFailureQt+=n-s)}if(0!=h&&(h==n&&i.lCacheRespN++,i.lCacheRespQt+=t.L_.p_),0!=s)if(s==n&&(this.oH(t.type)&&i.respP2pN++,i.p2pSubRespN++),i.p2pSubReqQt+=n,i.p2pSubRespQt+=s,i.p2pAgenTrafficSuccessQt+=t.L_.p2pAgenTrafficSuccessQt,i.p2pDirectQt+=s,t.partner.hP.peerInfo.type==c.pf.bf)i.p2pUdpbQt+=s,i.p2pNatQt+=s;else{var u=this.tv.sP();u&&0<u&&(null!=t.J0?u===t.J0.internalAs&&(i.p2pNatQt+=s):this.logger.warn("Missing partner info"))}}if(0!=r){if(this.Vtt(t.type)&&(i.srcOtherReqQt+=t.L_.g_),r==n)this.Vtt(t.type)?(i.srcOtherRespN++,i.srcOtherRespQt+=t.L_.g_,i.srcOtherOverQt+=t.L_.g_,i.fallAgentRespN++):i.respFallbackN++,i.srcRespN++;else{i.srcRespErrN++;var a=r/(s+r);i.respFallbackN=a,i.respP2pN=1-a,this.Vtt(t.type)&&(i.srcOtherRespErrN++,i.srcOtherRespQt+=t.L_.g_,i.srcOtherOverQt+=t.L_.g_,i.fallAgenTrafficFailureQt+=t.L_.g_)}i.srcReqQt+=t.L_.g_,i.srcRespQt+=t.L_.g_,i.srcOverQt+=t.L_.g_,this.Vtt(t.type)&&(i.fallAgenTrafficSuccessQt+=t.L_.b_)}},u.prototype.Gtt=function(t){var i=null;if(t.A_ instanceof s.dA){var n=t.A_;n.getQualityLevel()&&(i=n.getQualityLevel())}return i},u.prototype.oH=function(t){return t!=a.h_.l_&&t!=a.h_.a_},u.prototype.Vtt=function(t){return!this.oH(t)},u.prototype.r0=function(){this.qtt()},u.prototype.ZZ=function(){r.Framework.clearInterval(this.Qtt),this.Qtt=null},u.prototype.qtt=function(){var t=this;null==this.Qtt&&(this.Qtt=r.Framework.setInterval(function(){t.Vl.JU=t.tv.eP(),t.Vl.zU=t.tv.sP(),t.Vl.ZU=t.tv.getPublicIp()},h.xu.Lu.vu))},u);function u(){this.Ftt=!0===e.HiveConfig.Stats.AudioAccounting,this.Qtt=null}i.lx=o},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(112),c=n(5),o=n(67),l=n(0),v=n(2),d=n(1),E=n(49),u=(e=h.pY,s(a,e),a.prototype.init=function(t){e.prototype.init.call(this,t),this.h0=t.h0},a.prototype.dY=function(t,i){try{return i.sort(o.iU.JH),i.slice(0,t)}catch(t){return d.ErrorMonitor.getInstance().logError("Error selecting partners to remove",this.Att,v.hn.rn,t),[]}},a.prototype.EY=function(t,n,r,i){try{var s=i.filter(function(i){return n.every(function(t){return t.guid!=i.peerInfo.guid})&&-1==r.indexOf(i.peerInfo.guid)});if(0<s.length){this.h0.Ytt(),this.h0.Ktt(!0);var e=[],h=0;for(s.forEach(function(t){h+=t.J2(),t.J2()});0<s.length&&e.length<t;)for(var o=l.Framework.random()*h,u=0,a=0;a<s.length;a++){var f=s[a];if(u<=o&&o<=u+f.J2()){e.push(f),h-=f.J2(),s.splice(a,1);break}u+=f.J2()}return c.xu.Fu.pu&&(s.sort(function(t,i){return i.J2()-t.J2()}),E.Lk.Mk(null,null,"local_score",this.tv.getReportingGuid(),[[s.length],e.map(function(t){return t.J2()}),s.reduce(function(t,i){return 0<i.J2()&&t.push(i.J2()),t},[])],6)),e}return[]}catch(t){return d.ErrorMonitor.getInstance().logError("Error selecting partners to add",this.Att,v.hn.sn,t),[]}},a);function a(){var t=e.call(this)||this;return t.Att="[Score Partner Selection] ",t.type="Locality",t}i.yZ=u},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0}),n(25);var u=n(5),r=(s.prototype.init=function(t){this.tv=t.tv},s.prototype.Ytt=function(){},s.prototype.Wtt=function(t,i){var n=0,r=t.split("."),s=i.split(".");if(4==r.length&&4==s.length)for(var e=0;e<r.length&&n==e;)r[e]==s[e]&&n++,e++;return n},s.prototype.$tt=function(t){var i=this.tv.ZF();if(!i)return!1;var n=!1;return t.peerInfo.streams.forEach(function(t){t.qualityLevel===i.id&&(n=!0)}),n},s.prototype.Y2=function(t){var i=this.tv.getPrivateIp()?this.tv.getPrivateIp().split(".").slice(0,2).join("."):null,n=this.tv.sP(),r=this.tv.getPublicIp(),s=this.tv.eP(),e=!1,h=0;if(0<s&&s===t.peerInfo.externalAs&&(h+=u.xu.Gu.gu,e=!0,0==n&&(h+=u.xu.Gu.bu)),r&&t.peerInfo.publicIpString){var o=this.Wtt(r,t.peerInfo.publicIpString);h+=o,4===o&&(e=!0)}e&&0<n&&n===t.peerInfo.internalAs&&(h+=u.xu.Gu.bu),e&&t.peerInfo.privateIpString&&t.peerInfo.privateIpString.startsWith(i)&&(h+=u.xu.Gu.yu),this.$tt(t)&&(h+=u.xu.Gu.Tu),h/=u.xu.Gu.Ou,t.Z2(h)},s.prototype.Ktt=function(t){void 0===t&&(t=!1)},s);function s(){}i.NZ=r},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var e=n(4);n(235);var r=n(0),h=n(1),o=n(2),u=n(16),s=n(6),a=(f.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.v.p).log(t.sessionId),this.tv=t.tv},f.prototype.Xtt=function(){var s=this;this.client&&this.client.xS()?this.ztt().then(function(t){s.logger.debug(s.loggerId+"Peer Locality Info constructed with privateip "+t.networkInfo.privateIp);var i=null;try{i=s.vtt.ia(t,"LOCALITY_INFO",0)}catch(t){h.ErrorMonitor.getInstance().logError("Error serializing locality info update",s.loggerId,o.Oe.Zs)}if(i){var n=new u.Lc(HiveStreamingServices.TW,0,i),r=s.client.xS().send(n);r.then(function(){return s.logger.info("LOCALITY INFO UPDATE SENT")}),r.fail(function(t){h.ErrorMonitor.getInstance().logError("Error sending locality update",s.loggerId,o.Oe.Sr)})}}):h.ErrorMonitor.getInstance().logError("Error sending locality update because of missing connection",this.loggerId,o.Oe.Dr)},f.prototype.ztt=function(){var n=this,t=e.defer(),i=new PeerLocalityInfo();i.agentId=this.tv.getReportingGuid();var r=new CustomerInfo();r.partnerId=this.tv.wP().mR(),r.customerId=this.tv.wP()._R(),i.customerInfo=r;var s=new NetworkInfo();return this.kS.getConnectivityInfo().then(function(t){var i=t.getNetworkChanged().getPrivateIp();n.tv.bG(i)}).fail(function(t){h.ErrorMonitor.getInstance().logError("Error getting connectivity info",n.loggerId,o.Oe.yr)})["finally"](function(){""!=n.tv.getPublicIp()&&(s.publicIp=n.tv.getPublicIp()),""!=n.tv.getPrivateIp()&&(s.privateIp=n.tv.getPrivateIp()),i.networkInfo=s,t.resolve(i)}),t.promise},f.prototype.PS=function(t){this.Xtt()},f);function f(){this.loggerId="[LocalityServiceClient] ",this.kS=r.Framework.resolve(r.Framework.v.jR),this.vtt=new s.va(),r.Framework.T()||(this.client=r.Framework.resolve(r.Framework.v.jl))}i.fZ=a},function(t,i,n){var s=n(22),e=window.CustomerInfo=function(t){this.partnerId=null,this.customerId=null,t&&(void 0!==t.partnerId&&null!==t.partnerId&&(this.partnerId=t.partnerId),void 0!==t.customerId&&null!==t.customerId&&(this.customerId=t.customerId))};e.prototype={},e.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=i.ftype,r=i.fid;if(n==s.Type.STOP)break;switch(r){case 1:n==s.Type.STRING?this.partnerId=t.$E().value:t.XE(n);break;case 2:n==s.Type.STRING?this.customerId=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},e.prototype.write=function(t){t.tw("CustomerInfo"),null!==this.partnerId&&void 0!==this.partnerId&&(t.iw("partnerId",s.Type.STRING,1),t.nw(this.partnerId),t.rw()),null!==this.customerId&&void 0!==this.customerId&&(t.iw("customerId",s.Type.STRING,2),t.nw(this.customerId),t.rw()),t.ew(),t.hw()};var h=window.NetworkInfo=function(t){this.privateIp=null,this.publicIp=null,t&&(void 0!==t.privateIp&&null!==t.privateIp&&(this.privateIp=t.privateIp),void 0!==t.publicIp&&null!==t.publicIp&&(this.publicIp=t.publicIp))};h.prototype={},h.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=i.ftype,r=i.fid;if(n==s.Type.STOP)break;switch(r){case 1:n==s.Type.STRING?this.privateIp=t.$E().value:t.XE(n);break;case 2:n==s.Type.STRING?this.publicIp=t.$E().value:t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},h.prototype.write=function(t){t.tw("NetworkInfo"),null!==this.privateIp&&void 0!==this.privateIp&&(t.iw("privateIp",s.Type.STRING,1),t.nw(this.privateIp),t.rw()),null!==this.publicIp&&void 0!==this.publicIp&&(t.iw("publicIp",s.Type.STRING,2),t.nw(this.publicIp),t.rw()),t.ew(),t.hw()};var r=window.PeerLocalityInfo=function(t){this.agentId=null,this.customerInfo=null,this.networkInfo=null,t&&(void 0!==t.agentId&&null!==t.agentId&&(this.agentId=t.agentId),void 0!==t.customerInfo&&null!==t.customerInfo&&(this.customerInfo=new e(t.customerInfo)),void 0!==t.networkInfo&&null!==t.networkInfo&&(this.networkInfo=new h(t.networkInfo)))};r.prototype={},r.prototype.read=function(t){for(t.cp();;){var i=t.WE(),n=i.ftype,r=i.fid;if(n==s.Type.STOP)break;switch(r){case 1:n==s.Type.STRING?this.agentId=t.$E().value:t.XE(n);break;case 2:n==s.Type.STRUCT?(this.customerInfo=new e(),this.customerInfo.read(t)):t.XE(n);break;case 3:n==s.Type.STRUCT?(this.networkInfo=new h(),this.networkInfo.read(t)):t.XE(n);break;default:t.XE(n)}t.JE()}t.ZE()},r.prototype.write=function(t){t.tw("PeerLocalityInfo"),null!==this.agentId&&void 0!==this.agentId&&(t.iw("agentId",s.Type.STRING,1),t.nw(this.agentId),t.rw()),null!==this.customerInfo&&void 0!==this.customerInfo&&(t.iw("customerInfo",s.Type.STRUCT,2),this.customerInfo.write(t),t.rw()),null!==this.networkInfo&&void 0!==this.networkInfo&&(t.iw("networkInfo",s.Type.STRUCT,3),this.networkInfo.write(t),t.rw()),t.ew(),t.hw()}},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),s=(e.prototype.startServer=function(t,i){try{this.Jtt&&this.Jtt.startServer(t,i)}catch(t){this.logger.warn(this.loggerId+t)}},e.prototype.Ztt=function(){try{this.Jtt&&this.Jtt.Ztt()}catch(t){this.logger.warn(this.loggerId+t)}},e.prototype.broadcast=function(t,i,n){try{this.Jtt&&this.Jtt.broadcast(t,i,n)}catch(t){this.logger.warn(this.loggerId+t)}},e.prototype.$Z=function(){try{this.Jtt&&this.Jtt.$Z()}catch(t){this.logger.warn(this.loggerId+t)}},e.prototype.tit=function(t,i){try{this.Jtt&&this.Jtt.tit(t,i)}catch(t){this.logger.warn(this.loggerId+t)}},e);function e(){this.loggerId="[ProxyUDPB]",this.logger=r.Framework.resolve(r.Framework.v.p).log(),this.Jtt=window.myUdpBroadcaster,this.Jtt||this.logger.error(this.loggerId+" helper undefined")}i.kZ=s},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=n(0),e=n(5),h=n(9),o=n(238),s=n(13),u=(a.prototype.init=function(t){this.logger=r.Framework.resolve(r.Framework.v.p).log(t.sessionId),this.Jtt=t.o0,this.tv=t.tv},a.prototype.HZ=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.listeners=t,this.contextId=this.tv.getContextId()},a.prototype.startServer=function(){var s=this;this.logger.debug(this.loggerId+"START UDP BROADCAST SERVER"),this.Jtt.startServer(e.xu.UDPBroadcast.Xo,function(t,i){if(-1<s.iit){var n=o.nit.Pc(i);if(n.uuid!=s.guid&&n.streamId==s.contextId&&n.p2pProtocolVersion===e.xu._u.xh){s.logger.debug(s.loggerId+"I RECEIVED A MESSAGE FROM "+n.uuid);var r=new h.yf(h.pf.bf,null,n.isLeader);r.guid=n.uuid,r.privateIpString=t,r.rankValue=n.rankValue,s.listeners.forEach(function(t){return t.JV([r],!1)})}}})},a.prototype.n0=function(){var t=this;this.logger.info(this.loggerId+"START BROADCAST EVERY "+e.xu.UDPBroadcast.zo),-1!=this.iit&&r.Framework.clearInterval(this.iit),this.iit=r.Framework.setInterval(function(){t.rit()},e.xu.UDPBroadcast.zo),this.rit()},a.prototype.$Z=function(){-1!=this.iit&&r.Framework.clearInterval(this.iit)},a.prototype.rit=function(){var t=new o.nit(this.contextId,this.tv.getId(),this.tv.jq(),this.tv.zM(),e.xu._u.xh);this.logger.info(this.loggerId+"BROADCAST MESSAGE contextId "+t.streamId+" id "+t.uuid+" udpscore "+t.rankValue+" lan leader "+t.isLeader+" protobufVersion "+t.p2pProtocolVersion),s.HiveConfig.UDPBroadcast.usiz&&(e.xu.UDPBroadcast.Jo=s.HiveConfig.UDPBroadcast.usiz),this.Jtt.broadcast(e.xu.UDPBroadcast.Xo,e.xu.UDPBroadcast.Jo,t.ia())},a.prototype.PS=function(t){this.logger.info("UDPDISCOVERY SERVER CONNECTED"),this.sit||(this.guid=t,this.startServer(),this.n0())},a);function a(){this.sit=!1,this.loggerId="[UDPBDiscovery] ",this.iit=-1}i.CZ=u},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.ia=function(){var t={streamId:this.streamId,uuid:this.uuid,rankValue:this.rankValue,isLeader:this.isLeader,p2pProtocolVersion:this.p2pProtocolVersion};return JSON.stringify(t,this.eit)},s.prototype.eit=function(t,i){if(null!==i)return i},s.Pc=function(t){var i=t,n=JSON.parse(i);return new s(n.streamId,n.uuid,n.rankValue,n.isLeader,n.p2pProtocolVersion)},s);function s(t,i,n,r,s){this.streamId=t,this.uuid=i,this.rankValue=n,this.isLeader=r,this.p2pProtocolVersion=s}i.nit=r},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(20),o=(e=h.HiveTechOptions,s(u,e),u);function u(){var t=null!==e&&e.apply(this,arguments)||this;return t.minVersion="3.0.0",t.renderStatsCallback=function(t){},t}i.HiveJSOptions=o},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(6),o=n(35),u=n(1),a=n(32),f=n(95),c=(e=o.VA,s(l,e),l.prototype.send=function(){var i=this;this.pluginId||(this.pluginId=a.aR.getInstance().wA()),f.Rx.getInstance().AR(this.pluginId,this.url,function(t){t.tech.nZ(i)})||(u.ErrorMonitor.getInstance().logError("Failed to initialize session on player request",this.loggerId),this.resolve())},l.prototype.resolve=function(){var t=this,i=new XMLHttpRequest();i.open("GET",this.url),i.onreadystatechange=function(){4===i.readyState&&(t.response=i.responseText,t.responseText=i.responseText,t.readyState=4,t.status=i.status,t.dispatchEvent(h.createEvent(Event,"readystatechange",{currentTarget:t})),t.dispatchEvent(h.createEvent(ProgressEvent,"load",{currentTarget:t})),!1)},i.send()},l);function l(){return null!==e&&e.apply(this,arguments)||this}i.nx=c},function(t,s,i){"use strict";var r,n=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(s,"s",{value:!0});var o=i(4),e=i(47),h=i(75),u=i(46),a=i(242),f=i(15),c=i(243),l=i(20),v=i(244),d=i(28),E=i(45),w=i(44),p=i(19),g=i(29),b=i(62),y=i(1),T=i(60);s.hit=navigator;var O,m=(O=e.HiveSessionInternal,n(_,O),_);function _(){return null!==O&&O.apply(this,arguments)||this}var R=(S.prototype.getName=function(){return S.dR},S.prototype.getVersion=function(){return this.version},S.prototype.needsReportingInstance=function(){return!1},S.prototype.isReady=function(){var n=this;if(null==this.oit||1e4<Date.now()-this.uit){var t=new T.OS();t.mS(navigator.userAgent);var i=t.cL();if("IE"===i.name&&i.version&&parseInt(i.version)<10)return o.reject(new d.HiveTechError(d.wR.NOT_READY,"Internet Explorer < v.10 not supported"));this.ait=Date.now(),this.fit=0;var r="//"+E.gv.Ok+":"+this.plugin.options().monitorPort+"/version.json";this.logger().debug(this.id()+"verifying Hive Client version"),this.oit=f.Cc(r).then(function(t){var i=JSON.parse(t);return n.state=i.state,n.version=i.version,"ready"===n.state?"developer"===n.version||n.version>=n.options_.minVersion?(n.fit=Date.now(),n.logger().debug(n.id()+"Hive Client ready - version "+n.version+" ["+(n.fit-n.ait)+"]"),"ready"):(y.ErrorMonitor.getInstance().logError("Client version requirement not satisfied",n.id(),{version:n.version,minVersion:n.options_.minVersion}),n.plugin.addTechEvent(new g.XS(null,2)),o.reject(new d.HiveTechError(d.wR.VERSION_ERROR,"version "+n.version))):(y.ErrorMonitor.getInstance().logError("Cannot check version: client state not ready",n.id(),{state:n.state}),n.plugin.addTechEvent(new g.XS(null,1)),n.fit=Date.now(),n.logger().debug("[Timing] Hive Client not ready",n.fit-n.ait),o.reject(new d.HiveTechError(d.wR.NOT_READY,"state "+n.state)))},function(t){var i="Client not reachable";return null!=t&&null!=t.status&&-1!=t.status&&(i="Client check returned error"),500===t.status?(y.ErrorMonitor.getInstance().logError(i,n.id(),{error:t}),n.plugin.addTechEvent(new g.XS(null,1)),o.reject(new d.HiveTechError(d.wR.PLUGIN_ERROR,i))):(y.ErrorMonitor.getInstance().logError(i,n.id(),null!=t&&null!=t.status&&-1!=t.status?{status:t.status}:void 0),n.plugin.addTechEvent(new g.XS(null,0)),o.reject(new d.HiveTechError(d.wR.NOT_READY,i)))})["catch"](function(t){if(t instanceof d.HiveTechError)return o.reject(t);var i="Error fetching Hive Client version";return y.ErrorMonitor.getInstance().logError(i,n.id(),t),o.reject(new d.HiveTechError(d.wR.NOT_READY,i))}),this.uit=Date.now()}return this.oit},S.prototype.initSession=function(t,i){var n=this,r=this.plugin.options(),s=r.readyCheckTimeout,e=r.macReadyCheckTimeout,h=this.cit.getTimeout(s,e,this.logger());return(h&&0<h?this.isReady().timeout(h,"Client Ready check timed out after "+h+"ms"):this.isReady()).then(function(){return n.lit(t)["catch"](function(t){return o.reject(t)})})["catch"](function(t){return t instanceof Error&&(t=new d.HiveTechError(d.wR.TIMEOUT_ERROR,t.message)),o.reject(t)})},S.prototype.getInitSessionTimeout=function(){return this.options_.initTimeout},S.prototype.isActive=function(t,i){return-1<t.indexOf(i.vit)},S.prototype.closeSession=function(i,n){var r=this;this.logger().debug(this.id()+"Stopping session "+i.id+" [complete close:"+n+"]");var t="//"+E.gv.Ok+":"+this.plugin.options().playerPort+"/session?action=stop";t+="&currentSession="+i.id,n&&(t+="&completeStop=true"),n&&s.hit.sendBeacon?(s.hit.sendBeacon(t),this.logger().debug(this.id()+"session stopped ["+i.id+"][beacon]")):f.Cc(t,null,!n).then(function(){r.logger().debug(r.id()+"session stopped ["+i.id+"]"+(n?"[sync]":""))},function(t){r.logger().warn(r.id()+"session close error ["+i.id+"]"+(n?"[sync]":""),t)})},S.prototype.onStateChange=function(t,i){this.dit=i?p.Il.IDLE:p.Il.Nl,this.logger().notice("[HiveComm] client state: "+p.Il[this.dit])},S.prototype.handleStats=function(t,i){if(this.dit==p.Il.IDLE)return o.resolve(!0);var n="playing-point="+i.playingPoint;n+="&buffer-length="+i.bufferLength,n+="&total-buffering="+i.totalBuffering,n+="&width="+i.width,n+="&height="+i.height,n+="&fullscreen="+i.fullscreen;var r=t.vit+"stats?"+n;return this.logger().trace(r),f.Cc(r)},S.prototype.handleEvent=function(t,i,n){var r=this;if(!(i!==g.PlayerEvents.VISIBLE&&i!==g.PlayerEvents.HIDDEN||this.version&&("developer"===this.version||"2017"<=this.version)))return o.resolve(!0);var s=t.vit+"player-event?type="+g.PlayerEvents[i];if(null!=n)for(var e in n)n.hasOwnProperty(e)&&(s+="&"+e+"="+n[e]);return this.logger().debug(this.id()+"event "+g.PlayerEvents[i],null!=n?n:""),f.Cc(s).fail(function(t){return r.logger().warn(r.id()+"error sending feedback event to Hive Client",t),o.reject(t)})},S.prototype.handleTechEvent=function(t,i){return o.resolve(!0)},S.prototype.updatePlayerInfo=function(t){var i=this;if(this.Eit())return this.logger().warn("Player info not supported in this Java client version"),o.resolve(!0);var n="comm-version="+this.plugin.getCoreVersion();n+="&plugin-name="+this.plugin.getPluginName(),n+="&plugin-version="+this.plugin.getPluginVersion(),n+="&player-tech="+this.plugin.getPlayerTech(),n+="&player-version="+this.plugin.getPlayerVersion(),this.plugin.getTelemetryId()&&(n+="&telemetry-id="+this.plugin.getTelemetryId());var r=t.vit+"player-info?"+n;return f.Cc(r).fail(function(t){return i.logger().debug(i.id()+"error sending player Info to Hive Client",t),o.reject(t)})},S.prototype.onError=function(t){var i=!0;if(null!=this.options_.onError)try{!1===this.options_.onError(t)&&(i=!1)}catch(t){y.ErrorMonitor.getInstance().logError("Exception in user-defined onError callback",this.id(),t)}return i},S.prototype.onTechTimeout=function(t,i,n){var r={isReadyIn:this.ait,isReadyOut:this.fit,leaseIn:this.wit,leaseOut:this.pit,resolveIn:this.git,resolveOut:this.bit};void 0!==i&&null!=i&&(r.sessionId=i.id),void 0!==n&&(r.total=n);var s=JSON.parse(JSON.stringify(r));y.ErrorMonitor.getInstance().logError(t.message,this.id(),s),this.plugin.addTechEvent(new g.XS(null,5,r)),this.yit()},S.prototype.onActiveSession=function(t){if(this.updatePlayerInfo(t),h.SessionStorageUtil.setItem("hiveActiveSessionId",t.id),null!=this.options_.onActiveSession)try{this.options_.onActiveSession(t.toHiveSession())}catch(t){y.ErrorMonitor.getInstance().logError("Exception in user-defined onActiveSession callback",this.id(),t)}},S.prototype.setPlugin=function(t){this.plugin=t},S.prototype.id=function(){return"["+S.dR+"] "},S.prototype.Tit=function(t){null!=t[S.dR]&&f.updateOptions(t[S.dR],this.options_)},S.prototype.lit=function(i){var n=this,r=new Date().getTime();return this.Oit(i).then(function(t){return t?n.mit(i,t,r):n.resolveTicketPromise(i).then(function(t){return n.mit(i,t,r)})})},S.prototype.Oit=function(i){var r=this;if(this.wit=Date.now(),this.plugin.options().useSessionCheck){var n="//"+E.gv.Ok+":"+this.plugin.options().playerPort+"/session?&action=check";n+="&hivePluginId="+this.plugin.getPluginId(),n+="&callback="+encodeURIComponent(i);var t=h.SessionStorageUtil.getItem("hiveActiveSessionId");return h.SessionStorageUtil.removeItem("hiveActiveSessionId"),t&&(n+="&currentSession="+t),this._it(),this.Rit(n).then(function(t){return r.pit=Date.now(),t?r.Sit(t,n,i,r.wit):(r.logger().debug(r.id()+"session allowed ["+(r.pit-r.wit)+"]"),!1)},function(t){if(400==t.status)return r.Ait("bad request","error resolving ticket",t);if(401==t.status)return r.Ait("unauthorized","error verifying the ticket",t);if(403!=t.status)return 404==t.status?(r.logger().debug(r.id()+"installed version does not support active session check"),r.pit=Date.now(),!1):(y.ErrorMonitor.getInstance().logError("unhandled error from Java",r.id(),{error:t.status}),r.plugin.addTechEvent(new g.XS(null,4)),o.reject(new d.HiveTechError(d.wR.PLUGIN_ERROR,t)));var i=S.Iit(t,void 0,"session"),n=i?{Nit:i}:void 0;return y.ErrorMonitor.getInstance().logError("reports another active session",r.id(),n),r.plugin.addTechEvent(new g.XS(null,3,n)),o.reject(new d.HiveTechError(d.wR.SESSION_ERROR,"another active session"+(n?" ["+n.Nit+"]":"")))})["catch"](function(t){return t instanceof d.HiveTechError?o.reject(t):(y.ErrorMonitor.getInstance().logError("unhandled error on requestLeaseDirect",r.id(),{error:t}),r.plugin.addTechEvent(new g.XS(null,4)),r.pit=Date.now(),r.plugin.logger().warn("[Timing] unhandeled session request ",r.pit-r.wit),o.reject(new d.HiveTechError(d.wR.PLUGIN_ERROR,t)))})["finally"](function(){clearTimeout(r.Cit)})}return this.logger().debug(this.id()+"Hive session check disabled - will directly resolve ticket (other active sessions may fail)"),o.resolve(!1)},S.prototype.Rit=function(t){var i;if(this.plugin.options().testId){if(!("developer"!==this.version||this.version<E.gv.Ak))return f.Cc(t,void 0,!0,((i={})[w.Rc.Tk]=this.plugin.options().testId,i));this.logger().warn(this.id()+"The Hive Client Version installed does not support the test id in its generated metrics")}return f.Cc(t)},S.prototype.Ait=function(t,i,n){var r=S.Iit(n,t);return y.ErrorMonitor.getInstance().logError(i,this.id()),this.bit=Date.now(),o.reject(new d.HiveTechError(d.wR.TICKET_ERROR,r))},S.Iit=function(t,i,n){void 0===n&&(n="status");var r=i;if(t.body)try{r=JSON.parse(t.body)[n]}catch(t){}return r},S.prototype.resolveTicketPromise=function(i){var n=this;this.git=Date.now(),this.logger().debug(this.id()+"resolving ticket: "+i);var r=this.kit(i);return f.Cc(r,"application/json").then(function(t){return n.Sit(t,r,i,n.git)},function(t){return n.Dit(t,i)})["catch"](function(t){return y.ErrorMonitor.getInstance().logError("error parsing ticket response",n.id(),t),o.reject(new d.HiveTechError(d.wR.PLUGIN_ERROR,t))})},S.prototype.Dit=function(t,i){return y.ErrorMonitor.getInstance().logError("error resolving ticket",this.id(),{ticket:i}),o.reject(new d.HiveTechError(d.wR.TICKET_ERROR,t))},S.prototype.Sit=function(t,i,n,r){var s=JSON.parse(t),e=c.jit((0===i.indexOf("//")?location.protocol:"")+i,s.location);return s.version&&!this.version&&(this.version=s.version),this.bit=Date.now(),this.logger().debug(this.id()+"resolved ticket "+n+" -> "+e+" ["+(this.bit-r)+"]"),e},S.prototype.mit=function(t,i,n){var r=this.$G(t,i);if(null==r)throw new d.HiveTechError(d.wR.TICKET_ERROR,"error generating session");var s=new Date().getTime()-n;return s>=this.options_.warnSlowRespTimeout&&this.onTechTimeout(new d.HiveTechError(d.wR.TIMEOUT_ERROR,this.id()+" The tech initialization took more than "+this.options_.warnSlowRespTimeout+" milliseconds"),r,s),u.HiveRequestFactory.register(this),r},S.prototype.$G=function(t,i){var n=b.Ticket.OR(t),r=new m(t,n,i,null,this.plugin.options().onSessionStateChange);r.SDN=!0;var s=E.gv.Rk.exec(r.manifest);return null!=s?(r.vit=s[1],r.id=s[5],r):null},S.prototype.kit=function(t){var i=-1==t.indexOf("?")?"?":"&";return this.Eit()?f.Ic(E.gv._k,E.gv.Ok,this.plugin.options().playerPort,t):f.Ic(E.gv.mk,E.gv.Ok,this.plugin.options().playerPort,t,i,this.plugin.getPluginId4Java())},S.prototype._it=function(){var t=this;this.Cit&&clearTimeout(this.Cit),this.Cit=setTimeout(function(){y.ErrorMonitor.getInstance().logError("The Lease Request is taking more than "+t.options_.warnSlowRespTimeout+" secs",t.id())},this.options_.warnSlowRespTimeout)},S.prototype.yit=function(){this.wit=0,this.pit=0,this.git=0,this.bit=0},S.prototype.logger=function(){return this.plugin.logger()},S.prototype.resetTech=function(){this.yit()},S.prototype.Eit=function(){return this.options_.supportLegacyClient&&(!this.version||this.version.substr(0,4)<"2016")},S.prototype.getPluginId=function(){return this.plugin.getPluginId()},S.prototype.createManifestRequest=function(t){return new XMLHttpRequest()},S.prototype.createRequest=function(t){return new XMLHttpRequest()},S.prototype.supportsXhrInterception=function(){return!1},S.dR="HiveJava",S);function S(t,i){this.uit=0,this.plugin=t,this.options_=new v.HiveJavaOptions(),this.cit=new a.TimeoutResolver(),this.Tit(i),f.parseParameterOptions(window.location.href,new l.UrlConfigurableOptions(),this.options_)}s.HiveJava=R},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var r=(s.prototype.getTimeout=function(t,i,n){return t=isNaN(t)?(n.debug("readyCheckTimeout is "+t+". Setting it to 0"),0):Number(t),i=isNaN(i)?(n.debug("macReadyCheckTimeout is "+i+". Setting it to 0"),0):Number(i),window.navigator.platform.match(/Mac/gi)&&-1<i?i:t},s);function s(){}i.TimeoutResolver=r},function(t,i,n){var r,f,s,e,c;r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,f=/^([^\/?#]*)(.*)$/,s=/(?:\/|^)\.(?=\/)/g,e=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,c={jit:function(t,i,n){if(n=n||{},t=t.trim(),!(i=i.trim())){if(!n.Mit)return t;var r=c.Pit(t);if(!r)throw new Error("Error trying to parse base URL.");return r.path=c.vE(r.path),c.Lit(r)}var s=c.Pit(i);if(!s)throw new Error("Error trying to parse relative URL.");if(s.scheme)return n.Mit?(s.path=c.vE(s.path),c.Lit(s)):i;var e=c.Pit(t);if(!e)throw new Error("Error trying to parse base URL.");if(!e.Hit&&e.path&&"/"!==e.path[0]){var h=f.exec(e.path);e.Hit=h[1],e.path=h[2]}e.Hit&&!e.path&&(e.path="/");var o={scheme:e.scheme,Hit:s.Hit,path:null,Uit:s.Uit,query:s.query,Av:s.Av};if(!s.Hit&&(o.Hit=e.Hit,"/"!==s.path[0]))if(s.path){var u=e.path,a=u.substring(0,u.lastIndexOf("/")+1)+s.path;o.path=c.vE(a)}else o.path=e.path,s.Uit||(o.Uit=e.Uit,s.query||(o.query=e.query));return null===o.path&&(o.path=n.Mit?c.vE(s.path):s.path),c.Lit(o)},Pit:function(t){var i=r.exec(t);return i?{scheme:i[1]||"",Hit:i[2]||"",path:i[3]||"",Uit:i[4]||"",query:i[5]||"",Av:i[6]||""}:null},vE:function(t){for(t=t.split("").reverse().join("").replace(s,"");t.length!==(t=t.replace(e,"")).length;);return t.split("").reverse().join("")},Lit:function(t){return t.scheme+t.Hit+t.path+t.Uit+t.query+t.Av}},t.exports=c},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var e,h=n(20),o=n(45),u=(e=h.HiveTechOptions,s(a,e),a);function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.minVersion=o.gv.Sk,t.initTimeout=6e4,t.warnSlowRespTimeout=5e3,t.supportLegacyClient=!1,t}i.HiveJavaOptions=u},function(t,i,n){"use strict";var r,s=this&&this.ic||(r=function(t,i){return(r=Object.setPrototypeOf||{__proto__:[]} instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}r(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n())});Object.defineProperty(i,"s",{value:!0});var o,e=n(26),h=(o=e.fR,s(u,o),u.prototype.YJ=function(t,i,n){if(this.Fit&&t!==this.Fit)return o.prototype.YJ.call(this,t,i,n);if(!t[i])throw new Error(this.loggerId+" - method "+i+" is undefined in event target.")},u.prototype.registerEvent=function(t,i,n,r,s){if(t!==this.Fit)return o.prototype.registerEvent.call(this,t,i,n,r,s);var e=t[i](n,r);if(void 0===e||"function"!=typeof e.remove)throw new Error(this.loggerId+" - Missing remove method for unsubscribing '"+n+"' event");var h=e.remove;return"function"==typeof s?h:(s.IY=h,s)},u.prototype.SR=function(t){void 0===t&&(t=!1),o.prototype.SR.call(this,t),t&&(this.Fit=void 0)},u.prototype.zJ=function(t,i,n,r){if(t!==this.Fit)return o.prototype.zJ.call(this,t,i,n,r);r()},u);function u(t,i,n){var r=o.call(this,t,i,n,null)||this;return r.loggerId="[OzEventsBinder]",r.Fit=i,r}i["default"]=h},function(t,i,n){"use strict";Object.defineProperty(i,"s",{value:!0});var c=n(26),l="[HiveOzRequestImplementation]",r="0";function v(t,i,n){try{i(r,d(t),{reason:n,status:t.status,statusText:t.statusText})}catch(t){c.logError("Exception caught from Oz onFailure callback: "+t.message,l,t)}}function d(t){return t.getAllResponseHeaders()||""}i["default"]=function(t,i,n){var r=t.url,s=t.http,e=t.options,h=t.method,o=t.responseType,u=s&&s.credentials,a=e&&e.networkTimeoutMs,f=this.createXMLHttpRequest();"include"===u&&(f.withCredentials=!0),"number"==typeof a&&(f.timeout=a),f.addEventListener("load",function(){return function(t,i){try{i(t.response,function(t){return t.status+(t.statusText?": "+t.statusText:"")}(t),d(t))}catch(t){c.logError("Exception caught from Oz onSuccess callback: "+t.message,l,t)}}(f,i)}),f.addEventListener("error",function(){return v(f,n,"network error")}),f.addEventListener("timeout",function(){return v(f,n,"timeout")}),f.open(h,r),f.responseType=o,f.send()}}],g={},h.lb=f,h.c=g,h.d=function(t,i,n){h.Git(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},h.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"s",{value:!0})},h.t=function(i,t){if(1&t&&(i=h(i)),8&t)return i;if(4&t&&"object"==typeof i&&i&&i.s)return i;var n=Object.create(null);if(h.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:i}),2&t&&"string"!=typeof i)for(var r in i)h.d(n,r,function(t){return i[t]}.bind(null,r));return n},h.n=function(t){var i=t&&t.s?function(){return t["default"]}:function(){return t};return h.d(i,"a",i),i},h.Git=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},h.Bb="",h(h.Tb=114);function h(t){if(g[t])return g[t].exports;var i=g[t]={xit:t,Bit:!1,exports:{}};return f[t].call(i.exports,i,i.exports,h),i.Bit=!0,i.exports}var f,g})}),null);
__d("HiveStreamingOzSDK",["OzHiveStreaming"],(function(a,b,c,d,e,f){"use strict";f.HiveOz=b("OzHiveStreaming").HiveOz;a=window.HiveConfig;f.HiveConfig=a}),null);
__d("XVideoPermalinkController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/{vanity}/videos/{?set_token}/{video_id}/{?story_token}/",{photo_id:{type:"Int"},set_token:{type:"String"},type:{type:"Enum",defaultValue:3,enumType:0},link_share:{type:"String"},subject:{type:"Int"},object_id:{type:"Int"},opaque_cursor:{type:"String"},legacy_user_id:{type:"Int"},legacy_photo_id:{type:"Int"},video_id:{type:"Int"},comment_id:{type:"Int"},notif_t:{type:"String"},is_notification_preview:{type:"Bool",defaultValue:!1},force_theater:{type:"Bool",defaultValue:!1},story_token:{type:"String"},extid:{type:"String"},vanity:{type:"String"},__tn__:{type:"String"},t:{type:"Int"},flite:{type:"String"},__so__:{type:"Enum",enumType:1},__rv__:{type:"Enum",enumType:1},redirect:{type:"Bool",defaultValue:!0},depth:{type:"Int"},reply_comment_id:{type:"Int"},privacy_mutation_token:{type:"String"}})}),null);